<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <!-- <link rel="stylesheet" type="text/css" href="styles.css"> -->
    <style>


html {
    background-color: #B2DFDB;
    
    overflow-y: hidden;;
    overflow-x: hidden;;
  touch-action: manipulation;

    overflow: hidden;
    /* margin: -10px; */
}

/* Navbar Styles */

    .gamepage-header {
        display: flex;
        flex-direction: row;
        align-content: center;
        justify-content: left;
        color: white;
        background-color: #004D40;
        flex: 2;
        padding-top: 00px;
    }

    .nav-content {
        display: flex;
        flex-direction: row;
        align-content: center;
        justify-content: center;

        text-align: center;
        text-decoration: none;
        font-size: 22px;
    }

    .nav-list-item {
        text-align: center;
        display: inline;
        float: none;
        vertical-align: middle;
        padding: 0px 0px 0px 0px;
        margin: 0px 0px;
    }

    #site-logo {
        max-height: 60px;
        width: auto;
        padding: 10px;
        padding-left: 20px;
    }

    .nav-link-text:link {
        color: white;
        text-decoration: none;
        text-transform: uppercase;
    }

    .nav-link-text:visited {
        color: white;
        text-decoration: none;
        text-transform: uppercase;
    }

    .nav-link-text:hover {
        color: darkslategrey;
        background-color: #B2DFDB;
        text-decoration: none;
        text-transform: uppercase;
    }

/* Gamepage Styles */

    .gamepage-wrapper {
        display: flex;
        flex-direction: column;
        flex: 1;
        height: 100vh;
        color: darkslategrey;
        background-color: #00897B;
        color: white; 
    }

    .game-content-container {
        display: flex;
        flex: 100;
        margin: auto;
    }

    .gamepage-left-aside {
        flex: 2;
        color: white;
        background-color: #00897B;
        padding: 15px;
    }

    #dog-image-container {
        margin: auto;
    }
    .game-container {
        color: darkslategrey;
        background-color: #00897B;
        flex: 7;
        width: 100%;
    }

    #game {
        width: 100%;
        height: auto;
    }

    .gamepage-right-aside {
        flex: 1;
        color: white;
        background-color: #00897B;
        padding: 5px;
        padding-right: 20px;
    }
w
    .games-footer {
        display: flex;
        align-items: center;
        justify-content: center;
        flex: 1;
        background-color: #004D40;
        color: white;
    }


    /* cloes crap */


    body {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    
        position: relative;
    background-color: white;
  }

  a:hover,a:active{color:#4CAF50}
  table.w3-table-all{margin:20px 0}
  /*OPPSETT AV TOP, TOPNAV, SIDENAV, MAIN, RIGHT OG FOOTER:*/
  .top {
  position:relative;
  background-color:#ffffff;
  height:68px;
  padding-top:20px;
  line-height:50px;
  overflow:hidden;
  z-index:2;
  }
  .w3schools-logo {
  font-family:fontawesome;
  text-decoration:none;
  line-height:1;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  font-size:37px;
  letter-spacing:3px;
  color:#555555;
  display:block;
  position:absolute;
  top:17px;
  }
  .w3schools-logo .dotcom {color:#4CAF50}
  .topnav {
  position:relative;
  z-index:2;
  font-size:17px;
  background-color:#5f5f5f;
  color:#f1f1f1;
  width:100%;
  padding:0;
  letter-spacing:1px;
  font-family:"Segoe UI",Arial,sans-serif;
  }
  .topnav a{
  padding:10px 15px 9px 15px !important;
  }
  .topnav .w3-bar a:hover,.topnav .w3-bar a:focus{
  background-color:#000000 !important;
  color:#ffffff !important;
  }
  .topnav .w3-bar a.active {
  background-color:#4CAF50;
  color:#ffffff;
  }
  a.topnav-icons {
  width:52px !important;
  font-size:20px !important;
  padding-top:11px !important;
  padding-bottom:13px !important;
  }
  a.topnav-icons.fa-home {font-size:22px !important}
  a.topnav-icons.fa-menu {font-size:22px !important}
  a.topnav-localicons {
  font-size:20px !important;
  padding-top:6px !important;
  padding-bottom:12px !important;
  }
  i.fa-caret-down,i.fa-caret-up{width:10px}
  #sidenav h2 {
  font-size:21px;
  padding-left:16px;
  margin:-4px 0 4px 0;
  width:204px;
  }
  #sidenav a {font-family:"Segoe UI",Arial,sans-serif;text-decoration:none;display:block;padding:2px 1px 1px 16px}
  #sidenav a:hover,#sidenav a:focus {color:#000000;background-color:#cccccc;}
  #sidenav a.active {background-color:#4CAF50;color:#ffffff}
  #sidenav a.activesub:link,#sidenav a.activesub:visited {background-color:#ddd;color:#000;}
  #sidenav a.activesub:hover,#sidenav a.activesub:active {background-color:#ccc;color:#000;}
  #leftmenuinner {
  position:fixed;
  top:0;
  padding-top:112px;
  padding-bottom:0;    
  height:100%;
  width:220px;
  background-color:transparent;
  }
  #leftmenuinnerinner {
  height:100%;
  width:100%;
  overflow-y:scroll;
  overflow-x:hidden;
  padding-top:20px;
  }
  #main {padding:16px}
  #mainLeaderboard {height:90px}
  #right {text-align:center;padding:16px 16px 0 0}
  #right a {text-decoration:none}
  #right a:hover {text-decoration:underline}
  #skyscraper {min-height:600px}
  .sidesection {margin-bottom:32px;}
  #sidesection_exercise a{display:block;padding:4px 10px;}
  #sidesection_exercise a:hover,#sidesection_exercise a:active{background-color:#ccc;text-decoration:none;color:#000000;}
  .bottomad {padding:0 16px 16px 0;float:left;width:auto;}
  .footer a {text-decoration:none;}
  .footer a:hover{text-decoration:underline;}
  #nav_tutorials,#nav_references,#nav_exercises{-webkit-overflow-scrolling:touch;overflow:auto;}
  #nav_tutorials::-webkit-scrollbar,#nav_references::-webkit-scrollbar,#nav_exercises::-webkit-scrollbar {width: 12px;}
  #nav_tutorials::-webkit-scrollbar-track,#nav_references::-webkit-scrollbar-track,#nav_exercises::-webkit-scrollbar-track {background:#555555;}
  #nav_tutorials::-webkit-scrollbar-thumb,#nav_references::-webkit-scrollbar-thumb,#nav_exercises::-webkit-scrollbar-thumb {background: #999999;}
  #nav_tutorials,#nav_references,#nav_exercises {
  display:none;
  letter-spacing:0;
  margin-top:44px;
  }
  #nav_tutorials a,#nav_references a,#nav_exercises a{
  padding:2px 0 2px 6px!important;
  }
  #nav_tutorials a:focus,#nav_references a:focus,#nav_exercises a:focus{
  color: #000;
  background-color: #ccc;
  }
  #nav_tutorials h3,#nav_references h3,#nav_exercises h3{
  padding-left:6px;
  }
  .ref_overview{display:none}
  .tut_overview{
   display :none;
   margin-left:10px;
   background-color :#ddd;
   line-height:1.8em;
  }
  #sidenav a.activesub:link,#sidenav a.activesub:visited {background-color:#ddd;color:#000;}
  #sidenav a.activesub:hover,#sidenav a.activesub:active {background-color:#ccc;color:#000;}
  #sidenav a.active_overview:link,#sidenav a.active_overview:visited {background-color:#ccc;color:#000;}
  .w3-example{background-color:#f1f1f1;padding:0.01em 16px;margin:20px 0;box-shadow:0 2px 4px 0 rgba(0,0,0,0.16),0 2px 10px 0 rgba(0,0,0,0.12)!important}
  .nextprev a {font-size:17px;border:1px solid #cccccc;}
  .nextprev a:link,.nextprev a:visited {background-color:#ffffff;color:#000000;}
  .w3-example a:focus,.nextprev a:focus{box-shadow:0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);}
  .nextprev a.w3-right,.nextprev a.w3-left {background-color:#4CAF50;color:#ffffff;border-color:#4CAF50}
  #w3-exerciseform {background-color:#555555;padding:16px;color:#ffffff;}
  #w3-exerciseform .exercisewindow {background-color:#ffffff;padding:16px;color:#000000;}
  #w3-exerciseform .exerciseprecontainer {background-color:#f1f1f1;padding:16px;font-size:120%;font-family:Consolas,"Courier New", Courier, monospace;}
  #w3-exerciseform .exerciseprecontainer pre[class*="language-"] {padding:1px;}
  #w3-exerciseform .exerciseprecontainer pre {display: block;}
  #w3-exerciseform .exerciseprecontainer input {padding:1px;border: 1px solid transparent;height:1.3em;}
  .w3-theme {color:#fff !important;background-color:#73AD21 !important;background-color:#4CAF50 !important}
  .w3-theme-border {border-color:#4CAF50 !important}
  .sharethis a:hover {color:inherit;}
  .fa-facebook-square,.fa-twitter-square,.fa-google-plus-square {padding:0 8px;}
  .fa-facebook-square:hover, .fa-thumbs-o-up:hover {color:#3B5998;}
  .fa-twitter-square:hover {color:#55acee;}
  .fa-google-plus-square:hover {color:#dd4b39;}
  #google_translate_element img {margin-bottom:-1px;}
  #googleSearch {color:#000000;}
  #googleSearch a {padding:0 !important;}
  .searchdiv {max-width:400px;margin:auto;text-align:left;font-size:16px}
  div.cse .gsc-control-cse, div.gsc-control-cse {background-color:transparent;border:none;padding:6px;margin:0px}
  td.gsc-search-button input.gsc-search-button {background-color:#4CAF50;border-color:#4CAF50}
  td.gsc-search-button input.gsc-search-button:hover {background-color:#46a049;}
  input.gsc-input, .gsc-input-box, .gsc-input-box-hover, .gsc-input-box-focus, .gsc-search-button {
  box-sizing:content-box; line-height:normal;}
  .gsc-tabsArea div {overflow:visible;}
  /*"nullstille" w3css:*/
  .w3-main{transition:margin-left 0s;}
  /*"nullstilling" slutt*/
  @media (min-width:1675px) {
  #main {width:79%}
  #right {width:21%}
  }
  @media (max-width:992px) {
  .top {height:100px}
  .top img {display:block;margin:auto;}
  .top .w3schools-logo {position:relative;top:0;width:100%;text-align:center;margin:auto}
  .toptext {width:100%;text-align:center}
  #sidenav {width:260px;
  box-shadow:0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
  }
  #sidenav h2 {font-size:26px;width:100%;}
  #sidenav a {padding:3px 2px 3px 24px;font-size:17px}
  #leftmenuinner {  
  overflow:auto;
  -webkit-overflow-scrolling:touch;
  height:100%;
  position:relative;
  width:auto;
  padding-top:0;
  background-color:#f1f1f1;
  }
  #leftmenuinnerinner {overflow-y:scroll}
  .bottomad {float:none;text-align:center}
  #skyscraper {min-height:60px}
  }
  @media screen and (max-width:600px) {
  .w3-example, .w3-note, #w3-exerciseform {margin-left:-16px;margin-right:-16px;}
  .top {height:68px}
  .toptext {display:none}
  }
  @font-face {
  font-family:'fontawesome';
  src: url('../lib/fonts/fontawesome.eot?14663396');
  src:url('../lib/fonts/fontawesome.eot?14663396#iefix') format('embedded-opentype'),
  url('../lib/fonts/fontawesome.woff?14663396') format('woff'),
  url('../lib/fonts/fontawesome.ttf?14663396') format('truetype'),
  url('../lib/fonts/fontawesome.svg?14663396#fontawesome') format('svg');
  font-weight:normal;
  font-style:normal;
  }
  .fa {
  display:inline-block;
  font:normal normal normal 14px/1 FontAwesome;
  font-size:inherit;
  text-rendering:auto;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  transform:translate(0, 0);
  }
  .fa-2x {
   font-size:2em;
  }
  .fa-home:before {content:'\e800';}
  .fa-menu:before {content: '\f0c9';}
  .fa-globe:before {content:'\e801';}
  .fa-search:before {content:'\e802'; }
  .fa-thumbs-o-up:before {content:'\e803';}
  .fa-left-open:before {content:'\e804';}
  .fa-right-open:before {content:'\e805';}
  .fa-facebook-square:before {content:'\e806';}
  .fa-google-plus-square:before {content:'\e807';}
  .fa-twitter-square:before {content:'\e808';}
  .fa-caret-down:before {content:'\e809';}
  .fa-caret-up:before {content:'\e80a';}
  .fa.fa-adjust:before { content: '\e80b'; }
  span.marked, span.deprecated {
   color:#e80000;
   background-color:transparent;
  }
  .w3-code span.marked {
   color:#e80000;
   background-color:transparent;
  }
  .darktheme .w3-code span.marked {
   color:#ff9999;
   background-color:transparent;
  }
  .darktheme .w3-example.w3-light-grey {
    background-color:rgb(40,44,52)!important;color:white;
  }
  .intro {font-size:16px}
  .w3-btn, .w3-btn:link, .w3-btn:visited {color:#FFFFFF;background-color:#4CAF50}
  a.w3-btn[href*="exercise.asp"],a.w3-btn[href*="exercise_js.asp"] {margin:10px 5px 0 0}
  a.btnplayit,a.btnplayit:link,a.btnplayit:visited {background-color:#FFAD33;padding:1px 10px 2px 10px}
  a.btnplayit:hover,a.btnplayit:active {background-color:#ffffff;color:#FFAD33}
  a.btnplayit:hover {box-shadow:0 4px 8px 0 rgba(0,0,0,0.2);}
  a.btnsmall:link,a.btnsmall:visited,a.btnsmall:active,a.btnsmall:hover {
  float:right;padding:1px 10px 2px 10px;font:15px Verdana, sans-serif;}
  a.btnsmall:hover {box-shadow:0 4px 8px 0 rgba(0,0,0,0.2);}
  a.btnsmall:active,a.btnsmall:hover {color:#4CAF50;background-color:#ffffff}
  .tagcolor{color:mediumblue}
  .tagnamecolor{color:brown}
  .attributecolor{color:red}
  .attributevaluecolor{color:mediumblue}
  .commentcolor{color:green}
  .cssselectorcolor{color:brown}
  .csspropertycolor{color:red}
  .csspropertyvaluecolor{color:mediumblue}
  .cssdelimitercolor{color:black}
  .cssimportantcolor{color:red}  
  .jscolor{color:black}
  .jskeywordcolor{color:mediumblue}
  .jsstringcolor{color:brown}
  .jsnumbercolor{color:red}
  .jspropertycolor{color:black}
  .javacolor{color:black}
  .javakeywordcolor{color:mediumblue}
  .javastringcolor{color:brown}
  .javanumbercolor{color:red}
  .javapropertycolor{color:black}
  .kotlincolor{color:black}
  .kotlinkeywordcolor{color:mediumblue}
  .kotlinstringcolor{color:brown}
  .kotlin…
  










































  
#slidecontainer {
    width:100%;
  }
  .slider-color {
    -webkit-appearance: none;
    width: 100%;
    height: 15px;
    border-radius: 5px;
    background: #d3d3d3;
    outline: none;
    opacity:0.7;
    -webkit-transition: opacity .15s ease-in-out;
    transition: opacity .15s ease-in-out;
  }
  .slider-color:hover {
    opacity:1;
  }
  .slider-color::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 25px;
    height: 25px;
    border-radius: 50%;
    background: #4CAF50;
    cursor: pointer;
  }
  .slider-color::-moz-range-thumb {
    width: 25px;
    height: 25px;
    border: 0;
    border-radius: 50%;
    background: #4CAF50;
    cursor: pointer;
  }
  
  .slider-pic {
    -webkit-appearance: none;
    width: 100%;
    height: 10px;
    border-radius: 5px;
    background: #FFFFFF;
    outline: none;
    opacity:0.7;
    -webkit-transition: opacity .15s ease-in-out;
    transition: opacity .15s ease-in-out;
  }
  
  .slider-square {
    -webkit-appearance: none;
    width: 40%;
    height: 100%;
    height: 33px;
    background: #000000;
    outline: none;
    opacity:0.7;
    -webkit-transition: opacity .15s ease-in-out;
    transition: opacity .15s ease-in-out;
  }
  .slider-square:hover {
    opacity:1;
  }
  .slider-square::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 24px;
    height: 24px;
    background: #ffffff;
    cursor: pointer;
  }
  .slider-square::-moz-range-thumb {
    width: 24px;
    height: 24px;
    border: 0;
    background: #ffffff;
    cursor: pointer;
  }






  .slider-squarex {
    -webkit-appearance: none;
    width: 40%;
    height: 100%;
    height: 33px;
    background: #000000;
    outline: none;
    opacity:0.7;
    -webkit-transition: opacity .15s ease-in-out;
    transition: opacity .15s ease-in-out;
  }
  .slider-squarex:hover {
    opacity:1;
  }
  .slider-squarex::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 5px;
    height: 33px;
    background: #FF0000;
    cursor: pointer;
  }
  .slider-squarex::-moz-range-thumb {
    width: 24px;
    height: 24px;
    border: 0;
    background: #ffffff;
    cursor: pointer;
  }




  .slider-squarey {
    -webkit-appearance: none;
    width: 40%;
    height: 100%;
    height: 15px;
    background: #000000;
    outline: none;
    opacity:0.7;
    -webkit-transition: opacity .15s ease-in-out;
    transition: opacity .15s ease-in-out;
  }
  .slider-squarey:hover {
    opacity:1;
  }
  .slider-squarey::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 5px;
    height: 20px;
    background: #FF0000;
    cursor: pointer;
  }
  .slider-squarey::-moz-range-thumb {
    width: 24px;
    height: 24px;
    border: 0;
    background: #ffffff;
    cursor: pointer;
  }
  
.GraphCard {
  padding: 1px;
  margin: 1px;
  background-color: #ffde00;
  color: #333;
  display: inline-block;
  font-family: monospace;
  font-size: 32px;
  text-align: center;
}


.disable-dbl-tap-zoom {
  touch-action: manipulation;
}
/* 
@font-face {
  font-family: 'programming6';
  src: url('http://www.ditzbitz.com/ft.ttf');
} */

.ExampleCard {
  padding: 1px;
  margin: 1px;
  background-color: #ffde00;
  color: #333;
  display: inline-block;
  font-family: monospace;
  font-size: 32px;
  text-align: center;
}


    </style>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-5P52B8ZSEF');
    </script>
</head>
<!-- <script src="https://example.com/example-framework.js" crossorigin="anonymous"></script> -->
<div class="gamepage-wrapper">

    <!-- Basic header. Should hold simple branding and navigation. -->
    <header class="gamepage-header">
        <!-- Image provided by Eucalyp Studio in Artificial Intelligence from https://www.iconfinder.com/iconsets/artificial-intelligence-6 -->
        <!-- <img id="site-logo" src="assets/iconfinder_ArtificialIntelligence29_2890576_blackwhite.png"> -->
        <ul class="nav-content">
            <!-- <li class="nav-list-item"><a class="nav-link-text" href="">Home</a></li> -->
            <li class="nav-list-item"><a class="nav-link-text" href="http://ditzbitz.com/games.html">Games</a></li>
            <!-- <li class="nav-list-item"><a class="nav-link-text" href="https://www.linkedin.com/in/cole-ditzler-41b160133/" target="_blank">About</a></li> -->
        </ul>
    </header>

    <!-- Container for page content. Contains and aligns instructions, game, and ads. -->
    <div class="game-content-container">
        <!-- <audio controls>
            <source src="theme.mp3" type="audio/mpeg">
        </audio> -->
        <!-- Left side banner. Should contain instuctions for the game. -->
      
        <!-- Game container. Holds the game for this page scaled to fit.  -->

        <div class="game-container">

            <div id="dog-image-container" >
                <canvas id="canvas"  width="1280" height="720"  style="margin:auto"></canvas>
                <canvas hidden="true" id="tempcanvas" width="2500" height="500"></canvas>

            </div id="go">

                <input type="text" id="fname" name="fname" value="Chat/PlayerName"><br>
                <label hidden for="rooms">Choose a room:</label>
                <select hidden name="rooms" id="rooms">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    <option value="13">13</option>
                    <option value="14">14</option>
                    <option value="15">15</option>
                </select>
        </div>

        <!-- Right side banner. No content for now. Perhaps ad-space in the future. -->
        <aside class="gamepage-right-aside">
            <!-- Add content here later. -->
        </aside>
    </div>

    <!-- Simple footer. Just a copyright notice. -->
    <footer class="games-footer">
    </footer>

</div>

<script>

    // console.log(mongoURL)
    ////////////// ////////////////////////////////////////////console.log(HOST)
    let pick = -1
    let meshX = 10
    const armgranularity = 7

    const squaretable = {}
for(let t = 0;t<14100000;t++){
    squaretable[`${t}`] = Math.sqrt(t)
    if(t > 999){
        t+=9
    }
}

let camerax = 0
    let cameray = 0
    let cameraxsum = 0
    let cameraysum = 0
    // const meshtoggle = 0
    let boys = []
    let stars = []
    let localPlayToggle = 0
    let mapIcons = []
    let minigameIcons = []
    let strarr = []
    let selectors = []
    let characterbuttons = []
    let scores = [] // [119, 0]
    let fightnum = 0
    let drops = []
    const baselaunch = .60
    const vsmashlimit = 210
    const jumplimit = 20
    let scale = .33
    let invscale = 1 / scale
    let worldcounter = 0
    //qqqqq
    let optionsToggle = 0
    let humanPlayers = 1004
    let AItoggle = 0
    let campaignToggle = 0
    let campaigntime = 0
    let campaigntimestart = 0
    let cameraLocked = 0
    let meshtoggle = 0
    let meshRun = 0
    let meshLearn = 0
    let fightlogged = 0
    let mapSelectToggle = 0
    let minigameSelectToggle = 0
    let MapSelect = 0
    let minigameSelected = -1

    let stock = 0
    let ws
    let HOST = location.origin.replace(/^http/, 'ws')
    if (AItoggle == 0  && localPlayToggle == 0) {
        ws = new WebSocket(HOST);
    }
    let connectionnumber = -1
    let start = 0
    let ID = parseFloat(Math.random().toFixed(7))
    let IDaddress = 0
    let color = "#FFFFFF"
    let hit = 0
    let players = 0
    let serverID = parseFloat(Math.random().toFixed(7))
    let localIDs = []
    const colors = ["#FF0000", "#00FF00", "#0000FF", "#FFFF00", "#FFAA00", "#FF00FF", "#00FFFF", "#BBBBBB", "#FF00AA", "#AAFF00", "#AA00FF", "#FFFFAA", "#FFAAFF", "#CC8800", "#FFFFFF", "#BBBBBB", "#FF0000", "#00FF00", "#0000FF", "#FFFF00", "#FFAA00", "#FF00FF", "#00FFFF", "#BBBBBB", "#FF0000", "#00FF00", "#0000FF", "#FFFF00", "#FFAA00", "#FF00FF", "#00FFFF", "#BBBBBB", "#FF0000", "#00FF00", "#0000FF", "#FFFF00", "#FFAA00", "#FF00FF", "#00FFFF", "#BBBBBB", "#FF0000", "#00FF00", "#0000FF", "#FFFF00", "#FFAA00", "#FF00FF", "#00FFFF", "#BBBBBB"]

    const counters = []
    for (let t = 0; t < 1005; t++) {
        counters[t] = 0
    }



    if (AItoggle == 0  && localPlayToggle == 0) {
        socketize(ws)
    }
    // const punchaud1 = new Audio()
    // punchaud1.src = "hitsound2.mp3"
    // const shieldaud1 = new Audio()
    // shieldaud1.src = "shieldhit3.mp3"
    // const gametheme = new Audio()
    // gametheme.src = "theme.mp3"

    let canvas
    let canvas_context
    const keysPressed = {}
    let FLEX_engine
    const TIP_engine = {}
    let XS_engine
    let YS_engine
    const mutationrate = 1 / 21111




    function socketize(ws) {
        
        ws.addEventListener("open", () => {
            ws.addEventListener("message", ({ data }) => {

                if (AItoggle == 1 || localPlayToggle == 1 || campaignToggle == 1) {
                    return
                }





                if (start == 0 && (parseInt(JSON.parse(data).pinging)) !== 1) {
                    data = JSON.parse(data)
                    for (let t = 0; t < data.playerIDs.length; t++) { //error?
                        data.playerIDs[t] = parseFloat(data.playerIDs[t])
                    }
                    if (data.length >= 0 && data.length < 1005 && !(data.delete)) {
                        start = 1
                        connectionnumber = parseInt(data.slot)

                        ID = connectionnumber
                        IDaddress = connectionnumber
                        players = parseInt(data.length)
                        CreatePlayer(data.playerIDs.length)
                    }
                } else if (parseInt(JSON.parse(data).clean) == 1) {
                    data = JSON.parse(data)
                    for (let t = 0; t < (data).playerIDs.length; t++) {
                        data.playerIDs[t] = parseFloat((data).playerIDs[t])
                    }
                    for (let q = 0; q < data.playerIDs.length; q++) {
                        for (let g = 0; g < data.playerIDs.length; g++) {
                            for (let y = 0; y < boys.length; y++) {
                                if (counters[y] > 250) {
                                    if (!(data).playerIDs.includes(boys[y].serverID)) {
                                        if (boys[y].serverID != serverID) {
                                            ////////////////////////////////////console.log(localIDs,)
                                            ////////////////////////////////console.log("caseA", boys[y])
                                            localIDs.splice(localIDs.indexOf(boys[y].serverID)) //sus
                                            boys.splice(y, 1)
                                            ////////////////////////////////////console.log("snip")
                                        }
                                    }
                                }
                            }
                        }
                    }
                } else if (parseInt(JSON.parse(data).kill) == 1) {
                    for (let t = 0; t < boys.length; t++) {
                        if (boys[t].serverID == parseFloat(JSON.parse(data).index)) {
                            boys[t].knocks++
                        }
                    }
                } else if (parseInt(JSON.parse(data).pinging) == 1) {
                    for (let t = 0; t < boys.length; t++) {
                        if (boys[t].serverID == parseFloat(JSON.parse(data).serverID)) {
                            const now = new Date()
                            boys[t].ping = now.getTime() - parseInt(JSON.parse(data).ping)
                        }
                    }
                } else if (parseInt(JSON.parse(data).counter) == 1) {
                    ////////////////////////////////////console.log(data)
                    for (let t = 0; t < boys.length; t++) {
                        if (boys[t].serverID == parseFloat(JSON.parse(data).index)) {
                            boys[t].body.xmom += parseFloat(JSON.parse(data).xmom)
                            boys[t].body.ymom += parseFloat(JSON.parse(data).ymom)
                            boys[t].damage += parseFloat(JSON.parse(data).damage)
                        }
                    }
                } else if (JSON.parse(data).delete) {
                    data = JSON.parse(data)
                    for (let t = 0; t < (data).playerIDs.length; t++) {
                        data.playerIDs[t] = parseFloat((data).playerIDs[t])
                    }

                    if (boys.length == 1) {
                        if (typeof boys[0] == "undefined") {
                            CreatePlayer(0)
                        }
                    }

                    for (let t = 0; t < boys.length; t++) {
                        if (typeof boys[t] == "undefined") {
                            boys.splice(t, 1)
                        }
                    }
                    for (let q = 0; q < data.playerIDs.length; q++) {
                        for (let g = 0; g < data.playerIDs.length; g++) {
                            for (let t = 0; t < boys.length; t++) {
                                if (!(data).playerIDs.includes(boys[t].serverID)) {
                                    if (serverID != boys[t].serverID) {
                                        ////////////////////////////////console.log("caseB", boys[t])
                                        localIDs.splice(localIDs.indexOf(boys[t].serverID))//sus
                                        boys.splice(t, 1)
                                        ////////////////////////////////////console.log("snip")
                                    }
                                }
                            }
                        }
                    }

                    if (boys.length == 1) {
                        if (typeof boys[0] == "undefined") {
                            CreatePlayer(0)
                        }
                    }

                    for (let t = 0; t < boys.length; t++) {
                        if (typeof boys[t] == "undefined") {
                            boys.splice(t, 1)
                        }
                    }
                    for (let t = 0; t < boys.length; t++) {
                        if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                            ID = t
                            connectionnumber = t
                            IDaddress = t
                        }

                    }
                } else if ((data.length >= 0)) {
                    data = JSON.parse(data)
                    data.serverID = parseFloat(data.serverID)
                    let dropouts = 0
                    for (let t = 0; t < Math.max(data.players, boys.length); t++) {
                        if (boys[t] && boys[t].inactive != 1) {
                        } else {
                            dropouts++
                        }
                    }
                    const tempIDs = []
                    for (let t = 0; t < boys.length; t++) {
                        tempIDs.push(boys[t].serverID)
                    }
                    for (let t = 0; t < data.playerIDs.length; t++) {
                        // //////////////////////////////console.log(serverID, data.serverID)
                        if (serverID != data.serverID) {
                            const identites = []
                            for (let g = 0; g < boys.length; g++) {
                                identites.push(boys[g].serverID)
                            }
                            if (localIDs.includes(data.serverID)) {
                                //should prevent sending yourself to yourself?
                                // ////////////////////////////////console.log("caseG")
                                counters[tempIDs.indexOf(data.serverID)] = 0
                                if (data.name == "Coreboy") {
                                    boys[tempIDs.indexOf(data.serverID)] = new Boy(data.id, data)  //data.id?
                                }else if (data.name == "Mass") {
                                    boys[tempIDs.indexOf(data.serverID)] = new Mass(data.id, data)
                                }else if (data.name == "Blastgirl") {
                                    boys[tempIDs.indexOf(data.serverID)] = new Blastgirl(data.id, data)
                                }else if (data.name == "Jox") {
                                    boys[tempIDs.indexOf(data.serverID)] = new Jox(data.id, data)
                                }else  if (data.name == "Adobrasig Man") {
                                    boys[tempIDs.indexOf(data.serverID)] = new AsigMan(data.id, data)
                                }else if (data.name == "Princess GeGeGeGee") {
                                    boys[tempIDs.indexOf(data.serverID)] = new Princess(data.id, data)
                                }else if (data.name == "Rhopho") {
                                    boys[tempIDs.indexOf(data.serverID)] = new Rhopho(data.id, data)
                                }else if (data.name == "Banandroid") {
                                    boys[tempIDs.indexOf(data.serverID)] = new Banandroid(data.id, data)
                                }else if (data.name == "Funky Bunkstanks") {
                                    boys[tempIDs.indexOf(data.serverID)] = new Bunkstanks(data.id, data)
                                }else if (data.name == "Dummy") {
                                    boys[tempIDs.indexOf(data.serverID)] = new Dummy(data.id, data)
                                }else if (data.name == "Scorched Mass") {
                                    boys[tempIDs.indexOf(data.serverID)] = new ScorchedMass(data.id, data)
                                }else if (data.name == "Doctor Soto") {
                                    boys[tempIDs.indexOf(data.serverID)] = new DrSoto(data.id, data)
                                }else if (data.name == "Joule") {
                                    boys[tempIDs.indexOf(data.serverID)] = new Joule(data.id, data)
                                }else if (data.name == "Kessler") {
                                    boys[tempIDs.indexOf(data.serverID)] = new Kessler(data.id, data)
                                }else if (data.name == "Pinwheelian") {
                                    boys[tempIDs.indexOf(data.serverID)] = new Pinwheelian(data.id, data)
                                }else if (data.name == "Gwomp") {
                                    boys[tempIDs.indexOf(data.serverID)] = new Gwompei(data.id, data)
                                }else{
                                    return
                                }
                                const gp = new Gamepad(0)
                                boys[tempIDs.indexOf(data.serverID)]['gamepad'] = gp

                            } else if (!localIDs.includes(data.serverID)) {
                                counters[tempIDs.indexOf(data.serverID)] = 0
                                localIDs.push(data.serverID)
                                ////////////////////////////////console.log("caseC", data)
                                let newplayer = {}
                                if (data.name == "Coreboy") {
                                    newplayer = new Boy(data.slot)  //data.id?
                                }
                                if (data.name == "Mass") {
                                    newplayer = new Mass(data.slot)
                                }
                                if (data.name == "Blastgirl") {
                                    newplayer = new Blastgirl(data.slot)
                                }
                                if (data.name == "Jox") {
                                    newplayer = new Jox(data.slot)
                                }
                                if (data.name == "Adobrasig Man") {
                                    newplayer = new AsigMan(data.slot)
                                }
                                if (data.name == "Princess GeGeGeGee") {
                                    newplayer = new Princess(data.slot)
                                }
                                if (data.name == "Rhopho") {
                                    newplayer = new Rhopho(data.slot)
                                }
                                if (data.name == "Banandroid") {
                                    newplayer = new Banandroid(data.slot)
                                }
                                if (data.name == "Funky Bunkstanks") {
                                    newplayer = new Bunkstanks(data.slot)
                                }
                                if (data.name == "Dummy") {
                                    newplayer = new Dummy(data.slot)
                                }
                                if (data.name == "Scorched Mass") {
                                    newplayer = new ScorchedMass(data.slot)
                                }
                                if (data.name == "Doctor Soto") {
                                    newplayer = new DrSoto(data.slot)
                                }
                                if (data.name == "Joule") {
                                    newplayer = new Joule(data.slot)
                                }
                                if (data.name == "Kessler") {
                                    newplayer = new Kessler(data.slot)
                                }
                                if (data.name == "Pinwheelian") {
                                    newplayer = new Pinwheelian(data.slot)
                                }
                                if (data.name == "Gwomp") {
                                    newplayer = new Gwompei(data.slot)
                                }
                                newplayer.serverID = data.serverID
                                const gp = new Gamepad(0)
                                newplayer['gamepad'] = gp
                                boys.push(newplayer)
                                scores.push(0)
                                drops.push(0)
                            }
                        }

                    }


                    for (let t = 0; t < boys.length; t++) {
                        if (typeof boys[t] == "undefined") {
                            boys.splice(t, 1)
                        }
                    }
                    for (let t = 0; t < boys.length; t++) {
                        if (!boys[t].hasOwnProperty('righthand')) {
                            boys.splice(t, 1)
                        }
                    }


                    if (flopper % 2 == 0) {
                        for (let t = 0; t < boys.length; t++) {
                            if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                boys[t].enemycollide()
                            }
                        }
                    } else {
                        for (let t = boys.length - 1; t >= 0; t--) {
                            if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                boys[t].enemycollide()
                            }
                        }
                    }
                } else {
                    if (data.length >= 0) {
                    }
                }

                // ////////////////////////////////////////////console.log(boys)
            })
            if (AItoggle == 0  && localPlayToggle == 0) {

                if(localPlayToggle != 1){
                ws.send(serverID)
                swapRoom()
                }
            }
        })
    }
    class Perceptron {
        constructor(inputs, layer, outputcount = 0, override = 0) {
            if (override == 0) {
                this.inputs = [...inputs]
                this.weights = []
                this.bias = 0 //this.weight()*2 // 0 // (Math.random() - .5) * 10
                for (let t = 0; t < this.inputs.length; t++) {
                    this.weights.push(this.weight())
                }
                this.value = this.compute()
                this.error = 0
                // if(Math.random()<.1){
                //     this.dropped = Math.floor(Math.random()*2)
                // }else{
                //     this.dropped = 0
                // }
                this.dropped = 0
                this.momentum = .0010 // 0.001
                this.gradient = .001 //Math.random()
                this.layer = layer
                this.biasMomentum = .0010//.001
                this.biasGradient = .0010//.001
                //  this.outputWeightsIndex = Array(outputcount);   
            } else {

                const keys = Object.keys(override)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = override[keys[t]]
                }

            }
        }
        compute() {
            const value = this.bias
            for (let t = 0; t < this.inputs.length; t++) {
                value += this.inputs[t] * this.weights[t]
            }
            return (value)
        }
        lognormalize(output) {
            return (1 / (1 + Math.pow(Math.E, (output * -1))))
        }
        weight() {
            return 1
            // return .01
            // return (Math.random()-.5) * 1
        }
        clone(inputs) {
            const clone = new Perceptron(inputs, this.layer)
            clone.inputs = [...inputs]
            clone.weights = [...this.weights]
            clone.bias = this.bias
            clone.value = clone.compute()
            clone.biasMomentum = this.biasMomentum
            clone.gradient = this.gradient
            clone.biasGradient = this.biasGradient
            clone.momentum = this.momentum
            return clone
        }
        mutate() {
            for (let t = 0; t < this.weights.length; t++) {
                if (Math.random() < mutationrate) {
                    this.weights[t] += (.05 * (Math.random() - .5))
                }
                // if (Math.random() < mutationrate) {
                //     // this.weights[t] *= -1
                // }
                // if (Math.random() < mutationrate) {
                //     // this.weights[t] *= 0
                // }
                // if (Math.random() < mutationrate) {
                //     // this.weights[t] = this.weight()
                // }
                // if (Math.random() < mutationrate) {
                //     // this.weights[t] *= 1 + ((Math.random() - .5) * .5)
                // }
            }

            if (Math.random() < mutationrate) {
                this.bias += (.05 * (Math.random() - .5))
            }
        }
    }
    class GenNN {
        constructor(inputs, layercount, layersetupArray, outputs = 2, override = 0) {
            if (override == 0) {
                this.longInputs = []
                this.longErrors = []
                this.name = getRandomColor()
                this.fitness = 0
                this.correct = 0
                this.wrong = 0
                this.parent = this.name
                this.generation = 0
                this.inputs = [...inputs]
                this.layercount = layercount
                this.layersetupArray = [...layersetupArray]
                this.tempinputs = [...inputs]
                this.structure = []
                this.prev_momentum = 0
                this.lr = .5
                this.iterations = 1
                this.optimizerParams = {}
                this.optimizerParams.alpha = .005
                this.optimizerParams.beta1 = .05
                this.optimizerParams.beta2 = .15
                this.gradients = []
                this.adjustments = []
                for (let t = 0; t < this.layercount; t++) {
                    const nodes = []
                    for (let k = 0; k < this.layersetupArray[t]; k++) {
                        if (typeof this.layersetupArray[t + 1] !== "undefined") {
                            const node = new Perceptron([...this.tempinputs], t, this.layersetupArray[t + 1])
                            nodes.push(node)
                        } else {
                            const node = new Perceptron([...this.tempinputs], t, 0)
                            nodes.push(node)
                        }
                    }
                    this.structure.push(nodes)
                    this.tempinputs = []
                    this.tempclone = []
                    for (let g = 0; g < this.structure[this.structure.length - 1].length; g++) {
                        this.tempinputs.push(this.structure[this.structure.length - 1][g].value)
                        this.tempclone.push(this.structure[this.structure.length - 1][g].value)
                    }
                    for (let n = 0; n < this.tempinputs.length; n++) {
                        this.tempinputs[n] = this.normalize(this.tempinputs[n], Math.min(...this.tempclone), Math.max(...this.tempclone)) //optional
                    }
                }
                this.outputs = this.layersetupArray[this.layersetupArray.length - 1]
                this.outputMagnitudes = []
                this.outputMagnitudesClone = []
                this.outputMagnitudesCloneSpare = []
                for (let t = 0; t < this.outputs; t++) {
                    this.outputMagnitudes.push(this.tempclone[t])
                    this.outputMagnitudesClone.push(this.tempclone[t])
                    this.outputMagnitudesCloneSpare.push(this.tempclone[t])
                }

                this.outputSum = 0
                for (let t = 0; t < this.outputs; t++) {
                    this.outputMagnitudesClone[t] = this.normalize(this.outputMagnitudesClone[t], Math.min(...this.outputMagnitudesCloneSpare), Math.max(...this.outputMagnitudesCloneSpare))
                    // this.outputMagnitudesClone[t] = this.truenormalize(this.outputMagnitudesClone[t], Math.min(...this.outputMagnitudesCloneSpare), Math.max(...this.outputMagnitudesCloneSpare))
                }
                for (let t = 0; t < this.outputs; t++) {
                    this.outputMagnitudes[t] = this.normalize(this.outputMagnitudes[t], Math.min(...this.outputMagnitudesCloneSpare), Math.max(...this.outputMagnitudesCloneSpare))
                    this.outputMagnitudes[t] = this.lognormalize(this.outputMagnitudes[t], Math.min(...this.outputMagnitudesClone), Math.max(...this.outputMagnitudesClone))
                    this.outputSum += this.outputMagnitudes[t]
                }
                if (this.outputSum != 0) {
                    this.outputSum = 1 / this.outputSum
                } else {
                    this.outputSum = 0
                }
                for (let t = 0; t < this.outputs; t++) {
                    this.outputMagnitudes[t] *= this.outputSum
                }
                this.outputcheck = 0
                for (let t = 0; t < this.outputs; t++) {
                    this.outputcheck += this.outputMagnitudes[t]
                }
                if (this.outputcheck == 0) {
                    this.outputMagnitudes[this.outputMagnitudesCloneSpare.indexOf(Math.max(...this.outputMagnitudesCloneSpare))] = 1
                }

                this.r = Math.round(Math.random() * 255)
                this.g = Math.round(Math.random() * 255)
                this.b = Math.round(Math.random() * 255)
                if (this.r < 16) {
                    this.r = 16
                }
                if (this.g < 16) {
                    this.g = 16
                }
                if (this.b < 16) {
                    this.b = 16
                }
                this.name = `#${this.r.toString(16)}${this.g.toString(16)}${this.b.toString(16)}`
            } else {
                // //////////console.log(override)
                const keys = Object.keys(override)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = override[keys[t]]
                }

                for (let t = 0; t < this.structure.length; t++) {
                    for (let k = 0; k < this.structure[t].length; k++) {
                        this.structure[t][k] = new Perceptron(0, 0, 0, this.structure[t][k])
                    }
                }

                // this = override
            }
        }
        clone() {
            const clone = new GenNN(this.inputs, this.layercount, this.layersetupArray, 4, this)
            // for (let t = 0; t < this.structure.length; t++) {
            //     for (let k = 0; k < this.structure[t].length; k++) {
            //         for (let p = 0; p < this.structure[t][k].weights.length; p++) {
            //             clone.structure[t][k].weights[p] = this.structure[t][k].weights[p]
            //             clone.structure[t][k].bias = this.structure[t][k].bias
            //         }
            //     }
            // }
            clone.generation = this.generation + 1
            if (this.r < 16) {
                this.r = 16
            }
            if (this.g < 16) {
                this.g = 16
            }
            if (this.b < 16) {
                this.b = 16
            }
            clone.r = this.r
            clone.g = this.g
            clone.b = this.b
            clone.longErrors = [...this.longErrors]
            clone.longInputs = [...this.longInputs]
            clone.parent = this.name
            clone.name = `#${clone.r.toString(16)}${clone.g.toString(16)}${clone.b.toString(16)}`
            // //////////console.log(clone)
            return clone
        }
        freshClone() {
            const clone = new GenNN(this.inputs, this.layercount, this.layersetupArray, 4, this)
            // for (let t = 0; t < this.structure.length; t++) {
            //     for (let k = 0; k < this.structure[t].length; k++) {
            //         for (let p = 0; p < this.structure[t][k].weights.length; p++) {
            //             clone.structure[t][k].weights[p] = this.structure[t][k].weights[p]
            //             clone.structure[t][k].bias = this.structure[t][k].bias
            //         }
            //     }
            // }
            clone.generation = this.generation + 1
            if (this.r < 16) {
                this.r = 16
            }
            if (this.g < 16) {
                this.g = 16
            }
            if (this.b < 16) {
                this.b = 16
            }
            clone.r = this.r
            clone.g = this.g
            clone.b = this.b
            clone.longErrors = []
            clone.longInputs = []
            clone.parent = this.name
            clone.name = `#${clone.r.toString(16)}${clone.g.toString(16)}${clone.b.toString(16)}`
            return clone
        }
        mutate() {

            this.r = Math.round(Math.max(Math.min((this.r + ((Math.random() - .5) * 36)), 255), 0))
            this.g = Math.round(Math.max(Math.min((this.g + ((Math.random() - .5) * 36)), 255), 0))
            this.b = Math.round(Math.max(Math.min((this.b + ((Math.random() - .5) * 36)), 255), 0))
            if (this.r < 16) {
                this.r = 16
            }
            if (this.g < 16) {
                this.g = 16
            }
            if (this.b < 16) {
                this.b = 16
            }

            this.name = `#${this.r.toString(16)}${this.g.toString(16)}${this.b.toString(16)}`
            for (let t = 0; t < this.structure.length; t++) {
                for (let k = 0; k < this.structure[t].length; k++) {
                    this.structure[t][k].mutate()
                }
            }
            this.changeInputs(this.inputs)
        }
        bigErrorReduce() {

            const bigerror = 0
            for (let i = 0; i < this.longInputs.length; i++) {
                const error = 0
                this.changeInputs(this.longInputs[i])
                for (let t = 0; t < this.longErrors[i].length; t++) {
                    if (t < 3) {
                        error += Math.round(Math.abs(this.longErrors[i][t] - this.outputMagnitudes[t])) * 2
                    } else {
                        error += Math.abs(this.longErrors[i][t] - this.outputMagnitudes[t])
                    }

                }
                bigerror += error
            }
            this.error = (bigerror)
            // //////////console.log(bigerror)

        }
        calculateError(errors) {
            const error = 0
            this.errors = errors
            this.dropoffs = []
            for (let t = 0; t < errors.length; t++) {
                // //////////console.log(this.outputMagnitudes[t])
                if (t < 3) {
                    this.dropoffs.push([errors[t], this.outputMagnitudes[t], Math.abs(errors[t] - this.outputMagnitudes[t]) * 2])
                    error += Math.round(Math.abs(errors[t] - this.outputMagnitudes[t])) * 2//*(errors[t]-this.outputMagnitudes[t])  //notround?
                } else {
                    this.dropoffs.push([errors[t], this.outputMagnitudes[t], Math.abs(errors[t] - this.outputMagnitudes[t])])
                    error += Math.abs(errors[t] - this.outputMagnitudes[t])//*(errors[t]-this.outputMagnitudes[t])  //notround?
                }
            }
            this.error = (error)
        }

        reduceWrapper(errors, index) {

            if (meshLearn == 1) {

                const clone1 = this.clone()
                clone1.mutate()
                //////////console.log(clone1)
                clone1.bigErrorReduce()
                this.bigErrorReduce()
                const failsafe = 0
                while (((this.error) / this.longErrors.length) > ((clone1.error) / this.longErrors.length) - .00001) {
                    failsafe++
                    if (failsafe > 10) {
                        break
                    }
                    clone1 = this.clone()
                    clone1.mutate()
                    clone1.bigErrorReduce()
                }

                if (((this.error) / this.longErrors.length) > ((clone1.error) / this.longErrors.length) - .00001) {
                    //////////console.log(this.error, clone1.error)
                    const keys = Object.keys(clone1)
                    for (let t = 0; t < keys.length; t++) {
                        this[keys[t]] = clone1[keys[t]]
                    }

                    for (let t = 0; t < this.structure.length; t++) {
                        for (let k = 0; k < this.structure[t].length; k++) {
                            this.structure[t][k] = new Perceptron(0, 0, 0, this.structure[t][k])
                        }
                    }
                    // //////////console.log(this.error)
                    // canvas_context.fillText(this.error, 200,200)
                    //////////console.log(this)
                }

                meshX += 5
                canvas_context.fillText(this.error, 200, 200)
                const circle = new Circle(meshX, (this.error * 50) / this.longErrors.length, 2.5, this.name)
                temp_context.beginPath()
                temp_context.fillStyle = "#FFFF00"
                temp_context.arc(circle.x, circle.y, circle.radius, 0, Math.PI * 2)
                temp_context.fill()
                // temp_context.stroke()
                if (meshX > tempcanvas.width) {
                    meshX = 10
                    temp_context.clearRect(0, 0, tempcanvas.width, tempcanvas.height)
                }

                // if(keysPressed['n']){
                //////////console.log(this)
                // }
            }
        }
        errorReduce(errors, index) {

            if (meshLearn == 1) {

                if (index == 0) {
                    const clone1 = this.clone()
                    clone1.mutate()
                    clone1.changeInputs(this.inputs)
                    clone1.calculateError(errors)
                    this.calculateError(errors)
                    const failsafe = 0
                    while (this.error > clone1.error) {
                        failsafe++
                        if (failsafe > 10) {
                            break
                        }
                        clone1 = this.clone()
                        clone1.mutate()
                        clone1.changeInputs(this.inputs)
                        clone1.calculateError(errors)
                    }

                    if (this.error > clone1.error) {

                        const keys = Object.keys(clone1)
                        for (let t = 0; t < keys.length; t++) {
                            this[keys[t]] = clone1[keys[t]]
                        }

                        for (let t = 0; t < this.structure.length; t++) {
                            for (let k = 0; k < this.structure[t].length; k++) {
                                this.structure[t][k] = new Perceptron(0, 0, 0, this.structure[t][k])
                            }
                        }
                        // //////////console.log(this.error)
                        // canvas_context.fillText(this.error, 200,200)
                    }

                    meshX += .5
                    canvas_context.fillText(this.error, 200, 200)
                    const circle = new Circle(meshX, this.error * 20, .5, this.name)
                    temp_context.beginPath()
                    temp_context.fillStyle = "#FFFF00"
                    temp_context.arc(circle.x, circle.y, circle.radius, 0, Math.PI * 2)
                    temp_context.fill()
                    // temp_context.stroke()
                    if (meshX > tempcanvas.width) {
                        meshX = 10
                        temp_context.clearRect(0, 0, tempcanvas.width, tempcanvas.height)
                    }

                    if (keysPressed['n']) {
                        //////////console.log(boys[index])
                    }
                } else {


                    const clone1 = this.clone()
                    clone1.mutate()
                    clone1.changeInputs(this.inputs)
                    clone1.calculateError(errors)
                    this.calculateError(errors)
                    const failsafe = 0
                    while (this.error > clone1.error) {
                        failsafe++
                        if (failsafe > 3) {
                            break
                        }
                        clone1 = this.clone()
                        clone1.mutate()
                        clone1.changeInputs(this.inputs)
                        clone1.calculateError(errors)
                    }

                    if (this.error > clone1.error) {

                        const keys = Object.keys(clone1)
                        for (let t = 0; t < keys.length; t++) {
                            this[keys[t]] = clone1[keys[t]]
                        }

                        for (let t = 0; t < this.structure.length; t++) {
                            for (let k = 0; k < this.structure[t].length; k++) {
                                this.structure[t][k] = new Perceptron(0, 0, 0, this.structure[t][k])
                            }
                        }
                        // //////////console.log(this.error)
                        // canvas_context.fillText(this.error, 200,200)
                    }

                    // meshX+=.01
                    canvas_context.fillText(this.error, 200, 300)
                    const circle = new Circle(meshX, this.error * 20, .5, this.name)
                    temp_context.beginPath()
                    temp_context.fillStyle = "#FF00FF"
                    temp_context.arc(circle.x, circle.y, circle.radius, 0, Math.PI * 2)
                    temp_context.fill()
                    // temp_context.stroke()
                    if (meshX > tempcanvas.width) {
                        meshX = 10
                        temp_context.clearRect(0, 0, tempcanvas.width, tempcanvas.height)
                    }

                }

                if (keysPressed['m']) {
                    //////////console.log(boys[index])
                }
                // //////////console.log(this.error)
            }
        }
        changeInputs(inputs) {
            this.inputs = [...inputs]
            this.tempinputs = [...inputs]
            this.structureclone = []
            for (let t = 0; t < this.structure.length; t++) {
                this.structureclone[t] = []
                for (let k = 0; k < this.structure[t].length; k++) {
                    this.structureclone[t].push(this.structure[t][k].clone(this.tempinputs))
                }
                this.tempinputs = []
                this.tempclone = []
                for (let g = 0; g < this.structureclone[this.structureclone.length - 1].length; g++) {
                    this.tempinputs.push(this.structureclone[this.structureclone.length - 1][g].value)
                    this.tempclone.push(this.structureclone[this.structureclone.length - 1][g].value)
                }
                for (let n = 0; n < this.tempinputs.length; n++) {
                    this.tempinputs[n] = this.normalize(this.tempinputs[n], Math.min(...this.tempclone), Math.max(...this.tempclone))//optional
                }
            }
            this.outputs = this.layersetupArray[this.layersetupArray.length - 1]
            this.outputMagnitudes = []
            this.outputMagnitudesClone = []
            this.outputMagnitudesCloneSpare = []
            for (let t = 0; t < this.outputs; t++) {
                this.outputMagnitudes.push(this.tempclone[t])
                this.outputMagnitudesClone.push(this.tempclone[t])
                this.outputMagnitudesCloneSpare.push(this.tempclone[t])
            }
            this.outputSum = 0
            for (let t = 0; t < this.outputs; t++) {
                this.outputMagnitudesClone[t] = this.normalize(this.outputMagnitudesClone[t], Math.min(...this.outputMagnitudesCloneSpare), Math.max(...this.outputMagnitudesCloneSpare))
            }
            for (let t = 0; t < this.outputs; t++) {
                this.outputMagnitudes[t] = this.normalize(this.outputMagnitudes[t], Math.min(...this.outputMagnitudesCloneSpare), Math.max(...this.outputMagnitudesCloneSpare))
                this.outputMagnitudes[t] = this.lognormalize(this.outputMagnitudes[t], Math.min(...this.outputMagnitudesClone), Math.max(...this.outputMagnitudesClone))
                this.outputSum += this.outputMagnitudes[t]
            }
            this.structure = this.structureclone
            for (let t = 0; t < this.outputMagnitudes.length; t++) {
                // const circle = new Circle(200+(t*350), 400, 30, "#FFFFFF")
                // canvas_context.globalAlpha = this.outputMagnitudes[t]
                // circle.draw()
                // canvas_context.font = "40px arial"
                // if(t==0){
                //     canvas_context.fillText('jump', circle.x-40, circle.y + 70)
                // }
                // if(t==1){
                //     canvas_context.fillText('left', circle.x-40, circle.y + 70)
                // }
                // if(t==2){
                //     canvas_context.fillText('right', circle.x-40, circle.y + 70)
                // }
                // if(t==3){
                //     canvas_context.fillText('degrip', circle.x-40, circle.y + 70)
                // }
                // if(t==4){
                //     canvas_context.fillText('upattack', circle.x-40, circle.y + 70)
                // }
                // if(t==5){
                //     canvas_context.fillText('downattack', circle.x-40, circle.y + 70)
                // }
                // if(t==6){
                //     canvas_context.fillText('sidesmash', circle.x-40, circle.y + 70)
                // }
                // if(t==7){
                //     canvas_context.fillText('rightattack', circle.x-40, circle.y + 70)
                // }
                // if(t==8){
                //     canvas_context.fillText('leftattack', circle.x-40, circle.y + 70)
                // }
                // if(t==9){
                //     canvas_context.fillText('shield', circle.x-40, circle.y + 70)
                // }
                // canvas_context.globalAlpha = 1
            }
        }
        lognormalize(output) {
            if (output > 1) {
                return 1
            }
            if (output < 0) {
                return 0
            }
            return output
            // return (1/(1+Math.pow(Math.E, (output*-1))))
        }
        normalize(val, min, max) {
            return Math.max(val, 0)
        }
        truenormalize(val, min, max) {
            if (min < 0) {
                max += 0 - min;
                val += 0 - min;
                min = 0;
            }
            val = val - min;
            max = max - min;
            if (max == 0) {
                max = .0000001
            }
            return val / max
        }
    }
    class Point {
        constructor(x, y) {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = 0
        }
        pointDistance(point) {
            return (new LineOP(this, point, "transparent", 0)).hypotenuse()
        }
    }
    class Line {
        constructor(x, y, x2, y2, color, width) {
            this.x1 = x
            this.y1 = y
            this.x2 = x2
            this.y2 = y2
            this.color = color
            this.width = width
        }
        angle() {
            return Math.atan2(this.y1 - this.y2, this.x1 - this.x2)
        }
        hypotenuse() {
            const xdif = this.x1 - this.x2
            const ydif = this.y1 - this.y2
            const hypotenuse = (xdif * xdif) + (ydif * ydif)
            if(hypotenuse < 14100000-1){
                if(hypotenuse > 1000){
                    return squaretable[`${Math.round(10*Math.round((hypotenuse*.1)))}`]
                }else{
                return squaretable[`${Math.round(hypotenuse)}`]
                }
            }else{
                //console.log(hypotenuse)
                // if(isNaN(hypotenuse) ){
                //     console.trace()
                // }
                return Math.sqrt(hypotenuse)
            }
        }
        sqrDis() {
            const xdif = this.x1 - this.x2
            const ydif = this.y1 - this.y2
            const hypotenuse = (xdif * xdif) + (ydif * ydif)
            return (hypotenuse)
        }
        draw() {
            const linewidthstorage = canvas_context.lineWidth
            canvas_context.strokeStyle = this.color
            canvas_context.lineWidth = this.width
            canvas_context.beginPath()
            canvas_context.moveTo(this.x1, this.y1)
            canvas_context.lineTo(this.x2, this.y2)
            canvas_context.stroke()
            canvas_context.lineWidth = linewidthstorage
        }
    }
    class LineOP {
        constructor(object, target, color, width) {
            this.object = object
            this.target = target
            this.color = color
            this.width = width
        }
        hypotenuse() {
            const xdif = this.object.x - this.target.x
            const ydif = this.object.y - this.target.y
            const hypotenuse = (xdif * xdif) + (ydif * ydif)
            if(hypotenuse < 14100000-1){
                if(hypotenuse > 1000){
                    return squaretable[`${Math.round(10*Math.round((hypotenuse*.1)))}`]
                }else{
                return squaretable[`${Math.round(hypotenuse)}`]
                }
            }else{
                //console.log(hypotenuse)
                return Math.sqrt(hypotenuse)
            }
        }
        sqrDis() {
            const xdif = this.object.x - this.target.x
            const ydif = this.object.y - this.target.y
            const hypotenuse = (xdif * xdif) + (ydif * ydif)
            return (hypotenuse)
        }
        angle() {
            return Math.atan2(this.object.y - this.target.y, this.object.x - this.target.x)
        }
        draw() {
            const linewidthstorage = canvas_context.lineWidth
            canvas_context.strokeStyle = this.color
            canvas_context.lineWidth = this.width
            canvas_context.beginPath()
            canvas_context.moveTo(this.object.x, this.object.y)
            canvas_context.lineTo(this.target.x, this.target.y)
            canvas_context.stroke()
            canvas_context.lineWidth = linewidthstorage
        }
    }
    class LineOPx {
        constructor(object, target, color, width) {
            this.object = object
            this.target = target
            this.color = color
            this.width = width
        }
        hypotenuse() {
            const xdif = this.object.x - this.target.x
            const ydif = this.object.y - this.target.y
            const hypotenuse = (xdif * xdif) + (ydif * ydif)
                //console.log(hypotenuse)

            return Math.sqrt(hypotenuse)
        }
        sqrDis() {
            const xdif = this.object.x - this.target.x
            const ydif = this.object.y - this.target.y
            const hypotenuse = (xdif * xdif) + (ydif * ydif)
            return (hypotenuse)
        }
        angle() {
            return Math.atan2(this.object.y - this.target.y, this.object.x - this.target.x)
        }
        draw() {
            const linewidthstorage = canvas_context.lineWidth
            canvas_context.strokeStyle = this.color
            canvas_context.lineWidth = this.width
            // canvas_context.beginPath()
            canvas_context.moveTo(this.object.x, this.object.y)
            canvas_context.lineTo(this.target.x, this.target.y)
            // canvas_context.stroke()
            canvas_context.lineWidth = linewidthstorage
        }
    }
    class Triangle {
        constructor(x, y, color, length, fill = 0, strokeWidth = 0, leg1Ratio = 1, leg2Ratio = 1, heightRatio = 1) {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.color = color
            this.length = length
            this.x1 = this.x + this.length * leg1Ratio
            this.x2 = this.x - this.length * leg2Ratio
            this.tip = this.y - this.length * heightRatio
            this.accept1 = (this.y - this.tip) / (this.x1 - this.x)
            this.accept2 = (this.y - this.tip) / (this.x2 - this.x)
            this.fill = fill
            this.stroke = strokeWidth
        }
        draw() {
            canvas_context.strokeStyle = this.color
            canvas_context.stokeWidth = this.stroke
            canvas_context.beginPath()
            canvas_context.moveTo(this.x, this.y)
            canvas_context.lineTo(this.x1, this.y)
            canvas_context.lineTo(this.x, this.tip)
            canvas_context.lineTo(this.x2, this.y)
            canvas_context.lineTo(this.x, this.y)
            if (this.fill == 1) {
                canvas_context.fill()
            }
            canvas_context.stroke()
            canvas_context.closePath()
        }
        isPointInside(point) {
            if (point.x <= this.x1) {
                if (point.y >= this.tip) {
                    if (point.y <= this.y) {
                        if (point.x >= this.x2) {
                            this.accept1 = (this.y - this.tip) / (this.x1 - this.x)
                            this.accept2 = (this.y - this.tip) / (this.x2 - this.x)
                            this.basey = point.y - this.tip
                            this.basex = point.x - this.x
                            if (this.basex == 0) {
                                return true
                            }
                            this.slope = this.basey / this.basex
                            if (this.slope >= this.accept1) {
                                return true
                            } else if (this.slope <= this.accept2) {
                                return true
                            }
                        }
                    }
                }
            }
            return false
        }
    }
    class Rectangle {
        constructor(x, y, width, height, color, fill = 1, stroke = 0, strokeWidth = 1) {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.height = height
            this.width = width
            this.color = color
            this.xmom = 0
            this.ymom = 0
            this.stroke = stroke
            this.strokeWidth = parseFloat(strokeWidth)
            this.fill = fill
        }
        draw() {
            canvas_context.fillStyle = this.color
            canvas_context.fillRect(this.x, this.y, this.width, this.height)
        }
        move() {
            this.x += this.xmom
            this.y += this.ymom
        }
        isPointInside(point) {
            if (point.x >= this.x) {
                if (point.y >= this.y) {
                    if (point.x <= this.x + this.width) {
                        if (point.y <= this.y + this.height) {
                            return true
                        }
                    }
                }
            }
            return false
        }
        doesPerimeterTouch(point) {
            if (point.x + point.radius >= this.x) {
                if (point.y + point.radius >= this.y) {
                    if (point.x - point.radius <= this.x + this.width) {
                        if (point.y - point.radius <= this.y + this.height) {
                            return true
                        }
                    }
                }
            }
            return false
        }
    }
    class Circle {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseInt(xmom)
            this.ymom = parseInt(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        smovex() {
            this.x += this.sxmom
            this.y += this.symom
            this.sxmom = 0
            this.symom = 0
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            if (typeof this.radius !== 'number') {
                return
            }
            canvas_context.lineWidth = this.strokeWidth
            canvas_context.strokeStyle = this.color
            canvas_context.beginPath();
            if (this.radius > 0) {
                canvas_context.arc(this.x, this.y, this.radius, 0, (Math.PI * 2), true)
                canvas_context.fillStyle = this.color
                canvas_context.fill()
                canvas_context.stroke();
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }
        track() {

            if (this.anchored !== 2) {
                this.x += this.xmom
                this.y += this.ymom
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
            }
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }
    class CircleCB {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            // this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseInt(xmom)
            this.ymom = parseInt(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        smovex() {
            this.x += this.sxmom
            this.y += this.symom
            this.sxmom = 0
            this.symom = 0
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            if (typeof this.radius !== 'number') {
                return
            }
            canvas_context.lineWidth = this.strokeWidth
            canvas_context.strokeStyle = this.color
            canvas_context.beginPath();
            if (this.radius > 0) {
                canvas_context.arc(this.x, this.y, this.radius, 0, (Math.PI * 2), true)
                canvas_context.fillStyle = this.color
                canvas_context.fill()
                canvas_context.stroke();
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }
        track() {

            if (this.anchored !== 2) {
                this.x += this.xmom
                this.y += this.ymom
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
            }
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }
    class CircleS {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseInt(xmom)
            this.ymom = parseInt(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        smovex() {
            this.x += this.sxmom
            this.y += this.symom
            this.sxmom = 0
            this.symom = 0
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            if (typeof this.radius !== 'number') {
                return
            }
            canvas_context.lineWidth = 4
            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.beginPath();
            if (this.radius > 0) {
                canvas_context.arc(this.x, this.y, Math.max(this.radius - 2, 0), 0, (Math.PI * 2), true)
                canvas_context.fillStyle = this.color
                canvas_context.fill()
                canvas_context.stroke();
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }
        track() {

            if (this.anchored !== 2) {
                this.x += this.xmom
                this.y += this.ymom
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
            }
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        bmove() {
            if (this.anchored !== 1) {
                this.x += this.xmom
                this.y += this.ymom
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }
    class ShotJ {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, angle = 0.0001, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.marked = parseFloat(marked)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseInt(xmom)
            this.ymom = parseInt(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.angle = parseFloat(angle)
            this.fired = parseFloat(fired)
            this.flip = 0
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            if (typeof this.radius !== 'number') {
                return
            }
            canvas_context.lineWidth = 5
            canvas_context.strokeStyle = this.color
            canvas_context.beginPath();
            if (this.radius > 0) {
                canvas_context.arc(this.x, this.y, this.radius, 0 + this.angle, (Math.PI * 2) + (this.angle * 1.01), true)
                canvas_context.fillStyle = this.color


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.round(this.y), Math.max(this.radius - canvas_context.lineWidth, 0))
                    this.string = this.color
                    if (typeof this.string !== "string") {
                        this.string = "#FF0000"
                    }
                    gard.addColorStop(0, this.string + `ff`)
                    gard.addColorStop(0.01, this.string + "a1")
                    gard.addColorStop(0.41, this.string + "55")
                    gard.addColorStop(1, this.string + "22")
                    canvas_context.fillStyle = gard
                    canvas_context.fill()
                    canvas_context.arc(this.x, this.y, this.radius * .1, 0 + this.angle, (Math.PI * 2) + (this.angle * 1.01), true)
                    canvas_context.arc(this.x, this.y, this.radius * .4, 0 + this.angle, Math.abs((Math.PI * 2) - (this.angle * 1.01)), false)

                    if (this.angle > Math.PI * 2) {
                        this.angle = 0
                    }


                    canvas_context.stroke();
                    this.angle += .1
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }
        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }
        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }

    class ShotG {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, angle = 0.0001, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.marked = parseFloat(marked)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseInt(xmom)
            this.ymom = parseInt(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.angle = parseFloat(angle)
            this.fired = parseFloat(fired)
            this.flip = 0
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            if (typeof this.radius !== 'number') {
                return
            }
            canvas_context.lineWidth = (this.radius / 36)
            canvas_context.strokeStyle = invertColor(this.color)
            canvas_context.beginPath();
            if (this.radius > 0) {
                canvas_context.arc(this.x, this.y, this.radius, 0 + this.angle, (Math.PI * 2) + (this.angle * 1.01), true)
                canvas_context.fillStyle = this.color


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.round(this.y), Math.max(this.radius - canvas_context.lineWidth, 0))
                    this.string = this.color
                    if (typeof this.string !== "string") {
                        this.string = "#FF0000"
                    }
                    gard.addColorStop(0, "#FFFFFF" + `ff`)
                    gard.addColorStop(0.01, "#FFFFFF" + "a1")
                    gard.addColorStop(0.41, "#FFFFFF" + "55")
                    gard.addColorStop(1, this.string + "ff")
                    canvas_context.fillStyle = gard
                    for (let t = 0; t < (this.radius / 10); t++) {
                        canvas_context.arc(this.x, this.y, this.radius * ((t + 1) / (this.radius / 10)), 0 + this.angle, (Math.PI * 2) + (this.angle * 1.01), true)

                    }

                    if (this.angle > Math.PI * 2) {
                        this.angle = 0
                    }


                    canvas_context.stroke();
                    canvas_context.fill()
                    this.angle += (Math.PI) / 20
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }

    class ShotO {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, angle = 0.0001, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.marked = parseFloat(marked)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseInt(xmom)
            this.ymom = parseInt(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.angle = parseFloat(angle)
            this.fired = parseFloat(fired)
            this.flip = 0
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            if (typeof this.radius !== 'number') {
                return
            }
            canvas_context.lineWidth = (this.radius / 36)
            canvas_context.strokeStyle = invertColor(this.color)
            canvas_context.beginPath();
            if (this.radius > 0) {
                canvas_context.arc(this.x, this.y, this.radius, 0 + this.angle, (Math.PI * 2) + (this.angle * 1.01), true)
                canvas_context.fillStyle = this.color


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    // var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.round(this.y), Math.max(this.radius - canvas_context.lineWidth, 0))
                    // this.string = this.color
                    // if (typeof this.string !== "string") {
                    //     this.string = "#FF0000"
                    // }
                    // gard.addColorStop(0, "#AAAABB" + `ff`)
                    // gard.addColorStop(0.01, "#AAAABB" + "FF")
                    // gard.addColorStop(0.41, "#AAAABB" + "FF")
                    // gard.addColorStop(1, this.string + "ff")
                    canvas_context.fillStyle = this.string
                    // for(let t = 0;t<1;t+=1){
                    //     for(let k = 0;k<(Math.PI*2);k+=(Math.PI/5)){
                    //             canvas_context.arc(this.x, this.y, this.radius, k, k+(Math.PI/30), true)
                    //             canvas_context.arc(this.x, this.y, this.radius-(this.radius*.2), k+(Math.PI/30), k+(Math.PI/30)+(Math.PI/30), true)
                    //     }
                    // }

                    if (this.angle > Math.PI * 2) {
                        this.angle = 0
                    }


                    canvas_context.stroke();
                    canvas_context.fill()
                    // this.angle+=(Math.PI)/20
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }

    class ShotJR {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, angle = 0.0001, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.marked = parseFloat(marked)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseInt(xmom)
            this.ymom = parseInt(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.angle = parseFloat(angle)
            this.fired = parseFloat(fired)
            this.flip = 0
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            if (typeof this.radius !== 'number') {
                return
            }
            canvas_context.lineWidth = 5
            canvas_context.strokeStyle = this.color
            canvas_context.beginPath();
            if (this.radius > 0) {
                canvas_context.arc(this.x, this.y, this.radius, 0 + this.angle, (Math.PI * 2) + (this.angle * 1.0001), true)
                canvas_context.fillStyle = this.color


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.round(this.y), Math.max(this.radius - canvas_context.lineWidth, 0))
                    this.string = this.color
                    if (typeof this.string !== "string") {
                        this.string = "#FF0000"
                    }
                    gard.addColorStop(0, this.string + `FF`)
                    gard.addColorStop(0.25, this.string + "88")
                    gard.addColorStop(1, this.string + "10")
                    canvas_context.fillStyle = gard
                    canvas_context.fill()
                    canvas_context.arc(this.x, this.y, this.radius * .1, 0, (Math.PI * 2), true)

                    if (this.angle > Math.PI * 2) {
                        this.angle = 0
                    }


                    // canvas_context.stroke();
                    canvas_context.closePath()
                    this.angle += .1
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }

    class Shot {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.marked = parseFloat(marked)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseInt(xmom)
            this.ymom = parseInt(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        xmove(){
            this.x+=this.xmom
            this.y+=this.ymom
        }
        draw() {
            if (typeof this.radius !== 'number') {
                return
            }
            canvas_context.lineWidth = 5
            canvas_context.strokeStyle = this.color
            canvas_context.beginPath();
            if (this.radius > 0) {
                canvas_context.arc(this.x, this.y, this.radius, 0, (Math.PI * 2), true)
                canvas_context.fillStyle = this.color


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.round(this.y), Math.max(this.radius - canvas_context.lineWidth, 0))
                    this.string = this.color
                    if (typeof this.string !== "string") {
                        this.string = "#FF0000"
                    }
                    gard.addColorStop(0, this.string + `ff`)
                    gard.addColorStop(0.01, this.string + "a1")
                    gard.addColorStop(0.41, this.string + "94")
                    gard.addColorStop(1, this.string + "51")
                    canvas_context.fillStyle = gard
                    canvas_context.fill()
                    canvas_context.stroke();
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }
        rmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width*6.2) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                        this.messup = 1
                    }
                }
                if (this.y + this.radius > canvas.height*6.2) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                        this.messup = 1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                        this.messup = 1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                        this.messup = 1
                    }
                }
            }
            this.x += this.xmom
            this.y += this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }
    class Shotb {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseInt(xmom)
            this.ymom = parseInt(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            if (typeof this.radius !== 'number') {
                return
            }
            canvas_context.lineWidth = 5
            canvas_context.strokeStyle = this.color
            canvas_context.beginPath();
            if (this.radius > 0) {
                canvas_context.arc(this.x, this.y, this.radius, 0, (Math.PI * 2), true)
                canvas_context.fillStyle = this.color

                if (Math.random() < .0001) {
                    ////////// ////////////////////////////////////////////console.log(this)
                }
                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.round(this.y), Math.ceil(Math.max(this.radius - canvas_context.lineWidth, 0)))
                    this.string = this.color

                    gard.addColorStop(0, invertColor(this.string) + `51`)
                    gard.addColorStop(0.01, invertColor(this.string) + "94")
                    gard.addColorStop(0.41, invertColor(this.string) + "a1")
                    gard.addColorStop(1, this.string + "ff")
                    canvas_context.fillStyle = gard
                    canvas_context.fill()
                    canvas_context.stroke();
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }
    class ShotP {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseInt(xmom)
            this.ymom = parseInt(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            if (typeof this.radius !== 'number') {
                return
            }
            canvas_context.lineWidth = 5
            canvas_context.strokeStyle = this.color
            canvas_context.beginPath();
            if (this.radius > 0) {
                canvas_context.arc(this.x, this.y, this.radius, 0, (Math.PI * 2), true)
                canvas_context.fillStyle = this.color


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.ceil(this.y - (this.radius * 1.25)), Math.ceil(Math.max((this.radius * 2.5) - canvas_context.lineWidth, 0)))
                    this.string = this.color
                    for (let t = 0; t < 13; t += 6) {
                        gard.addColorStop(t / 18.1, (this.string) + `ff`)
                        gard.addColorStop((t + 1.5) / 18.1, "#000000" + "ff")
                        gard.addColorStop((t + 3) / 18.1, (this.string) + "ff")
                        gard.addColorStop((t + 4.5) / 18.1, "#000000" + "ff")
                    }
                    canvas_context.fillStyle = gard
                    canvas_context.fill()
                    canvas_context.stroke();
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }
    class ShotR {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseFloat(xmom)
            this.ymom = parseFloat(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            if (typeof this.radius !== 'number') {
                return
            }
            canvas_context.lineWidth = 5
            canvas_context.strokeStyle = this.color
            canvas_context.beginPath();
            if (this.radius > 0) {
                canvas_context.arc(this.x, this.y, this.radius, 0, (Math.PI * 2), true)
                canvas_context.fillStyle = this.color


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.ceil(this.y + (this.radius * 1.25)), Math.ceil(Math.max((this.radius * 2.5) - canvas_context.lineWidth, 0)))
                    this.string = this.color
                    if (this.color != "#00FF00") {
                        for (let t = 0; t < 13; t += 6) {
                            gard.addColorStop(t / 18.1, (this.string) + `ff`)
                            gard.addColorStop((t + 1.5) / 18.1, "#00FF00" + "ff")
                            gard.addColorStop((t + 3) / 18.1, (this.string) + "ff")
                            gard.addColorStop((t + 4.5) / 18.1, "#00FF00" + "ff")
                        }
                    } else {
                        for (let t = 0; t < 13; t += 6) {
                            gard.addColorStop(t / 18.1, (this.string) + `ff`)
                            gard.addColorStop((t + 1.5) / 18.1, "#000000" + "ff")
                            gard.addColorStop((t + 3) / 18.1, (this.string) + "ff")
                            gard.addColorStop((t + 4.5) / 18.1, "#000000" + "ff")
                        }
                    }
                    canvas_context.fillStyle = gard
                    canvas_context.fill()
                    canvas_context.stroke();
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }
    class ShotN {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseFloat(xmom)
            this.ymom = parseFloat(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            if (typeof this.radius !== 'number') {
                return
            }
            canvas_context.lineWidth = 5
            canvas_context.strokeStyle = this.color
            // canvas_context.beginPath();
            if (this.radius > 0) {
                for (let t = 0; t < Math.PI * 2; t += .3) {
                    canvas_context.beginPath();
                    canvas_context.arc(this.x, this.y, this.radius, t, t + .1, false)
                    canvas_context.strokeStyle = this.color
                    canvas_context.stroke()
                }


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.ceil(this.y + (this.radius * 1.25)), Math.ceil(Math.max((this.radius * 2.5) - canvas_context.lineWidth, 0)))
                    this.string = this.color
                    if (this.color != "#FFFF00") {
                        for (let t = 0; t < 13; t += 6) {
                            gard.addColorStop(t / 18.1, (this.string) + `ff`)
                            gard.addColorStop((t + 1.5) / 18.1, "#FFFF00" + "ff")
                            gard.addColorStop((t + 3) / 18.1, (this.string) + "ff")
                            gard.addColorStop((t + 4.5) / 18.1, "#FFFF00" + "ff")
                        }
                    } else {
                        for (let t = 0; t < 13; t += 6) {
                            gard.addColorStop(t / 18.1, (this.string) + `ff`)
                            gard.addColorStop((t + 1.5) / 18.1, "#AA5500" + "ff")
                            gard.addColorStop((t + 3) / 18.1, (this.string) + "ff")
                            gard.addColorStop((t + 4.5) / 18.1, "#AA5500" + "ff")
                        }

                    }









                    // tempcanvas.width = this.radius * 2
                    // tempcanvas.height = this.radius * 2


                    // temp_context.save();
                    // temp_context.fillStyle = gard
                    // temp_context.beginPath();
                    // temp_context.arc(this.radius, this.radius, this.radius, 0, (Math.PI * 2), true)
                    // temp_context.fill()
                    // temp_context.globalCompositeOperation = 'destination-out'
                    // temp_context.beginPath();
                    // temp_context.fillStyle = '#888888'
                    // temp_context.arc(this.radius, this.radius - (this.radius * .75), this.radius * 1.1, 0, 2 * Math.PI)
                    // temp_context.fill()
                    // // temp_context.restore()
                    // canvas_context.drawImage(tempcanvas, 0, 0, tempcanvas.width, tempcanvas.height, this.x - this.radius, this.y - this.radius, this.radius * 2, this.radius * 2)
                    // // canvas_context.stroke();
                    // temp_context.globalCompositeOperation = 'source-over'

                    canvas_context.fillStyle = gard
                    canvas_context.beginPath();
                    canvas_context.arc(this.x, this.y, this.radius, Math.PI, 0, true);
                    canvas_context.arc(this.x, this.y - (this.radius * .5), this.radius, - 0, Math.PI, false);
                    canvas_context.fill()
                    canvas_context.closePath();
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }

    class ShotFP {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, angle = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseFloat(xmom)
            this.ymom = parseFloat(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
            this.angle = parseFloat(angle)
            this.linkdraw = 1
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            this.angle -= .04
            if (typeof this.radius !== 'number') {
                return
            }
            if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                canvas_context.lineWidth = this.radius * .1
            } else {
                canvas_context.lineWidth = 10
            }
            canvas_context.strokeStyle = this.color
            // canvas_context.beginPath();
            if (this.radius > 0) {
                for (let t = 0; t < Math.PI * 2; t += (Math.PI / 2)) {
                    canvas_context.beginPath();
                    canvas_context.arc(this.x, this.y, this.radius, t + this.angle, t + (Math.PI / 7) + this.angle, false)
                    canvas_context.strokeStyle = this.color
                    canvas_context.stroke()
                }


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.ceil(this.y + (this.radius * 0)), Math.ceil(Math.max((this.radius * 1.1) - canvas_context.lineWidth, 0)))
                    this.string = this.color
                    // if (this.color != "#FFAAAA") {
                    //     for (let t = 0; t < 13; t += 6) {
                    //         gard.addColorStop(t / 18.1, (this.string) + `ff`)
                    //         gard.addColorStop((t + 1.5) / 18.1, "#000000" + "ff")
                    //         gard.addColorStop((t + 3) / 18.1, (this.string) + "ff")
                    //         gard.addColorStop((t + 4) / 18.1, "#000000" + "ff")
                    //     }
                    // } else {
                    //     for (let t = 0; t < 13; t += 6) {
                    //         gard.addColorStop(t / 18.1, (this.string) + `ff`)
                    //         gard.addColorStop((t + 1.5) / 18.1, "#000000" + "ff")
                    //         gard.addColorStop((t + 3) / 18.1, (this.string) + "ff")
                    //         gard.addColorStop((t + 4) / 18.1, "#000000" + "ff")
                    //     }

                    // }


                    gard.addColorStop(0, (this.string) + `FF`)
                    gard.addColorStop(.5, this.string + "FF")
                    gard.addColorStop(.75, (this.string) + "ff")
                    // gard.addColorStop(.9, (this.string) + "ff")
                    gard.addColorStop(1, "#000000" + "FF")

                    canvas_context.fillStyle = gard
                    canvas_context.beginPath();
                    canvas_context.arc(this.x, this.y, this.radius, 0, (Math.PI * 2), true)
                    canvas_context.fill()


                    // tempcanvas.width = this.radius * 2
                    // tempcanvas.height = this.radius * 2


                    // // temp_context.save();
                    // temp_context.fillStyle = gard
                    // temp_context.beginPath();
                    // temp_context.arc(this.radius, this.radius, this.radius, 0, (Math.PI * 2), true)
                    // temp_context.fill()
                    // temp_context.globalCompositeOperation = 'destination-out'
                    // temp_context.beginPath();
                    // temp_context.fillStyle = '#888888'
                    // temp_context.arc(this.radius, this.radius, this.radius * .5, 0, 2 * Math.PI)
                    // temp_context.fill()
                    // // temp_context.restore()
                    // canvas_context.drawImage(tempcanvas, 0, 0, tempcanvas.width, tempcanvas.height, this.x - this.radius, this.y - this.radius, this.radius * 2, this.radius * 2)
                    // // canvas_context.stroke();
                    // temp_context.globalCompositeOperation = 'source-over'
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }
   
    class ShotFMP {
        constructor(boss, x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, angle = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseFloat(xmom)
            this.ymom = parseFloat(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.bomb = 1
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
            this.angle = parseFloat(angle)
            this.linkdraw = 1
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {




                    if(this.bomb == 1){


                    for(let h = 0;h<boys.length;h++){
                                for(let r = 0;r<boys[h].shots.length;r++){
                                    if(boys[h].shots[r].linkdraw != 1){
                                        let link = new LineOP(this, boys[h].shots[r], this.color, 8)
                                        if(link.hypotenuse() < 300){
                                            link.draw()
                                        }
                                    }
                                }
                                if(boys[h].hasOwnProperty('radball')){
                                    let link = new LineOP(this, boys[h].radball, this.color, 8)
                                    if(link.hypotenuse() < 300){
                                        link.draw()
                                    }
                                }
                            }
                    

                        for(let t = 0;t<boys.length;t++){
                            let link = new LineOP(this, boys[t].body, this.color, 3)
                            link.width = Math.min(Math.max(1000/link.hypotenuse(), 1),15)
                                if(link.hypotenuse() < 400){
                                    link.draw()
                                }
                        }
                    }
                

            this.angle -= .04
            if (typeof this.radius !== 'number') {
                return
            }
            if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                canvas_context.lineWidth = this.radius * .1
            } else {
                canvas_context.lineWidth = 10
            }
            canvas_context.strokeStyle = this.color
            // canvas_context.beginPath();
            if (this.radius > 0) {
                for (let t = 0; t < Math.PI * 2; t += (Math.PI / 2)) {
                    canvas_context.beginPath();
                    canvas_context.arc(this.x, this.y, this.radius, t + this.angle, t + (Math.PI / 7) + this.angle, false)
                    canvas_context.strokeStyle = this.color
                    canvas_context.stroke()
                }


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.ceil(this.y + (this.radius * 0)), Math.ceil(Math.max((this.radius * 1.1) - canvas_context.lineWidth, 0)))
                    this.string = this.color
                    // if (this.color != "#FFAAAA") {
                    //     for (let t = 0; t < 13; t += 6) {
                    //         gard.addColorStop(t / 18.1, (this.string) + `ff`)
                    //         gard.addColorStop((t + 1.5) / 18.1, "#000000" + "ff")
                    //         gard.addColorStop((t + 3) / 18.1, (this.string) + "ff")
                    //         gard.addColorStop((t + 4) / 18.1, "#000000" + "ff")
                    //     }
                    // } else {
                    //     for (let t = 0; t < 13; t += 6) {
                    //         gard.addColorStop(t / 18.1, (this.string) + `ff`)
                    //         gard.addColorStop((t + 1.5) / 18.1, "#000000" + "ff")
                    //         gard.addColorStop((t + 3) / 18.1, (this.string) + "ff")
                    //         gard.addColorStop((t + 4) / 18.1, "#000000" + "ff")
                    //     }

                    // }


                    gard.addColorStop(0, (this.string) + `FF`)
                    gard.addColorStop(.1, this.string + "FF")
                    gard.addColorStop(.2, (this.string) + "00")
                    // gard.addColorStop(.9, (this.string) + "ff")
                    gard.addColorStop(1, "#000000" + "00")

                    canvas_context.fillStyle = gard
                    canvas_context.beginPath();
                    canvas_context.arc(this.x, this.y, this.radius, 0, (Math.PI * 2), true)
                    canvas_context.fill()


                    // tempcanvas.width = this.radius * 2
                    // tempcanvas.height = this.radius * 2


                    // // temp_context.save();
                    // temp_context.fillStyle = gard
                    // temp_context.beginPath();
                    // temp_context.arc(this.radius, this.radius, this.radius, 0, (Math.PI * 2), true)
                    // temp_context.fill()
                    // temp_context.globalCompositeOperation = 'destination-out'
                    // temp_context.beginPath();
                    // temp_context.fillStyle = '#888888'
                    // temp_context.arc(this.radius, this.radius, this.radius * .5, 0, 2 * Math.PI)
                    // temp_context.fill()
                    // // temp_context.restore()
                    // canvas_context.drawImage(tempcanvas, 0, 0, tempcanvas.width, tempcanvas.height, this.x - this.radius, this.y - this.radius, this.radius * 2, this.radius * 2)
                    // // canvas_context.stroke();
                    // temp_context.globalCompositeOperation = 'source-over'
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }
   
    class ShotGW {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, angle = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseFloat(xmom)
            this.ymom = parseFloat(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
            this.angle = parseFloat(angle)
            this.linkdraw = 1
            this.marked = 0
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            this.angle -= .04
            if (typeof this.radius !== 'number') {
                return
            }
            if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                canvas_context.lineWidth = this.radius * .1
            } else {
                canvas_context.lineWidth = 10
            }
            canvas_context.strokeStyle = this.color
            // canvas_context.beginPath();
            if (this.radius > 0) {
                // for (let t = 0; t < Math.PI * 2; t += (Math.PI / 21)) {
                //     canvas_context.beginPath();
                //     canvas_context.arc(this.x, this.y, this.radius, t + this.angle, t + (Math.PI / 70) + this.angle, false)
                //     canvas_context.strokeStyle = this.color
                //     canvas_context.stroke()
                // }


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {

                    var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.ceil(this.y + (this.radius * 0)), Math.ceil(Math.max((this.radius * 1) - canvas_context.lineWidth, 0)))
                    this.string = this.color
                    gard.addColorStop(.3, (this.string) + `FF`)
                    gard.addColorStop(1, (this.string) + `00`)
                    canvas_context.fillStyle = gard
                    canvas_context.beginPath();
                    canvas_context.arc(this.x, this.y, this.radius, 0,  Math.PI*2, true)
                    canvas_context.fill()

                    // for(let t= 0;t<6;t++){
                    // if(t%2 == 0){
                    //     var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.ceil(this.y + (this.radius * 0)), Math.ceil(Math.max((this.radius * 1) - canvas_context.lineWidth, 0)))
                    // this.string = this.color
                    //     gard.addColorStop(1, (this.string) + `FF`)
                    // canvas_context.fillStyle = gard
                    // canvas_context.beginPath();
                    // canvas_context.arc(this.x, this.y, this.radius, t*(Math.PI*.33)-this.angle,  t*(Math.PI*.33) + ((Math.PI*.33))-this.angle, false)
                    // canvas_context.fill()
                    // }else{

                    //     var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.ceil(this.y + (this.radius * 0)), Math.ceil(Math.max((this.radius * 1) - canvas_context.lineWidth, 0)))
                    // this.string = this.color
                    // gard.addColorStop(1, invertColor(this.string) + `FF`)
                    // canvas_context.fillStyle = gard
                    // canvas_context.beginPath();
                    // canvas_context.arc(this.x, this.y, this.radius, this.angle+t*(Math.PI*.33),  this.angle+t*(Math.PI*.33) + ((Math.PI*.33)), false)
                    // canvas_context.fill()
                    // }
                    // if(t%2 == 0){
                    //     var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.ceil(this.y + (this.radius * 0)), Math.ceil(Math.max((this.radius * 1) - canvas_context.lineWidth, 0)))
                    // this.string = this.color
                    //     gard.addColorStop(1, invertColor(this.string) + `FF`)
                    // canvas_context.fillStyle = gard
                    // canvas_context.beginPath();
                    // canvas_context.arc(this.x, this.y, this.radius*.8, (t+1)*(Math.PI*.33)-this.angle,  (t+1)*(Math.PI*.33) + ((Math.PI*.33))-this.angle, false)
                    // canvas_context.fill()
                    // }else{

                    //     var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.ceil(this.y + (this.radius * 0)), Math.ceil(Math.max((this.radius * 1) - canvas_context.lineWidth, 0)))
                    // this.string = this.color
                    // gard.addColorStop(1, (this.string) + `FF`)
                    // canvas_context.fillStyle = gard
                    // canvas_context.beginPath();
                    // canvas_context.arc(this.x, this.y, this.radius*.8, this.angle-(t+1)*(Math.PI*.33),  this.angle-(t+1)*(Math.PI*.33) + ((Math.PI*.33)), false)
                    // canvas_context.fill()
                    // }

                    // }


                    // tempcanvas.width = this.radius * 2
                    // tempcanvas.height = this.radius * 2


                    // // temp_context.save();
                    // temp_context.fillStyle = gard
                    // temp_context.beginPath();
                    // temp_context.arc(this.radius, this.radius, this.radius, 0, (Math.PI * 2), true)
                    // temp_context.fill()
                    // temp_context.globalCompositeOperation = 'destination-out'
                    // temp_context.beginPath();
                    // temp_context.fillStyle = '#888888'
                    // temp_context.arc(this.radius, this.radius, this.radius * .5, 0, 2 * Math.PI)
                    // temp_context.fill()
                    // // temp_context.restore()
                    // canvas_context.drawImage(tempcanvas, 0, 0, tempcanvas.width, tempcanvas.height, this.x - this.radius, this.y - this.radius, this.radius * 2, this.radius * 2)
                    // // canvas_context.stroke();
                    // temp_context.globalCompositeOperation = 'source-over'
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }
   
    class ShotF {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, angle = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseFloat(xmom)
            this.ymom = parseFloat(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
            this.angle = parseFloat(angle)
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            this.angle += .04
            if (typeof this.radius !== 'number') {
                return
            }
            if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                canvas_context.lineWidth = this.radius * .1
            } else {
                canvas_context.lineWidth = 10
            }
            canvas_context.strokeStyle = this.color
            // canvas_context.beginPath();
            if (this.radius > 0) {
                for (let t = 0; t < Math.PI * 2; t += (Math.PI / 10)) {
                    canvas_context.beginPath();
                    canvas_context.arc(this.x, this.y, this.radius, t + this.angle, t + (Math.PI / 20) + this.angle, false)
                    canvas_context.strokeStyle = this.color
                    canvas_context.stroke()
                }


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.ceil(this.y + (this.radius * 0)), Math.ceil(Math.max((this.radius * 1.1) - canvas_context.lineWidth, 0)))
                    this.string = this.color
                    // if (this.color != "#FFAAAA") {
                    //     for (let t = 0; t < 13; t += 6) {
                    //         gard.addColorStop(t / 18.1, (this.string) + `ff`)
                    //         gard.addColorStop((t + 1.5) / 18.1, "#000000" + "ff")
                    //         gard.addColorStop((t + 3) / 18.1, (this.string) + "ff")
                    //         gard.addColorStop((t + 4) / 18.1, "#000000" + "ff")
                    //     }
                    // } else {
                    //     for (let t = 0; t < 13; t += 6) {
                    //         gard.addColorStop(t / 18.1, (this.string) + `ff`)
                    //         gard.addColorStop((t + 1.5) / 18.1, "#000000" + "ff")
                    //         gard.addColorStop((t + 3) / 18.1, (this.string) + "ff")
                    //         gard.addColorStop((t + 4) / 18.1, "#000000" + "ff")
                    //     }

                    // }


                    gard.addColorStop(0, (this.string) + `00`)
                    gard.addColorStop(.5, "#000000" + "00")
                    gard.addColorStop(.75, (this.string) + "ff")
                    // gard.addColorStop(.9, (this.string) + "ff")
                    gard.addColorStop(1, "#000000" + "00")

                    canvas_context.fillStyle = gard
                    canvas_context.beginPath();
                    canvas_context.arc(this.x, this.y, this.radius, 0, (Math.PI * 2), true)
                    canvas_context.fill()


                    // tempcanvas.width = this.radius * 2
                    // tempcanvas.height = this.radius * 2


                    // // temp_context.save();
                    // temp_context.fillStyle = gard
                    // temp_context.beginPath();
                    // temp_context.arc(this.radius, this.radius, this.radius, 0, (Math.PI * 2), true)
                    // temp_context.fill()
                    // temp_context.globalCompositeOperation = 'destination-out'
                    // temp_context.beginPath();
                    // temp_context.fillStyle = '#888888'
                    // temp_context.arc(this.radius, this.radius, this.radius * .5, 0, 2 * Math.PI)
                    // temp_context.fill()
                    // // temp_context.restore()
                    // canvas_context.drawImage(tempcanvas, 0, 0, tempcanvas.width, tempcanvas.height, this.x - this.radius, this.y - this.radius, this.radius * 2, this.radius * 2)
                    // // canvas_context.stroke();
                    // temp_context.globalCompositeOperation = 'source-over'
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }
    class Bullet {
        constructor(x, y, radius, color) {
            this.startrad = 1
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.body = new CircleS(this.x, this.y, this.radius, this.color, 0, 0, 1)  //delete friction?
            // this.launched = 0
            this.generating = 0
            this.gravity = .4
            delete this.body.friction
        }
        draw() {

            this.body.draw()
            this.body.x = Math.round(this.body.x)
            this.body.y = Math.round(this.body.y)
        }
        move() {
            this.gravity = .4
            if (this.generating == 1) {
                this.body.radius = this.startrad
                this.startrad += .05
                if (this.startrad >= this.radius) {
                    this.generating = 0
                }
            } else {
                this.body.ymom += this.gravity
                this.body.bmove()  //sdfddf
            }
            this.body.x = Math.round(this.body.x)
            this.body.y = Math.round(this.body.y)
        }
    }
    class ShotZ {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, angle = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseFloat(xmom)
            this.ymom = parseFloat(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
            this.angle = parseFloat(angle)
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            this.angle += .04
            if (typeof this.radius !== 'number') {
                return
            }
            if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                canvas_context.lineWidth = this.radius * .1
            } else {
                canvas_context.lineWidth = this.radius * .4
            }
            canvas_context.strokeStyle = this.color
            // canvas_context.beginPath();
            if (this.radius > 0) {
                // for (let t = 0; t < Math.PI * 2; t += (Math.PI / 10)) {
                //     canvas_context.beginPath();
                //     canvas_context.arc(this.x, this.y, this.radius, t + this.angle, t + (Math.PI / 20) + this.angle, false)
                //     canvas_context.strokeStyle = this.color
                //     canvas_context.stroke()
                // }


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    // var gard = canvas_context.createRadialGradient(Math.round(this.radius), Math.round(this.radius), 0, Math.round(this.radius), Math.ceil(this.radius + (this.radius * 0)), Math.ceil(Math.max((this.radius * 2.5) - canvas_context.lineWidth, 0)))
                    // this.string = this.color

                    //         gard.addColorStop(0, (this.string) + `00`)
                    //         gard.addColorStop(.8, "#FFFFFF" + "00")
                    //         gard.addColorStop(.85, (this.string) + "ff")
                    //         gard.addColorStop(.9, this.string + "00")
                    //         gard.addColorStop(.95, this.string + "00")
                    //         gard.addColorStop(.1, "#FFFFFF" + "00")



                    // // tempcanvas.width = this.radius * 2
                    // // tempcanvas.height = this.radius * 2


                    // // temp_context.save();
                    // canvas_context.fillStyle = gard
                    canvas_context.beginPath();
                    canvas_context.arc(this.x, this.y, this.radius, 0, (Math.PI * 2), true)

                    // canvas_context.fill()
                    canvas_context.stroke()
                    // temp_context.globalCompositeOperation = 'destination-out'
                    // temp_context.beginPath();
                    // temp_context.fillStyle = '#888888'
                    // temp_context.arc(this.radius, this.radius, this.radius * .8, 0, 2 * Math.PI)
                    // temp_context.fill()
                    // temp_context.restore()


                    // canvas_context.fillStyle = '#000000'
                    // canvas_context.arc(this.x, this.y, this.radius * .8, 0, 2 * Math.PI)
                    // canvas_context.fill()
                    // canvas_context.drawImage(tempcanvas, 0, 0, tempcanvas.width, tempcanvas.height, this.x - this.radius, this.y - this.radius, this.radius * 2, this.radius * 2)
                    // canvas_context.stroke();
                    // temp_context.globalCompositeOperation = 'source-over'
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }
        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }
    class ShotE {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, angle = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseFloat(xmom)
            this.ymom = parseFloat(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
            this.angle = parseFloat(angle)
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            this.angle += .04
            if (typeof this.radius !== 'number') {
                return
            }
            if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                canvas_context.lineWidth = this.radius * .3
            } else {
                canvas_context.lineWidth = 10
            }
            canvas_context.strokeStyle = this.color
            // canvas_context.beginPath();
            if (this.radius > 0) {
                // for (let t = 0; t < Math.PI * 2; t +=(Math.PI/10)) {
                //     canvas_context.beginPath();
                //     canvas_context.arc(this.x, this.y, this.radius, t+this.angle, t + (Math.PI/20)+this.angle, false)
                //     canvas_context.strokeStyle = this.color
                //     canvas_context.stroke()
                // }


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    var gard = canvas_context.createRadialGradient(Math.round(this.radius), Math.round(this.radius), 0, Math.round(this.radius), Math.ceil(this.radius + (this.radius * 0)), Math.ceil(Math.max((this.radius * 2.5) - canvas_context.lineWidth, 0)))
                    this.string = this.color
                    if (this.color != "#FFAAAA") {
                        for (let t = 0; t < 13; t += 6) {
                            gard.addColorStop(t / 18.1, (this.string) + `ff`)
                            gard.addColorStop((t + 1.5) / 18.1, "#000000" + "ff")
                            gard.addColorStop((t + 3) / 18.1, (this.string) + "ff")
                            gard.addColorStop((t + 4) / 18.1, "#000000" + "ff")
                        }
                    } else {
                        for (let t = 0; t < 13; t += 6) {
                            gard.addColorStop(t / 18.1, (this.string) + `ff`)
                            gard.addColorStop((t + 1.5) / 18.1, "#000000" + "ff")
                            gard.addColorStop((t + 3) / 18.1, (this.string) + "ff")
                            gard.addColorStop((t + 4) / 18.1, "#000000" + "ff")
                        }

                    }


                    canvas_context.beginPath();
                    canvas_context.arc(this.x, this.y, this.radius, 0, (Math.PI * 2), true)
                    canvas_context.stroke()

                    // tempcanvas.width = this.radius * 2
                    // tempcanvas.height = this.radius * 2


                    // temp_context.save();
                    // temp_context.fillStyle = gard
                    // temp_context.beginPath();
                    // temp_context.arc(this.radius, this.radius, this.radius, 0, (Math.PI * 2), true)
                    // temp_context.fill()
                    // temp_context.globalCompositeOperation = 'destination-out'
                    // temp_context.beginPath();
                    // temp_context.fillStyle = '#888888'
                    // temp_context.arc(this.radius, this.radius, this.radius * .5, 0, 2 * Math.PI)
                    // temp_context.fill()
                    // temp_context.restore()
                    // canvas_context.drawImage(tempcanvas, 0, 0, tempcanvas.width, tempcanvas.height, this.x - this.radius, this.y - this.radius, this.radius * 2, this.radius * 2)
                    // canvas_context.stroke();
                    // temp_context.globalCompositeOperation = 'source-over'
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }
    class ShotC {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseInt(xmom)
            this.ymom = parseInt(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            if (typeof this.radius !== 'number') {
                return
            }
            canvas_context.lineWidth = 5
            canvas_context.strokeStyle = this.color
            canvas_context.beginPath();
            if (this.radius > 0) {
                canvas_context.arc(this.x, this.y, this.radius, 0, (Math.PI * 2), true)
                canvas_context.fillStyle = this.color


                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.round(this.y), Math.max(this.radius - canvas_context.lineWidth, 0))
                    this.string = this.color

                    gard.addColorStop(0, (this.string) + `ff`)
                    gard.addColorStop(0.33, invertColor(this.string) + "ff")
                    gard.addColorStop(0.66, (this.string) + "ff")
                    gard.addColorStop(1, invertColor(this.string) + "ff")
                    canvas_context.fillStyle = gard
                    canvas_context.fill()
                    canvas_context.stroke();
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
            // canvas_context.closePath()
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    }
    class ShotD {
        constructor(x, y, radius, color, xmom = 0, ymom = 0, friction = 1, marked = 0, fired = 0, reflect = 0, strokeWidth = 0, strokeColor = "transparent") {
            this.x = parseFloat(x)
            this.id = parseFloat(Math.random().toFixed(5))
            this.y = parseFloat(y)
            this.radius = parseFloat(radius)
            this.color = color
            this.xmom = parseInt(xmom)
            this.ymom = parseInt(ymom)
            this.friction = parseFloat(friction)
            this.reflect = parseInt(reflect)
            this.strokeWidth = parseFloat(strokeWidth)
            this.strokeColor = strokeColor
            this.anchored = 0
            this.anchor = {}
            this.sxmom = 0
            this.symom = 0
            this.fired = parseFloat(fired)
            this.marked = parseFloat(marked)
        }
        smove(player) {
            this.x += this.sxmom
            this.y += this.symom
        }
        reversePointinside(point) {

            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (point.radius * point.radius)) {
                return true
            }
            return false
        }
        draw() {
            if (typeof this.radius !== 'number') {
                return
            }
            canvas_context.lineWidth = 5
            canvas_context.strokeStyle = this.color
            canvas_context.beginPath();
            if (this.radius > 0) {
                canvas_context.arc(this.x, this.y, this.radius, 0, (Math.PI * 2), true)
                canvas_context.fillStyle = this.color



                if (isFinite(this.x) && isFinite(this.y) && isFinite(this.radius)) {
                    var gard = canvas_context.createRadialGradient(Math.round(this.x), Math.round(this.y), 0, Math.round(this.x), Math.round(this.y), Math.max(this.radius - canvas_context.lineWidth, 0))
                    this.string = this.color

                    gard.addColorStop(0, (this.string) + `ff`)
                    gard.addColorStop(0.33, "#FF0000" + "ff")
                    gard.addColorStop(0.66, (this.string) + "ff")
                    gard.addColorStop(1, "#000000" + "ff")
                    canvas_context.fillStyle = gard
                    canvas_context.fill()
                    canvas_context.stroke();
                }
            } else {
                // //////////////////////////// ////////////////////////////////////////////console.log("The circle is below a radius of 0, and has not been drawn. The circle is:", this)
            }
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        unmove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.x -= this.xmom
            this.y -= this.ymom
        }

        frictiveMove(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
            this.xmom *= this.friction
            this.ymom *= this.friction
        }
        frictiveunMove() {
            if (this.reflect == 1) {
                if (this.x + this.radius > canvas.width) {
                    if (this.xmom > 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y + this.radius > canvas.height) {
                    if (this.ymom > 0) {
                        this.ymom *= -1
                    }
                }
                if (this.x - this.radius < 0) {
                    if (this.xmom < 0) {
                        this.xmom *= -1
                    }
                }
                if (this.y - this.radius < 0) {
                    if (this.ymom < 0) {
                        this.ymom *= -1
                    }
                }
            }
            this.xmom /= this.friction
            this.ymom /= this.friction
            this.x -= this.xmom
            this.y -= this.ymom
        }
        isPointInside(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.radius * this.radius)) {
                return true
            }
            return false
        }
        doesPerimeterTouch(point) {
            this.areaY = point.y - this.y
            this.areaX = point.x - this.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= ((this.radius + point.radius) * (this.radius + point.radius))) {
                return true
            }
            return false
        }
    } class Polygon {
        constructor(x, y, size, color, sides = 3, xmom = 0, ymom = 0, angle = 0, reflect = 0) {
            if (sides < 2) {
                sides = 2
            }
            this.reflect = reflect
            this.xmom = parseInt(xmom)
            this.ymom = parseInt(ymom)
            this.body = new Circle(x, y, size - (size * .293), "transparent")
            this.nodes = []
            this.angle = angle
            this.size = size
            this.color = color
            this.angleIncrement = (Math.PI * 2) / sides
            this.sides = sides
            for (let t = 0; t < sides; t++) {
                const node = new Circle(this.body.x + (this.size * (Math.cos(this.angle))), this.body.y + (this.size * (Math.sin(this.angle))), 0, "transparent")
                this.nodes.push(node)
                this.angle += this.angleIncrement
            }
        }
        isPointInside(point) { // rough approximation
            this.body.radius = this.size - (this.size * .293)
            if (this.sides <= 2) {
                return false
            }
            this.areaY = point.y - this.body.y
            this.areaX = point.x - this.body.x
            if (((this.areaX * this.areaX) + (this.areaY * this.areaY)) <= (this.body.radius * this.body.radius)) {
                return true
            }
            return false
        }

        move(player) {
            if (this.anchored !== 1) {
                let fricbreak = 0
                for (let t = 0; t < (Math.abs(this.xmom) + Math.abs(this.ymom)); t += (Math.abs(this.xmom) + Math.abs(this.ymom)) * .08) {
                    fricbreak++
                    if (fricbreak > 27) {
                        break
                    }
                    this.x += this.xmom * .08
                    this.y += this.ymom * .08

                    if (typeof player != 'undefined') {
                        for (let k = 0; k < stage.bricks.length; k++) {
                            stage.bricks[k].doesPerimeterTouch(this, player)
                        }
                        for (let k = 0; k < stage.walls.length; k++) {
                            stage.walls[k].doesPerimeterTouch(this, player)
                        }
                    }
                }
            } else {
                this.x = this.anchor.x
                this.y = this.anchor.y
                this.xmom = 0
                this.ymom = 0
            }
        }
        draw() {
            this.nodes = []
            this.angleIncrement = (Math.PI * 2) / this.sides
            this.body.radius = this.size - (this.size * .293)
            for (let t = 0; t < this.sides; t++) {
                const node = new Circle(this.body.x + (this.size * (Math.cos(this.angle))), this.body.y + (this.size * (Math.sin(this.angle))), 0, "transparent")
                this.nodes.push(node)
                this.angle += this.angleIncrement
            }
            canvas_context.strokeStyle = this.color
            canvas_context.fillStyle = this.color
            canvas_context.lineWidth = 0
            canvas_context.beginPath()
            canvas_context.moveTo(this.nodes[0].x, this.nodes[0].y)
            for (let t = 1; t < this.nodes.length; t++) {
                canvas_context.lineTo(this.nodes[t].x, this.nodes[t].y)
            }
            canvas_context.lineTo(this.nodes[0].x, this.nodes[0].y)
            // canvas_context.fill()
            canvas_context.stroke()
            canvas_context.closePath()
        }
    }
    class Shape {
        constructor(shapes) {
            this.shapes = shapes
            this.compareflop = 0
        }
        shiftRight(num) {
            // ////////console.log(num)
            for (let t = 0; t < this.shapes.length; t++) {
                this.shapes[t].x += num
                // this.shapes[t].color = getRandomColor()
            }
        }
        shiftDown(num) {
            // ////////console.log(num)
            for (let t = 0; t < this.shapes.length; t++) {
                this.shapes[t].y += num
                // this.shapes[t].color = getRandomColor()
            }
        }
        draw() {
            for (let t = 0; t < this.shapes.length; t++) {
                this.shapes[t].draw()
            }
        }
        isPointInside(point) {
            for (let t = 0; t < this.shapes.length; t++) {
                if (this.shapes[t].isPointInside(point)) {
                    return true
                }
            }
            return false
        }
        doesPerimeterTouch(point) {
            for (let t = 0; t < this.shapes.length; t++) {
                if (this.shapes[t].doesPerimeterTouch(point)) {
                    return true
                }
            }
            return false
        }
        innerShape(point) {
            this.compareflop++
            if(this.compareflop%2 == 0){
                for (let t = 0; t < this.shapes.length; t++) {
                if (this.shapes[t].doesPerimeterTouch(point)) {
                    return this.shapes[t]
                }
            }
            }else{

            for (let t = this.shapes.length-1;t >=0;  t--) {
                if (this.shapes[t].doesPerimeterTouch(point)) {
                    return this.shapes[t]
                }
            }
            }
            return false
        }
        isInsideOf(box) {
            for (let t = 0; t < this.shapes.length; t++) {
                if (box.isPointInside(this.shapes[t])) {
                    return true
                }
            }
            return false
        }
        push(object) {
            this.shapes.push(object)
        }
    }
    class Spring {
        constructor(x, y, radius, color, body = 0, length = 1, gravity = 0, width = 1) {
            if (body == 0) {
                this.body = new Circle(x, y, radius, color)
                this.anchor = new Circle(x, y, radius, color)
                this.beam = new Line(this.body.x, this.body.y, this.anchor.x, this.anchor.y, "yellow", width)
                this.length = length
            } else {
                this.body = body
                this.anchor = new Circle(x, y, radius, color)
                this.beam = new Line(this.body.x, this.body.y, this.anchor.x, this.anchor.y, "yellow", width)
                this.length = length
            }
            this.gravity = gravity
            this.width = width
        }
        balance() {
            this.beam = new Line(this.body.x, this.body.y, this.anchor.x, this.anchor.y, "yellow", this.width)
            if (this.beam.sqrDis() < this.length * this.length) {
                this.body.xmom += (this.body.x - this.anchor.x) / this.length
                this.body.ymom += (this.body.y - this.anchor.y) / this.length
                this.anchor.xmom -= (this.body.x - this.anchor.x) / this.length
                this.anchor.ymom -= (this.body.y - this.anchor.y) / this.length
            } else {
                this.body.xmom -= (this.body.x - this.anchor.x) / this.length
                this.body.ymom -= (this.body.y - this.anchor.y) / this.length
                this.anchor.xmom += (this.body.x - this.anchor.x) / this.length
                this.anchor.ymom += (this.body.y - this.anchor.y) / this.length
            }
            const xmomentumaverage = (this.body.xmom + this.anchor.xmom) / 2
            const ymomentumaverage = (this.body.ymom + this.anchor.ymom) / 2
            this.body.xmom = (this.body.xmom + xmomentumaverage) / 2
            this.body.ymom = (this.body.ymom + ymomentumaverage) / 2
            this.anchor.xmom = (this.anchor.xmom + xmomentumaverage) / 2
            this.anchor.ymom = (this.anchor.ymom + ymomentumaverage) / 2
        }
        draw() {
            this.beam = new Line(this.body.x, this.body.y, this.anchor.x, this.anchor.y, "yellow", this.width)
            this.beam.draw()
            this.body.draw()
            this.anchor.draw()
        }
        move() {
            this.anchor.ymom += this.gravity
            this.anchor.move()
        }

    }
    class SpringOP {
        constructor(body, anchor, length = 10, width = 3, color = "#ffffff") {
            if (body == 0) {
                const keys = Object.keys(anchor)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = anchor[keys[t]]
                }
                this.body = new Circle(this.body.x, this.body.y, this.body.radius, this.body.color, this.body.xmom, this.body.ymom, this.body.friction)
                this.anchor = new Circle(this.anchor.x, this.anchor.y, this.anchor.radius, this.anchor.color, this.anchor.xmom, this.anchor.ymom, this.anchor.friction)
                this.beam = new LineOP(this.body, this.anchor, color, width)
            } else {
                this.body = body
                this.anchor = anchor
                this.beam = new LineOP(body, anchor, color, width)
                this.str = this.beam.sqrDis()
                this.length = length
            }
        }

        sqrDis() {
            const xdif = this.body.x - this.anchor.x
            const ydif = this.body.y - this.anchor.y
            const hypotenuse = (xdif * xdif) + (ydif * ydif)
            return (hypotenuse)
        }
        balance() {
            this.str = this.beam.sqrDis()
            // return
            if (this.length < 2.1) {
                this.length = 2.1
            }
            if (this.str < (this.length - 2) * (this.length - 2)) {

                // return

                this.body.xmom += ((this.body.x - this.anchor.x) / this.length) * 2
                this.body.ymom += ((this.body.y - this.anchor.y) / this.length) * 2
                this.anchor.xmom -= ((this.body.x - this.anchor.x) / this.length) * 2
                this.anchor.ymom -= ((this.body.y - this.anchor.y) / this.length) * 2
                if (Math.abs(this.anchor.xmom) + Math.abs(this.anchor.ymom) > 1) {
                    this.anchor.xmom *= .9
                    this.anchor.ymom *= .9
                }
                if (Math.abs(this.body.xmom) + Math.abs(this.body.ymom) > 1) {
                    this.body.xmom *= .9
                    this.body.ymom *= .9
                }
                if (this.anchor.fired < 8 && this.anchor.fired > 0) {
                    this.anchor.xmom -= ((this.body.x - this.anchor.x) / (this.length)) * 7.66
                    this.anchor.ymom -= ((this.body.y - this.anchor.y) / (this.length)) * 7.66
                    if (this.anchor.fired < 6 && this.anchor.fired > 3) {
                        if (Math.abs(this.anchor.xmom) + Math.abs(this.anchor.ymom) > 1) {
                            this.anchor.xmom *= .4
                            this.anchor.ymom *= .4
                        }
                        if (Math.abs(this.body.xmom) + Math.abs(this.body.ymom) > 1) {
                            this.body.xmom *= .4
                            this.body.ymom *= .4
                        }
                    }
                }
            } else if (this.str > (this.length * 2) * (this.length * 2)) {

                // return

                this.body.xmom -= ((this.body.x - this.anchor.x) / (this.length)) * 5.66
                this.body.ymom -= ((this.body.y - this.anchor.y) / (this.length)) * 5.66
                this.anchor.xmom += ((this.body.x - this.anchor.x) / (this.length)) * 5.66
                this.anchor.ymom += ((this.body.y - this.anchor.y) / (this.length)) * 5.66
                if (this.anchor.anchored == 1) {
                    this.body.xmom -= ((this.body.x - this.anchor.x) / (this.length)) * 5.66
                    this.body.ymom -= ((this.body.y - this.anchor.y) / (this.length)) * 5.66
                    this.body.ymom += this.body.gravity
                }
                if (this.anchor.fired < 10 && this.anchor.fired > 0) {
                    this.anchor.xmom += ((this.body.x - this.anchor.x) / (this.length)) * 7.66
                    this.anchor.ymom += ((this.body.y - this.anchor.y) / (this.length)) * 7.66
                    if (this.anchor.fired < 6 && this.anchor.fired > 3) {
                        if (Math.abs(this.anchor.xmom) + Math.abs(this.anchor.ymom) > 1) {
                            this.anchor.xmom *= .4
                            this.anchor.ymom *= .4
                        }
                        if (Math.abs(this.body.xmom) + Math.abs(this.body.ymom) > 1) {
                            this.body.xmom *= .4
                            this.body.ymom *= .4
                        }
                    }
                }
            } else if (this.str > (this.length + 2) * (this.length + 2)) {

                // //////console.log(this.str, this.length)
                this.body.xmom -= ((this.body.x - this.anchor.x) / (this.length)) * 1.66
                this.body.ymom -= ((this.body.y - this.anchor.y) / (this.length)) * 1.66
                this.anchor.xmom += ((this.body.x - this.anchor.x) / (this.length)) * 1.66
                this.anchor.ymom += ((this.body.y - this.anchor.y) / (this.length)) * 1.66
                // return

                if (this.anchor.anchored == 1) {
                    this.body.xmom -= ((this.body.x - this.anchor.x) / (this.length)) * 5.66
                    this.body.ymom -= ((this.body.y - this.anchor.y) / (this.length)) * 5.66
                    this.body.ymom += this.body.gravity
                }
                if (this.anchor.fired < 10 && this.anchor.fired > 0) {
                    this.anchor.xmom += ((this.body.x - this.anchor.x) / (this.length)) * 5.66
                    this.anchor.ymom += ((this.body.y - this.anchor.y) / (this.length)) * 5.66
                    if (this.anchor.fired < 6 && this.anchor.fired > 3) {

                        if (Math.abs(this.anchor.xmom) + Math.abs(this.anchor.ymom) > 1) {
                            this.anchor.xmom *= .4
                            this.anchor.ymom *= .4
                        }
                        if (Math.abs(this.body.xmom) + Math.abs(this.body.ymom) > 1) {
                            this.body.xmom *= .4
                            this.body.ymom *= .4
                        }
                    }
                }
            } else {
                if (Math.abs(this.body.xmom) + Math.abs(this.body.ymom) > 1) {
                    this.body.xmom *= .19
                    this.body.ymom *= .19
                }
                if (Math.abs(this.anchor.xmom) + Math.abs(this.anchor.ymom) > 1) {
                    this.anchor.xmom *= .19
                    this.anchor.ymom *= .19
                }
            }
            let xmomentumaverage = (this.body.xmom + (this.anchor.xmom * 10)) / 11
            let ymomentumaverage = (this.body.ymom + (this.anchor.ymom * 10)) / 11
            this.body.xmom = (this.body.xmom + xmomentumaverage) / 2
            this.body.ymom = (this.body.ymom + ymomentumaverage) / 2
            this.anchor.xmom = (this.anchor.xmom + xmomentumaverage) / 2
            this.anchor.ymom = (this.anchor.ymom + ymomentumaverage) / 2

            if (this.anchor.anchored !== 1) {
                let xmomentumaverage = (this.body.xmom + (this.anchor.xmom * 10)) / 11
                let ymomentumaverage = (this.body.ymom + (this.anchor.ymom * 10)) / 11
                this.body.xmom = (this.body.xmom + xmomentumaverage) / 2
                this.body.ymom = (this.body.ymom + ymomentumaverage) / 2
                this.anchor.xmom = (this.anchor.xmom + xmomentumaverage) / 2
                this.anchor.ymom = (this.anchor.ymom + ymomentumaverage) / 2
                xmomentumaverage = (this.body.xmom + (this.anchor.xmom * 10)) / 11
                ymomentumaverage = (this.body.ymom + (this.anchor.ymom * 10)) / 11
                this.body.xmom = (this.body.xmom + xmomentumaverage) / 2
                this.body.ymom = (this.body.ymom + ymomentumaverage) / 2
                this.anchor.xmom = (this.anchor.xmom + xmomentumaverage) / 2
                this.anchor.ymom = (this.anchor.ymom + ymomentumaverage) / 2
                xmomentumaverage = (this.body.xmom + (this.anchor.xmom * 10)) / 11
                ymomentumaverage = (this.body.ymom + (this.anchor.ymom * 10)) / 11
                this.body.xmom = (this.body.xmom + xmomentumaverage) / 2
                this.body.ymom = (this.body.ymom + ymomentumaverage) / 2
                this.anchor.xmom = (this.anchor.xmom + xmomentumaverage) / 2
                this.anchor.ymom = (this.anchor.ymom + ymomentumaverage) / 2
            }
            //      xmomentumaverage = (this.body.xmom + this.anchor.xmom) / 2
            //      ymomentumaverage = (this.body.ymom + this.anchor.ymom) / 2
            //     this.body.xmom = (this.body.xmom + xmomentumaverage) / 2
            //     this.body.ymom = (this.body.ymom + ymomentumaverage) / 2
            //     this.anchor.xmom = (this.anchor.xmom + xmomentumaverage) / 2
            //     this.anchor.ymom = (this.anchor.ymom + ymomentumaverage) / 2
        }
        draw() {
            this.beam.draw()
        }
        move() {
            //movement of SpringOP objects should be handled separate from their linkage, to allow for many connections, balance here with this object, move nodes independently
        }
    }

    class Color {
        constructor(baseColor, red = -1, green = -1, blue = -1, alpha = 1) {
            this.hue = baseColor
            if (red != -1 && green != -1 && blue != -1) {
                this.r = red
                this.g = green
                this.b = blue
                if (alpha != 1) {
                    if (alpha < 1) {
                        this.alpha = alpha
                    } else {
                        this.alpha = alpha / 255
                        if (this.alpha > 1) {
                            this.alpha = 1
                        }
                    }
                }
                if (this.r > 255) {
                    this.r = 255
                }
                if (this.g > 255) {
                    this.g = 255
                }
                if (this.b > 255) {
                    this.b = 255
                }
                if (this.r < 0) {
                    this.r = 0
                }
                if (this.g < 0) {
                    this.g = 0
                }
                if (this.b < 0) {
                    this.b = 0
                }
            } else {
                this.r = 0
                this.g = 0
                this.b = 0
            }
        }
        normalize() {
            if (this.r > 255) {
                this.r = 255
            }
            if (this.g > 255) {
                this.g = 255
            }
            if (this.b > 255) {
                this.b = 255
            }
            if (this.r < 0) {
                this.r = 0
            }
            if (this.g < 0) {
                this.g = 0
            }
            if (this.b < 0) {
                this.b = 0
            }
        }
        randomLight() {
            var letters = '0123456789ABCDEF';
            var hash = '#';
            for (var i = 0; i < 6; i++) {
                hash += letters[(Math.floor(Math.random() * 12) + 4)];
            }
            var color = new Color(hash, 55 + Math.random() * 200, 55 + Math.random() * 200, 55 + Math.random() * 200)
            return color;
        }
        randomDark() {
            var letters = '0123456789ABCDEF';
            var hash = '#';
            for (var i = 0; i < 6; i++) {
                hash += letters[(Math.floor(Math.random() * 12))];
            }
            var color = new Color(hash, Math.random() * 200, Math.random() * 200, Math.random() * 200)
            return color;
        }
        random() {
            var letters = '0123456789ABCDEF';
            var hash = '#';
            for (var i = 0; i < 6; i++) {
                hash += letters[(Math.floor(Math.random() * 16))];
            }
            var color = new Color(hash, Math.random() * 255, Math.random() * 255, Math.random() * 255)
            return color;
        }
    }
    function setUp(canvas_pass, style = "#090909") {
        canvas = canvas_pass
        canvas_context = canvas.getContext('2d');
        canvas.style.background = style
        canvas_context.scale(scale, scale)
        window.setInterval(function () {

            main()

        }, 18)
        document.addEventListener('keydown', (event) => {
            keysPressed[event.key] = true;
            if (event.key == 'Backspace') {
                if (roomSelectionBox.focus == 1) {
                    roomSelectionBox.backspace()
                }
                if (stockSelectionBox.focus == 1) {
                    stockSelectionBox.backspace()
                }
            } else {
                if (roomSelectionBox.focus == 1) {
                    if (parseInt(event.key, 10) > -1 && parseInt(event.key, 10) < 10) {
                        roomSelectionBox.addchar(event.key)
                    }
                }
                if (stockSelectionBox.focus == 1) {
                    if (parseInt(event.key, 10) > -1 && parseInt(event.key, 10) < 10) {
                        stockSelectionBox.addchar(event.key)
                    }
                }
            }
        });
        document.addEventListener('keyup', (event) => {
            delete keysPressed[event.key];
            if (roomSelectionBox.lock == event.key) {
                roomSelectionBox.lock = ''
            }
            if (stockSelectionBox.lock == event.key) {
                stockSelectionBox.lock = ''
            }
        });

        formname.addEventListener('pointerdown', e => {
            formname.value = ''
      
        });
        canvas.addEventListener('pointerdown', e => {
            FLEX_engine = canvas.getBoundingClientRect();
            XS_engine = e.clientX - FLEX_engine.left;
            YS_engine = e.clientY - FLEX_engine.top;
            TIP_engine.x = XS_engine * invscale
            TIP_engine.y = YS_engine * invscale
            TIP_engine.body = TIP_engine

            ////////////////// ////////////////////////////////////////////console.log(TIP_engine)
            for (let t = 0; t < selectors.length; t++) {
                if (selectors[t].body.isPointInside(TIP_engine)) {
                    selectors[t].body.anchored = 2
                    selectors[t].body.anchor = TIP_engine
                    break
                }
            }
            // if (counter == 1) {
            //     for(let t = 0;t<boys.length;t++){
            //         boys[t].righthand.anchored = 0
            //         boys[t].lefthand.anchored = 0
            //         boys[t].righthand.x += (TIP_engine.x * 1) - boys[t].righthand.x
            //         boys[t].righthand.y += (TIP_engine.y * 1) - boys[t].righthand.y
            //         boys[t].lefthand.x += (TIP_engine.x * 1) - boys[t].lefthand.x
            //         boys[t].lefthand.y += (TIP_engine.y * 1) - boys[t].lefthand.y
            //         boys[t].body.x = TIP_engine.x * 1
            //         boys[t].body.y = TIP_engine.y * 1
            //         boys[t].body.xmom = 0
            //         boys[t].body.ymom = 0
            //     }
            // }
            // example usage: if(object.isPointInside(TIP_engine)){ take action }
            canvas.addEventListener('pointermove', continued_stimuli);
            if (optionsButton.isPointInside(TIP_engine)) {
                if (optionsToggle == 0) {
                    optionsToggle = 1
                    roomSelectionBox.focus = 1
                } else {
                    optionsToggle = 0
                    descriptor.index = -1
                    roomSelectionBox.focus = 0
                }
            }
            if (escapeButton.isPointInside(TIP_engine)) {

                stars = []
                descriptor.index = -1
                serverID = parseFloat(Math.random().toFixed(7))
                selectors = []
                for (let t = 0; t < 16; t++) {

                    const selector = new Selector()
                    selector.body.color = colors[t]
                    selectors.push(selector)

                }
                if (counter == 1) {
                    counter = 0
                    if (campaignToggle == 1 || minigameSelected == 0  || minigameSelected == 1  || minigameSelected == 6 || minigameSelected == 12) {
                        canvas_context.translate(boys[0].body.x - (canvas.width * (invscale * .5)), boys[0].body.y - (canvas.height * (invscale * .5)))
                    }

                    minigameSelected = -1
                    boys = []
                    scores = []
                    drops = []

                    localIDs = []
                }
                stage = new Stage(MapSelect)

                if (AItoggle == 0  && localPlayToggle == 0) {
                    ws.close()
                    start = 0
                    HOST = location.origin.replace(/^http/, 'ws')
                    ws = new WebSocket(HOST);
                    socketize(ws)
                }
            }
            if (counter == 0) {


                if (optionsToggle == 1) {
                    if (campaignButton.isPointInside(TIP_engine)) {
                        if (campaignToggle == 0) {
                            campaignToggle = 1
                            stock = 0
                            AIFightButton.color = "#00FF00"
                            campaignButton.color = "#00FF00"
                            onlineButton.color = "#FF0000"
                            stage = new Stage(MapSelect)
                            AItoggle = 1
                            boys = []
                            scores = []
                            drops = []
                            ws.close()
                            minigameSelected = -1
                            minigameSelectToggle = 0
                            descriptor.index = -1

                        } else {
                            campaignToggle = 0
                            // AIFightButton.color = "#FF0000"
                            campaignButton.color = "#FF0000"
                            stage = new Stage(MapSelect)
                            // AItoggle = 0
                            boys = []
                            scores = []
                            drops = []
                        }
                    }
                    if (AIFightButton.isPointInside(TIP_engine)) {
                        if (AItoggle == 0 ) {
                            AIFightButton.color = "#00FF00"
                            onlineButton.color = "#FF0000"
                            localButton.color = "#FF0000"
                            stage = new Stage(MapSelect)
                            AItoggle = 1
                            humanPlayers = 0
                            boys = []
                            scores = [] //jumpin( break)
                            drops = []
                            ws.close()
                            minigameSelected = -1
                        } else {
                            AIFightButton.color = "#FF0000"
                            stage = new Stage(MapSelect)
                            AItoggle = 0
                            // humanPlayers = 1004
                            // campaignToggle = 0
                            // campaignButton.color = "#FF0000"
                            // boys = []
                        }
                    }
                    if(saveScoreButton.isPointInside(TIP_engine)){

                            HOST = location.origin.replace(/^http/, 'ws')
                            ws = new WebSocket(HOST);
                            socketize(ws)
                            setTimeout(function(){worldscore.save()}, 3000);
                        
                    }
                    if (onlineButton.isPointInside(TIP_engine)) {
                        if (AItoggle == 1 || localPlayToggle == 1 ) {
                            ws.close()
                            minigameSelectToggle = 0
                            descriptor.index = -1
                            campaignToggle = 0
                            AItoggle = 0
                            start = 0
                            HOST = location.origin.replace(/^http/, 'ws')
                            ws = new WebSocket(HOST);
                            socketize(ws)
                            onlineButton.color = "#00FF00"
                            campaignButton.color = "#FF0000"
                            AIFightButton.color = "#FF0000"
                            localButton.color = "#FF0000"
                            localPlayToggle = 0
                            humanPlayers = 1004
                            stage = new Stage(MapSelect)
                            boys = []
                            scores = []
                            drops = []
                            localIDs = []
                            minigameSelected = -1
                            minigameSelectToggle = 0
                        }else{
                            minigameSelectToggle = 0
                            descriptor.index = -1
                            localPlayToggle = 0
                            localButton.color = "#FF0000"
                        }
                    }

                    if (mapSelectButton.isPointInside(TIP_engine)) {
                        if (mapSelectToggle == 0) {
                            mapSelectToggle = 1
                            minigameSelectToggle = 0
                            descriptor.index = -1
                            minigameSelected = -1
                        } else {
                            mapSelectToggle = 0
                        }
                    }
                    if (minigameSelectButton.isPointInside(TIP_engine)) {
                        if (minigameSelectToggle == 0) {
                            selectors = []
                            for (let t = 0; t < 15; t++) {
                                const selector = new Selector()
                                selector.body.color = colors[t]
                                selectors.push(selector)
                            }
                            boys = []
                            ws.close()
                            minigameSelected = 0
                            humanPlayers = 1004
                            minigameSelectToggle = 1
                            boys = [new Princess(0)]
                                scores = [0]
                                drops = [0]
                            stage = new Stage(1000)
                            mapSelectToggle = 0
                            localPlayToggle = 1  //AITggle
                            localButton.color = "#00FF00"
                            AIFightButton.color = "#FF0000"
                            AItoggle = 0
                            campaignToggle = 0
                            campaignButton.color = "#FF0000"
                            onlineButton.color = "#FF0000"
                        } else {
                            minigameSelectToggle = 0
                            minigameSelected = -1
                            descriptor.index = -1
                            stage = new Stage(1000)
                        }
                    }
                    if(localButton.isPointInside(TIP_engine)){
                        if(localPlayToggle == 0){

                            ws.close()
                            minigameSelectToggle = 0
                            descriptor.index = -1
                            localPlayToggle = 1
                            humanPlayers = 1004
                            AItoggle = 0
                            AIFightButton.color = "#FF0000"
                            campaignToggle = 0
                            localButton.color = "#00FF00"
                            onlineButton.color = "#FF0000"
                            campaignButton.color = "#FF0000"
                            minigameSelected = -1
                            stage = new Stage(MapSelect)
                            boys = []

                        }else{
                            ws.close()
                            minigameSelectToggle = 0
                            descriptor.index = -1
                            campaignToggle = 0
                            AItoggle = 0
                            start = 0
                            HOST = location.origin.replace(/^http/, 'ws')
                            ws = new WebSocket(HOST);
                            socketize(ws)
                            onlineButton.color = "#00FF00"
                            campaignButton.color = "#FF0000"
                            AIFightButton.color = "#FF0000"
                            localButton.color = "#FF0000"
                            localPlayToggle = 0
                            humanPlayers = 1004
                            stage = new Stage(MapSelect)
                            boys = []
                            scores = []
                            drops = []
                            localIDs = []
                            minigameSelected = -1
                            minigameSelectToggle = 0
                        }
                    }

                }
                if ( ws.readyState == 1){ //AItoggle == 0  && localPlayToggle == 0 && campaignToggle == 0 &&
                    onlineButton.color = "#00FF00"
                }else{
                    onlineButton.color = "#FF0000"
                }
            }

            if (optionsToggle == 1) {
                if (roomSelectionBox.inputbox.isPointInside(TIP_engine)) {
                    roomSelectionBox.focus = 1
                } else {
                    roomSelectionBox.focus = 0
                }
                if (stockSelectionBox.inputbox.isPointInside(TIP_engine)) {
                    stockSelectionBox.focus = 1
                } else {
                    stockSelectionBox.focus = 0
                }
                if (mapSelectToggle == 1) {
                    for (let t = 0; t < mapIcons.length; t++) {
                        if (mapIcons[t].box.isPointInside(TIP_engine)) {
                            stage = new Stage(t)
                            MapSelect = t
                            roomSelectionBox.addchar('')
                        }
                    }
                }
                if (minigameSelectToggle == 1) {
                    for (let t = 0; t < minigameIcons.length; t++) {
                        if (minigameIcons[t].box.isPointInside(TIP_engine)) {
                            boys = []
                            minigameSelected = t
                            humanPlayers = 1004
                            stage = new Stage(t+1000)
                            if(t == 0){
                                boys = [new Princess(0)]
                                scores = [0]
                                drops = [0]
                            }

                            if(t == 1){
                                humanPlayers = 1004
                            }
                            if(t == 2){
                                boys = [new Jox(0)]
                                scores = [0]
                                drops = [0]
                            }
                            if(t == 3){
                                boys.push(new Joule(0))
                                scores = [0]
                                drops = [0]
                            }
                            if(t == 4){
                                boys.push(new Mass(0))
                                scores = [0]
                                drops = [0]
                            }
                            if(t == 5){
                                boys.push(new Rhopho(0))
                                humanPlayers = 1004
                                scores = [0]
                                drops = [0]
                            }
                            if(t == 6){
                                boys = [new Bunkstanks(0)]
                                humanPlayers = 1004
                                scores = [0]
                                drops = [0]
                            }
                            if(t == 7){
                                boys.push(new Boy(0))
                                humanPlayers = 1004
                                scores = [0]
                                drops = [0]
                            }
                            if(t == 8){
                                boys.push(new AsigMan(0), new AsigMan(0), new Dummy(0))
                                for(let t = 0;t<boys[0].nodes.length;t++){
                                    boys[0].nodes[t].x = 400
                                    boys[0].nodes[t].y = 500
                                    boys[0].nodes[t].color = "#FF000088"
                                }
                                for(let t = 0;t<boys[1].nodes.length;t++){
                                    boys[1].nodes[t].x = 3300
                                    boys[1].nodes[t].y = 500
                                    boys[1].nodes[t].color = "#0000FF88"
                                }
                                    boys[2].body.x = 1900
                                    boys[2].body.y = 500
                                humanPlayers = 0
                                scores = [0,0]
                                drops = [0,0]
                            }
                            if(t == 9){
                                boys.push(new Blastgirl(0))

                                humanPlayers = 1004
                                scores = [0]
                                drops = [0]
                            }
                            if(t == 10){
                                boys.push(new Banandroid(0))
                                boys[0].body.x = 1900
                                boys[0].lefthand.x = 1900
                                boys[0].righthand.x = 1900
                                boys[0].middlehand.x = 1900
                                boys[0].bananahand.x = 1900

                                humanPlayers = 1004
                                scores = [0]
                                drops = [0]
                            }
                            if(t == 11){
                                boys.push(new DrSoto(0))
                                boys[0].body.x = 1900
                                boys[0].lefthand.x = 1900
                                boys[0].righthand.x = 1900

                                humanPlayers = 1004
                                scores = [0]
                                drops = [0]
                            }
                            if(t == 12){
                                boys.push(new Kessler(0))
                                boys[0].body.x = 1900
                                boys[0].lefthand.x = 1900
                                boys[0].righthand.x = 1900

                                for(let t = 0;t<100000;t++){
                                    const star = new Rectangle((Math.random()-.5)*100000, (Math.random()-.5)*100000, -1, -1, getRandomLightColor())
                                    stars.push(star)
                                }
                                humanPlayers = 1004
                                scores = [0]
                                drops = [0]
                            }
                        }
                    }
                }
            }
            if(AItoggle == 0){
                AIFightButton.color = "#FF0000"
            }else{
                AIFightButton.color = "#00FF00"
            }
        });
        window.addEventListener('pointermove', continued_stimuli);
        window.addEventListener('pointerup', e => {

            // if (counter == 1) {
            //     boys[1].righthand.anchored = 0
            //     boys[1].lefthand.anchored = 0
            //     boys[1].righthand.x += (TIP_engine.x * 1) - boys[1].righthand.x
            //     boys[1].righthand.y += (TIP_engine.y * 1) - boys[1].righthand.y
            //     boys[1].lefthand.x += (TIP_engine.x * 1) - boys[1].lefthand.x
            //     boys[1].lefthand.y += (TIP_engine.y * 1) - boys[1].lefthand.y
            //     boys[1].body.x = TIP_engine.x * 1
            //     boys[1].body.y = TIP_engine.y * 1
            //     boys[1].body.xmom = 0
            //     boys[1].body.ymom = 0
            // }
            for (let t = 0; t < selectors.length; t++) {
                if (selectors[t].body.anchored === 2) {
                    for (let k = 0; k < characterbuttons.length; k++) {
                        if (characterbuttons[k].isPointInside(selectors[t].body)) {
                            descriptor.index = k
                        }
                    }
                }
                selectors[t].body.anchored = 0
            }
            window.removeEventListener("pointermove", continued_stimuli);
        })
        function continued_stimuli(e) {
            FLEX_engine = canvas.getBoundingClientRect();
            XS_engine = e.clientX - FLEX_engine.left;
            YS_engine = e.clientY - FLEX_engine.top;
            TIP_engine.x = XS_engine * invscale
            TIP_engine.y = YS_engine * invscale
            TIP_engine.body = TIP_engine

            for (let t = 0; t < selectors.length; t++) {
                if (selectors[t].body.anchored === 2) {
                    for (let k = 0; k < characterbuttons.length; k++) {
                        if (characterbuttons[k].isPointInside(selectors[t].body)) {
                            descriptor.index = k
                        }
                    }
                }
            }
        }
    }


    function gamepad_control_controller_proto(object, speed = 1, controller) { // basic control for objects using the controler
        //         //////////////////////////// ////////////////////////////////////////////console.log(this.axesStatus[1]*this.axesStatus[0]) //debugging

        if (object.self.shield == 0) {
            if (keysPressed['s']) {
                object.self.righthand.anchored = 0
                object.self.lefthand.anchored = 0
            } else if ((controller.gamepad.axesStatus[1] * speed) > speed * .5) {
                object.self.righthand.anchored = 0
                object.self.lefthand.anchored = 0
            }

            if (keysPressed['w']) {
                if (object.self.grounded == 1) {
                    object.self.jumping = 1
                    object.ymom -= speed * 2
                } else {
                    if (object.self.lefthand.anchored == 1) {
                        object.self.degripl()
                        object.self.jumping = 1
                        object.ymom -= speed
                    }
                    if (object.self.righthand.anchored == 1) {
                        object.self.degripr()
                        object.self.jumping = 1
                        object.ymom -= speed
                    }
                }
            }
            if (keysPressed['d']) {
                object.self.face = 1
                object.x += speed
                if (object.self.righthand.anchored == 1) {
                    object.self.degripr()
                    object.self.jumping = 1
                }
            }
            // if (keysPressed['s']) {
            //     object.y += speed
            //     object.self.degrip()
            // }
            if (keysPressed['a']) {
                object.self.face = -1
                object.x -= speed
                if (object.self.righthand.anchored == 1 || object.self.lefthand.anchored == 1) {
                    object.self.degripl()
                    object.self.jumping = 1
                }
            }


            if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                if (controller.gamepad.axesStatus[0] > .1) {
                    object.self.face = 1
                }

                if (controller.gamepad.axesStatus[1] < -.1) {
                    object.self.face = -1
                }
            }

            if (typeof object != 'undefined') {
                if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                    if (typeof (controller.gamepad.axesStatus[0]) != 'undefined') {
                        // object.y += (controller.gamepad.axesStatus[1] * speed)
                        // if((controller.gamepad.axesStatus[1] * speed)  < speed*-.5){             
                        if (object.self.grounded == 1) {
                            object.x += (controller.gamepad.axesStatus[0] * speed)
                            if ((controller.gamepad.axesStatus[1] * speed) < speed * -.5) {
                                object.ymom -= speed * 2
                                object.self.jumping = 1
                            }
                        } else {


                            if (controller.gamepad.axesStatus[0] < -.5) {
                                if (object.self.lefthand.anchored == 1) {
                                    object.self.degripl()
                                    object.self.jumping = 1
                                    object.ymom -= speed
                                } else {
                                    object.x += (controller.gamepad.axesStatus[0] * speed)
                                }
                            }
                            if (controller.gamepad.axesStatus[0] > .5) {
                                object.self.face = 1
                                if (object.self.righthand.anchored == 1) {
                                    object.self.degripr()
                                    object.self.jumping = 1
                                    object.ymom -= speed
                                } else {
                                    object.x += (controller.gamepad.axesStatus[0] * speed)
                                }
                            }


                            if (controller.gamepad.axesStatus[1] < -.5) {
                                object.self.face = -1
                                if (object.self.righthand.anchored == 1 || object.self.lefthand.anchored == 1) {
                                    object.self.degripr()
                                    object.self.degripl()
                                    object.self.jumping = 1
                                    object.ymom -= speed
                                }

                            }
                        }
                        // }
                    }
                }
            }
        }
    }

    function gamepad_control_controller_proto_dj(object, speed = 1, controller) { // basic control for objects using the controler
        //         //////////////////////////// ////////////////////////////////////////////console.log(this.axesStatus[1]*this.axesStatus[0]) //debugging


        if (keysPressed['w']) {
            object.self.jumping = 1
            object.ymom = -speed * 2
            object.self.jumpcount = 100 - object.self.jumpreduction

        }
        if (typeof object != 'undefined') {
            if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                if (typeof (controller.gamepad.axesStatus[0]) != 'undefined') {
                    if (controller.gamepad.axesStatus[1] < -.5) {
                        object.ymom = -speed * 2
                        object.self.jumpcount = 100
                    }
                    // if((controller.gamepad.axesStatus[1] * speed)  < speed*-.5){             

                    //             if (object.self.lefthand.anchored == 1) {
                    //                 object.self.degripl()
                    //                 object.self.jumping = 1
                    //                 object.ymom -= speed 
                    //                 // object.self.jumpcount = 12
                    //             }
                    //             if (object.self.righthand.anchored == 1) {
                    //                 object.self.degripr()
                    //                 object.self.jumping = 1
                    //                 object.ymom -= speed 
                    //             }
                    // }
                }
            }
        }
    }
    function gamepad_control(object, speed = 1) { // basic control for objects using the controler
        //         //////////////////////////// ////////////////////////////////////////////console.log(this.axesStatus[1]*this.axesStatus[0]) //debugging
        if (typeof object.body != 'undefined') {
            if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                if (typeof (controller.gamepad.axesStatus[0]) != 'undefined') {
                    object.body.x += (controller.gamepad.axesStatus[0] * speed)
                    object.body.y += (controller.gamepad.axesStatus[1] * speed)
                }
            }
        } else if (typeof object != 'undefined') {
            if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                if (typeof (controller.gamepad.axesStatus[0]) != 'undefined') {
                    object.x += (controller.gamepad.axesStatus[0] * speed)
                    object.y += (controller.gamepad.axesStatus[1] * speed)

                }
            }
        }
    }
    function control(object, speed = 1) { // basic control for objects
        if (typeof object.body != 'undefined') {
            if (keysPressed['w']) {
                object.body.y -= speed
            }
            if (keysPressed['d']) {
                object.body.x += speed
            }
            if (keysPressed['s']) {
                object.body.y += speed
            }
            if (keysPressed['a']) {
                object.body.x -= speed
            }
        } else if (typeof object != 'undefined') {
            if (keysPressed['w']) {
                object.y -= speed
            }
            if (keysPressed['d']) {
                object.x += speed
            }
            if (keysPressed['s']) {
                object.y += speed
            }
            if (keysPressed['a']) {
                object.x -= speed
            }
        }
    }

    function invertColorx(hex) {
        return getRandomColor()
        if (typeof hex == "undefined") {
            return getRandomColor()
        }
        if (hex.indexOf('#') === 0) {
            hex = hex.slice(1);
        }
        // convert 3-digit hex to 6-digits.
        if (hex.length === 3) {
            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
        }
        if (hex.length !== 6) {
            return getRandomColor()
            throw new Error('Invalid HEX color.');
        }
        // invert color components
        var g = (255 - parseInt(hex.slice(0, 2), 16)).toString(16),
            r = (255 - parseInt(hex.slice(2, 4), 16)).toString(16),
            b = (255 - parseInt(hex.slice(4, 6), 16)).toString(16);
        // pad each with zeros and return
        return '#' + padZero(r) + padZero(g) + padZero(b);
    }

    function invertColor(hex) {
        if (typeof hex == "undefined") {
            return getRandomColor()
        }
        if (hex.indexOf('#') === 0) {
            hex = hex.slice(1);
        }
        // convert 3-digit hex to 6-digits.
        if (hex.length === 3 || hex.length === 4) {
            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
        }
        if (hex.length !== 6 && hex.length != 8) {
            return getRandomColor()
            throw new Error('Invalid HEX color.');
        }
        // invert color components
        var r = (255 - parseInt(hex.slice(0, 2), 16)).toString(16),
            g = (255 - parseInt(hex.slice(2, 4), 16)).toString(16),
            b = (255 - parseInt(hex.slice(4, 6), 16)).toString(16);
        // pad each with zeros and return
        return '#' + padZero(r) + padZero(g) + padZero(b);
    }
    function padZero(str, len) {
        len = len || 2;
        var zeros = new Array(len).join('0');
        return (zeros + str).slice(-len);
    }


    function invertColory(hex) {
        if (typeof hex == "undefined") {
            return getRandomColor()
        }
        if (hex.indexOf('#') === 0) {
            hex = hex.slice(1);
        }
        // convert 3-digit hex to 6-digits.
        if (hex.length === 3) {
            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
        }
        if (hex.length !== 6) {
            return getRandomColor()
            throw new Error('Invalid HEX color.');
        }
        // invert color components
        var b = (255 - parseInt(hex.slice(0, 2), 16)).toString(16),
            r = (255 - parseInt(hex.slice(2, 4), 16)).toString(16),
            g = (255 - parseInt(hex.slice(4, 6), 16)).toString(16);
        // pad each with zeros and return
        return '#' + padZero(r) + padZero(g) + padZero(b);
    }
    function padZero(str, len) {
        len = len || 2;
        var zeros = new Array(len).join('0');
        return (zeros + str).slice(-len);
    }


    function getRandomLightColor() { // random color that will be visible on  black background
        var letters = '0123456789ABCDEF';
        var color = '#';
        for (var i = 0; i < 6; i++) {
            color += letters[(Math.floor(Math.random() * 12) + 4)];
        }
        return color;
    }
    function getRandomColor() { // random color
        var letters = '0123456789ABCDEF';
        var color = '#';
        for (var i = 0; i < 6; i++) {
            color += letters[(Math.floor(Math.random() * 16) + 0)];
        }
        return color;
    }
    function getRandomDarkColor() {// color that will be visible on a black background
        var letters = '0123456789ABCDEF';
        var color = '#';
        for (var i = 0; i < 6; i++) {
            color += letters[(Math.floor(Math.random() * 12))];
        }
        return color;
    }
    function castBetween(from, to, granularity = 10, radius = 1) { //creates a sort of beam hitbox between two points, with a granularity (number of members over distance), with a radius defined as well
        const limit = granularity
        // //////console.log(limit)
        if (limit < 1) {
            limit = 1
        }
        const shape_array = []
        for (let t = 0; t < limit; t++) {
            const circ = new CircleCB((from.x * (t / limit)) + (to.x * ((limit - t) / limit)), (from.y * (t / limit)) + (to.y * ((limit - t) / limit)), radius, "#FF0000")
            shape_array.push(circ)
            // circ.draw()
        }
        return (new Shape(shape_array))
    }
    function castBetweenRat(from, to, granularity = 10, radius = 1) { //creates a sort of beam hitbox between two points, with a granularity (number of members over distance), with a radius defined as well
        const limit = granularity
        // //////console.log(limit)
        if (limit < 1) {
            limit = 1
        }
        const shape_array = []
        for (let t = 0; t < limit; t++) {
            const circ = new CircleCB((from.x * (t / limit)) + (to.x * ((limit - t) / limit)), (from.y * (t / limit)) + (to.y * ((limit - t) / limit)), radius, "#FF0000")
            circ.torat =t/limit
            circ.fromrat = (limit-t)/limit
            shape_array.push(circ)
            // circ.draw()
        }
        return (new Shape(shape_array))
    }

    // function armCastBetween(from, to, granularity = 10, radius = 1) { //creates a sort of beam hitbox between two points, with a granularity (number of members over distance), with a radius defined as well
    //     const limit = granularity
    //     const shape_array = []
    //     // const xdiv = (from.x-to.x)/(granularity*1)
    //     // const ydiv = (from.y-to.y)/(granularity*1)
    //     for (let t = 0; t < limit; t++) {
    //         const circ = new Circle((from.x * (t / limit)) + (to.x * ((limit - t) / limit)), (from.y * (t / limit)) + (to.y * ((limit - t) / limit)), radius, "#FF0000")
    //         // circ.y-=ydiv
    //         // circ.x-=xdiv
    //         shape_array.push(circ)
    //         // circ.draw()
    //     }
    //     return (new Shape(shape_array))
    // }

    const setup_canvas = document.getElementById('canvas') //getting canvas from document
    const formname = document.getElementById('fname') //getting canvas from document
    const rooms = document.getElementById('rooms') //getting canvas from document
    const tempcanvas = document.getElementById('tempcanvas')
    // tempcanvas.height = 1200
    // tempcanvas.width 1200
    const temp_context = tempcanvas.getContext("2d")
    tempcanvas.style.background = "#000000"
    //////////////////////////////////console.log(tempcanvas)

    rooms.onchange = swapRoom

    setUp(setup_canvas) // setting up canvas refrences, starting timer. 

    function swapRoom() {
        const room = roomSelectionBox.rooms
        const Rson = {
            "room": `${room}`
        }

        if(localPlayToggle != 1){
        ws.send(JSON.stringify(Rson))
        }
    }



    class Gamepad {
        constructor(num) {
            this.locator = 0
            this.gamepad = {
                locator: 0,
                controller: {},
                turbo: true,
                connect: function (evt) {
                    if (navigator.getGamepads()[0] != null) {
                        this.controller = navigator.getGamepads()[0]
                        this.turbo = true;
                    } else if (navigator.getGamepads()[1] != null) {
                        this.controller = navigator.getGamepads()[0]
                        this.turbo = true;
                    } else if (navigator.getGamepads()[2] != null) {
                        this.controller = navigator.getGamepads()[0]
                        this.turbo = true;
                    } else if (navigator.getGamepads()[3] != null) {
                        this.controller = navigator.getGamepads()[0]
                        this.turbo = true;
                    }
                    for (let i = 0; i < gamepads.length; i++) {
                        if (gamepads[i] === null) {
                            continue;
                        }
                        if (!gamepads[i].connected) {
                            continue;
                        }
                    }
                },
                disconnect: function (evt) {
                    this.turbo = false;
                    delete this.controller;
                },
                update: function () {
                    if(localPlayToggle == 0 || minigameSelected == 1 || minigameSelected == 3 || minigameSelected == 5|| minigameSelected == 7){
                        this.controller = navigator.getGamepads()[0]
                    }else{
                        this.controller = navigator.getGamepads()[this.locator]
                    }
                    this.buttonsCache = [];// clear the buttons cache
                    for (var k = 0; k < this.buttonsStatus.length; k++) {// move the buttons status from the previous frame to the cache
                        this.buttonsCache[k] = this.buttonsStatus[k];
                    }
                    this.buttonsStatus = [];// clear the buttons status
                    var c = this.controller || {}; // get the gamepad object
                    var pressed = [];
                    if (c.buttons) {
                        for (var b = 0, t = c.buttons.length; b < t; b++) {// loop through buttons and push the pressed ones to the array
                            if (c.buttons[b].pressed) {
                                if (c.buttons[b].pressed == true) {
                                    boys[0].wasfalse[b] = 0
                                }
                                pressed.push(this.buttons[b]);
                            } else if (c.buttons[b].pressed == false) {
                                boys[0].wasfalse[b] = 1
                            }
                        }
                    }
                    var axes = [];
                    if (c.axes) {
                        for (var a = 0, x = c.axes.length; a < x; a++) {// loop through axes and push their values to the array
                            axes.push(c.axes[a].toFixed(2));
                        }
                    }
                    this.axesStatus = axes;// assign received values
                    this.buttonsStatus = pressed;
                    // //////////////////////////// ////////////////////////////////////////////console.log(pressed); // return buttons for debugging purposes
                    return pressed;
                },
                buttonPressed: function (button, hold) {
                    var newPress = false;
                    for (var i = 0, s = this.buttonsStatus.length; i < s; i++) {// loop through pressed buttons
                        if (this.buttonsStatus[i] == button) {// if we found the button we're looking for..
                            newPress = true;// set the boolean variable to true
                            if (!hold) {// if we want to check the single press
                                for (var j = 0, p = this.buttonsCache.length; j < p; j++) {// loop through the cached states from the previous frame
                                    if (this.buttonsCache[j] == button) { // if the button was already pressed, ignore new press
                                        newPress = false;
                                    }
                                }
                            }
                        }
                    }
                    return newPress;
                },
                buttons: [
                    'A', 'B', 'X', 'Y', 'LB', 'RB', 'Left-Trigger', 'Right-Trigger', 'Back', 'Start', 'Axis-Left', 'Axis-Right', 'DPad-Up', 'DPad-Down', 'DPad-Left', 'DPad-Right', "Power"
                ],
                buttonsCache: [],
                buttonsStatus: [],
                axesStatus: []
            }
        }
    }


    class CrazyDetonator{
        constructor(){
            this.flashing = 1
            this.flashon = 100
            this.flashtick = 0
            this.start = new Shot(500+(Math.random()*1280*5.4), 300+(Math.random()*720*5.9), 50, "#FF00FF", (Math.random()-.5)*stage.dodgespeed, (Math.random()-.5)*stage.dodgespeed, 1.01, 1 )
            this.end = new Shot(500+(Math.random()*1280*5.4), 300+(Math.random()*720*5.9), 50, "#FF00FF",(Math.random()-.5)*stage.dodgespeed, (Math.random()-.5)*stage.dodgespeed, 1.01, 1 )
            this.angle = Math.random()*Math.PI*2
            this.end.x = this.start.x + Math.cos(this.angle)*1000
            this.end.y = this.start.y + Math.sin(this.angle)*1000
            this.end.xmom = this.start.xmom // + Math.cos(this.angle)*1000
            this.end.ymom = this.start.ymom //+ Math.sin(this.angle)*1000
            this.start.reflect = 1
            this.end.reflect = 1
            this.link = new LineOP(this.start, this.end, "#FF00FFAA", 50)
            this.link2 = new LineOP(this.start, this.end, "#FF0000", 90)
            this.body = castBetweenRat(this.start, this.end, 100, 50)

            if(typeof boys[0] !== "undefined"){
                if(this.body.doesPerimeterTouch(boys[0].body)){
                stage.obstacles.splice(stage.obstacles.indexOf(this), 1)
                stage.obstacles.push(new CrazyDetonator())
            }
            }
        }
        draw(){
            if(this.flashing == 0){

                this.start.rmove()
            this.end.rmove()
            for(let t = 0;t<this.body.shapes.length;t++){
                this.body.shapes[t].x += (this.body.shapes[t].fromrat*this.end.xmom)
                this.body.shapes[t].x += (this.body.shapes[t].torat*this.start.xmom)
                this.body.shapes[t].y += (this.body.shapes[t].fromrat*this.end.ymom)
                this.body.shapes[t].y += (this.body.shapes[t].torat*this.start.ymom)
                // this.body.shapes[t].draw()
            }
            // this.body = castBetween(this.start, this.end, this.link.sqrDis()*.004, 50)
            if(this.body.doesPerimeterTouch(boys[0].body)){
                boys[0] = boys[0].copy()
                stage = new Stage(1011)

                const now = new Date()
                campaigntimestart = now.getTime()
            }
            this.start.xmom*=1.008
            this.start.ymom*=1.008
            this.end.xmom*=1.008
            this.end.ymom*=1.008
            this.start.draw()
            this.end.draw()
            this.link2.draw()
            this.link.draw()
            if(this.start.messup == 1){
                stage.obstacles.splice(stage.obstacles.indexOf(this), 1)
                stage.obstacles.push(new CrazyDetonator())
                if(Math.random()<.5){
                stage.obstacles.push(new CrazyDetonator())
                stage.dodgespeed += .1
                }
                return
            }
            if(this.end.messup == 1){
                stage.obstacles.splice(stage.obstacles.indexOf(this), 1)
                if(Math.random()<.5){
                stage.obstacles.push(new CrazyDetonator())
                stage.dodgespeed += .1
                }
                stage.obstacles.push(new CrazyDetonator())
                return
            }
            }else{
                this.flashtick++
                if(this.flashtick%10 >= 4){
                    this.link.draw()
                }else{
                    this.link2.draw()
                }
                if(this.flashtick > 150){
                    this.flashing = 0
                }
            }
        }
    }


    let trapstartZ = 1
    let trapstartY = 1000

    class Trapeeze{
        constructor(){
            let x = 1500
            if(Math.random()<.5){
                x+=1500*(Math.random()-.5)
            }
            this.body = new CircleCB(x, trapstartY, 10, "#FF0000")
            this.body.xlock = this.body.x
            this.body.ylock = this.body.y
            this.anchor = new CircleCB(x, trapstartY, 20+(Math.random()*5), "#00FF00")
            this.spring = new SpringOP(this.body, this.anchor, 400+((Math.random()-.7)*100), 10)
            this.angle = Math.random()*2*Math.PI
            trapstartY -= (750+trapstartZ)
            trapstartZ++
            this.shotspawn = 0
            if(Math.random()<.1 +(trapstartZ/111)){
            this.shotspawn = 1
            this.shotspawner = new ShotC(this.body.x, this.body.y+(Math.random()*200), 100, "#00FF00")
            this.shots = []
            this.shotclock = 0
            this.shottimer = 110-trapstartZ
            if(this.shottimer < 10){
                this.shottimer = 10
            }
            if(Math.random()<.5){
                this.shotspawner.x+=1500
            }else{
                this.shotspawner.x-=1500
            }
            }
        }
        draw(){
            if(this.shotspawn == 1){
                const link = new LineOP(boys[0].body, this.shotspawner)
                if(link.sqrDis() < (4000*4000)){
                    this.shotspawner.draw()
                    for(let t = 0;t<this.shots.length;t++){
                        this.shots[t].life--
                        this.shots[t].move()
                        this.shots[t].draw()
                        if(this.shots[t].doesPerimeterTouch(boys[0].body)){
                            boys[0].body.xmom = this.shots[t].xmom*3
                            boys[0].lefthand.anchored = -50
                            boys[0].righthand.anchored = -50
                        }
                        if(this.shots[t].life <= 0){
                            this.shots.splice(t,1)
                            t--
                        }
                    }
                    this.shotclock++
                    if(this.shotclock == this.shottimer){
                    if(this.shotspawner.x > boys[0].body.x){
                        const shot = new Shot(this.shotspawner.x, this.shotspawner.y, 80, "#FFFFFF", -50)
                        shot.life = 100
                        this.shots.push(shot)
                    }
                    if(this.shotspawner.x < boys[0].body.x){
                        const shot = new Shot(this.shotspawner.x, this.shotspawner.y, 80, "#FFFFFF", 50)
                        shot.life = 100
                        this.shots.push(shot)
                    }
                    this.shotclock = 0
                    }
                }else{

                    for(let t = 0;t<this.shots.length;t++){
                        this.shots[t].move()
                    }
                }

            }
            this.angle +=.05
            this.anchor.x+=(Math.sin(this.angle))*50
            this.spring.balance()
            this.body.x = this.body.xlock
            this.body.y = this.body.ylock
            this.anchor.ymom+=5
            this.anchor.move()
            this.body.draw()
            this.body.xmom = 0
            this.body.ymom = 0
            this.spring.beam.draw()
            this.anchor.draw()
            for(let t =0;t<boys.length;t++){
                if(boys[t].lefthand.anchored != 1 && boys[t].righthand.anchored != 1){
                    boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].lefthand.radius)
                if(boys[t].lefthand.doesPerimeterTouch(this.anchor) || boys[t].lefthands.doesPerimeterTouch(this.anchor)){
                    boys[t].lefthand.anchored = 1
                    boys[t].lefthand.anchor = this.anchor
                    break
                }
                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].righthand.radius)
                if(boys[t].righthand.doesPerimeterTouch(this.anchor) || boys[t].righthands.doesPerimeterTouch(this.anchor)){
                    boys[t].righthand.anchored = 1
                    boys[t].righthand.anchor = this.anchor
                    break
                }
                if(boys[t].body.doesPerimeterTouch(this.anchor)){
                    if(Math.random()<.5){
                        boys[t].righthand.anchored = 1
                    boys[t].righthand.anchor = this.anchor
                    break
                    }else{
                        boys[t].lefthand.anchored = 1
                    boys[t].lefthand.anchor = this.anchor
                    break
                    }
                }
                }
            }
        }
    }


class SpringOPx {
constructor(body, anchor, length, width = 3, color = body.color) {
this.body = body
this.anchor = anchor
this.beam = new LineOP(body, anchor, color, width)
this.length = length
}
balance() {
if (this.beam.hypotenuse() < this.length) {
this.body.xmom += ((this.body.x - this.anchor.x) / this.length) 
this.body.ymom += ((this.body.y - this.anchor.y) / this.length) 
this.anchor.xmom -= ((this.body.x - this.anchor.x) / this.length) 
this.anchor.ymom -= ((this.body.y - this.anchor.y) / this.length) 
} else if (this.beam.hypotenuse() > this.length) {
this.body.xmom -= (this.body.x - this.anchor.x) / (this.length)
this.body.ymom -= (this.body.y - this.anchor.y) / (this.length)
this.anchor.xmom += (this.body.x - this.anchor.x) / (this.length)
this.anchor.ymom += (this.body.y - this.anchor.y) / (this.length)
}

const xmomentumaverage = (this.body.xmom + this.anchor.xmom) / 2
const ymomentumaverage = (this.body.ymom + this.anchor.ymom) / 2
this.body.xmom = (this.body.xmom + xmomentumaverage) / 2
this.body.ymom = (this.body.ymom + ymomentumaverage) / 2
this.anchor.xmom = (this.anchor.xmom + xmomentumaverage) / 2
this.anchor.ymom = (this.anchor.ymom + ymomentumaverage) / 2
}
draw() {
this.beam.draw()
}
move() {
//movement of SpringOP objects should be handled separate from their linkage, to allow for many connections, balance here with this object, move nodes independently
}
}

    class Jumprope{
        constructor(){
            this.start = new Circle(600, 1200, 10, "#00FFFF")
            this.end = new Circle(3200, 1200, 10, "#FF00FF")
            this.beads = castBetween(this.end, this.start, 50, 10)
            this.beads = [...this.beads.shapes]
            this.startangle = 0
            this.endangle = Math.PI
            this.springs = []
            this.lines = []

            const spring = new SpringOPx(this.start, this.beads[0], 1, 8) 
            this.springs.push(spring)
            for(let t =0;t<this.beads.length;t++){
            for(let k =0;k<this.beads.length;k++){
                if(t!=k){
                    const line = new LineOP(this.beads[t], this.beads[k], "#FFFF00", 5 )
                    if(line.hypotenuse() < 100){
                        const spring = new SpringOPx(this.beads[t], this.beads[k], 9, 8)
                        this.springs.push(spring)
                        this.lines.push(line)
                    }
                }
            }
            }
            const spring2 = new SpringOPx(this.beads[this.beads.length-1], this.end, 1, 8)    
            this.springs.push(spring2)
        }
        draw(){
            for(let t  =0;t<this.springs.length;t++){
                this.springs[t].balance()
            }

            for(let t  =0;t<this.beads.length;t++){
                this.beads[t].ymom +=.1
                this.beads[t].move()
            }

            for(let t  =0;t<this.lines.length;t++){
                this.lines[t].draw()
            }
            for(let t  =0;t<this.beads.length;t++){
                this.beads[t].draw()
            }
            this.start.xmom = 0
            this.start.ymom = 0
            this.end.xmom = 0
            this.end.ymom = 0

            this.start.y += (Math.cos(this.startangle))*7
            this.startangle += .051127621563278

            this.end.y += (Math.cos(this.endangle))*7
            this.endangle += .07134522735217

            this.start.draw()
            this.end.draw()
        }
    }


    let targetcount = 0
    class Target {
        constructor(){
            this.body = new ShotJ(500+(1000*(targetcount%4)), 1200+((Math.random()-.5)*400) + (200*(targetcount%3)), 120-targetcount, "#FF0000")

            targetcount++
            this.angle = Math.random()
            this.turn = (Math.random()-.5)*.05
            if(Math.abs(this.turn) < .001){
                this.turn = .002
            }

        }
        draw(){
            this.body.draw()
            this.body.y+=(Math.cos(this.angle))*7
            if(this.body.y > 2000){
                this.body.y = 2000
            }
            if(this.body.y < 200){
                this.body.y = 200
            }
            this.angle += this.turn
           
        }
        clean(){
            for(let t = 0;t<boys[0].shots.length;t++){
                if(this.body.doesPerimeterTouch(boys[0].shots[t])){

                    const now = new Date()
                    campaigntime = now.getTime() - campaigntimestart
                    let seconds = campaigntime
                    seconds = Math.floor(seconds / 1000)  
                    if(seconds < 60){
                    stage.masstargetscore++
                    }
                    if(seconds > 30){
                        if(stage.obstacles.length < 3){
                            stage.obstacles.push(new Target())
                        }
                    }
                    if(seconds > 45){
                        if(stage.obstacles.length < 4){
                            stage.obstacles.push(new Target())
                        }
                    }
                    stage.obstacles.splice(stage.obstacles.indexOf(this),1)
                    stage.obstacles.push(new Target())
                }
            }
        }
    }

    class Scores {
        constructor(){
                this.joulepopscoremax = 0
                this.masstargetscoremax = 0
                this.rhophosortscoremax = 0
                this.coreboywhackscoremax = 0
                this.joxwallscoremax = 0
                this.blastgirlclimbscoremax = 0
                this.funkyclimbscoremax = 0
                this.banandroidtimemax = 0
                this.sototimemax = 0
                this.kesslerscoremax = 0
                this.smashoutmax = 0
                this.gegegegeedropmin = 999999999
                this.campaigncomplete = false
                this.gegegegeedropminstr = "??"
                
        }
        save(){

                        const dson = {}
                       dson.dataScores = 1
                       dson.model = this
                       if(formname.value != "Chat/PlayerName"){
                        dson.model.playername = formname.value
                       }else{
                        dson.model.playername = ''
                       }

                    //    console.log(dson)
                        ws.send(JSON.stringify(dson))
                        // ws.close()
        }
        tally(){
            if(stage.kesslerscore > this.kesslerscoremax){
                this.kesslerscoremax = stage.kesslerscore
            }
            if(stage.joulepopscore > this.joulepopscoremax){
                this.joulepopscoremax = stage.joulepopscore
            }
            if(stage.masstargetscore > this.masstargetscoremax){
                this.masstargetscoremax = stage.masstargetscore
            }
            if(stage.rhophosortscore > this.rhophosortscoremax){
                this.rhophosortscoremax = stage.rhophosortscore
            }
            if(stage.coreboywhackscore > this.coreboywhackscoremax){
                this.coreboywhackscoremax = stage.coreboywhackscore
            }
            if(stage.joxwallscore > this.joxwallscoremax){
                this.joxwallscoremax = stage.joxwallscore
            }
            if(stage.blastgirlclimbscore > this.blastgirlclimbscoremax){
                this.blastgirlclimbscoremax = stage.blastgirlclimbscore
            }
            if(stage.funkyclimbscore > this.funkyclimbscoremax){
                this.funkyclimbscoremax = stage.funkyclimbscore
            }

            

        }
    }

    const worldscore = new Scores()
    class Stage {

        constructor(MapToggle = 0) {
            this.dodgespeed = 9
                this.spawnrunner = 900
                this.pops = []
                this.popslength = 0
                this.mostrecentpopcolor = "#FFFFFF"
                this.joulepopscore = 0
                this.kesslerscore = 0
                this.masstargetscore = 0
                this.rhophosortscore = 0
                this.coreboywhackscore = 0
                this.joxwallscore = 0
                this.blastgirlclimbscore = 0
                this.funkyclimbscore = 0



                this.obstacles = []
                this.lines = []
                this.joxwalltick = 70
                this.joxwallcounter = 0
            // MapToggle-=1
            if (campaignToggle == 1) {
                this.playerrunner = 0
                this.walljumper = 6 * 1400
                this.spawnrunner = 900
                this.bricks = []
                this.trueBricks = []
                this.setArenas = []
                this.tempBricks = []
                this.tempWalls = []
                this.walls = []
                this.triggers = []

                this.block = new Wall(this.walljumper, 1600, 300, 10000)
                for (let k = 0; k < 16; k++) {

                    if (k == 0) {
                        this.tempBricks = []
                        this.tempWalls = []
                        this.bricks.push(new Brick(850 + (k * (6 * 1400)), 1600, 700))
                        this.bricks.push(new Brick(2950 + (k * (6 * 1400)), 1600, 700))
                        this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2160))
                        this.tempBricks.push(new Brick(850 + (k * (6 * 1400)), 1600, 700))
                        this.tempBricks.push(new Brick(2950 + (k * (6 * 1400)), 1600, 700))
                        this.tempBricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2160))
                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]])
                    } else if (k == 1) {
                        this.tempBricks = []
                        this.tempWalls = []
                        this.bricks.push(new Brick(1100 + (k * (6 * 1400)), 1600, 1200))
                        this.bricks.push(new Brick(2700 + (k * (6 * 1400)), 1600, 1200))
                        this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 1900))
                        this.walls.push(new Wall(1100 - 500 + (k * (6 * 1400)), 1800, 200, 200))
                        this.walls.push(new Wall(2700 + 500 + (k * (6 * 1400)), 1800, 200, 200))
                        this.tempBricks.push(new Brick(1100 + (k * (6 * 1400)), 1600, 1200))
                        this.tempBricks.push(new Brick(2700 + (k * (6 * 1400)), 1600, 1200))
                        this.tempBricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 1900))
                        this.tempWalls.push(new Wall(1100 - 500 + (k * (6 * 1400)), 1800, 200, 200))
                        this.tempWalls.push(new Wall(2700 + 500 + (k * (6 * 1400)), 1800, 200, 200))
                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]])
                    } else if (k == 2) {
                        this.tempBricks = []
                        this.tempWalls = []
                        this.bricks.push(new Brick(1100 + (k * (6 * 1400)), 1600, 300))
                        this.bricks.push(new Brick(1800 + (k * (6 * 1400)), 1600, 300))
                        this.bricks.push(new Brick(2500 + (k * (6 * 1400)), 1600, 300))
                        this.bricks.push(new Brick(1000 + (k * (6 * 1400)), 2100, 1000))
                        this.bricks.push(new Brick(2600 + (k * (6 * 1400)), 2100, 1000))
                        this.tempBricks.push(new Brick(1100 + (k * (6 * 1400)), 1600, 300))
                        this.tempBricks.push(new Brick(1800 + (k * (6 * 1400)), 1600, 300))
                        this.tempBricks.push(new Brick(2500 + (k * (6 * 1400)), 1600, 300))
                        this.tempBricks.push(new Brick(1000 + (k * (6 * 1400)), 2100, 1000))
                        this.tempBricks.push(new Brick(2600 + (k * (6 * 1400)), 2100, 1000))
                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]])
                    } else if (k == 3) {
                        this.tempBricks = []
                        this.tempWalls = []
                        this.bricks.push(new Brick(850 + (k * (6 * 1400)), 1600, 700))
                        this.bricks.push(new Brick(2950 + (k * (6 * 1400)), 1600, 700))
                        this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2160))
                        this.walls.push(new Wall(1900 + (k * (6 * 1400)), 1200, 200, 500))
                        this.tempBricks.push(new Brick(850 + (k * (6 * 1400)), 1600, 700))
                        this.tempBricks.push(new Brick(2950 + (k * (6 * 1400)), 1600, 700))
                        this.tempBricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2160))
                        this.tempWalls.push(new Wall(1900 + (k * (6 * 1400)), 1200, 200, 500))
                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]])
                    } else if (k == 4) {
                        this.tempBricks = []
                        this.tempWalls = []
                        this.bricks.push(new Brick(850 + (k * (6 * 1400)), 1600, 700))
                        this.bricks.push(new Brick(2950 + (k * (6 * 1400)), 1600, 700))
                        this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2160))
                        this.tempBricks.push(new Brick(850 + (k * (6 * 1400)), 1600, 700))
                        this.tempBricks.push(new Brick(2950 + (k * (6 * 1400)), 1600, 700))
                        this.tempBricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2160))
                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]])
                    } else if (k == 5) {
                        this.tempBricks = []
                        this.tempWalls = []
                        this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2760))
                        this.tempBricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2760))
                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]])
                    } else if (k == 6) {
                        this.tempBricks = []
                        this.tempWalls = []
                        this.bricks.push(new Brick(850 + (k * (6 * 1400)), 1600, 700))
                        this.bricks.push(new Brick(2950 + (k * (6 * 1400)), 1600, 700))
                        this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2160))
                        this.walls.push(new Wall(1900 + (k * (6 * 1400)), 1200, 200, 700))
                        this.walls.push(new Wall(1100 + (k * (6 * 1400)), 1200, 200, 700))
                        this.walls.push(new Wall(2700 + (k * (6 * 1400)), 1200, 200, 700))
                        this.tempBricks.push(new Brick(850 + (k * (6 * 1400)), 1600, 700))
                        this.tempBricks.push(new Brick(2950 + (k * (6 * 1400)), 1600, 700))
                        this.tempBricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2160))
                        this.tempWalls.push(new Wall(1900 + (k * (6 * 1400)), 1200, 200, 700))
                        this.tempWalls.push(new Wall(1100 + (k * (6 * 1400)), 1200, 200, 700))
                        this.tempWalls.push(new Wall(2700 + (k * (6 * 1400)), 1200, 200, 700))
                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]])
                    } else if (k == 7) {
                        this.tempBricks = []
                        this.tempWalls = []
                        this.bricks.push(new Brick(850 + (k * (6 * 1400)), 1600, 700))
                        this.bricks.push(new Brick(2950 + (k * (6 * 1400)), 1600, 700))
                        this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2160))
                        this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 1450, 700))
                        this.walls.push(new Wall(1900 + (k * (6 * 1400)), 1200, 200, 450))
                        this.tempBricks.push(new Brick(850 + (k * (6 * 1400)), 1600, 700))
                        this.tempBricks.push(new Brick(2950 + (k * (6 * 1400)), 1600, 700))
                        this.tempBricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2160))
                        this.tempBricks.push(new Brick(1900 + (k * (6 * 1400)), 1450, 700))
                        this.tempWalls.push(new Wall(1900 + (k * (6 * 1400)), 1200, 200, 450))
                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]])
                    } else if (k == 8) {
                        this.tempBricks = []
                        this.tempWalls = []
                        for (let n = 0; n < 7; n++) {
                            this.bricks.push(new Brick((n * 350) + 750 + (k * (6 * 1400)), 1600 + ((n % 2) * (400)), 400))
                        }
                        for (let n = 0; n < 7; n++) {
                            this.tempBricks.push(new Brick((n * 350) + 750 + (k * (6 * 1400)), 1600 + ((n % 2) * (400)), 400))
                        }

                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]])
                    } else if (k == 9) {
                        this.tempBricks = []
                        this.tempWalls = []
                        for (let n = 0; n < 7; n++) {
                            this.bricks.push(new Brick((n * 400) + 650 + (k * (6 * 1400)), 2200 + ((Math.abs(-3 + n)) * (-300)), 450))
                        }
                        for (let n = 0; n < 7; n++) {
                            this.tempBricks.push(new Brick((n * 400) + 650 + (k * (6 * 1400)), 2200 + ((Math.abs(-3 + n)) * (-300)), 450))
                        }

                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]])
                    } else if (k == 10) {
                        this.tempBricks = []
                        this.tempWalls = []
                        this.bricks.push(new Brick(850 + (k * (6 * 1400)), 1700, 700))
                        this.bricks.push(new Brick(2950 + (k * (6 * 1400)), 1700, 700))
                        this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 1700, 200))
                        this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2160))
                        this.tempBricks.push(new Brick(850 + (k * (6 * 1400)), 1700, 700))
                        this.tempBricks.push(new Brick(2950 + (k * (6 * 1400)), 1700, 700))
                        this.tempBricks.push(new Brick(1900 + (k * (6 * 1400)), 1700, 200))
                        this.tempBricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2160))
                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]])
                    } else if (k == 11) {
                        this.tempBricks = []
                        this.tempWalls = []
                        for (let n = 0; n < 6; n++) {
                            this.walls.push(new Wall((n * 560) + 500 + (k * (6 * 1400)), 2100, 200, 350))
                        }
                        this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 3000))
                        for (let n = 0; n < 6; n++) {
                            this.tempWalls.push(new Wall((n * 560) + 500 + (k * (6 * 1400)), 2100, 200, 350))
                        }
                        this.tempBricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 3000))
                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]])
                    } else if (k == 12) {
                        this.tempBricks = []
                        this.tempWalls = []
                        for (let n = 0; n < 2; n++) {
                            this.walls.push(new Wall((n * 3000) + 500 + (k * (6 * 1400)), 2100, 200, 350))
                        }
                        this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 3000))
                        for (let n = 0; n < 2; n++) {
                            this.tempWalls.push(new Wall((n * 3000) + 500 + (k * (6 * 1400)), 2100, 200, 350))
                        }
                        this.tempBricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 3000))
                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]])
                    } else if (k == 13) {
                        this.tempBricks = []
                        this.tempWalls = []
                        this.bricks.push(new Brick(2000+ (k * (6 * 1400)), 2100, 1800))
                        this.bricks.push(new Brick(1000+ (k * (6 * 1400)), 1760, 500))
                        this.bricks.push(new Brick(2800+ (k * (6 * 1400)), 1440, 500))
                        this.bricks.push(new Brick(1900+ (k * (6 * 1400)), 1440, 500))
                        this.bricks.push(new Brick(1000+ (k * (6 * 1400)), 920, 500))
                        // this.bricks.push(new Brick(2800+ (k * (6 * 1400)), 500, 500))
                        this.tempBricks.push(new Brick(2000+ (k * (6 * 1400)), 2100, 1800))
                        this.tempBricks.push(new Brick(1000+ (k * (6 * 1400)), 1760, 500))
                        this.tempBricks.push(new Brick(2800+ (k * (6 * 1400)), 1440, 500))
                        this.tempBricks.push(new Brick(1900+ (k * (6 * 1400)), 1440, 500))
                        this.tempBricks.push(new Brick(1000+ (k * (6 * 1400)), 920, 500))
                        // this.tempBricks.push(new Brick(2800+ (k * (6 * 1400)), 500, 500))
                        // for (let n = 0; n < 2; n++) {
                        //     this.walls.push(new Wall((n * 2950) + 500+ (k * (6 * 1400)), 2100, 200, 650))
                        //     this.tempWalls.push(new Wall((n * 2950) + 500+ (k * (6 * 1400)), 2100, 200, 650))
                        // }
                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]]) 
                        // this.tempBricks = []
                        // this.tempWalls = []
                        // this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 3000))
                        // this.tempBricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 3000))
                        // this.tempWalls.push(this.block)
                        // this.setArenas.push([[...this.tempBricks], [...this.tempWalls]])
                    } else if(k == 14){
                       
                        this.tempBricks = []
                        this.tempWalls = []
                        this.bricks.push(new Brick(2000+ (k * (6 * 1400)), 2100, 1800))
                        this.bricks.push(new Brick(1000+ (k * (6 * 1400)), 1760, 500))
                        this.bricks.push(new Brick(2800+ (k * (6 * 1400)), 1440, 500))
                        this.bricks.push(new Brick(1900+ (k * (6 * 1400)), 1440, 500))
                        this.bricks.push(new Brick(1000+ (k * (6 * 1400)), 920, 500))
                        // this.bricks.push(new Brick(2800+ (k * (6 * 1400)), 500, 500))
                        this.tempBricks.push(new Brick(2000+ (k * (6 * 1400)), 2100, 1800))
                        this.tempBricks.push(new Brick(1000+ (k * (6 * 1400)), 1760, 500))
                        this.tempBricks.push(new Brick(2800+ (k * (6 * 1400)), 1440, 500))
                        this.tempBricks.push(new Brick(1900+ (k * (6 * 1400)), 1440, 500))
                        this.tempBricks.push(new Brick(1000+ (k * (6 * 1400)), 920, 500))
                        // this.tempBricks.push(new Brick(2800+ (k * (6 * 1400)), 500, 500))
                        // for (let n = 0; n < 2; n++) {
                        //     this.walls.push(new Wall((n * 2950) + 500+ (k * (6 * 1400)), 2100, 200, 650))
                        //     this.tempWalls.push(new Wall((n * 2950) + 500+ (k * (6 * 1400)), 2100, 200, 650))
                        // }
                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]]) 
                    } else if(k == 15){
                       
                        this.tempBricks = []
                        this.tempWalls = []
                        this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2760))
                        this.tempBricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2760))
                        this.tempWalls.push(this.block)
                        this.setArenas.push([[...this.tempBricks], [...this.tempWalls]]) 
                    }else {
                        this.tempBricks = []
                        this.tempWalls = []
                        this.bricks.push(new Brick(850 + (k * (6 * 1400)), 1600, 700))
                        this.bricks.push(new Brick(2950 + (k * (6 * 1400)), 1600, 700))
                        this.bricks.push(new Brick(1900 + (k * (6 * 1400)), 2100, 2160))
                        this.walls.push(new Wall(1900 + (k * (6 * 1400)), 1200, 200, 500))
                    }
                    this.triggers.push(new Circle(1900 + (k * (6 * 1400)), 1600, 1800, "#FF000044"))

                    for (let t = 3; t < 7; t++) {
                        const brick = new Brick(t * 1335 + (k * (6 * 1400)), 1600, 770)
                        this.bricks.push(brick)
                    }
                    // for(let t = 4;t<8;t++){
                    //     const brick = new Wall(t*1100+(k*(6*1400)), 1600, 200, 470)
                    //     this.walls.push(brick)
                    // }


                }


                this.walls.push(this.block)
                this.trueBricks = [...this.bricks]
                this.trueWalls = [...this.walls]


            } else {
                // this.walls = [new Wall(400, 1200, 200, 3000), new Wall(3000, 1200, 200, 3000)]
                // this.bricks = [new Brick(1900, 2100, 4160), new Brick(1900, 200, 4160)]

                this.walls = []
                this.bricks = []
                if (MapToggle == -1) {
                    this.bricks = [new Brick(850, 1600, 700), new Brick(2950, 1600, 700), new Brick(1900, 2100, 2160)]
                    this.walls = [new Wall(1900, 1200, 200, 500)]
                } else if (MapToggle == 0) {
                    this.bricks.push(new Brick(850, 1600, 700))
                    this.bricks.push(new Brick(2950, 1600, 700))
                    this.bricks.push(new Brick(1900, 2100, 2160))
                } else if (MapToggle == 1) {
                    this.bricks.push(new Brick(1100, 1600, 1200))
                    this.bricks.push(new Brick(2700, 1600, 1200))
                    this.bricks.push(new Brick(1900, 2100, 1900))
                    this.walls.push(new Wall(1100 - 500, 1800, 200, 200))
                    this.walls.push(new Wall(2700 + 500, 1800, 200, 200))
                } else if (MapToggle == 2) {
                    this.bricks.push(new Brick(1100, 1600, 300))
                    this.bricks.push(new Brick(1800, 1600, 300))
                    this.bricks.push(new Brick(2500, 1600, 300))
                    this.bricks.push(new Brick(1000, 2100, 1000))
                    this.bricks.push(new Brick(2600, 2100, 1000))
                } else if (MapToggle == 3) {
                    this.bricks.push(new Brick(850, 1600, 700))
                    this.bricks.push(new Brick(2950, 1600, 700))
                    this.bricks.push(new Brick(1900, 2100, 2160))
                    this.walls.push(new Wall(1900, 1200, 200, 500))
                } else if (MapToggle == 4) {
                    this.bricks.push(new Brick(850, 1600, 350))
                    this.bricks.push(new Brick(2950, 1600, 350))
                    this.bricks.push(new Brick(1900, 2100, 2160))
                } else if (MapToggle == 5) {
                    this.bricks.push(new Brick(1900, 2100, 2760))
                } else if (MapToggle == 6) {
                    this.bricks.push(new Brick(850, 1600, 700))
                    this.bricks.push(new Brick(2950, 1600, 700))
                    this.bricks.push(new Brick(1900, 2100, 2160))
                    this.walls.push(new Wall(1900, 1200, 200, 700))
                    this.walls.push(new Wall(1100, 1200, 200, 700))
                    this.walls.push(new Wall(2700, 1200, 200, 700))
                } else if (MapToggle == 7) {
                    this.bricks.push(new Brick(850, 1600, 700))
                    this.bricks.push(new Brick(2950, 1600, 700))
                    this.bricks.push(new Brick(1900, 2100, 2160))
                    this.bricks.push(new Brick(1900, 1450, 700))
                    this.walls.push(new Wall(1900, 1200, 200, 450))
                } else if (MapToggle == 8) {
                    for (let n = 0; n < 7; n++) {
                        this.bricks.push(new Brick((n * 350) + 750, 1600 + ((n % 2) * (400)), 400))
                    }
                } else if (MapToggle == 9) {
                    for (let n = 0; n < 7; n++) {
                        this.bricks.push(new Brick((n * 400) + 650, 2200 + ((Math.abs(-3 + n)) * (-300)), 450))
                    }
                } else if (MapToggle == 10) {
                    this.bricks.push(new Brick(850, 1700, 700))
                    this.bricks.push(new Brick(2950, 1700, 700))
                    this.bricks.push(new Brick(1900, 1700, 200))
                    this.bricks.push(new Brick(1900, 2100, 2160))
                } else if (MapToggle == 11) {
                    for (let n = 0; n < 6; n++) {
                        this.walls.push(new Wall((n * 560) + 500, 2100, 200, 450))
                    }
                    this.bricks.push(new Brick(1900, 2100, 3000))
                } else if (MapToggle == 12) {
                    for (let n = 0; n < 2; n++) {
                        this.walls.push(new Wall((n * 3000) + 500, 2100, 200, 450))
                    }
                    this.bricks.push(new Brick(1900, 2100, 3000))
                } else if (MapToggle == 13) {
                    this.bricks.push(new Brick(1900, 2100, 3000))
                    this.walls.push(new Wall(1900, 1200, 200, 450))
                } else if (MapToggle == 14) {
                    this.bricks.push(new Brick(1900, 2100, 3000))
                    this.walls.push(new Wall(3400, 1900, 200, 850))
                } else if (MapToggle == 15) {
                    this.bricks.push(new Brick(1900, 2100, 3000))
                    this.walls.push(new Wall(400, 1900, 200, 850))
                } else if (MapToggle == 16) {
                    this.bricks.push(new Brick(1900, 2100, 3000))
                    this.walls.push(new Wall(400, 1900, 200, 850))
                    this.walls.push(new Wall(3400, 1900, 200, 850))
                } else if (MapToggle == 17) {
                    this.bricks.push(new Brick(1900, 2100, 3000))
                    this.bricks.push(new Brick(1900, 1600, 2000))
                    this.walls.push(new Wall(400, 1900, 200, 850))
                    this.walls.push(new Wall(3400, 1900, 200, 850))
                } else if (MapToggle == 18) {
                    this.bricks.push(new Brick(1900, 1000, 3000))
                    this.bricks.push(new Brick(1900, 1600, 2000))
                    this.walls.push(new Wall(400, 1900, 200, 850))
                    this.walls.push(new Wall(3400, 1900, 200, 850))
                } else if (MapToggle == 19) {
                    this.bricks.push(new Brick(1900, 1000, 350))
                    this.bricks.push(new Brick(1900, 1600, 350))
                    this.bricks.push(new Brick(1000, 1600, 350))
                    this.bricks.push(new Brick(1900, 1600, 800))
                    this.bricks.push(new Brick(2800, 1600, 350))
                    this.walls.push(new Wall(400, 1900, 200, 850))
                    this.walls.push(new Wall(3400, 1900, 200, 850))
                } else if (MapToggle == 20) {
                    this.bricks.push(new Brick(1900, 1000, 350))
                    this.bricks.push(new Brick(1900, 1600, 350))
                    this.bricks.push(new Brick(1000, 1600, 350))
                    this.bricks.push(new Brick(1900, 1600, 800))
                    this.bricks.push(new Brick(2800, 1600, 350))
                } else if (MapToggle == 21) {
                    this.bricks.push(new Brick(1900, 2200, 2000))
                    this.bricks.push(new Brick(1900, 1600, 350))
                    this.bricks.push(new Brick(1000, 1600, 350))
                    this.bricks.push(new Brick(1900, 1600, 800))
                    this.bricks.push(new Brick(2800, 1600, 350))
                } else if (MapToggle == 22) {
                    this.bricks.push(new Brick(1900, 2230, 2000))
                    this.bricks.push(new Brick(1900, 1790, 1600))
                    this.bricks.push(new Brick(1900, 1370, 1200))
                    this.bricks.push(new Brick(1900, 950, 800))
                    this.bricks.push(new Brick(1900, 530, 400))


                    this.walls.push(new Wall(1900, 1400, 200, 1700))
                } else if (MapToggle == 23) {
                    this.bricks.push(new Brick(1900, 2200, 2500))
                    this.bricks.push(new Brick(1000, 1760, 500))
                    this.bricks.push(new Brick(2800, 1340, 500))
                    this.bricks.push(new Brick(1000, 920, 500))
                    this.bricks.push(new Brick(2800, 500, 500))
                } else if (MapToggle == 24) {
                    this.bricks.push(new Brick(1900, 2200, 2500))
                    this.bricks.push(new Brick(1000, 1760, 500))
                    this.bricks.push(new Brick(2800, 1440, 500))
                    this.bricks.push(new Brick(1900, 1230, 500))
                    this.bricks.push(new Brick(1000, 920, 500))
                    this.bricks.push(new Brick(2800, 500, 500))
                } else if (MapToggle == 25) {
                    this.bricks.push(new Brick(850, 1600, 700))
                    this.bricks.push(new Brick(2950, 1600, 700))
                    this.bricks.push(new Brick(1900, 2100, 2160))
                    this.walls.push(new Wall(1900, 700, 200, 1500))
                } else if (MapToggle == 26) {
                    this.bricks.push(new Brick(850, 1600, 700))
                    this.bricks.push(new Brick(1900, 2200, 2500))
                    this.bricks.push(new Brick(2950, 1600, 700))
                    this.walls.push(new Wall(1900, 2100, 400, 700))
                    this.walls.push(new Wall(1900, 700, 200, 1000))
                } else if (MapToggle == 27) {
                    this.bricks.push(new Brick(850, 1600, 900))
                    this.bricks.push(new Brick(1900, 2200, 2500))
                    this.bricks.push(new Brick(2950, 1600, 300))
                } else if (MapToggle == 28) {
                    this.bricks.push(new Brick(850, 1600, 300))
                    this.bricks.push(new Brick(1900, 2200, 2500))
                    this.bricks.push(new Brick(2950, 1600, 900))
                } else if (MapToggle == 29) {
                    this.bricks.push(new Brick(2000, 2200, 1800))
                    this.bricks.push(new Brick(1000, 1760, 500))
                    this.bricks.push(new Brick(2800, 1440, 500))
                    this.bricks.push(new Brick(1900, 1230, 500))
                    this.bricks.push(new Brick(1000, 920, 500))
                    this.bricks.push(new Brick(2800, 500, 500))
                    for (let n = 0; n < 2; n++) {
                        this.walls.push(new Wall((n * 3000) + 500, 2100, 200, 650))
                    }
                } else if (MapToggle == 30) {
                    this.bricks.push(new Brick(1875, 2200, 1800))
                    this.bricks.push(new Brick(1000, 1760, 500))
                    this.bricks.push(new Brick(2800, 1440, 500))
                    this.bricks.push(new Brick(1900, 1230, 500))
                    this.bricks.push(new Brick(1000, 920, 500))
                    this.bricks.push(new Brick(2800, 500, 500))
                    for (let n = 0; n < 2; n++) {
                        this.walls.push(new Wall((n * 3000) + 350, 2100, 200, 2050))
                    }
                } else if (MapToggle == 31) {
                    this.bricks.push(new Brick(1875, 2200, 1800))
                    this.bricks.push(new Brick(1875, 1700, 1400))
                    this.bricks.push(new Brick(1875, 1200, 1000))
                } else if (MapToggle == 32) {
                    this.bricks.push(new Brick(1075, 2200, 1800))
                    this.bricks.push(new Brick(1875, 1700, 1400))
                    this.bricks.push(new Brick(2675, 1200, 1200))
                } else if (MapToggle == 33) {
                    this.bricks.push(new Brick(2675, 2200, 1800))
                    this.bricks.push(new Brick(1875, 1700, 1400))
                    this.bricks.push(new Brick(1075, 1200, 1200))
                } else if (MapToggle == 34) {
                    this.bricks.push(new Brick(2675, 2200, 1000))
                    this.bricks.push(new Brick(1075, 2200, 1000))
                }else if (MapToggle == 1000) {
                    for (let n = 0; n < 7; n++) {
                        this.bricks.push(new Brick((n * 400) + 650, 2200 + ((Math.abs(-3 + n)) * (-300)), 450))
                    }
                    this.obstacles = []
                    for(let t = 0;t<98;t++){
                        const circ = new CircleCB(Math.random()*(2560*invscale*.5), 2300+t*500, 70, "#FF0000")
                        this.obstacles.push(circ)
                        const circ2 = new CircleCB(Math.random()*(2560*invscale*.5), 2450+t*500, 70, "#FF0000")
                        this.obstacles.push(circ2)
                    }
                    this.bricks.push(new Brick(1900, 50000, 10000))
                }else if (MapToggle == 1001) {
                    const ragdoll = new Dummy(0)
                    ragdoll.body.x = 600
                    ragdoll.body.y = 1000
                    for(let t = -10;t<1000;t++){
                        const line = new Line(t*500, -100000, t*500, 100000, getRandomColor(), 4)
                        this.lines.push(line)
                    }
                    boys.push(ragdoll)
                    this.bricks.push(new Brick(750, 1900, 1500))
                    this.bricks.push(new Brick(750, 750, 1500))
                    this.walls.push(new Wall(150, 1500, 200, 1200))
                    this.walls.push(new Wall(1350, 1500, 200, 1200))
                    // this.bricks.push(new Brick(1900, 2450, 10000))
                } else if (MapToggle == 1002) {
                    this.bricks.push(new Brick(1900, 250, 3800))
                    this.bricks.push(new Brick(1900, 2000, 3800))
                    this.obstacles = []
                    for(let t = 0;t<9;t++){
                        const circ = new CircleCB(0, 300+t*200, 100, "#FF0000")
                        this.obstacles.push(circ)
                    }
                }else if (MapToggle == 1003) {
                    const floor1 = new Brick(2750, 2000, 1900)
                    const floor2 = new Brick(1050, 2000, 1900)
                    floor1.edgeleft.x -= 100000
                    floor2.edgeright.x += 100000
                    floor2.edgeleft.x -= 10000
                    floor1.edgeright.x += 100000
                    floor1.edgeleft.radius = .1
                    floor2.edgeright.radius = .1
                    floor2.edgeleft.radius = .1
                    floor1.edgeright.radius = .1
                    this.bricks.push(floor1)
                    this.bricks.push(new Brick(1050, 100, 1900))
                    this.bricks.push(floor2)
                    this.bricks.push(new Brick(2750, 100, 1900))

                    // this.walls.push(new Wall(70, 1100, 200, 1700))
                    // this.walls.push(new Wall(3700, 1100, 200, 1700))

                    for(let t = 0;t<19;t++){
                    const ragdoll = new Dummy(0)
                    ragdoll.body.x = 1200+(t*70)
                    ragdoll.body.y = 1000+((t%2)*200)
                    ragdoll.body.radius*= 2
                    ragdoll.body.color = getRandomColor()
                    ragdoll.body.gravity = 1.5
                    boys.push(ragdoll)
                    }

                }else if(MapToggle == 1004){
                    const floor1 = new Brick(2750, 2100, 1900)
                    const floor2 = new Brick(1050, 2100, 1900)
                    floor1.edgeleft.x -= 100000
                    floor2.edgeright.x += 100000
                    floor2.edgeleft.x -= 10000
                    floor1.edgeright.x += 100000
                    floor1.edgeleft.radius = .1
                    floor2.edgeright.radius = .1
                    floor2.edgeleft.radius = .1
                    floor1.edgeright.radius = .1
                    this.bricks.push(floor1)
                    this.bricks.push(floor2)
                    for(let t = 0;t<2;t++){
                        const target= new Target()
                        this.obstacles.push(target)
                    }
                }else if(MapToggle == 1005){


                    for(let t = 0;t<9;t++){
                    const ragdoll = new Dummy(0)
                    ragdoll.body.x = 1900
                    ragdoll.body.y = 300+t+100
                    // ragdoll.body.radius*= .5    
                    ragdoll.life = 600
                     if(Math.random()<.5){
                                    ragdoll.body.color = "#FF0000"
                                }else{
                                    ragdoll.body.color =   "#0000FF"
                                }
                    ragdoll.body.gravity = 1.5
                    boys.unshift(ragdoll)
                    }


                    this.redbox = new Rectangle(300, 1175, 1400, 1400, "#FF000065")
                    this.bluebox = new Rectangle(2100, 1175, 1400, 1400, "#0000FF65")
                    this.walls.push(new Wall(1900, 1900, 400, 900))
                    this.walls.push(new Wall(300, 1400, 400, 1600))
                    this.walls.push(new Wall(3500, 1400, 400, 1600))

                    const floor1 = new Brick(2750, 2100, 1900)
                    const floor2 = new Brick(1050, 2100, 1900)
                    floor1.edgeleft.x -= 100000
                    floor2.edgeright.x += 100000
                    floor2.edgeleft.x -= 10000
                    floor1.edgeright.x += 100000
                    floor1.edgeleft.radius = .1
                    floor2.edgeright.radius = .1
                    floor2.edgeleft.radius = .1
                    floor1.edgeright.radius = .1
                    this.bricks.push(floor1)
                    this.bricks.push(floor2)
                    this.bricks.push(new Brick(1900, 1250, 800))
                    this.bricks.push(new Brick(1900, 1700, 1000))
                }else if(MapToggle == 1006){
                    const floor1 = new Brick(2750, 2100, 1900)
                    const floor2 = new Brick(1050, 2100, 1900)
                    floor1.edgeleft.x -= 100000
                    floor2.edgeright.x += 100000
                    floor2.edgeleft.x -= 10000
                    floor1.edgeright.x += 100000
                    floor1.edgeleft.radius = .1
                    floor2.edgeright.radius = .1
                    floor2.edgeleft.radius = .1
                    floor1.edgeright.radius = .1
                    this.bricks.push(floor1)
                    this.bricks.push(floor2)
                    this.obstacles = []
                        trapstartZ = 1

                        trapstartY = 1000
                    for(let t = 0;t<80;t++){

                        const trap = new Trapeeze()
                        this.obstacles.push(trap)
                    }
                }else if(MapToggle == 1007){
                    const floor1 = new Brick(2750, 2100, 1900)
                    const floor2 = new Brick(1050, 2100, 1900)
                    floor1.edgeleft.x -= 100000
                    floor2.edgeright.x += 100000
                    floor2.edgeleft.x -= 10000
                    floor1.edgeright.x += 100000
                    floor1.edgeleft.radius = .1
                    floor2.edgeright.radius = .1
                    floor2.edgeleft.radius = .1
                    floor1.edgeright.radius = .1
                    this.bricks.push(floor1)
                    this.bricks.push(floor2)
                     const floor1a = new Brick(2750, 1600, 1900)
                    const floor2a = new Brick(1050, 1600, 1900)
                    floor1a.edgeleft.x -= 100000
                    floor2a.edgeright.x += 100000
                    floor2a.edgeleft.x -= 10000
                    floor1a.edgeright.x += 100000
                    floor1a.edgeleft.radius = .1
                    floor2a.edgeright.radius = .1
                    floor2a.edgeleft.radius = .1
                    floor1a.edgeright.radius = .1
                    this.bricks.push(floor1a)
                    this.bricks.push(floor2a)
                    this.obstacles = []


                    for(let t = 0;t<3;t++){
                    const ragdoll = new Dummy(0)
                    ragdoll.body.x = 1900
                    ragdoll.body.y = 2700
                    ragdoll.life = 350
                    ragdoll.body.gravity = 1.5
                    boys.unshift(ragdoll)
                    }

                }else if(MapToggle == 1008){

                const  floor1 = new Brick(2750, 1900, 1900)
                const floor2 = new Brick(1050, 1900, 1900)
                floor1.edgeleft.x -= 100000
                floor2.edgeright.x += 100000
                floor2.edgeleft.x -= 10000
                floor1.edgeright.x += 100000
                floor1.edgeleft.radius = .1
                floor2.edgeright.radius = .1
                floor2.edgeleft.radius = .1
                floor1.edgeright.radius = .1
                this.bricks.push(floor1)
                this.bricks.push(floor2)

                const floor1a = new Brick(2750, 400, 1900)
                const floor2a = new Brick(1050, 400, 1900)
                floor1a.edgeleft.x -= 100000
                floor2a.edgeright.x += 100000
                floor2a.edgeleft.x -= 10000
                floor1a.edgeright.x += 100000
                floor1a.edgeleft.radius = .1
                floor2a.edgeright.radius = .1
                floor2a.edgeleft.radius = .1
                floor1a.edgeright.radius = .1
                this.bricks.push(floor1a)
                this.bricks.push(floor2a)
                this.walls.push(new Wall(1900, 1200, 120, 1700))
                this.walls.push(new Wall(50, 1200, 120, 1700))
                this.walls.push(new Wall(3650, 1200, 120, 1700))



                this.redbox = new Rectangle(0, 0, 600, 3000, "#FF000065")
                this.bluebox = new Rectangle(3100, 0, 600, 3000, "#0000FF65")


                }else if(MapToggle == 1009){
                    for(let t = 0;t<9;t++){
                        const brick = new Brick((Math.random()*4500)+299, t*370, 800, 50)
                        this.bricks.push(brick)
                    }
                }else if(MapToggle == 1010){
                        const brick = new Brick(1900, 1400, 800, 50)
                        this.bricks.push(brick)
                        this.rope = new Jumprope()
                }else if(MapToggle == 1011){
                    for(let t = 0;t<120;t++){
                        const brick = new Brick(300+(t%8)*1000, (Math.floor(t/15)*500)+900, 400, 50)
                        this.bricks.push(brick)
                    }
                    const crazyDetonator = new CrazyDetonator()
                    this.obstacles.push(crazyDetonator)
                     const crazyDetonator2 = new CrazyDetonator()
                    this.obstacles.push(crazyDetonator2)
                } else if(MapToggle == 1012){

                } else {
                    this.bricks.push(new Brick(850, 1600, 700))
                    this.bricks.push(new Brick(2950, 1600, 700))
                    this.bricks.push(new Brick(1900, 2100, 2160))
                    this.walls.push(new Wall(1900, 1200, 200, 500))
                }
                // this.walls = []
                // this.bricks = []
                // for(let t =0;t<100;t++){
                //     this.walls.push(new Wall(Math.random()*3000, 1500, 200, 200))
                // }
            }
            //standard
            // this.bricks = [new Brick(1490 * (invscale * .4), 1760 * (invscale * .4), 1410 * (invscale * .4)), new Brick(2450 * (invscale * .4), 1470 * (invscale * .4), 1000 * (invscale * .4)), new Brick(1480 * (invscale * .4), 1200 * (invscale * .4), 400 * (invscale * .4)), new Brick(550 * (invscale * .4), 1470 * (invscale * .4), 750 * (invscale * .4))]

            //split floor
            // this.bricks = [new Brick(850, 1500, 700), new Brick(2950, 1500, 700),new Brick(1050, 2100, 900), new Brick(2750, 2100, 900) ]

            //wide floor

            // this.walls = []
            // this.bricks = [new Brick(1490 * (invscale * .4), 1760 * (invscale * .4), 400 * (invscale * .4))]

            // this.bricks = [new Brick(1440, 1760, 200), new Brick(1040, 1760, 200), new Brick(640, 1760, 200), new Brick(240, 1760, 200)]
            // for(let t = 0;t<5;t++){
            //     this.bricks.push(new Brick(Math.random()*invscale*canvas.width, Math.random()*invscale*canvas.height, 300))
            // // }
            // this.bricks = []
            // for (let t = 0; t < 3; t++) {
            //     this.bricks.push(new Brick(500+(t * 1300) + 200, 1760, 400))
            // }
            this.brickswap = 0
        }
        draw() {


            if(minigameSelected == 12){ 
                if(typeof this.starcheck == "undefined"){
                    this.starcheck = 0
                }
                this.starcheck++
                for(let t = 0;t<stars.length;t++){
                    if(stars[t].on == 1){
                        stars[t].height = 15
                        stars[t].width = 15
                        stars[t].draw()
                    }else{
                        stars[t].height-=.2
                        stars[t].width-=.2
                        if(stars[t].height < 0){
                        stars[t].height = 0
                        }else if(stars[t].width < 0){
                        stars[t].width = 0
                        }else{
                            stars[t].draw()
                        }
                    }
                }
                if(this.starcheck%10 == 0){

                for(let t = 0;t<stars.length;t++){
                    const link = new LineOP(boys[0].body, stars[t])
                    if(link.sqrDis() < 6000000){
                        stars[t].on = 1
                    }else{
                        stars[t].on = 0
                    }
                }
                }
            }


            if(minigameSelected == 11){
                for(let t  = 0;t<this.obstacles.length;t++){
                    this.obstacles[t].draw()
                }

                const now = new Date()
                    campaigntime = now.getTime() - campaigntimestart
                    let seconds = campaigntime
                    seconds = Math.floor(seconds / 1000) 


                    if(seconds > worldscore.sototimemax){
                        worldscore.sototimemax = seconds
                }
                canvas_context.font =  "140px Arial"
                canvas_context.fillStyle = "#FFFFFF"
                    canvas_context.fillText(`Dodged for ${seconds} Seconds`, 20, 300)
            
            }

            
            if(minigameSelected == 9){


                const now = new Date()
                    campaigntime = now.getTime() - campaigntimestart
                    let seconds = campaigntime
                    seconds = Math.floor(seconds / 1000)  
                    canvas_context.font = "60px Arial"
                    canvas_context.fillStyle = "#FFFFFF"
                    canvas_context.fillText(`Climbed: ${this.blastgirlclimbscore}`, 50, 170)
                    canvas_context.fillText(`Survived ${seconds} Seconds`, 50, 270)

                for(let t = 0;t<this.bricks.length;t++){
                    this.bricks[t].shape.shiftDown(8)
                    this.bricks[t].edgeleft.y +=8
                    this.bricks[t].center.y +=8
                    this.bricks[t].edgeright.y +=8
                    this.bricks[t].link.y1 +=8
                    this.bricks[t].link.y2 +=8
                    if(this.bricks[t].edgeleft.y > 3600){
                        this.blastgirlclimbscore++

                        this.bricks.splice(t,1)
                        t--
                        this.bricks.push(new Brick(500 + (Math.random()*4500), 0, 800, 50))
                    }
                }
            }

            if(minigameSelected == 8){
                this.redbox.draw()
                this.bluebox.draw()

                if(this.bluebox.isPointInside(boys[2].body)){
                    drops[0]++
                    scores[1]++
                    boys[2] = boys[2].copy()

                    boys[2].body.x = 1900 + 800

                }
                if(this.redbox.isPointInside(boys[2].body)){

                    drops[1]++
                    scores[0]++
                    boys[2] = boys[2].copy()

                    boys[2].body.x = 1900 - 800
                }
                for(let t = 0;t<boys[0].nodes.length;t++){
                    if(boys[0].nodes[t].x > 1900){
                    boys[0].nodes[t].x = 1900
                }
                }
                for(let t = 0;t<boys[1].nodes.length;t++){
                if(boys[1].nodes[t].x < 1900){
                    boys[1].nodes[t].x = 1900
                }
            }
            }
            if(minigameSelected == 5){
                this.redbox.draw()
                this.bluebox.draw()
                for(let t = 0;t<boys.length;t++){
                    if(boys[t].name != "Rhopho"){
                        boys[t].damage = 0
                        if(Math.random()<.1){
                            if(boys[t].body.color == "#FF0000"){
                            if(this.redbox.isPointInside(boys[t].body)){
                                boys[t].body.y = 300
                                boys[t].body.x = 1900
                                boys[t].body.ymom = 0
                                boys[t].body.xmom = 0
                                boys[t].life = 600
                    const now = new Date()
                    campaigntime = now.getTime() - campaigntimestart
                    let seconds = campaigntime
                    seconds = Math.floor(seconds / 1000)  
                    if(seconds < 60){
                                this.rhophosortscore++
                    }
                                if(Math.random()<.5){
                                    boys[t].body.color = "#FF0000"
                                }else{
                                    boys[t].body.color ="#0000FF"
                                }

                            }
                            }else{
                            if(this.bluebox.isPointInside(boys[t].body)){
                                boys[t].body.y = 300
                                boys[t].body.x = 1900
                                boys[t].body.ymom = 0
                                boys[t].body.xmom = 0
                                boys[t].life = 600

                    const now = new Date()
                    campaigntime = now.getTime() - campaigntimestart
                    let seconds = campaigntime
                    seconds = Math.floor(seconds / 1000)  
                    if(seconds < 60){
                                this.rhophosortscore++
                    }
                                if(Math.random()<.5){
                                    boys[t].body.color = "#FF0000"
                                }else{
                                    boys[t].body.color ="#0000FF"
                                }

                            }

                            }
                        }else{
                            boys[t].life--
                            if(boys[t].life <= 0){
                                boys[t].life = 600
                                boys[t].body.y = 300
                                boys[t].body.x = 1900
                                boys[t].body.ymom = 0
                                boys[t].body.xmom = 0
                                if(Math.random()<.5){
                                    boys[t].body.color = "#FF0000"
                                }else{
                                    boys[t].body.color ="#0000FF"
                                }
                            }
                        }
                    }
                }
            }
            if(minigameSelected == 7){

                for(let t = 0;t<boys.length;t++){
                              boys[t].life--
                            if(boys[t].life <= 0){
                                boys[t].life = 350
                                boys[t].body.y = 2700
                                boys[t].body.x = (Math.random()*3000) + 500
                                boys[t].body.ymom = 0
                                boys[t].body.xmom = 0
                            }
                }

            }
            if (campaignToggle == 1) {

                for (let t = 0; t < this.bricks.length; t++) {
                    if (Math.abs(boys[0].body.x - this.bricks[t].center.x) < 3400) {
                        this.bricks[t].draw()
                    }
                }
                for (let t = 0; t < this.walls.length; t++) {
                    if (Math.abs(boys[0].body.x - this.walls[t].center.x) < 3400) {
                        this.walls[t].draw()
                    }
                }
                // for (let t = 0; t < this.triggers.length; t++) {
                //     this.triggers[t].draw()
                // }
                for (let t = 0; t < this.triggers.length; t++) {
                    this.triggers[t].draw()
                    if (this.triggers[t].isPointInside(boys[0].body)) {
                        runCampaign(this.playerrunner)

                        if(this.setArenas.length > this.playerrunner){
                            this.bricks = [...this.setArenas[this.playerrunner][0]]
                            this.walls = [...this.setArenas[this.playerrunner][1]]
                        }
                        // this.walljumper += 6*1400
                        // this.walls[this.walls.length-1] = new Wall(this.walljumper, 1600, 300, 10000)

                        this.playerrunner++
                        if(this.playerrunner > 15){
                            worldscore.campaigncomplete = true
                        }
                        for (let f = 0; f < boys[1].nodes.length; f++) {
                            boys[1].nodes[f].x = boys[0].body.x + 2000
                            boys[1].nodes[f].y = boys[0].body.y
                        }
                        this.triggers.splice(t, 1)
                        humanPlayers = 0
                    }
                }
                if (boys.length == 1) {
                    this.bricks = this.trueBricks
                    this.walls = this.trueWalls
                }
            } else {

                for (let t = 0; t < this.lines.length; t++) {
                    this.lines[t].draw()
                }
                if(minigameSelected == 0 || minigameSelected == 2 ||minigameSelected == 4 ||minigameSelected == 6){
                    for (let t = 0; t < this.obstacles.length; t++) {
                    this.obstacles[t].draw()
                }
                if(minigameSelected == 4){
                    for (let t = 0; t < this.obstacles.length; t++) {
                    this.obstacles[t].clean()
                }
                }
                if(minigameSelected == 2){

                    canvas_context.font = "40px Arial"
                    canvas_context.fillStyle = "#00FFFF"
                    canvas_context.fillText(`Avoided: ${this.joxwallscore}`, 1000, 100)

                    this.joxwallcounter++
                    if(this.joxwallcounter%this.joxwalltick == 1){
                        if(Math.random()<.5){
                        const wall = new Wall(3900, (Math.random() * 1250)+600, 200, 900)
                        this.walls.push(wall)
                        }else{
                        const wall = new Wall(3900, (Math.random() * 500)+ 600, 200, 500)
                        this.walls.push(wall)
                         const wall2 = new Wall(3900, (Math.random() * 500) + 1000, 200, 500)
                        this.walls.push(wall2)
                        }
                    }
                    for(let t = 0;t<this.walls.length;t++){
                        if(this.walls[t].topcap.x < 0){
                            this.walls.splice(t,1)
                            this.joxwallscore++
                            if(this.joxwallscore%2 == 0){
                                if( this.joxwalltick < 23){
                                    this.joxwalltick = 23
                                }
                                this.joxwalltick-=1
                                this.joxwallcounter = 1
                            }
                        }
                    }
                    for(let t = 0;t<this.walls.length;t++){
                        this.walls[t].shape.shiftRight(-12)
                    }
                }
                }else  if(minigameSelected == 1){


                    if(boys[0].name == "Dummy"){
                    const tmp = boys[0]
                    boys[0] = boys[1]
                    boys[1] = tmp
                    }

                    const now = new Date()
                    campaigntime = now.getTime() - campaigntimestart
                    let seconds = campaigntime
                    seconds = Math.floor(seconds / 1000) 
                    if(seconds > 15){

                    if(boys[0].name != "Dummy"){
                    const tmp = boys[0]
                    boys[0] = boys[1]
                    boys[1] = tmp
                    }
                        boys[0].jumping = 0
                        boys[0].grounded = 0
                        boys[0].body.friction = .999
                        canvas_context.font = "40px Arial"
                        canvas_context.fillStyle = "#FFFF00"
                        canvas_context.fillText(`Distance Launched: ${Math.abs(boys[0].body.x-boys[1].body.x)}`, (boys[0].body.x - (canvas.width * invscale * .5) + 20), (boys[0].body.y - (canvas.height * invscale * .5) + (((boys.length) * 61) + 270)))

                    if(worldscore.smashoutmax < Math.abs(boys[0].body.x-boys[1].body.x)){
                        worldscore.smashoutmax = Math.abs(boys[0].body.x-boys[1].body.x)
                    }

                if(this.brickswap == 0){
                for (let t = 0; t < this.walls.length; t++) {
                        this.walls[t].shape.shiftRight(-1000000)
                }
            }

                if(this.brickswap == 0){
                        this.bricks = []
                        this.bricks.push(new Brick(750, 1900, 1500))
                        this.brickswap = 1
                    }
                    }
                }else if(minigameSelected == 3){
                    for(let t = 0;t<this.pops.length;t++){
                        this.pops[t].xmove()
                        this.pops[t].draw()
                        this.pops[t].life--
                    }
                    for(let t = 0;t<this.pops.length;t++){
                        if(this.pops[t].life<=0){
                            this.pops.splice(t,8)
                        }
                    }

                    this.popslength = this.pops.length
                    canvas_context.font = "70px Arial"
                    canvas_context.fillStyle = this.mostrecentpopcolor
                    canvas_context.fillText(`Popped: ${this.joulepopscore}`, 200, 300)
                }
                for (let t = 0; t < this.bricks.length; t++) {
                    this.bricks[t].draw()
                }
                for (let t = 0; t < this.walls.length; t++) {
                    this.walls[t].draw()
                }
            }
            if(minigameSelected == 4){
                    canvas_context.font = "70px Arial"
                    canvas_context.fillStyle = "#00FFFF"
                    canvas_context.fillText(`Shot: ${this.masstargetscore}`, 200, 300)
                }
            if(minigameSelected == 5){
                    canvas_context.font = "70px Arial"
                    canvas_context.fillStyle = "#FF00FF"
                    canvas_context.fillText(`Sorted: ${this.rhophosortscore}`, 200, 200)
                }
            if(minigameSelected == 7){
                    canvas_context.font = "70px Arial"
                    canvas_context.fillStyle = "#FF00FF"
                    canvas_context.fillText(`Whacked: ${this.coreboywhackscore}`, 200, 200)


                    const now = new Date()
                    campaigntime = now.getTime() - campaigntimestart
                    let seconds = campaigntime
                    seconds = Math.floor(seconds / 1000) 

                }
            if(minigameSelected == 6){
                    canvas_context.font = "70px Arial"
                    canvas_context.fillStyle = "#00FF00"
                    if((boys[0].body.y-2200)*-1 > this.funkyclimbscore){
                        this.funkyclimbscore = (boys[0].body.y-2200)*-1
                    }
                    canvas_context.fillText(`Height Reached: ${Math.round(this.funkyclimbscore)}`, boys[0].body.x-1920, boys[0].body.y-950)
                }

            if(minigameSelected == 10){
                
                this.rope.draw()
                for(let t = 0;t<this.rope.beads.length;t++){
                    if(this.rope.beads[t].doesPerimeterTouch(boys[0].body)){
                        boys[0] = boys[0].copy()
                                boys[0].body.x = 1900
                                boys[0].lefthand.x = 1900
                                boys[0].righthand.x = 1900
                                boys[0].middlehand.x = 1900
                                boys[0].bananahand.x = 1900
                        const now = new Date()
                        campaigntimestart = now.getTime()
                    }
                }


                const now = new Date()
                    campaigntime = now.getTime() - campaigntimestart
                    let seconds = campaigntime
                    seconds = Math.floor(seconds / 1000) 


                    if(seconds > worldscore.banandroidtimemax){
                        worldscore.banandroidtimemax = seconds
                }
                    canvas_context.fillText(`Jumped for ${seconds} Seconds`, 20, 300)
            }

        }
    }

    class Wall {
        constructor(x, y, width = 200, height = 600) {
            if(minigameSelected == 2){
                width = 150
            }
            // width = 200
            // height = 1600
            this.center = new Circle(x, y,0,"")
            this.width = width
            this.height = height
            this.topcap = new Circle(this.center.x, this.center.y - (this.height * .5), this.width * .5, "#FFFFFF")
            this.basecap = new Circle(this.center.x, this.center.y + (this.height * .5), this.width * .5, "#FFFFFF")

            if(minigameSelected == 2){
            this.shape = castBetween(this.topcap, this.basecap, (this.height / (this.width * .5)) * 1.2, width * .5)
            }else{
            this.shape = castBetween(this.topcap, this.basecap, (this.height / (this.width * .5)) *1.2, width * .5)
            }
            // if(minigameSelected == 2){
            // this.shape2 = castBetween(this.topcap, this.basecap, (this.height / (this.width*.5)) * 1.41, width*.5)
            // this.shape2.shapes.push(this.topcap)
            // this.shape2.shapes.push(this.basecap)
            // }
            this.shape.shapes.push(this.topcap)
            this.shape.shapes.push(this.basecap)
            this.shape.shapes.push(this.center)
            this.link = new LineOP(this.topcap, this.basecap, "#FFFFFF", this.width)
            if(minigameSelected == 8){
                this.link.color = "#FFFFFF88"
            }

        }
        stick(point) {
            let j = 0
            while (this.shape.doesPerimeterTouch(point)) {
                j++
                if (j > 100) {
                    break
                }
                point.stuck = 1
                point.y--
            }
        }
        doesPerimeterTouch(circle, player) {
            if(minigameSelected == 8){
                if(player.name == "Dummy"){
                    return
                }
            }
            if (circle == player.body) {
                for (let t = 0; t < player.shots.length; t++) {
                    if (this.shape.doesPerimeterTouch(player.shots[t])) {
                        if (player.shots[t].bomb != 1) {
                            player.shots[t].marked = 1
                        }
                    }
                }
            }
            if (circle == player.rightshoulder) {
                return
            }
            if (circle == player.leftshoulder) {
                return
            }
            if (circle == player.rightshoulder2) {
                return
            }
            if (circle == player.leftshoulder2) {
                return
            }
            if (circle == player.rightshoulder2) {
                return
            }
            if (circle == player.bananashoulder2) {
                return
            }
            if (circle == player.middlehsoulder2) {
                return
            }
            if (circle == player.leftshoulder3) {
                return
            }
            if (circle == player.middleshoulder) {
                return
            }
            if (circle == player.radball) {
                return
            }
            const floorchecklink = new LineOP(circle, this.center)
            if (floorchecklink.sqrDis() > (this.height * 1.21) * (this.height * 1.21)) {
                return
            }
   ////gwompei problem

            if (this.shape.doesPerimeterTouch(circle)) {
                if (circle == player.righthand || circle == player.righthand2 || circle == player.righthand3) {
                    if (player.rightshoulder.x < this.center.x) {
                        circle.xmom *= -1
                        if (circle.x > this.center.x) {
                            circle.x = player.rightshoulder.x
                        }
                    }
                    if (player.rightshoulder.x > this.center.x) {
                        circle.xmom *= -1
                        if (circle.x < this.center.x) {
                            circle.x = player.rightshoulder.x
                        }
                    } 
                } else if (circle == player.lefthand || circle == player.lefthand2 || circle == player.lefthand3) {
                    if (player.leftshoulder.x < this.center.x) {
                        circle.xmom *= -1
                        if (circle.x > this.center.x) {
                            circle.x = player.leftshoulder.x
                        }
                    }
                    if (player.leftshoulder.x > this.center.x) {
                        circle.xmom *= -1
                        if (circle.x < this.center.x) {
                            circle.x = player.leftshoulder.x
                        }
                    }
                } else if (circle == player.middlehand ) {
                    if (player.middleshoulder.x < this.center.x) {
                        circle.xmom *= -1
                        if (circle.x > this.center.x) {
                            circle.x = player.middleshoulder.x
                        }
                    }
                    if (player.middleshoulder.x > this.center.x) {
                        circle.xmom *= -1
                        if (circle.x < this.center.x) {
                            circle.x = player.middleshoulder.x
                        }
                    }
                } else if (circle == player.bananahand) {
                    if (player.bananashoulder.x < this.center.x) {
                        circle.xmom *= -1
                        if (circle.x > this.center.x) {
                            circle.x = player.bananashoulder.x
                        }
                    }
                    if (player.bananashoulder.x > this.center.x) {
                        circle.xmom *= -1
                        if (circle.x < this.center.x) {
                            circle.x = player.bananashoulder.x
                        }
                    }
                }else if (circle == player.middlehand2 ) {
                    if (player.middleshoulder2.x < this.center.x) {
                        circle.xmom *= -1
                        if (circle.x > this.center.x) {
                            circle.x = player.middleshoulder2.x
                        }
                    }
                    if (player.middleshoulder2.x > this.center.x) {
                        circle.xmom *= -1
                        if (circle.x < this.center.x) {
                            circle.x = player.middleshoulder2.x
                        }
                    }
                } else if (circle == player.bananahand2) {
                    if (player.bananashoulder2.x < this.center.x) {
                        circle.xmom *= -1
                        if (circle.x > this.center.x) {
                            circle.x = player.bananashoulder2.x
                        }
                    }
                    if (player.bananashoulder2.x > this.center.x) {
                        circle.xmom *= -1
                        if (circle.x < this.center.x) {
                            circle.x = player.bananashoulder2.x
                        }
                    }
                } else {
                    if (circle.x < this.center.x) {
                        circle.xmom *= -1
                    }
                    if (circle.x > this.center.x) {
                        circle.xmom *= -1
                    }
                }
                if (this.topcap.y > circle.y) {
                    if (circle == player.body) {
                        player.grounded = 1
                        if (player.body.ymom > 0) {
                            player.body.ymom = 0
                        }
                    }
                }
            }
            if (this.topcap.doesPerimeterTouch(circle)) {
                if (this.topcap.y > circle.y) {
                    if (circle == player.body) {
                        player.grounded = 1
                        player.jumpcount = -20
                        if (player.body.ymom > 0) {
                            player.body.ymom = 0
                        }
                    }
                }
            }
            let j = 0
            const superbreak = 0



            const stagepoint = this.shape.innerShape(circle)
            if (stagepoint != false) {
                // const dis = (stagepoint.radius + circle.radius) - (new LineOP(circle, stagepoint).hypotenuse())
                const line = new LineOP(stagepoint,circle)
                const dis = (line.hypotenuse()-circle.radius)-stagepoint.radius
                const angle = line.angle()
            if(minigameSelected == 2){
                circle.x += dis * (Math.cos(angle)) * 1.05
                circle.y += dis * (Math.sin(angle)) * 1.05
            }else{
                circle.x += dis * (Math.cos(angle)) * .99
                circle.y += dis * (Math.sin(angle)) * .99
            }
            }



            // while(this.shape.doesPerimeterTouch(circle)){
            //     j++
            //     superbreak += 1
            //     if(j > 100){
            //         break
            //     }
            //     if(superbreak > 500){
            //         break
            //     }
            //     circle.x -= (this.center.x-circle.x)/1000
            //     circle.y -= (this.center.y-circle.y)/10000
            // }

        }
        draw() {
            this.link.draw()
            this.topcap.draw()
            this.basecap.draw()
            // this.shape.draw()
        }

    }

    class Brick {
        constructor(x, y, width = 200, height = 75) {
            this.center = new Point(x, y)
            this.width = width
            this.height = height
            this.edgeleft = new Circle(x - (width * .5), y, 4, "cyan")
            this.edgeright = new Circle(x + (width * .5), y, 4, "blue")
            this.link = new Line(this.edgeleft.x - 5, this.edgeleft.y, this.edgeright.x + 5, this.edgeright.y, "#FFFFFF", height * 2)
            this.shape = castBetween(this.edgeleft, this.edgeright, (this.width / this.height) * 1.81, height)
            this.shape2 = castBetween(this.edgeleft, this.edgeright, (this.width / this.height) * 1.81, height)
            this.edgeleft = new Circle(x - (width * .5), y - (height * 1), 26, "cyan")
            this.edgeright = new Circle(x + (width * .5), y - (height * 1), 26, "blue") ///16
        }
        stick(point) {
            if (point.x > this.edgeleft.x && point.x < this.edgeright.x) {
                let j = 0
                while (this.shape.doesPerimeterTouch(point)) {
                    j++
                    if (j > 300) {
                        break
                    }
                    point.stuck = 1
                    point.y--
                }
            }
        }
        doesPerimeterTouch(circle, player) {
            // this.edgeleft.draw()
            // this.edgeright.draw()
            // const link = new Line(this.edgeleft.x, this.center.y + (this.height*.5), this.edgeright.x, this.center.y + (this.height*.5), "#FF0000", 1)
            // link.draw()

            // for(let t = 0;t<player.shots.length;t++){
            //     if(this.shape.doesPerimeterTouch(player.shots[t])){
            //         // player.shots[t].marked = 1
            //     }
            // }


            if (circle == player.rightshoulder) {
                return
            }
            if (circle == player.leftshoulder) {
                return
            }
            if (circle == player.rightshoulder2) {
                return
            }
            if (circle == player.leftshoulder2) {
                return
            }
            if (circle == player.rightshoulder3) {
                return
            }
            if (circle == player.leftshoulder3) {
                return
            }
            if (circle == player.middleshoulder) {
                return
            }
            if (circle == player.radball) {
                return
            }

            if (circle == player.bananashoulder2) {
                return
            }
            if (circle == player.middlehsoulder2) {
                return
            }
            const floorchecklink = new LineOP(circle, this.center)
            if (floorchecklink.sqrDis() > (this.width * .65) * (this.width * .65)) {
                // const circ = new Circle(this.center.x, this.center.y,  (this.width*.65), "#FF000011")
                // circ.draw()
                return
            }



            if(player.pinwheel == 1 || player.gwomp == 1 && !((this.edgeleft.x < (player.body.x+player.body.radius))  && (this.edgeright.x > (player.body.x-player.body.radius)))  ){
                if(player.gwomp == 1){

                if (circle == player.bananahand2) {
                player.bananahand2s = castBetween(player.bananashoulder2, player.bananahand2, armgranularity, player.bananahand2.radius)
                if (player.bananahand2s.doesPerimeterTouch(this.edgeleft) || circle.doesPerimeterTouch(this.edgeleft)) {
                    if (circle.anchored >= -1) {
                        circle.anchored = 1
                        // ////////console.log("anchired r?")
                        circle.anchor = this.edgeleft
                    }
                    if (player.body.y > circle.y) {
                        circle.x--
                    }
                }
            }
            if (circle == player.bananahand2) {
                player.bananahand2s = castBetween(player.bananashoulder2, player.bananahand2, armgranularity, player.bananahand2.radius)
                if (player.bananahand2s.doesPerimeterTouch(this.edgeright) || circle.doesPerimeterTouch(this.edgeright)) {
                    if (circle.anchored >= -1) {
                        circle.anchored = 1
                        // ////////console.log("anchired r?")
                        circle.anchor = this.edgeright
                    }
                    if (player.body.y > circle.y) {
                        circle.x--
                    }
                }
            }
            if (circle == player.middlehand2) {
                player.middlehand2s = castBetween(player.middleshoulder2, player.middlehand2, armgranularity, player.middlehand2.radius)
                if (player.middlehand2s.doesPerimeterTouch(this.edgeleft) || circle.doesPerimeterTouch(this.edgeleft)) {
                    if (circle.anchored >= -1) {
                        circle.anchored = 1

                        // ////////console.log("anchired l?")
                        circle.anchor = this.edgeleft
                    }
                    if (player.body.y > circle.y) {
                        circle.x++
                    }
                }
            }
            if (circle == player.middlehand2) {
                player.middlehand2s = castBetween(player.middleshoulder2, player.middlehand2, armgranularity, player.middlehand2.radius)
                if (player.middlehand2s.doesPerimeterTouch(this.edgeright) || circle.doesPerimeterTouch(this.edgeright)) {
                    if (circle.anchored >= -1) {
                        circle.anchored = 1

                        // ////////console.log("anchired l?")
                        circle.anchor = this.edgeright
                    }
                    if (player.body.y > circle.y) {
                        circle.x++
                    }
                }
            }
                }

                if (circle == player.righthand) {
                player.righthands = castBetween(player.rightshoulder, player.righthand, armgranularity, player.righthand.radius)
                if (player.righthands.doesPerimeterTouch(this.edgeleft) || circle.doesPerimeterTouch(this.edgeleft)) {
                    if (circle.anchored >= -1) {
                        circle.anchored = 1
                        // ////////console.log("anchired r?")
                        circle.anchor = this.edgeleft
                    }
                    if (player.body.y > circle.y) {
                        circle.x--
                    }
                }
            }
            if (circle == player.lefthand) {
                player.lefthands = castBetween(player.leftshoulder, player.lefthand, armgranularity, player.lefthand.radius)
                if (player.lefthands.doesPerimeterTouch(this.edgeright) || circle.doesPerimeterTouch(this.edgeright)) {
                    if (circle.anchored >= -1) {
                        circle.anchored = 1

                        // ////////console.log("anchired l?")
                        circle.anchor = this.edgeright
                    }
                    if (player.body.y > circle.y) {
                        circle.x++
                    }
                }
            }
            if (circle == player.righthand) {
                player.righthands = castBetween(player.rightshoulder, player.righthand, armgranularity, player.righthand.radius)
                if (player.righthands.doesPerimeterTouch(this.edgeright) || circle.doesPerimeterTouch(this.edgeright)) {
                    if (circle.anchored >= -1) {
                        circle.anchored = 1
                        // ////////console.log("anchired r?")
                        circle.anchor = this.edgeright
                    }
                    if (player.body.y > circle.y) {
                        circle.x--
                    }
                }
            }
            if (circle == player.lefthand) {
                player.lefthands = castBetween(player.leftshoulder, player.lefthand, armgranularity, player.lefthand.radius)
                if (player.lefthands.doesPerimeterTouch(this.edgeleft) || circle.doesPerimeterTouch(this.edgeleft)) {
                    if (circle.anchored >= -1) {
                        circle.anchored = 1

                        // ////////console.log("anchired l?")
                        circle.anchor = this.edgeleft
                    }
                    if (player.body.y > circle.y) {
                        circle.x++
                    }
                }
            }

                if (circle == player.bananahand) {
                player.bananahands = castBetween(player.bananashoulder, player.bananahand, armgranularity, player.bananahand.radius)
                if (player.bananahands.doesPerimeterTouch(this.edgeleft) || circle.doesPerimeterTouch(this.edgeleft)) {
                    if (circle.anchored >= -1) {
                        circle.anchored = 1
                        // ////////console.log("anchired r?")
                        circle.anchor = this.edgeleft
                    }
                    if (player.body.y > circle.y) {
                        circle.x--
                    }
                }
            }
            if (circle == player.bananahand) {
                player.bananahands = castBetween(player.bananashoulder, player.bananahand, armgranularity, player.bananahand.radius)
                if (player.bananahands.doesPerimeterTouch(this.edgeright) || circle.doesPerimeterTouch(this.edgeright)) {
                    if (circle.anchored >= -1) {
                        circle.anchored = 1
                        // ////////console.log("anchired r?")
                        circle.anchor = this.edgeright
                    }
                    if (player.body.y > circle.y) {
                        circle.x--
                    }
                }
            }
            if (circle == player.middlehand) {
                player.middlehands = castBetween(player.middleshoulder, player.middlehand, armgranularity, player.middlehand.radius)
                if (player.middlehands.doesPerimeterTouch(this.edgeleft) || circle.doesPerimeterTouch(this.edgeleft)) {
                    if (circle.anchored >= -1) {
                        circle.anchored = 1

                        // ////////console.log("anchired l?")
                        circle.anchor = this.edgeleft
                    }
                    if (player.body.y > circle.y) {
                        circle.x++
                    }
                }
            }
            if (circle == player.middlehand) {
                player.middlehands = castBetween(player.middleshoulder, player.middlehand, armgranularity, player.middlehand.radius)
                if (player.middlehands.doesPerimeterTouch(this.edgeright) || circle.doesPerimeterTouch(this.edgeright)) {
                    if (circle.anchored >= -1) {
                        circle.anchored = 1

                        // ////////console.log("anchired l?")
                        circle.anchor = this.edgeright
                    }
                    if (player.body.y > circle.y) {
                        circle.x++
                    }
                }
            }
            }else{

            if (circle == player.righthand) {
                player.righthands = castBetween(player.rightshoulder, player.righthand, armgranularity, player.righthand.radius)
                if (player.righthands.doesPerimeterTouch(this.edgeleft) || circle.doesPerimeterTouch(this.edgeleft)) {
                    if (circle.anchored >= -1) {
                        circle.anchored = 1
                        // ////////console.log("anchired r?")
                        circle.anchor = this.edgeleft
                    }
                    if (player.body.y > circle.y) {
                        circle.x--
                    }
                }
            }
            if (circle == player.lefthand) {
                player.lefthands = castBetween(player.leftshoulder, player.lefthand, armgranularity, player.lefthand.radius)
                if (player.lefthands.doesPerimeterTouch(this.edgeright) || circle.doesPerimeterTouch(this.edgeright)) {
                    if (circle.anchored >= -1) {
                        circle.anchored = 1

                        // ////////console.log("anchired l?")
                        circle.anchor = this.edgeright
                    }
                    if (player.body.y > circle.y) {
                        circle.x++
                    }
                }
            }
            }

            if (circle !== player.rightshoulder && circle !== player.leftshoulder && circle !== player.rightshoulder2 && circle !== player.leftshoulder2 && circle !== player.rightshoulder3 && circle !== player.leftshoulder3 && circle !== player.middleshoulder) {
                if (circle.x <= this.edgeright.x + circle.radius) {
                    if (circle.x + circle.radius >= this.edgeleft.x) {  //fasd
                        if (this.shape.doesPerimeterTouch(circle)) {
                            if (circle == player.body) {
                                if (circle.y < this.center.y) {
                                    player.grounded = 1

                                }
                            }
                            if (circle.ymom > 4) {
                                if (circle.ymom > 1) {
                                    if (circle == player.righthand || circle == player.righthand2 || circle == player.righthand3) {
                                        if (player.body.y <= this.edgeleft.y) {
                                            circle.ymom *= -1
                                        }
                                    } else if (circle == player.lefthand || circle == player.lefthand2 || circle == player.lefthand3) {
                                        if (player.body.y <= this.edgeleft.y) {
                                            circle.ymom *= -1
                                        }
                                    } else {
                                        if (player.jumping == 0) {
                                            circle.ymom *= -.6
                                        }
                                    }
                                } else {
                                    circle.ymom = 0
                                }
                            } else {
                                if (circle.ymom > 0) {
                                    if (circle == player.righthand || circle == player.righthand2 || circle == player.righthand3) {
                                        if (player.body.y <= this.edgeleft.y) {
                                            circle.ymom *= -.6
                                        }
                                    } else if (circle == player.lefthand || circle == player.lefthand2 || circle == player.lefthand3) {
                                        if (player.body.y <= this.edgeleft.y) {
                                            circle.ymom *= -.6
                                        }
                                    } else {
                                        circle.ymom *= -.6
                                    }
                                }
                            }
                            if (circle.y > this.center.y) {
                                if (circle == player.body) {
                                    if (circle.ymom < 0) {
                                        circle.ymom *= -1
                                        circle.frictiveMove()
                                    }
                                    let j = 0
                                    while (this.shape.doesPerimeterTouch(circle)) {
                                        j++
                                        if (j > 100) {
                                            break
                                        }
                                        if (circle == player.body) {
                                            circle.y += .1
                                        } else {
                                            if (circle == player.lefthand || circle == player.lefthand2 || circle == player.lefthand3) {
                                                if (player.leftarm.sqrDis() < (this.height * 5.2) * (this.height * 5.2)) {
                                                    circle.y += .1
                                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                        if (circle == player.righthand) {
                                                            if (circle.anchored >= -1) {
                                                                circle.anchored = 1
                                                                circle.anchor = this.edgeleft
                                                            }
                                                            if (player.body.y > circle.y) {
                                                                circle.x--
                                                            }
                                                        }
                                                    }
                                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                                        if (circle == player.lefthand) {
                                                            if (circle.anchored >= -1) {
                                                                circle.anchored = 1
                                                                circle.anchor = this.edgeright
                                                            }
                                                            if (player.body.y > circle.y) {
                                                                circle.x++
                                                            }
                                                        }
                                                    }
                                                } else {
                                                    break
                                                }
                                            }
                                            if (circle == player.righthand || circle == player.righthand2 || circle == player.righthand3) {
                                                if (player.rightarm.sqrDis() < (this.height * 5.2) * (this.height * 5.2)) {
                                                    circle.y += .1
                                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                        if (circle == player.righthand) {
                                                            if (circle.anchored >= -1) {
                                                                circle.anchored = 1
                                                                circle.anchor = this.edgeleft
                                                            }
                                                            if (player.body.y > circle.y) {
                                                                circle.x--
                                                            }
                                                        }
                                                    }
                                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                                        if (circle == player.lefthand) {
                                                            if (circle.anchored >= -1) {
                                                                circle.anchored = 1
                                                                circle.anchor = this.edgeright
                                                            }
                                                            if (player.body.y > circle.y) {
                                                                circle.x++
                                                            }
                                                        }
                                                    }
                                                } else {
                                                    break
                                                }
                                            }
                                            if (circle == player.middlehand) {
                                                if (player.rightarm.sqrDis() < (this.height * 5.2) * (this.height * 5.2)) {
                                                    circle.y += .1
                                                } else {
                                                    break
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (player.body.y > circle.y) {
                                        if (circle.ymom < 0) {
                                            circle.ymom *= -1
                                            circle.frictiveMove()
                                        }
                                    }
                                }
                            } else {
                                let j = 0
                                while (this.shape.doesPerimeterTouch(circle)) {
                                    j++
                                    if (j > 100) {
                                        break
                                    }
                                    if (circle == player.body) {
                                        if (circle.anchored != 1) {
                                            circle.y -= .1
                                            if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                if (circle == player.righthand) {
                                                    if (circle.anchored >= -1) {
                                                        circle.anchored = 1
                                                        circle.anchor = this.edgeleft
                                                    }
                                                    if (player.body.y > circle.y) {
                                                        circle.x--
                                                    }
                                                }
                                            }
                                            if (circle.doesPerimeterTouch(this.edgeright)) {
                                                if (circle == player.lefthand) {
                                                    if (circle.anchored >= -1) {
                                                        circle.anchored = 1
                                                        circle.anchor = this.edgeright
                                                    }
                                                    if (player.body.y > circle.y) {
                                                        circle.x++
                                                    }
                                                }
                                            }
                                            player.grounded = 1
                                        } else {
                                            break
                                        }
                                    } else {
                                        if (circle == player.lefthand || circle == player.lefthand2 || circle == player.lefthand3) {
                                            if (player.leftarm.sqrDis() < (this.height * 15.2) * (this.height * 15.2)) {
                                                if (player.body.y <= this.edgeleft.y) {
                                                    if (circle.anchored != 1) {
                                                        circle.y -= .1

                                                        if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                            if (circle == player.righthand) {
                                                                if (circle.anchored >= -1) {
                                                                    circle.anchored = 1
                                                                    circle.anchor = this.edgeleft
                                                                }
                                                                if (player.body.y > circle.y) {
                                                                    circle.x--
                                                                }
                                                            }
                                                        }
                                                        if (circle.doesPerimeterTouch(this.edgeright)) {
                                                            if (circle == player.lefthand) {
                                                                if (circle.anchored >= -1) {
                                                                    circle.anchored = 1
                                                                    circle.anchor = this.edgeright
                                                                }
                                                                if (player.body.y > circle.y) {
                                                                    circle.x++
                                                                }
                                                            }
                                                        }
                                                    } else {
                                                        break
                                                    }
                                                } else {
                                                    break
                                                }

                                                if (this.shape.doesPerimeterTouch(circle)) {
                                                    if (circle == player.righthand || circle == player.righthand2 || circle == player.righthand3) {
                                                        if (player.body.y > circle.y) {
                                                            if (circle.x > player.body.x) {
                                                                if (circle.anchored != 1) {
                                                                    circle.x -= .15 //no
                                                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                                        if (circle == player.righthand) {
                                                                            if (circle.anchored >= -1) {
                                                                                circle.anchored = 1
                                                                                circle.anchor = this.edgeleft
                                                                            }
                                                                            if (player.body.y > circle.y) {
                                                                                circle.x--
                                                                            }
                                                                        }
                                                                    }
                                                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                                                        if (circle == player.lefthand) {
                                                                            if (circle.anchored >= -1) {
                                                                                circle.anchored = 1
                                                                                circle.anchor = this.edgeright
                                                                            }
                                                                            if (player.body.y > circle.y) {
                                                                                circle.x++
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    if (circle == player.lefthand || circle == player.lefthand2 || circle == player.lefthand3) {
                                                        if (player.body.y > circle.y) {
                                                            if (circle.x < player.body.x) {
                                                                if (circle.anchored != 1) {
                                                                    circle.x += .15
                                                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                                        if (circle == player.righthand) {
                                                                            if (circle.anchored >= -1) {
                                                                                circle.anchored = 1
                                                                                circle.anchor = this.edgeleft
                                                                            }
                                                                            if (player.body.y > circle.y) {
                                                                                circle.x--
                                                                            }
                                                                        }
                                                                    }
                                                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                                                        if (circle == player.lefthand) {
                                                                            if (circle.anchored >= -1) {
                                                                                circle.anchored = 1
                                                                                circle.anchor = this.edgeright
                                                                            }
                                                                            if (player.body.y > circle.y) {
                                                                                circle.x++
                                                                            }
                                                                        }
                                                                    }
                                                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                                        if (circle == player.righthand) {
                                                                            if (circle.anchored >= -1) {
                                                                                circle.anchored = 1
                                                                                circle.anchor = this.edgeleft
                                                                            }
                                                                            if (player.body.y > circle.y) {
                                                                                circle.x--
                                                                            }
                                                                        }
                                                                    }
                                                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                                                        if (circle == player.lefthand) {
                                                                            if (circle.anchored >= -1) {
                                                                                circle.anchored = 1
                                                                                circle.anchor = this.edgeright
                                                                            }
                                                                            if (player.body.y > circle.y) {
                                                                                circle.x++
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            } else {
                                                break
                                            }
                                        }
                                        if (circle == player.righthand || circle == player.righthand2 || circle == player.righthand3) {
                                            if (player.rightarm.sqrDis() < (this.height * 15.2) * (this.height * 15.2)) {
                                                if (player.body.y <= this.edgeleft.y) {
                                                    if (circle.anchored != 1) {
                                                        circle.y -= .1

                                                        if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                            if (circle == player.righthand) {
                                                                if (circle.anchored >= -1) {
                                                                    circle.anchored = 1
                                                                    circle.anchor = this.edgeleft
                                                                }
                                                                if (player.body.y > circle.y) {
                                                                    circle.x--
                                                                }
                                                            }
                                                        }
                                                        if (circle.doesPerimeterTouch(this.edgeright)) {
                                                            if (circle == player.lefthand) {
                                                                if (circle.anchored >= -1) {
                                                                    circle.anchored = 1
                                                                    circle.anchor = this.edgeright
                                                                }
                                                                if (player.body.y > circle.y) {
                                                                    circle.x++
                                                                }
                                                            }
                                                        }
                                                    } else {
                                                        break
                                                    }
                                                } else {
                                                    break
                                                }
                                                if (this.shape.doesPerimeterTouch(circle)) {
                                                    if (circle == player.righthand || circle == player.righthand2 || circle == player.righthand3) {
                                                        if (player.body.y > circle.y) {
                                                            if (circle.x > player.body.x) {
                                                                if (circle.anchored != 1) {
                                                                    circle.x -= .15
                                                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                                        if (circle == player.righthand) {
                                                                            if (circle.anchored >= -1) {
                                                                                circle.anchored = 1
                                                                                circle.anchor = this.edgeleft
                                                                            }
                                                                            if (player.body.y > circle.y) {
                                                                                circle.x--
                                                                            }
                                                                        }
                                                                    }
                                                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                                                        if (circle == player.lefthand) {
                                                                            if (circle.anchored >= -1) {
                                                                                circle.anchored = 1
                                                                                circle.anchor = this.edgeright
                                                                            }
                                                                            if (player.body.y > circle.y) {
                                                                                circle.x++
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }

                                                    if (circle == player.lefthand || circle == player.lefthand2 || circle == player.lefthand3) {
                                                        if (player.body.y > circle.y) {
                                                            if (circle.x < player.body.x) {
                                                                if (circle.anchored != 1) {
                                                                    circle.x += .15
                                                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                                        if (circle == player.righthand) {
                                                                            if (circle.anchored >= -1) {
                                                                                circle.anchored = 1
                                                                                circle.anchor = this.edgeleft
                                                                            }
                                                                            if (player.body.y > circle.y) {
                                                                                circle.x--
                                                                            }
                                                                        }
                                                                    }
                                                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                                                        if (circle == player.lefthand) {
                                                                            if (circle.anchored >= -1) {
                                                                                circle.anchored = 1
                                                                                circle.anchor = this.edgeright
                                                                            }
                                                                            if (player.body.y > circle.y) {
                                                                                circle.x++
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            } else {
                                                break
                                            }
                                        }
                                    }

                                    if (this.shape.doesPerimeterTouch(circle)) {
                                        if (circle == player.righthand || circle == player.righthand2 || circle == player.righthand3) {
                                            if (player.body.y > circle.y) {
                                                if (circle.x > player.body.x) {
                                                    if (circle.anchored != 1) {
                                                        circle.x -= .15
                                                        if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                            if (circle == player.righthand) {
                                                                if (circle.anchored >= -1) {
                                                                    circle.anchored = 1
                                                                    circle.anchor = this.edgeleft
                                                                }
                                                                if (player.body.y > circle.y) {
                                                                    circle.x--
                                                                }
                                                            }
                                                        }
                                                        if (circle.doesPerimeterTouch(this.edgeright)) {
                                                            if (circle == player.lefthand) {
                                                                if (circle.anchored >= -1) {
                                                                    circle.anchored = 1
                                                                    circle.anchor = this.edgeright
                                                                }
                                                                if (player.body.y > circle.y) {
                                                                    circle.x++
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }

                                        if (circle == player.lefthand || circle == player.lefthand2 || circle == player.lefthand3) {
                                            if (player.body.y > circle.y) {
                                                if (circle.x < player.body.x) {
                                                    if (circle.anchored != 1) {
                                                        circle.x += .15
                                                        if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                            if (circle == player.righthand) {
                                                                if (circle.anchored >= -1) {
                                                                    circle.anchored = 1
                                                                    circle.anchor = this.edgeleft
                                                                }
                                                                if (player.body.y > circle.y) {
                                                                    circle.x--
                                                                }
                                                            }
                                                        }
                                                        if (circle.doesPerimeterTouch(this.edgeright)) {
                                                            if (circle == player.lefthand) {
                                                                if (circle.anchored >= -1) {
                                                                    circle.anchored = 1
                                                                    circle.anchor = this.edgeright
                                                                }
                                                                if (player.body.y > circle.y) {
                                                                    circle.x++
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                                circle.y += .1
                                if (circle.doesPerimeterTouch(this.edgeleft)) {
                                    if (circle == player.righthand) {
                                        if (circle.anchored >= -1) {
                                            circle.anchored = 1
                                            circle.anchor = this.edgeleft
                                        }
                                        if (player.body.y > circle.y) {
                                            circle.x--
                                        }
                                    }
                                }
                                if (circle.doesPerimeterTouch(this.edgeright)) {
                                    if (circle == player.lefthand) {
                                        if (circle.anchored >= -1) {
                                            circle.anchored = 1
                                            circle.anchor = this.edgeright
                                        }
                                        if (player.body.y > circle.y) {
                                            circle.x++
                                        }
                                    }
                                }
                            }
                        } else {
                            if (circle == player.body) {
                                if (circle.y + circle.radius >= this.edgeleft.y - 1) {
                                    if (circle.y + circle.radius <= this.edgeleft.y + this.height * 2.5) {
                                        if (circle.x > this.edgeleft.x) {
                                            if (circle.x < this.edgeright.x) {
                                                player.grounded = 1
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }

            // const stagepoint = this.shape2.innerShape(circle)
            // if(stagepoint != false){
            //     const dis = (stagepoint.radius+circle.radius)-(new LineOP(circle, stagepoint).hypotenuse())
            //     const angle = new LineOP(circle, stagepoint).angle()
            //     if(circle.x+circle.radius > this.edgeleft.x && circle.x-circle.radius < this.edgeright){
            //         circle.x += dis*(Math.cos(angle))
            //     }
            //     circle.y += dis*(Math.sin(angle))
            // }


            let j = 0
            while (this.shape.doesPerimeterTouch(circle)) {
                j++
                if (j > 100) {
                    break
                }

                if (circle == player.body) {
                    if (player.body.x < this.edgeright.x + (player.body.radius * 1.2)) {
                        if (player.body.x > this.edgeleft.x - (player.body.radius * 1.2)) {
                            if (player.body.y < this.edgeleft.y) {
                                if (circle.anchored != 1) {
                                    circle.y -= .1

                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                        if (circle == player.righthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeleft
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x--
                                            }
                                        }
                                    }
                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                        if (circle == player.lefthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeright
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x++
                                            }
                                        }
                                    }
                                } else {
                                    break
                                }
                            } else if (player.body.y > this.edgeleft.y + (this.height * 2)) {
                                if (circle.anchored != 1) {
                                    circle.y += .1

                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                        if (circle == player.righthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeleft
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x--
                                            }
                                        }
                                    }
                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                        if (circle == player.lefthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeright
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x++
                                            }
                                        }
                                    }
                                } else {
                                    break
                                }
                            } else {
                                if (circle.anchored != 1) {
                                    circle.y -= ((circle.y - this.center.y) / (this.height)) * .1

                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                        if (circle == player.righthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeleft
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x--
                                            }
                                        }
                                    }
                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                        if (circle == player.lefthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeright
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x++
                                            }
                                        }
                                    }
                                    if (circle.x > this.center.x) {
                                        if (circle != player.body) {
                                            circle.x += .1

                                            if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                if (circle == player.righthand) {
                                                    if (circle.anchored >= -1) {
                                                        circle.anchored = 1
                                                        circle.anchor = this.edgeleft
                                                    }
                                                    if (player.body.y > circle.y) {
                                                        circle.x--
                                                    }
                                                }
                                            }
                                            if (circle.doesPerimeterTouch(this.edgeright)) {
                                                if (circle == player.lefthand) {
                                                    if (circle.anchored >= -1) {
                                                        circle.anchored = 1
                                                        circle.anchor = this.edgeright
                                                    }
                                                    if (player.body.y > circle.y) {
                                                        circle.x++
                                                    }
                                                }
                                            }
                                        } else {
                                            break
                                        }
                                    } else if (circle.x < this.center.x) {
                                        if (circle != player.body) {
                                            circle.x -= .1
                                            if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                if (circle == player.righthand) {
                                                    if (circle.anchored >= -1) {
                                                        circle.anchored = 1
                                                        circle.anchor = this.edgeleft
                                                    }
                                                    if (player.body.y > circle.y) {
                                                        circle.x--
                                                    }
                                                }
                                            }
                                            if (circle.doesPerimeterTouch(this.edgeright)) {
                                                if (circle == player.lefthand) {
                                                    if (circle.anchored >= -1) {
                                                        circle.anchored = 1
                                                        circle.anchor = this.edgeright
                                                    }
                                                    if (player.body.y > circle.y) {
                                                        circle.x++
                                                    }
                                                }
                                            }
                                        } else {
                                            break
                                        }
                                    } else {
                                        break
                                    }
                                } else {
                                    break
                                }
                            }
                        } else {
                            if (circle.anchored != 1) {
                                circle.y -= ((circle.y - this.center.y) / (this.height)) * .1

                                if (circle.doesPerimeterTouch(this.edgeleft)) {
                                    if (circle == player.righthand) {
                                        if (circle.anchored >= -1) {
                                            circle.anchored = 1
                                            circle.anchor = this.edgeleft
                                        }
                                        if (player.body.y > circle.y) {
                                            circle.x--
                                        }
                                    }
                                }
                                if (circle.doesPerimeterTouch(this.edgeright)) {
                                    if (circle == player.lefthand) {
                                        if (circle.anchored >= -1) {
                                            circle.anchored = 1
                                            circle.anchor = this.edgeright
                                        }
                                        if (player.body.y > circle.y) {
                                            circle.x++
                                        }
                                    }
                                }
                                if (circle.x > this.center.x) {
                                    if (circle != player.body) {
                                        circle.x += .1
                                        if (circle.doesPerimeterTouch(this.edgeleft)) {
                                            if (circle == player.righthand) {
                                                if (circle.anchored >= -1) {
                                                    circle.anchored = 1
                                                    circle.anchor = this.edgeleft
                                                }
                                                if (player.body.y > circle.y) {
                                                    circle.x--
                                                }
                                            }
                                        }
                                        if (circle.doesPerimeterTouch(this.edgeright)) {
                                            if (circle == player.lefthand) {
                                                if (circle.anchored >= -1) {
                                                    circle.anchored = 1
                                                    circle.anchor = this.edgeright
                                                }
                                                if (player.body.y > circle.y) {
                                                    circle.x++
                                                }
                                            }
                                        }
                                    } else {
                                        break
                                    }
                                } else if (circle.x < this.center.x) {
                                    if (circle != player.body) {
                                        circle.x -= .1
                                        if (circle.doesPerimeterTouch(this.edgeleft)) {
                                            if (circle == player.righthand) {
                                                if (circle.anchored >= -1) {
                                                    circle.anchored = 1
                                                    circle.anchor = this.edgeleft
                                                }
                                                if (player.body.y > circle.y) {
                                                    circle.x--
                                                }
                                            }
                                        }
                                        if (circle.doesPerimeterTouch(this.edgeright)) {
                                            if (circle == player.lefthand) {
                                                if (circle.anchored >= -1) {
                                                    circle.anchored = 1
                                                    circle.anchor = this.edgeright
                                                }
                                                if (player.body.y > circle.y) {
                                                    circle.x++
                                                }
                                            }
                                        }
                                    } else {
                                        break
                                    }
                                } else {
                                    break
                                }
                            } else {
                                break
                            }
                        }
                    } else {
                        if (circle.anchored != 1) {
                            circle.y -= ((circle.y - this.center.y) / (this.height)) * .1
                            if (circle.x > this.center.x) {
                                if (circle != player.body) {
                                    circle.x += .1
                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                        if (circle == player.righthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeleft
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x--
                                            }
                                        }
                                    }
                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                        if (circle == player.lefthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeright
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x++
                                            }
                                        }
                                    }
                                } else {
                                    break
                                }
                            } else if (circle.x < this.center.x) {
                                if (circle != player.body) {
                                    circle.x -= .1
                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                        if (circle == player.righthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeleft
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x--
                                            }
                                        }
                                    }
                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                        if (circle == player.lefthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeright
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x++
                                            }
                                        }
                                    }
                                } else {
                                    break
                                }
                            } else {
                                break
                            }
                        } else {
                            break
                        }
                    }
                } else {
                    if (circle.x < this.edgeright.x + circle.radius) {
                        if (circle.x > this.edgeleft.x - circle.radius) { //dsfa
                            if (player.body.y < this.edgeleft.y) {
                                if (circle.anchored != 1) {
                                    circle.y -= .1
                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                        if (circle == player.righthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeleft
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x--
                                            }
                                        }
                                    }
                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                        if (circle == player.lefthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeright
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x++
                                            }
                                        }
                                    }

                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                        if (circle == player.righthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeleft
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x--
                                            }
                                        }
                                    }
                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                        if (circle == player.lefthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeright
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x++
                                            }
                                        }
                                    }
                                } else {
                                    break
                                }
                            } else if (player.body.y > this.edgeleft.y + (this.height * 2)) {
                                if (circle.anchored != 1) {
                                    circle.y += .1
                                    if (circle.doesPerimeterTouch(this.edgeleft)) {
                                        if (circle == player.righthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeleft
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x--
                                            }
                                        }
                                    }
                                    if (circle.doesPerimeterTouch(this.edgeright)) {
                                        if (circle == player.lefthand) {
                                            if (circle.anchored >= -1) {
                                                circle.anchored = 1
                                                circle.anchor = this.edgeright
                                            }
                                            if (player.body.y > circle.y) {
                                                circle.x++
                                            }
                                        }
                                    }
                                } else {
                                    break
                                }
                            } else {
                                if (circle.anchored != 1) {
                                    circle.y -= ((circle.y - this.center.y) / (this.height)) * .1
                                    if (circle.x > this.center.x) {
                                        if (circle != player.body) {
                                            circle.x += .1
                                            if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                if (circle == player.righthand) {
                                                    if (circle.anchored >= -1) {
                                                        circle.anchored = 1
                                                        circle.anchor = this.edgeleft
                                                    }
                                                    if (player.body.y > circle.y) {
                                                        circle.x--
                                                    }
                                                }
                                            }
                                            if (circle.doesPerimeterTouch(this.edgeright)) {
                                                if (circle == player.lefthand) {
                                                    if (circle.anchored >= -1) {
                                                        circle.anchored = 1
                                                        circle.anchor = this.edgeright
                                                    }
                                                    if (player.body.y > circle.y) {
                                                        circle.x++
                                                    }
                                                }
                                            }
                                        } else {
                                            break
                                        }
                                    } else if (circle.x < this.center.x) {
                                        if (circle != player.body) {
                                            circle.x -= .1
                                            if (circle.doesPerimeterTouch(this.edgeleft)) {
                                                if (circle == player.righthand) {
                                                    if (circle.anchored >= -1) {
                                                        circle.anchored = 1
                                                        circle.anchor = this.edgeleft
                                                    }
                                                    if (player.body.y > circle.y) {
                                                        circle.x--
                                                    }
                                                }
                                            }
                                            if (circle.doesPerimeterTouch(this.edgeright)) {
                                                if (circle == player.lefthand) {
                                                    if (circle.anchored >= -1) {
                                                        circle.anchored = 1
                                                        circle.anchor = this.edgeright
                                                    }
                                                    if (player.body.y > circle.y) {
                                                        circle.x++
                                                    }
                                                }
                                            }
                                        } else {
                                            break
                                        }
                                    } else {
                                        break
                                    }
                                } else {
                                    break
                                }
                            }
                        } else {
                            if (circle.anchored != 1) {
                                // circle.y -= ((circle.y - this.center.y) / (this.height)) * .1
                                if (circle.x > this.center.x) {
                                    if (circle != player.body) {
                                        circle.x += .1
                                        if (circle.doesPerimeterTouch(this.edgeleft)) {
                                            if (circle == player.righthand) {
                                                if (circle.anchored >= -1) {
                                                    circle.anchored = 1
                                                    circle.anchor = this.edgeleft
                                                }
                                                if (player.body.y > circle.y) {
                                                    circle.x--
                                                }
                                            }
                                        }
                                        if (circle.doesPerimeterTouch(this.edgeright)) {
                                            if (circle == player.lefthand) {
                                                if (circle.anchored >= -1) {
                                                    circle.anchored = 1
                                                    circle.anchor = this.edgeright
                                                }
                                                if (player.body.y > circle.y) {
                                                    circle.x++
                                                }
                                            }
                                        }
                                    } else {
                                        break
                                    }
                                } else if (circle.x < this.center.x) {
                                    if (circle != player.body) {
                                        if (circle.x > this.edgeleft.x - circle.radius) {
                                            circle.x -= .1
                                        }
                                        if (circle.doesPerimeterTouch(this.edgeleft)) {
                                            if (circle == player.righthand) {
                                                if (circle.anchored >= -1) {
                                                    circle.anchored = 1
                                                    circle.anchor = this.edgeleft
                                                }
                                                if (player.body.y > circle.y) {
                                                    circle.x--
                                                }
                                            }
                                        }
                                        if (circle.doesPerimeterTouch(this.edgeright)) {
                                            if (circle == player.lefthand) {
                                                if (circle.anchored >= -1) {
                                                    circle.anchored = 1
                                                    circle.anchor = this.edgeright
                                                }
                                                if (player.body.y > circle.y) {
                                                    circle.x++
                                                }
                                            }
                                        }
                                    } else {
                                        break
                                    }
                                } else {
                                    break
                                }
                            } else {
                                break
                            }
                        }
                    } else {
                        break
                    }

                }
            }
        }

        draw() {
            this.link.draw()
            // this.shape.draw()
            // this.edgeleft.draw()
            // this.edgeright.draw()
        }
        // doesPerimeterTouch(circle, player){

        //     if (circle == player.rightshoulder) {
        //         return
        //     }
        //     if (circle == player.leftshoulder) {
        //         return
        //     }
        //     if (circle == player.rightshoulder2) {
        //         return
        //     }
        //     if (circle == player.leftshoulder2) {
        //         return
        //     }
        //     if (circle == player.rightshoulder3) {
        //         return
        //     }
        //     if (circle == player.leftshoulder3) {
        //         return
        //     }
        //     if (circle == player.middleshoulder) {
        //         return
        //     }
        //     if (circle == player.radball) {
        //         return
        //     }

        //     const floorchecklink = new LineOP(circle, this.center)
        //     if(floorchecklink.sqrDis() > (this.width*.65)*(this.width*.65)){
        //         // const circ = new Circle(this.center.x, this.center.y,  (this.width*.65), "#FF000011")
        //         // circ.draw()
        //         return
        //     }


        //     if (circle == player.righthand) {
        //     player.righthands = castBetween(player.rightshoulder, player.righthand, armgranularity, player.righthand.radius)
        //     if (player.righthands.doesPerimeterTouch(this.edgeleft) || circle.doesPerimeterTouch(this.edgeleft)) {
        //             if (circle.anchored >= -1) {
        //                 circle.anchored = 1
        //         // ////////console.log("anchired r?")
        //                 circle.anchor = this.edgeleft
        //             }
        //             if (player.body.y > circle.y) {
        //                 circle.x--
        //             }
        //         }
        //     }
        //  if (circle == player.lefthand) {
        //     player.lefthands = castBetween(player.leftshoulder, player.lefthand, armgranularity, player.lefthand.radius)
        //     if (player.lefthands.doesPerimeterTouch(this.edgeright) || circle.doesPerimeterTouch(this.edgeright)) {
        //             if (circle.anchored >= -1) {
        //                 circle.anchored = 1

        //         // ////////console.log("anchired l?")
        //                 circle.anchor = this.edgeright
        //             }
        //             if (player.body.y > circle.y) {
        //                 circle.x++
        //             }
        //         }
        //     }

        //     const stagepoint = this.shape.innerShape(circle)
        //     if(stagepoint != false){
        //         const dis = (stagepoint.radius+circle.radius)-(new LineOP(circle, stagepoint).hypotenuse())
        //         const angle = new LineOP(circle, stagepoint).angle()
        //         if(circle.x > this.edgeleft.x && circle.x < this.edgeright){
        //             circle.x += dis*(Math.cos(angle))
        //         }
        //         circle.y += dis*(Math.sin(angle))
        //         if(player.jumping == 1 && circle == player.body){
        //             circle.ymom = 0
        //         }else{
        //             circle.ymom *= (Math.sin(angle)*.6)
        //         }
        //         if(circle == player.body){
        //             if(circle.ymom >= 0){
        //                 player.grounded = 1
        //                 player.jumping = 0
        //             }
        //         }
        //     }



        // }
    }

    class MapIcon {
        constructor(bricks, walls) {
            this.links = []
            this.active = 0
            this.index = mapIcons.length
            this.yindex = Math.floor(mapIcons.length / 7)
            this.xindex = mapIcons.length % 7
            this.box = new Rectangle(this.xindex * 400, this.yindex * 300, 400, 300, "#FF000030")
            this.xindex += .15
            this.scale = 15
            for (let t = 0; t < bricks.length; t++) {
                const link = new Line((bricks[t].edgeleft.x / this.scale) + this.xindex * 400, (bricks[t].edgeleft.y / this.scale) + this.yindex * 300, (bricks[t].edgeright.x / this.scale) + this.xindex * 400, (bricks[t].edgeright.y / this.scale) + this.yindex * 300, "#FFFFFF", 4)
                this.links.push(link)
            }
            for (let t = 0; t < walls.length; t++) {
                const link = new Line((walls[t].topcap.x / this.scale) + this.xindex * 400, (walls[t].topcap.y / this.scale) + this.yindex * 300, (walls[t].basecap.x / this.scale) + this.xindex * 400, (walls[t].basecap.y / this.scale) + this.yindex * 300, "#FFFFFF", 4)
                this.links.push(link)
            }
            mapIcons.push(this)
        }
        draw() {
            if (MapSelect == this.index) {
                this.box.draw()
            }
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].draw()
            }
            canvas_context.font = "40px arial"
            canvas_context.fillStyle = "#FFFF00"
            canvas_context.fillText(this.index, this.box.x + 5, this.box.y + 40)
        }
    }
    class MiniGameIcon {
        constructor() {
            this.links = []
            this.active = 0
            this.index = minigameIcons.length
            this.yindex = Math.floor(minigameIcons.length / 7)
            this.xindex = minigameIcons.length % 7
            this.box = new Rectangle(this.xindex * 400, this.yindex * 300, 400, 300, "#FF000030")
            this.xindex += .15
            this.scale = 15
            minigameIcons.push(this)
        }
        draw() {
            if (minigameSelected == this.index) {
                this.box.draw()
            }
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].draw()
            }
            canvas_context.font = "40px arial"
            canvas_context.fillStyle = "#FFFF00"
            if(this.index == 0){
            canvas_context.fillText("GeGeGeGee Drop!", this.box.x + 15, this.box.y + 95)
            if(worldscore.gegegegeedropmin == 999999999){
                canvas_context.fillText(`Fastest ??`, this.box.x + 15, this.box.y + 155)
            }else{
                canvas_context.fillText(`Fastest ${worldscore.gegegegeedropminstr}`, this.box.x + 15, this.box.y + 155)
            }
            }else if(this.index == 1){
            canvas_context.fillText("Smashout!", this.box.x + 75, this.box.y + 95)
            canvas_context.fillText(`Distance ${Math.round(worldscore.smashoutmax)}`, this.box.x + 15, this.box.y + 155)
            }else if(this.index == 2){
            canvas_context.fillText("Running of the Jox!", this.box.x + 15, this.box.y + 95)
            canvas_context.fillText(`Avoided ${worldscore.joxwallscoremax}`, this.box.x + 15, this.box.y + 155)
            }else if(this.index == 3){
            canvas_context.fillText("Joule Pop!", this.box.x + 75, this.box.y + 95)
            canvas_context.fillText(`Popped ${worldscore.joulepopscoremax}`, this.box.x + 75, this.box.y + 155)
            }else if(this.index == 4){
            canvas_context.fillText("Mass Blast!", this.box.x + 75, this.box.y + 95)
            canvas_context.fillText(`Shot ${worldscore.masstargetscoremax}`, this.box.x + 75, this.box.y + 155)
            }else if(this.index == 5){
            canvas_context.fillText("Rhopho Sort!", this.box.x + 75, this.box.y + 95)
            canvas_context.fillText(`Sorted ${worldscore.rhophosortscoremax}`, this.box.x + 75, this.box.y + 155)
            }else if(this.index == 6){
            canvas_context.fillText("Funky Swinging!", this.box.x + 45, this.box.y + 95)
            canvas_context.fillText(`Height reached ${Math.round(worldscore.funkyclimbscoremax)}`, this.box.x + 45, this.box.y + 155)
            }else if(this.index == 7){
            canvas_context.fillText("Whack a Boy!", this.box.x + 55, this.box.y + 95)
            canvas_context.fillText(`Whacked ${worldscore.coreboywhackscoremax}`, this.box.x + 55, this.box.y + 155)
            }else if(this.index == 8){
            canvas_context.fillText("Adobrasig Ball!", this.box.x + 65, this.box.y + 95)
            }else if(this.index == 9){
            canvas_context.fillText("Blast Climb!", this.box.x + 75, this.box.y + 95)
            canvas_context.fillText(`Climbed ${worldscore.blastgirlclimbscoremax}`, this.box.x + 75, this.box.y + 155)
            }else if(this.index == 10){
            canvas_context.fillText("Banandroid Skip!", this.box.x + 45, this.box.y + 95)
            canvas_context.fillText(`Jumped for ${worldscore.banandroidtimemax}`, this.box.x + 45, this.box.y + 155)
            }else if(this.index == 11){
            canvas_context.fillText("Soto Scramble!", this.box.x + 20, this.box.y + 95)
            canvas_context.fillText(`Dodged for ${worldscore.sototimemax}`, this.box.x + 45, this.box.y + 155)
            }else if(this.index == 12){
            canvas_context.fillText("Kessler's Careen!", this.box.x + 40, this.box.y + 95)
            canvas_context.fillText(`Careened for ${worldscore.kesslerscoremax}`, this.box.x + 45, this.box.y + 155)
            }else{
            canvas_context.fillText(this.index, this.box.x + 15, this.box.y + 95)
            }
        }w
    }



    let stage = new Stage(MapSelect)

    for (let t = 0; t < 35; t++) {
        const iconStage = new Stage(t)
        const icon = new MapIcon(iconStage.bricks, iconStage.walls)
    }
    for (let t = 0; t < 12; t++) {
        const icon = new MiniGameIcon()
    }

    class Explosion {
        constructor(x, color) {
            this.count = -90
            this.center = x
            this.links = []
            for (let t = 0; t < 12; t++) {
                const curve = ((Math.random() - .5) * 150)
                const link = new Line(this.center + curve, 720 + (Math.abs(curve) * 2), this.center + curve, 10000 + ((Math.random() - .5) * 1000), getRandomLightColor(), 10)
                if (Math.random() < .5) {
                    link.color = color
                }
                this.links.push(link)
            }
        }
        draw() {
            this.count += 5.5
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].draw()
                this.links[t].width -= .5
                if (this.links[t].width < 1) {
                    this.links[t].width = 1
                }
                this.links[t].y1 += this.count
            }
        }
    }

    class ExplosionLeft {
        constructor(x, color) {
            this.count = -90
            this.center = x
            this.links = []
            for (let t = 0; t < 12; t++) {
                const curve = ((Math.random() - .5) * 150)
                const link = new Line(1180 + (Math.abs(curve) * 2), this.center + curve, 10000 + ((Math.random() - .5) * 1000), this.center + curve, getRandomLightColor(), 10)
                if (Math.random() < .5) {
                    link.color = color
                }
                this.links.push(link)
            }
        }
        draw() {
            this.count += 5.5
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].draw()
                this.links[t].width -= .5
                if (this.links[t].width < 1) {
                    this.links[t].width = 1
                }
                this.links[t].x1 += this.count
            }
        }
    }

    class ExplosionRight {
        constructor(x, color) {
            this.count = -90
            this.center = x
            this.links = []
            for (let t = 0; t < 12; t++) {
                const curve = ((Math.random() - .5) * 150)
                const link = new Line(1180 + (Math.abs(curve) * 2), this.center + curve, -10000 + ((Math.random() - .5) * 1000), this.center + curve, getRandomLightColor(), 10)
                if (Math.random() < .5) {
                    link.color = color
                }
                this.links.push(link)
            }
        }
        draw() {
            this.count += 5.5
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].draw()
                this.links[t].width -= .5
                if (this.links[t].width < 1) {
                    this.links[t].width = 1
                }
                this.links[t].x1 -= this.count
            }
        }
    }

    class ExplosionTop {
        constructor(x, color) {
            this.count = -90
            this.center = x
            this.links = []
            for (let t = 0; t < 12; t++) {
                const curve = ((Math.random() - .5) * 150)
                const link = new Line(this.center + curve, 720 + (Math.abs(curve) * 2), this.center + curve, -10000 + ((Math.random() - .5) * 1000), getRandomLightColor(), 10)
                if (Math.random() < .5) {
                    link.color = color
                }
                this.links.push(link)
            }
        }
        draw() {
            this.count += 5.5
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].draw()
                this.links[t].width -= .5
                if (this.links[t].width < 1) {
                    this.links[t].width = 1
                }
                this.links[t].y1 -= this.count
            }
        }
    }


    class Boy {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                if (AItoggle == 1 || localPlayToggle == 1) {
                    if (meshtoggle == 1) {
                        if (boys.length == 1) {
                            this.meshinputs = []
                            for (let t = 0; t < 200; t++) {
                                this.meshinputs.push(Math.random() - .5)
                            }
                            // //////////console.log(coreboyvcoreboymesh)
                            //bakedcoreboy
                            //overnight
                            this.mesh = new GenNN(this.meshinputs, 4, [66, 66, 24, 10], 10)
                        }
                    }
                }
                this.ping = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 1
                this.serverID = serverID
                this.shotdraw = 0
                this.id = controller //boys.length
                this.shielddraw = 0
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 0
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shot = {}
                this.striker = 10000
                this.name = "Coreboy"
                this.blasting = 40 // 0
                this.recovering = 0
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.wmove = 0
                this.amove = 0
                this.dmove = 0
                this.exgrip = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.storeshield = 0
                this.face = 0
                this.shots = []
                this.wasfalse = []
                this.controller = controller
                this.armlength = 30
                this.shoulderwidth = 8
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 11.5 //11.5
                if(minigameSelected == 7){
                    this.speed = 18
                }
                this.punchspeed = 6.5
                this.grounded = 0
                this.frame = 0
                this.jumping = 1
                this.jumpcount = 100

                this.color = getRandomColor()
                this.body = new Circle(400 + (Math.random() * 2560), 500, 37, this.color)

                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.nodes.push(this.body)
                this.leftshoulder = new Circle(this.body.x - (this.body.radius + this.shoulderwidth), 350, 10, "magenta", 0, 0, .999)
                this.rightshoulder = new Circle(this.body.x + (this.body.radius + this.shoulderwidth), 350, 10, "#FF0000", 0, 0, .999)
                this.lefthand = new Circle(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 27, "magenta", 0, 0, .85) //26
                this.righthand = new Circle(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 27, "#FF0000", 0, 0, .85) //26
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.gravity = 1
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = -1
                this.bodyx = this.body.x
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {
                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]

                    // const keys2 = Object.keys(args[keys[t]])
                    // // if(keys2.length > 1){
                    //     for(let j = 0; j<keys2.length;j++){
                    //     this[keys[t]][keys2[j]] = args[keys[t]][keys2[j]]
                    //  }
                }
                // ////////////// ////////////////////////////////////////////console.log(args)
                this.armlength = 30
                this.shoulderwidth = 8
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                // //////////// ////////////////////////////////////////////console.log(this.shotdraw)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    this.nodes[t] = new Circle(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }
                    this.nodes[t].id = idsto
                }

                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                    this.shots[t] = new Shot(this.shots[t].x, this.shots[t].y, this.shots[t].radius, this.shots[t].color, this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                    this.shots[t].id = idsto

                }
                this.id = args["id"]
                this.frame = args['frame']
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }
                this.rightshoulder = this.nodes[2]
                this.leftshoulder = this.nodes[1]
                this.righthand = this.nodes[3]
                this.lefthand = this.nodes[4]

                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }
            }
        }

        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            object.ymom = -this.speed * 1 * 2
                        } else {
                            if (this.lefthand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                            if (this.righthand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 2
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = 10000//this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            const copy = new Boy(this.controller)
            if (this.hasOwnProperty("mesh")) {
                this.mesh.reduceWrapper()



                copy.mesh = this.mesh.freshClone(this.meshinputs)
                // copy.mesh.mutate()
            }
            copy.id = this.id
            copy.frame = this.frame
            copy.body.color = this.body.color
            if (this.inactive == 1) {
                copy.inactive = 1
            } copy.serverID = this.serverID
            copy.striker = 10000 //this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

            return copy
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }

            this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            this.leftshoulder.y = this.body.y - (this.shoulderwidth)

            this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            this.rightshoulder.y = this.body.y - (this.shoulderwidth)

            this.leftshoulder.color = this.body.color
            this.rightshoulder.color = this.body.color
            this.lefthand.color = this.body.color
            this.righthand.color = this.body.color


            if (this.lefthand.anchored == 0) {
                this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth)))
                this.lefthand.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth))
                this.leftshoulder.xmom *= 0
                this.leftshoulder.ymom *= 0
            }
            if (this.righthand.anchored == 0) {
                this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth)))
                this.righthand.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth))
                this.rightshoulder.xmom *= 0
                this.rightshoulder.ymom *= 0
            }

            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }



            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2
                this.lefthand.ymom = -this.speed * 2
                this.righthand.ymom = -this.speed * 2
                this.jumpcount = 100

            }
        }

        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (this.shield == 1) {
                                            this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                        } else {
                                            this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 200)) + (boys[t].shots[k].xmom * baselaunch)) * 2
                                            this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 200)) + (boys[t].shots[k].ymom * baselaunch)) * 2) - (10 * (this.damage / 200))
                                            this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                            this.breaktimer = 0
                                        }
                                        boys[t].shots[k].marked = 1
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('radball')) {
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }
                            const enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }


                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }

                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 200)) + (boys[t].bananahand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 200)) + (boys[t].bananahand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 200)) + (boys[t].middlehand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 200)) + (boys[t].middlehand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }

                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 200)) + (boys[t].righthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 200)) + (boys[t].righthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14

                                            this.shotIDs.push(boys[t].righthand2.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 200)) + (boys[t].lefthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 200)) + (boys[t].lefthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 200)) + (boys[t].righthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 200)) + (boys[t].righthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 200)) + (boys[t].lefthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 200)) + (boys[t].lefthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)

                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }


                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 200)) + (boys[t].righthand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 200)) + (boys[t].righthand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }

                            if (boys[t].lefthand.fired > 14) {
                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)
                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            } else {
                                                this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 200)) + (boys[t].lefthand.xmom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 200)) + (boys[t].lefthand.ymom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)) * 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }

                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 200)) + (boys[t].body.xmom * baselaunch) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].body.ymom * (this.damage / 200)) + (boys[t].body.ymom * baselaunch)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        this.fixupshoulder()
                        boys[f].fixupshoulder()
                        this.body.ymom *= .99
                    }
                }
            }
            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        doJump(object, speed) {

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -speed * 2
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 2
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {
            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            this.jumpcount--
            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }
            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }
        fightcontrol() {
            if (this.inactive == 1) {
                return
            }

            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()
            this.righthand.fired--
            this.lefthand.fired--
            this.breaktimer--
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }


            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                    if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {
                        if (this.face == 1) {
                            if (this.righthand.fired <= 0) {
                                if (this.righthand.anchored == 0) {
                                    this.righthand.ymom = 0 + (this.body.ymom * 2)
                                    this.righthand.xmom = this.punchspeed * 14
                                    this.righthand.fired = 18
                                    this.idify()
                                }
                            }
                        }
                        if (this.face == -1) {
                            if (this.lefthand.fired <= 0) {
                                if (this.lefthand.anchored == 0) {
                                    this.lefthand.ymom = 0 + (this.body.ymom * 2)
                                    this.lefthand.xmom = -this.punchspeed * 14
                                    this.lefthand.fired = 18
                                    this.idify()
                                }
                            }
                        }
                    }


                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.righthand.ymom = -this.punchspeed * 14 + (this.body.ymom * 2)
                                this.righthand.xmom = this.punchspeed * 1
                                this.righthand.fired = 18
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.lefthand.ymom = -this.punchspeed * 14 + (this.body.ymom * 2)
                                this.lefthand.xmom = -this.punchspeed * 1
                                this.lefthand.fired = 18
                                this.idify()
                            }
                        }
                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                                this.righthand.xmom = this.punchspeed * 9
                                this.righthand.fired = 18
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                                this.lefthand.xmom = -this.punchspeed * 9
                                this.lefthand.fired = 18
                                this.idify()
                            }
                        }
                    }


                    if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
                        if (this.lefthand.fired <= 0) {
                            if (this.righthand.fired <= 0) {
                                this.shot = new Shot(this.body.x, this.body.y, 20, "#bbbbbb", 0, (this.speed * 2.5))
                                this.shots.push(this.shot)
                                if (this.body.ymom > -jumplimit) {
                                    this.body.ymom -= 8
                                    if (this.body.ymom < -jumplimit) {
                                        this.body.ymom = -jumplimit
                                    }
                                } else {
                                }
                                this.lefthand.fired = 12
                                this.righthand.fired = 12
                            }
                        }
                    }
                }
            }
        }
        meshCompute() {

            if (AItoggle == 1 || localPlayToggle == 1) {
                if (meshtoggle == 1 && this.hasOwnProperty('mesh')) {
                    if (boys.length == 2) {
                        this.meshinputs = []
                        this.meshinputs.push(this.damage)
                        this.meshinputs.push(Math.max(this.breaktimer, -1))
                        this.meshinputs.push(this.grounded)
                        this.meshinputs.push(this.shield)
                        this.meshinputs.push(this.shieldpower)
                        this.meshinputs.push(this.lefthand.anchored)
                        this.meshinputs.push(this.righthand.anchored)
                        this.meshinputs.push(Math.max(this.lefthand.fired, 0))
                        this.meshinputs.push(Math.max(this.righthand.fired, 0))
                        this.meshinputs.push(Math.max(this.body.fired, 0))
                        this.meshinputs.push(Math.max(this.blasting, 0))
                        this.meshinputs.push(this.face)
                        this.meshinputs.push(this.jumping)
                        this.meshinputs.push(Math.max(this.jumpcount, -20))
                        this.meshinputs.push(this.safe)
                        for (let k = 0; k < this.nodes.length; k++) {

                            const x = (this.nodes[k].x - (canvas.width * (invscale * .5))) / (canvas.width * (invscale * .5))
                            const y = (this.nodes[k].y - (canvas.height * (invscale * .5))) / (canvas.height * (invscale * .5))
                            this.meshinputs.push(x)
                            this.meshinputs.push(y)
                            this.meshinputs.push(this.nodes[k].radius)
                            this.meshinputs.push(this.nodes[k].xmom)
                            this.meshinputs.push(this.nodes[k].ymom)
                        }



                        for (let t = 0; t < boys.length; t++) {
                            if (this != boys[t]) {
                                this.meshinputs.push(boys[t].damage)
                                this.meshinputs.push(Math.max(boys[t].breaktimer, -1))
                                this.meshinputs.push(boys[t].grounded)
                                this.meshinputs.push(boys[t].shield)
                                this.meshinputs.push(boys[t].shieldpower)
                                this.meshinputs.push(boys[t].lefthand.anchored)
                                this.meshinputs.push(boys[t].righthand.anchored)
                                this.meshinputs.push(Math.max(boys[t].lefthand.fired, 0))
                                this.meshinputs.push(Math.max(boys[t].righthand.fired, 0))
                                this.meshinputs.push(Math.max(boys[t].body.fired, 0))
                                this.meshinputs.push(Math.max(boys[t].blasting, 0))
                                this.meshinputs.push(boys[t].face)
                                this.meshinputs.push(boys[t].jumping)
                                this.meshinputs.push(Math.max(boys[t].jumpcount, -20))
                                this.meshinputs.push(boys[t].safe)
                                for (let k = 0; k < boys[t].nodes.length; k++) {
                                    const x = (boys[t].nodes[k].x - (canvas.width * (invscale * .5))) / (canvas.width * (invscale * .5))
                                    const y = (boys[t].nodes[k].y - (canvas.height * (invscale * .5))) / (canvas.height * (invscale * .5))


                                    this.meshinputs.push(x)
                                    this.meshinputs.push(y)
                                    this.meshinputs.push(boys[t].nodes[k].radius)
                                    this.meshinputs.push(boys[t].nodes[k].xmom)
                                    this.meshinputs.push(boys[t].nodes[k].ymom)
                                }
                            }
                        }
                        this.mesh.changeInputs(this.meshinputs)
                        for (let t = 0; t < this.meshinputs.length; t++) {
                            if (isNaN(this.meshinputs[t])) {
                                this.meshinputs[t] = 0
                            }
                        }
                        // this.mesh.longInputs.push([...this.meshinputs])

                    }
                }
            }
        }
        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                // this.fleeing = 1 //aitesting
            }
            if (this.charge > 90) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }

            this.recovering = 0

            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + Math.max(this.body.radius, boys[t].body.radius))) {
                        this.wmove = 1
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        if (Math.random() < .2) {
                            this.wmove = 1
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }

            this.recovering = 0

            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }

            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    this.downspike = 1
                    this.wmove = 1
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    this.downspike = 1
                }
            }
            this.exgrip = 0
            for (let t = 0; t < boys.length; t++) {
                if (this.amomu <= 0 && this.dmomu <= 0) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].brick.center.y > this.brick.center.y) {
                            if (boys[t].body.x < this.body.x) {
                                this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                this.amomu += 15
                                this.exgrip = 1
                            } else {
                                this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                this.dmomu += 15
                                this.exgrip = 1
                            }
                        }
                    }
                } else {
                    this.exgrip = 1
                }
            }





            if (this.dmom > 0) {
                this.screwshot = 1
                this.dmove = 1
                this.wmove = 1
                this.amove = 0
                this.amom = 0
            } else {

                if (this.dmomu > 0) {
                    this.dmove = 1
                    this.amove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }
            if (this.amom > 0) {
                this.screwshot = 1
                this.dmom = 0
                this.amove = 1
                this.wmove = 1
                this.dmove = 0
            } else {
                if (this.amomu > 0) {
                    this.amove = 1
                    this.dmove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }

            if (this.safe == 0) {
                this.downspike = 1
                if (this.body.x > (this.brick.center.x)) {
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                } else {
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }


            if (this.trapped == 0) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]
                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        const runtimeR = xdisR / this.speed
                                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .8)) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.downspike = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        const runtimeL = xdisL / this.speed
                                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .8)) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.downspike = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }
                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        const runtimeR = xdisR / this.speed
                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .87)) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.downspike = 1
                                this.wmove = 1
                            }
                        }
                    } else {
                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        const runtimeL = xdisL / this.speed
                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .87)) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.downspike = 1
                                this.wmove = 1
                            }
                        }
                    }

                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }

            if (this.body.y < 900) {
                this.wmove = 0
                this.downspike = 0
            }
            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }



                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1

                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }


                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }

                if (object == this.body) {
                    if (this.hasOwnProperty('mesh')) {
                        this.meshCompute()

                        if (meshRun == 1) {

                            if (object == this.body) {
                                this.errors = [this.wmove, this.dmove, this.amove, this.exgrip]
                                this.wmove = Math.round(this.mesh.outputMagnitudes[0])
                                this.amove = Math.round(this.mesh.outputMagnitudes[1])
                                this.dmove = Math.round(this.mesh.outputMagnitudes[2])
                                if (isNaN(this.dmove)) {
                                    this.dmove = 0
                                }
                                if (isNaN(this.amove)) {
                                    this.amove = 0
                                }
                                this.exgrip = Math.round(this.mesh.outputMagnitudes[3])
                                if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[4])) {
                                    this.screwshot = 1
                                    this.downspike = 0
                                    this.hortsmash = 0
                                }
                                if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[5])) {
                                    this.downspike = 1
                                    this.screwshot = 0
                                    this.hortsmash = 0
                                }
                                if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[6])) {
                                    this.hortsmash = 1
                                    this.screwshot = 0
                                    this.downspike = 0
                                }
                                this.rightshot = Math.round(this.mesh.outputMagnitudes[7])
                                this.leftshot = Math.round(this.mesh.outputMagnitudes[8])
                                this.storeshield = Math.round(this.mesh.outputMagnitudes[9])
                            }
                        }
                    }
                }

                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 2
                    } else {
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                    }
                }

                if (!this.hasOwnProperty('mesh')) {
                    if (this.dmove == 1) {
                        this.face = 1
                        if (object == this.body) {
                            object.x += speed
                            this.righthand.x += speed
                            this.lefthand.x += speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    if (this.amove == 1) {
                        this.face = -1
                        if (object == this.body) {
                            object.x -= speed
                            this.righthand.x -= speed
                            this.lefthand.x -= speed
                        }
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }
                } else {



                    if (this.dmove > this.amove) {
                        if (object == this.body) {
                            this.face = 1
                            object.x += speed//*this.dmove
                            this.righthand.x += speed//*this.dmove
                            this.lefthand.x += speed//*this.dmove
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    } else if (this.dmove < this.amove) {
                        if (object == this.body) {
                            this.face = -1
                            object.x -= speed//*this.amove
                            this.righthand.x -= speed//*this.amove
                            this.lefthand.x -= speed//*this.amove
                        }
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }
                }
                if (this.exgrip == 1) {
                    this.righthand.anchored = 0
                    this.lefthand.anchored = 0
                }
            } else {

                if (this.hasOwnProperty('mesh')) {
                    if (object == this.body) {
                        this.errors = [this.wmove, this.dmove, this.amove, this.exgrip]
                    }
                }
            }
        }
        AI() {
            this.idify()
            if (this.inactive == 1) {
                return
            }

            this.breaks()
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].marked == 1) {
                    this.shots.splice(t, 1)
                } else {
                    this.shots[t].marked--
                }
            }

            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }



            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.rightshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {


                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if (link.hypotenuse() + (this.body.radius + boys[t].shots[g].radius) / (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) < 40) {
                            this.storeshield = 1
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 45 && this.body.y < boys[t].body.y) {
                        this.downspike = 1
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {
                        this.hortsmash = 1
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < 70 && this.body.y > boys[t].body.y) {
                        this.screwshot = 1
                    } else if (this.body.y - boys[t].body.y > 100) {
                        if (Math.random() < .01) {
                            this.downspike = 1
                        }
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == 1) {
                                this.hortsmash = 1
                            }
                        }
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == -1) {
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .09) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    this.leftshot = 1
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.leftshot = 0
                                    }
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    this.rightshot = 1
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.rightshot = 0
                                    }
                                }
                            }
                        }
                    }


                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }

            if (this.safe == 0) {
                if (this.recovering == 1) {
                    this.downspike = 1
                }
            }

            this.breaks()
            this.righthand.fired--
            this.lefthand.fired--
            this.breaktimer--
            if (Math.random() < .1) {
                this.storeshield = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .94) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (boys[t].lefthand.fired > 14) {
                        if (this.body.x < boys[t].body.x) {
                            if (Math.random() < .94) {
                                this.storeshield = 1
                            }
                        }
                    }
                }
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (this.grounded == 1) {
                                if (boys[t].shots[g].stuck != 1) {
                                    this.storeshield = 1
                                } else {
                                    this.wmove = 1
                                }
                            } else {
                                if (this.body.x < boys[t].shots[g].x) {
                                    if (this.amom <= 0 && this.dmom <= 0) {
                                        this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                        this.amove = 1
                                        this.dmove = 0
                                    }
                                } else {
                                    if (this.amom <= 0 && this.dmom <= 0) {
                                        this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                        this.amove = 0
                                        this.dmove = 1
                                    }
                                }
                            }
                            break
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].shots[g].x) {
                                            if (this.amom <= 0 && this.dmom <= 0) {
                                                this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                this.amove = 1
                                                this.dmove = 0
                                            }
                                        } else {
                                            if (this.amom <= 0 && this.dmom <= 0) {
                                                this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                this.amove = 0
                                                this.dmove = 1
                                            }
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        this.wmove = 1
                                        this.screwshot = 1
                                    }
                                }
                            }
                        }
                    }
                }
            }

            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }

            if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        this.shieldpower -= .63
                        this.shield = 1
                        this.shielddraw = 1
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }

            if (this.breaktimer <= 0 && this.shield == 0) {

                if (meshRun == 1) {
                    if (this.hasOwnProperty('mesh')) {
                        this.errors.push(this.screwshot)
                        this.errors.push(this.downspike)
                        this.errors.push(this.hortsmash)
                        this.errors.push(this.rightshot)
                        this.errors.push(this.leftshot)
                        this.errors.push(this.storeshield)
                        this.wmove = Math.round(this.mesh.outputMagnitudes[0])
                        this.amove = Math.round(this.mesh.outputMagnitudes[1])
                        this.dmove = Math.round(this.mesh.outputMagnitudes[2])
                        if (isNaN(this.dmove)) {
                            this.dmove = 0
                        }
                        if (isNaN(this.amove)) {
                            this.amove = 0
                        }
                        this.exgrip = Math.round(this.mesh.outputMagnitudes[3])
                        if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[4])) {
                            this.screwshot = 1
                            this.downspike = 0
                            this.hortsmash = 0
                        }
                        if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[5])) {
                            this.downspike = 1
                            this.screwshot = 0
                            this.hortsmash = 0
                        }
                        if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[6])) {
                            this.hortsmash = 1
                            this.screwshot = 0
                            this.downspike = 0
                        }
                        this.rightshot = Math.round(this.mesh.outputMagnitudes[7])
                        this.leftshot = Math.round(this.mesh.outputMagnitudes[8])
                        this.storeshield = Math.round(this.mesh.outputMagnitudes[9])
                    }
                }

                if (this.downspike == 1) {
                    if (this.lefthand.fired <= 0) {
                        if (this.righthand.fired <= 0) {
                            this.shot = new Shot(this.body.x, this.body.y, 20, "#bbbbbb", 0, (this.speed * 2.5))
                            this.shots.push(this.shot)
                            if (this.body.ymom > -jumplimit) {
                                this.body.ymom -= 8
                                if (this.body.ymom < -jumplimit) {
                                    this.body.ymom = -jumplimit
                                }
                            } else {
                            }
                            this.lefthand.fired = 12
                            this.righthand.fired = 12
                        }
                    }
                }

                if (this.leftshot == 1 || this.rightshot == 1) {
                    if (this.face == 1) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.righthand.ymom = 0 + (this.body.ymom * 2)
                                this.righthand.xmom = this.punchspeed * 14
                                this.righthand.fired = 18
                            }
                        }
                    }
                    if (this.face == -1) {
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.lefthand.ymom = 0 + (this.body.ymom * 2)
                                this.lefthand.xmom = -this.punchspeed * 14
                                this.lefthand.fired = 18
                            }
                        }
                    }
                }

                if (this.body.y < 900) {
                    this.wmove = 0
                    this.screwshot = 0
                }

                if (AItoggle == 1 || localPlayToggle == 1) {
                    if (meshtoggle == 1 && this.hasOwnProperty('mesh')) {
                        if (meshRun == 1) {
                            this.wmove = Math.round(this.mesh.outputMagnitudes[0])
                            this.amove = Math.round(this.mesh.outputMagnitudes[1])
                            this.dmove = Math.round(this.mesh.outputMagnitudes[2])
                            if (isNaN(this.dmove)) {
                                this.dmove = 0
                            }
                            if (isNaN(this.amove)) {
                                this.amove = 0
                            }
                            this.exgrip = Math.round(this.mesh.outputMagnitudes[3])
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[4])) {
                                this.screwshot = 1
                                this.downspike = 0
                                this.hortsmash = 0
                            }
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[5])) {
                                this.downspike = 1
                                this.screwshot = 0
                                this.hortsmash = 0
                            }
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[6])) {
                                this.hortsmash = 1
                                this.screwshot = 0
                                this.downspike = 0
                            }
                            this.rightshot = Math.round(this.mesh.outputMagnitudes[7])
                            this.leftshot = Math.round(this.mesh.outputMagnitudes[8])
                            this.storeshield = Math.round(this.mesh.outputMagnitudes[9])
                        }
                    }
                }


                if (this.screwshot == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.righthand.ymom = -this.punchspeed * 14 + (this.body.ymom * 2)
                            this.righthand.xmom = this.punchspeed * 1
                            this.righthand.fired = 18
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.lefthand.ymom = -this.punchspeed * 14 + (this.body.ymom * 2)
                            this.lefthand.xmom = -this.punchspeed * 1
                            this.lefthand.fired = 18
                        }
                    }
                }

                if (this.hortsmash == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                            this.righthand.xmom = this.punchspeed * 9
                            this.righthand.fired = 18
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                            this.lefthand.xmom = -this.punchspeed * 9
                            this.lefthand.fired = 18
                        }
                    }
                }

            } else {

                if (meshRun == 1) {

                    if (this.hasOwnProperty('mesh')) {
                        this.errors.push(this.screwshot)
                        this.errors.push(this.downspike)
                        this.errors.push(this.hortsmash)
                        this.errors.push(this.rightshot)
                        this.errors.push(this.leftshot)
                        this.errors.push(this.storeshield)
                    }
                }
            }

            if (meshLearn == 1) {

                if (this.hasOwnProperty('mesh')) {
                    if (this.hasOwnProperty('meshinputs')) {
                        if (this.hasOwnProperty('errors')) {
                            for (let t = 0; t < this.meshinputs.length; t++) {
                                if (isNaN(this.meshinputs[t])) {
                                    this.meshinputs[t] = 0
                                }
                            }
                            this.mesh.longInputs.push([...this.meshinputs])
                            for (let t = 0; t < this.errors.length; t++) {
                                if (isNaN(this.errors[t])) {
                                    this.errors[t] = 0
                                }
                            }
                            this.mesh.longErrors.push([...this.errors])
                        }
                    }
                }
            }
        }
        degripl() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        degripr() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        collideStage() {
            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {
            if (this.inactive == 1) {
                return
            }
            if (this.hasOwnProperty('mesh')) {
                if (keysPressed['p']) {
                    this.mesh.mutate()
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.grounded = 0
            this.frame++

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.shots.length; t++) {
                    this.shots[t].radius *= 1.02
                    this.shots[t].ymom *= 1.02
                    this.shots[t].move()
                    if (this.shots[t].marked <= 0) {
                        this.shots[t].draw()
                    }
                    if (this.shots[t].radius > 35) {
                        this.shots[t].marked = 1
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].draw()
                        }
                    }
                }
            }

            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].marked == 1) {
                    this.shots.splice(t, 1)
                } else {
                    this.shots[t].marked--
                }
            }
            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.collideStage()
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].color = invertColor(this.body.color)
                if (this.hasOwnProperty('mesh')) {
                    this.links[t].color = invertColor(this.mesh.name)
                }
                this.links[t].draw()
            }
            for (let t = 0; t < this.nodes.length; t++) {

                if (this.hasOwnProperty('mesh')) {
                    this.nodes[t].color = this.mesh.name
                }
                this.nodes[t].draw()
            }

            // if (this.controller == 0) {
            const link = new Line(this.body.x, this.body.y, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y, invertColor(this.body.color), this.body.radius * .2)

            canvas_context.lineWidth = 0
            canvas_context.strokeStyle = invertColor(this.body.color)
            canvas_context.beginPath();
            canvas_context.arc((link.x1 + link.x2) * .5, link.y1 - this.body.radius * .09, this.body.radius * .4, 0, (Math.PI * 1), true)
            canvas_context.fillStyle = invertColor(this.body.color)
            canvas_context.fill()
            // canvas_context.stroke();
            link.draw()
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.lefthand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
            canvas_context.font = "42px arial"

            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 70)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 70)
            canvas_context.fillStyle = "white"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 110)
            }


            // this.bodyx = this.body.x
        }
        operate() {

            if (this.inactive == 1) {
                return
            }

            if (this.righthand.anchored == 1) {
                if (this.body.x > this.righthand.x) {
                    this.righthand.anchored = -10
                }
            }
            if (this.lefthand.anchored == 1) {
                if (this.body.x < this.lefthand.x) {
                    this.lefthand.anchored = -10
                }
            }

            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {
            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                } else {

                    if (this.hasOwnProperty('mesh')) {
                        this.meshCompute()

                        if (meshRun == 1) {

                            this.errors = [this.wmove, this.dmove, this.amove, this.exgrip]
                            this.wmove = Math.round(this.mesh.outputMagnitudes[0])
                            this.amove = Math.round(this.mesh.outputMagnitudes[1])
                            this.dmove = Math.round(this.mesh.outputMagnitudes[2])
                            if (isNaN(this.dmove)) {
                                this.dmove = 0
                            }
                            if (isNaN(this.amove)) {
                                this.amove = 0
                            }
                            this.exgrip = Math.round(this.mesh.outputMagnitudes[3])
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[4])) {
                                this.screwshot = 1
                                this.downspike = 0
                                this.hortsmash = 0
                            }
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[5])) {
                                this.downspike = 1
                                this.screwshot = 0
                                this.hortsmash = 0
                            }
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[6])) {
                                this.hortsmash = 1
                                this.screwshot = 0
                                this.downspike = 0
                            }
                            this.rightshot = Math.round(this.mesh.outputMagnitudes[7])
                            this.leftshot = Math.round(this.mesh.outputMagnitudes[8])
                            this.storeshield = Math.round(this.mesh.outputMagnitudes[9])
                        }

                    }

                }
            }
            // }

            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.body.ymom *= .7
                    this.body.symom = this.leftshoulder.ymom * .99
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.body.ymom *= .7
                    this.body.symom = this.rightshoulder.ymom * .99
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     this.body.sxmom *= .5
                    // }
                }
                this.body.ymom += this.gravity
            } else {

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            } else {
                //this.collideStage()
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            } else {
                //this.collideStage()
            }
            this.righthand.ymom += this.gravity
            this.lefthand.ymom += this.gravity



            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].frictiveMove(this)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].smove(this)
                }
            }
            this.lefthand.xmom += (this.lefthand.x - this.body.x) / 80
            this.righthand.xmom += (this.righthand.x - this.body.x) / 80
            this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40
            this.fixupshoulder()

            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

            // this.leftshoulder.xmom *= 0
            // this.leftshoulder.ymom *= 0

            // this.rightshoulder.xmom *= 0
            // this.rightshoulder.ymom *= 0

            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            if (boys.indexOf(this) <= humanPlayers) {

                this.fightcontrol()
            } else {
                this.AI()

                if (this.hasOwnProperty('mesh')) {
                    // this.mesh.errorReduce(this.errors, boys.indexOf(this))
                }
            }
            // }
            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }
        }
    }

    class Descriptor {
        constructor() {
            this.string = ''
            this.index = -2
            this.xpointer = 50
            this.ypointer = 1600
        }
        draw() {

            if(this.index == -2){
                this.string = 'Hello and welcome to Coreboys! Drag the selection token (at the top) to pick a character! Each fighter has different moves, WASD/left control stick to move, IJKL/Arrow keys/ABXY (on controller) to fight. O/RB to shield. Press escape to return to the main menu when in game.'
            }
          
            if(this.index == -1){
                this.string = ''
            }
            if (this.index == 0) {
                this.string = "Mass: A young sky bound fellow, ready to plumb the depths of the cosmos. Bright-faced and ready to fight, Mass fancies himself a hotshot."
            }
            if (this.index == 1) {
                this.string = "Coreboy: When Coreboy started as a fighter, his suit was more primitive than even the first suits used in the sport. Gradually over time the parts have been swapped out, leaving only the pilot's core untouched. Coreboy has a small suit of average speed and weight, but packs a huge punch."
            }
            if (this.index == 2) {
                this.string = "Blastgirl: Orphaned as a child by an explosion that left her sexually attracted to loud noises and fire. Blastgirl specializes in high energy bombardment. She can launch the blastwave at targets in a downward angle (L/B)."
            }
            if (this.index == 3) {
                this.string = "Jox: Jox, Jox, tougher than rocks, fight him with care or be reflected or blocked."
            }
            if (this.index == 4) {
                this.string = "Scorched Mass: An older, wiser, fellow. Time-burnt and hurtled into the past by what he calls a 'spherical quantum field eversion', he returned to the fighting circuit and now faces a past version of himself quite frequently in combat."
            }
            if (this.index == 5) {
                this.string = "Adobrasig Man: A man of the times, six arms and sixty fingers. His dexterity allows him to operate the most complicated of the suits. A super-cooled helium membrane gives Adobrasig Man a force-reflective counter attack (J/X)."
            }
            if (this.index == 6) {
                this.string = "Princess GeGeGeGee: A hoyden through and through despite her advanced corpulence. Her suit is equipped with inertial dampeners, to slow acceleration due to gravity, as well as two nutrient synthesis systems."
            }
            if (this.index == 7) {
                this.string = "Rhopho: Despite having no built in energy generation systems, Rhopho is powered by photosynthesis."
            }
            if (this.index == 8) {
                this.string = "Banandroid: An 'android' constructed from lab-cultured bull sperm whale brain tissue. Grown to command a prototypical gravity manipulation suit, Banandroid exhibits extreme aggression. Banandroid is equipped with a tetrad of charged energy cannons (L/B), a personal gravity nullifier (J/X), and powerful upwards (I/Y) and downward (K/A) punches."
            }
            if (this.index == 9) {
                this.string = "Funky Bunkstanks: An energy being that agreed to be packaged into a suit as the power source, partnered with ex-street-musician to form Funky Bunkstanks."
            }
            if (this.index == 10) {
                this.string = "Training Dummy: An extreme masochist. He chooses to 'pilot' the only suit with no movement or offensive capability. The higher shielding and padding built into the training dummy make it safer, but large."
            }
            if (this.index == 11) {
                this.string = "Doctor Soto: A true expert in gemology. The carbon compressor Doctor Soto is equipped with produces diamond spheres with high speed and efficiency. The compressor also serves a dual purpose as a sphere launcher, converting the diamond spheres into projectiles."
            }
            if (this.index == 12) {
                this.string = "Joule: More machine than human, Joule individually commands the exact poisitioning of the nanobots forming its signature move 'The Sievert Storm'. Joule prevents its own irradiation simply by pointing the gamma beam of each nanobot away from itself. Joule directs the sievert storm with its forward punch (L/B), down punch (K/A), and up punch (I/Y). Joule can amplify the sievert storm using its own powercells (J/X), however this severely hinders its self powered movement."
            }
            if (this.index == 13) {
                this.string = "Kessler: Cleaner of the cosmos, crash lander, and combat contestant."
            }
            if (this.index == 14) {
                this.string = "Pinwheelian: Anything is within the wheelhouse of this 2.6M woman from Pinwheel."
            }
            if (this.index == 15) {
                this.string = "Gwomp: A backwoods swamp lumberjack from Adufleigh. The compression system built into this fighter is able to amplify punches when it returns to a normal size."
            }

            if(minigameSelected != -1){
                this.index = 1000+minigameSelected

            if (this.index == 1000) {
                this.string = "Character: Princess GeGeGeGee. Guide Princess GeGeGeGee down the shaft as fast as you can! Ground-pound to speed up, jump to stop, and shoot shoulder rockets to brake."
            }
            if (this.index == 1001) {
                this.string = "Chatacter: Any. Hit the dummy until shortly before the walls come down at 16 seconds. Then launch it as far as you can!"
            }
            if (this.index == 1002) {
                this.string = "Character: Jox. Steer Jox around the walls with his dash and rocket jump."
            }
            if (this.index == 1003) {
                this.string = "Character: Joule. Use the sievert storm to shrink down and pop as many dummies as you can in a minute. The irradiated particles can cause a chain meltdown!"
            }
            if (this.index == 1004) {
                this.string = "Character: Mass. Jump and shoot the targets, get as many as you can in a minute."
            }
            if (this.index == 1005) {
                this.string = "Character: Rhopho. Sort the red and blue dummies into their color-baskets. Sort as many as you can in a minute. Don't worry about the ones in the wrong baskets."
            }
            if (this.index == 1006) {
                this.string = "Character: Funky Bunkstanks. Climb the trapeeze as fast as you can, avoid the auto shooter shots."
            }
            if (this.index == 1007) {
                this.string = "Character: Coreboy. Shoot down onto the emerging dummies, see how many you can get in a minute!!"
            }
            if (this.index == 1008) {
                this.string = "Character: Adobrasig Man, two players. Smack the dummies, see how many you can get into the opponent's goal! Select AI Match before selecting this Minigame to play agianst the computer."
            }
            if (this.index == 1009) {
                this.string = "Character: Blastgirl. Climb the platforms for as long as you can!"
            }
            if (this.index == 1010) {
                this.string = "Character: Banandroid. Jump over the rope as many times as you can!"
            }
            if (this.index == 1011) {
                this.string = "Character: Doctor Soto. Avoid the pink lines for as long as possible!"
            }
            if (this.index == 1012) {
                this.string = "Character: Kessler. Do it!"
            }
            }




            // if(counter == 0){
            this.measure()


            // }

        }
        measure() {
            this.ypointer = 1600
            this.xpointer = 50
            canvas_context.font = "50px Arial";
            canvas_context.fillStyle = "#FFFFFF"
            let stoarr = this.string.split(' ')
            let stostring = ''
            for (let t = 0; t < stoarr.length; t++) {
                const width = canvas_context.measureText(stostring + ' ' + stoarr[t]).width
                if (width > canvas.width * invscale * .85) {
                    canvas_context.fillText(stostring + ' ' + stoarr[t], this.xpointer, this.ypointer)
                    this.ypointer += 60
                    stostring = ''
                } else {
                    stostring = stostring + " " + stoarr[t]
                    if (t == stoarr.length - 1) {
                        canvas_context.fillText(stostring, this.xpointer, this.ypointer)
                    }
                }
            }
            // //////////console.log(this)
        }

    }

    class Selector {
        constructor() {
            this.body = new Circle(100 + (selectors.length * 240), 160, 45, getRandomLightColor())
            this.num = selectors.length + 1
        }
        draw() {
            this.body.track()
            this.body.draw()
            canvas_context.font = "50px arial"
            canvas_context.fillStyle = `Black`
            canvas_context.fillText(this.num, this.body.x - (canvas_context.measureText(`${this.num}`).width * .5), this.body.y + (this.body.radius * .3))
        }
    }

    class Textinput {
        constructor(x, y, w, h) {
            this.inputbox = new Rectangle(x, y, w, h, "#FFFFFF")
            this.string = ""
            this.focus = 0
            this.neverfocus = 1
            this.lock = ''
            this.focusindicator = new Rectangle(x, y + (h * .1), w * .03, h * .8, "#000000")
            this.flash = -1
            this.flashspin = 45
            this.flashnum = -1
            this.rooms = 0
            this.primes = [2, 3, 5, 7, 11, 13, 17, 19, 23, 31, 37, 41, 43, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157]
        }

        measure() {
            canvas_context.font = "70px Arial";
            canvas_context.fillStyle = "#000000"
            const width = canvas_context.measureText(this.string).width
            return width
        }
        draw() {
            this.inputbox.draw()
            if (this.neverfocus == 1) {
                canvas_context.font = "70px Arial"
                canvas_context.fillStyle = "#000000"
                canvas_context.fillText("Room #", this.inputbox.x + 10, this.inputbox.y + 75)
            } else {
                canvas_context.font = "70px Arial"
                canvas_context.fillStyle = "#000000"
                canvas_context.fillText(this.string, this.inputbox.x + 10, this.inputbox.y + 75)
            }
            if (this.focus == 1) {
                this.neverfocus = 0
                this.flashnum++
                if (this.flashnum % (this.flashspin + (-15 * this.flash)) == 0) {
                    this.flash *= -1
                }
                if (this.flash == 1) {
                    this.focusindicator.x = (this.measure(this.string) + this.inputbox.x + 10)
                    this.focusindicator.draw()
                }
            }
        }
        backspace() {
            this.string = this.string.split('')
            this.string.splice(this.string.length - 1, 1)
            this.string = this.string.join('')
            const room = parseInt(this.string, 10)
            if (this.string.length == 0) {
                room = 0
            }
            const Rson = {
                "room": `${(0.5 * (room + MapSelect) * (room + MapSelect + 1)) + MapSelect}`
            }
            this.rooms = (0.5 * (room + MapSelect) * (room + MapSelect + 1)) + MapSelect

            if(localPlayToggle != 1){
            ws.send(JSON.stringify(Rson))
            }
        }
        addchar(char) {
            if (this.string.length < 3) {
                if (this.lock != char) {
                    this.string += char
                    this.lock = char
                }
                if (this.string.length == 0 || this.string == "0") {
                    this.string = "1"
                }
                const room = parseInt(this.string, 10)
                const Rson = {
                    "room": `${(0.5 * (room + MapSelect) * (room + MapSelect + 1)) + MapSelect}`
                }
                this.rooms = (0.5 * (room + MapSelect) * (room + MapSelect + 1)) + MapSelect

                if(localPlayToggle != 1){
                ws.send(JSON.stringify(Rson))
                }
            }
        }
    }

    class TextinputStock {
        constructor(x, y, w, h) {
            this.inputbox = new Rectangle(x, y, w, h, "#FFFFFF")
            this.string = ""
            this.focus = 0
            this.neverfocus = 1
            this.lock = ''
            this.focusindicator = new Rectangle(x, y + (h * .1), w * .03, h * .8, "#000000")
            this.flash = -1
            this.flashspin = 45
            this.flashnum = -1
            this.rooms = 0
            this.primes = [2, 3, 5, 7, 11, 13, 17, 19, 23, 31, 37, 41, 43, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157]
        }

        measure() {
            canvas_context.font = "70px Arial";
            canvas_context.fillStyle = "#000000"
            const width = canvas_context.measureText(this.string).width
            return width
        }
        draw() {
            
            stock = parseInt(this.string, 10)
            this.inputbox.draw()
            if (this.neverfocus == 1) {
                canvas_context.font = "70px Arial"
                canvas_context.fillStyle = "#000000"
                canvas_context.fillText("Stock ∞", this.inputbox.x + 10, this.inputbox.y + 75)
            } else {
                canvas_context.font = "70px Arial"
                canvas_context.fillStyle = "#000000"
                canvas_context.fillText(this.string, this.inputbox.x + 10, this.inputbox.y + 75)
            }
            if (this.focus == 1) {
                this.neverfocus = 0
                this.flashnum++
                if (this.flashnum % (this.flashspin + (-15 * this.flash)) == 0) {
                    this.flash *= -1
                }
                if (this.flash == 1) {
                    this.focusindicator.x = (this.measure(this.string) + this.inputbox.x + 10)
                    this.focusindicator.draw()
                }
            }
        }
        backspace() {
            this.string = this.string.split('')
            this.string.splice(this.string.length - 1, 1)
            this.string = this.string.join('')
            stock = parseInt(this.string, 10)
            if(campaignToggle == 1){
                stock = 0
            }
            for(let t = 0;t<boys.length;t++){
                boys[t].stock = stock
            }
            
        }
        addchar(char) {
            if (this.string.length < 3) {
                if (this.lock != char) {
                    this.string += char
                    this.lock = char
                }
                if (this.string.length == 0 || this.string == "0") {
                    this.string = "0"
                }
            stock = parseInt(this.string, 10)
            if(campaignToggle == 1){
                stock = 0
            }
            for(let t = 0;t<boys.length;t++){
                boys[t].stock = stock
            }
            }
        }
    }

    const roomSelectionBox = new Textinput(3300, 700 + 450, 320, 100)

    const stockSelectionBox = new TextinputStock(3300, 850, 320, 100)
    class Mass {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                if (AItoggle == 1 || localPlayToggle == 1) {
                    if (meshtoggle == 1) {
                        if (boys.length == 0) {
                            this.meshinputs = []
                            for (let t = 0; t < 200; t++) {
                                this.meshinputs.push(Math.random() - .5)
                            }
                            this.mesh = new GenNN(this.meshinputs, 4, [66, 66, 24, 10])
                        }
                    }
                }
                this.ping = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 0
                this.id = controller
                this.serverID = serverID
                this.jumpcount = 0
                this.gamepad = new Gamepad(controller)
                this.shotdraw = 0
                this.jumpreduction = 0
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shielddraw = 0
                this.shot = {}
                this.safe = 1
                this.striker = 10000
                this.name = "Mass"
                this.blasting = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.storeshield = 0
                this.wasfalse = []
                for (let t = 0; t < 100; t++) {
                    this.wasfalse.push(1)
                }
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = -1
                this.screwangle = 0
                this.charge = 0
                this.shots = []
                this.controller = controller
                this.armlength = 30
                this.shoulderwidth = 8
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 11.8 // 11.5
                this.punchspeed = 7 // 5 // 5.7 // 6
                if(minigameSelected == 4){
                    this.speed = 16
                }
                this.grounded = 0
                this.frame = 0
                this.jumping = 1
                this.body = new Shot(400 + (Math.random() * 2560), 500, 37.5, this.color)
                this.nodes.push(this.body)

                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.leftshoulder = new Shot(this.body.x - (this.body.radius + this.shoulderwidth), 350, 10, "magenta", 0, 0, .999)
                this.rightshoulder = new Shot(this.body.x + (this.body.radius + this.shoulderwidth), 350, 10, "#FF0000", 0, 0, .999)
                this.lefthand = new Shot(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 21.5, "magenta", 0, 0, .85)
                this.righthand = new Shot(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 21.5, "#FF0000", 0, 0, .85)
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.gravity = 1
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.body.fired = 0
                this.screwmomentum = 0
                this.screwtimer = 0
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }

                this.target = {}
                this.target.body = {}
            } else {
                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]

                    // const keys2 = Object.keys(args[keys[t]])
                    // // if(keys2.length > 1){
                    //     for(let j = 0; j<keys2.length;j++){
                    //     this[keys[t]][keys2[j]] = args[keys[t]][keys2[j]]
                    //  }
                }
                // ////////////// ////////////////////////////////////////////console.log(args)
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                // //////////// ////////////////////////////////////////////console.log(this.shotdraw)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    this.nodes[t] = new Shot(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }
                    this.nodes[t].id = idsto
                }

                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                    this.shots[t] = new Shot(this.shots[t].x, this.shots[t].y, this.shots[t].radius, this.shots[t].color, this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                    this.shots[t].id = idsto

                }
                this.id = args["id"]
                this.frame = args['frame']
                this.armlength = 30
                this.shoulderwidth = 8
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }
                this.rightshoulder = this.nodes[2]
                this.leftshoulder = this.nodes[1]
                this.righthand = this.nodes[3]
                this.lefthand = this.nodes[4]

                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }
            }
        }
        doJump(object, speed) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -speed * 2
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 2
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            object.ymom = -this.speed * 1 * 2
                        } else {
                            if (this.lefthand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                            if (this.righthand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 2
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            const copy = new Mass(this.controller)
            if (this.hasOwnProperty("mesh")) {
                copy.mesh = this.mesh.clone(this.meshinputs)
                copy.mesh.mutate()
            }
            copy.id = this.id
            copy.frame = this.frame
            copy.body.color = this.body.color
            if (this.inactive == 1) {
                copy.inactive = 1
            } copy.serverID = this.serverID
            copy.striker = this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

            return copy
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }

            if (this.screwangle != 0) {

                this.leftshoulder.x = this.body.x + ((((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle)))))
                this.leftshoulder.y = this.body.y + (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle))))

                this.rightshoulder.x = this.body.x + (((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle))))
                this.rightshoulder.y = this.body.y + (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle))))

                this.leftshoulder.color = this.body.color
                this.rightshoulder.color = this.body.color
                this.lefthand.color = this.body.color
                this.righthand.color = this.body.color


                if (this.lefthand.anchored == 0) {
                    this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x + (((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle))))))
                    this.lefthand.y -= this.leftshoulder.y - (this.body.y + (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle)))))
                    // this.lefthand.xmom *=  this.lefthand.friction
                    // this.lefthand.ymom *=  this.lefthand.friction
                    this.leftshoulder.xmom *= 0
                    this.leftshoulder.ymom *= 0
                }
                if (this.righthand.anchored == 0) {
                    this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle))))))
                    this.righthand.y -= this.rightshoulder.y - (this.body.y + (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle)))))
                    // this.righthand.xmom *=  this.righthand.friction
                    // this.righthand.ymom *=  this.righthand.friction
                    this.rightshoulder.xmom *= 0
                    this.rightshoulder.ymom *= 0
                }

                if (this.body.ymom < -vsmashlimit) {
                    this.body.ymom = -vsmashlimit
                }
                if (this.body.ymom > vsmashlimit) {
                    this.body.ymom = vsmashlimit
                }


                // this.lefthand.xmom += (this.lefthand.x - this.body.x) / 100
                // this.righthand.xmom += (this.righthand.x - this.body.x) / 100

                // this.lefthand.ymom += (this.lefthand.y - this.body.y) / 100
                // this.righthand.ymom += (this.righthand.y - this.body.y) / 100


            } else {
                this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth * .3)
                this.leftshoulder.y = this.body.y - (this.shoulderwidth * .7)

                this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth * .3)
                this.rightshoulder.y = this.body.y - (this.shoulderwidth * .7)

                this.leftshoulder.color = this.body.color
                this.rightshoulder.color = this.body.color
                this.lefthand.color = this.body.color
                this.righthand.color = this.body.color


                if (this.lefthand.anchored == 0) {
                    this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth * .3)))
                    this.lefthand.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                    this.leftshoulder.xmom *= 0
                    this.leftshoulder.ymom *= 0
                }
                if (this.righthand.anchored == 0) {
                    this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth * .3)))
                    this.righthand.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                    this.rightshoulder.xmom *= 0
                    this.rightshoulder.ymom *= 0
                }

                if (this.body.ymom < -vsmashlimit) {
                    this.body.ymom = -vsmashlimit
                }



            }


            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }

        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (this.shield == 1) {
                                            this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                        } else {
                                            this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 200)) + (boys[t].shots[k].xmom * baselaunch)) * 2
                                            this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 200)) + (boys[t].shots[k].ymom * baselaunch)) * 2) - (10 * (this.damage / 200))
                                            this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                            this.breaktimer = 0
                                        }
                                        boys[t].shots[k].marked = 1
                                    }
                                }
                            }


                            if (boys[t].hasOwnProperty('radball')) {
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }

                            const enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }


                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 200)) + (boys[t].bananahand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 200)) + (boys[t].bananahand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 200)) + (boys[t].middlehand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 200)) + (boys[t].middlehand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 200)) + (boys[t].righthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 200)) + (boys[t].righthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14

                                            this.shotIDs.push(boys[t].righthand2.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 200)) + (boys[t].lefthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 200)) + (boys[t].lefthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 200)) + (boys[t].righthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 200)) + (boys[t].righthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 200)) + (boys[t].lefthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 200)) + (boys[t].lefthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)

                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }

                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 200)) + (boys[t].righthand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 200)) + (boys[t].righthand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].lefthand.fired > 14) {
                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)

                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    // ////////////// //////////////////////////////////////////////console.log(this, boys[t])
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            } else {
                                                this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 200)) + (boys[t].lefthand.xmom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 200)) + (boys[t].lefthand.ymom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)) * 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 200)) + (boys[t].body.xmom * baselaunch) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].body.ymom * (this.damage / 200)) + (boys[t].body.ymom * baselaunch)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                            this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                            this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                            this.fixupshoulder()
                        }
                        // boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        // boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        // this.fixupshoulder()
                        // boys[f].fixupshoulder()
                        // this.body.ymom *= .99
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2
                this.lefthand.ymom = -this.speed * 2
                this.righthand.ymom = -this.speed * 2
                this.jumpcount = 100
                //////////////////// ////////////////////////////////////////////console.log(this)
            }
        }
        doubleJump() {
            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            this.jumpcount--
            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }

            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }

        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                // this.fleeing = 1
            }
            if (this.charge > 92) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }


            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + Math.max(this.body.radius, boys[t].body.radius))) {
                        this.wmove = 1
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        if (Math.random() < .2) {
                            this.wmove = 1
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }

            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    this.screwshot = 1
                    this.wmove = 1
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    this.screwshot = 1
                }
            }
            this.exgrip = 0
            if (this.under == 0) {
                for (let t = 0; t < boys.length; t++) {
                    if (this.amomu <= 0 && this.dmomu <= 0) {
                        if (this != boys[t] && boys[t]) {
                            if (boys[t].brick.center.y > this.brick.center.y) {
                                if (boys[t].body.x < this.body.x) {
                                    this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                    this.amomu += 15
                                    this.exgrip = 1
                                } else {
                                    this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                    this.dmomu += 15
                                    this.exgrip = 1
                                }
                            }
                        }
                    } else {
                        this.exgrip = 1
                    }
                }
            }



            if (this.dmom > 0) {
                this.screwshot = 1
                this.dmove = 1
                this.wmove = 1
                this.amove = 0
                this.amom = 0
            } else {

                if (this.dmomu > 0) {
                    this.dmove = 1
                    this.amove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }
            if (this.amom > 0) {
                this.screwshot = 1
                this.dmom = 0
                this.amove = 1
                this.wmove = 1
                this.dmove = 0
            } else {
                if (this.amomu > 0) {
                    this.amove = 1
                    this.dmove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }


            if (this.safe == 0) {
                this.screwshot = 1
                if (this.body.x > (this.brick.center.x)) {
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                } else {
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }


            if (this.trapped == 0 && ((this.dmomu <= 0) && (this.amomu <= 0)) && ((this.dmom <= 0) && (this.amom <= 0))) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]
                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        const runtimeR = xdisR / this.speed
                                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .850)) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        const runtimeL = xdisL / this.speed
                                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .850)) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }
                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        const runtimeR = xdisR / this.speed
                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .855)) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1
                                this.wmove = 1
                            }
                        }
                    } else {
                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        const runtimeL = xdisL / this.speed
                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .855)) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1
                                this.wmove = 1
                            }
                        }
                    }
                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                //
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        ////////////////////////// ////////////////////////////////////////////console.log(this.brick.center.x, this.body.x)
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }

            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }


                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }




                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }

                if (AItoggle == 1 || localPlayToggle == 1) {
                    if (meshtoggle == 1 && this.hasOwnProperty('mesh')) {
                        if (boys.length == 2) {
                            this.meshinputs = []


                            this.meshinputs.push(this.damage)
                            this.meshinputs.push(Math.max(this.breaktimer, -1))
                            this.meshinputs.push(this.grounded)
                            this.meshinputs.push(this.shield)
                            this.meshinputs.push(this.shieldpower)
                            this.meshinputs.push(this.lefthand.anchored)
                            this.meshinputs.push(this.righthand.anchored)
                            this.meshinputs.push(Math.max(this.lefthand.fired, 0))
                            this.meshinputs.push(Math.max(this.righthand.fired, 0))
                            this.meshinputs.push(Math.max(this.body.fired, 0))
                            this.meshinputs.push(Math.max(this.blasting, 0))
                            this.meshinputs.push(this.face)
                            this.meshinputs.push(this.jumping)
                            this.meshinputs.push(Math.max(this.jumpcount, -20))
                            this.meshinputs.push(this.safe)
                            for (let k = 0; k < this.nodes.length; k++) {

                                const x = (this.nodes[k].x - (canvas.width * (invscale * .5))) / (canvas.width * (invscale * .5))
                                const y = (this.nodes[k].y - (canvas.height * (invscale * .5))) / (canvas.height * (invscale * .5))
                                this.meshinputs.push(x)
                                this.meshinputs.push(y)
                                this.meshinputs.push(this.nodes[k].radius)
                                this.meshinputs.push(this.nodes[k].xmom)
                                this.meshinputs.push(this.nodes[k].ymom)
                            }



                            for (let t = 0; t < boys.length; t++) {
                                if (this != boys[t]) {
                                    this.meshinputs.push(boys[t].damage)
                                    this.meshinputs.push(Math.max(boys[t].breaktimer, -1))
                                    this.meshinputs.push(boys[t].grounded)
                                    this.meshinputs.push(boys[t].shield)
                                    this.meshinputs.push(boys[t].shieldpower)
                                    this.meshinputs.push(boys[t].lefthand.anchored)
                                    this.meshinputs.push(boys[t].righthand.anchored)
                                    this.meshinputs.push(Math.max(boys[t].lefthand.fired, 0))
                                    this.meshinputs.push(Math.max(boys[t].righthand.fired, 0))
                                    this.meshinputs.push(Math.max(boys[t].body.fired, 0))
                                    this.meshinputs.push(Math.max(boys[t].blasting, 0))
                                    this.meshinputs.push(boys[t].face)
                                    this.meshinputs.push(boys[t].jumping)
                                    this.meshinputs.push(Math.max(boys[t].jumpcount, -20))
                                    this.meshinputs.push(boys[t].safe)
                                    for (let k = 0; k < boys[t].nodes.length; k++) {
                                        const x = (boys[t].nodes[k].x - (canvas.width * (invscale * .5))) / (canvas.width * (invscale * .5))
                                        const y = (boys[t].nodes[k].y - (canvas.height * (invscale * .5))) / (canvas.height * (invscale * .5))


                                        this.meshinputs.push(x)
                                        this.meshinputs.push(y)
                                        this.meshinputs.push(boys[t].nodes[k].radius)
                                        this.meshinputs.push(boys[t].nodes[k].xmom)
                                        this.meshinputs.push(boys[t].nodes[k].ymom)
                                    }
                                }
                            }

                            this.mesh.changeInputs(this.meshinputs)
                            const errors = [this.wmove, this.dmove, this.amove, this.exgrip, this.screwshot, this.downspike, this.hortsmash, this.rightshot, this.leftshot, this.storeshield]
                            // this.mesh.errorReduce(errors, boys.indexOf(this))
                            if (keysPressed['r']) {
                                //////////console.log(this.mesh)
                            }
                        }

                        if (meshRun == 1) {
                            this.wmove = Math.round(this.mesh.outputMagnitudes[0])
                            this.amove = Math.round(this.mesh.outputMagnitudes[1])
                            this.dmove = Math.round(this.mesh.outputMagnitudes[2])
                            if (isNaN(this.dmove)) {
                                this.dmove = 0
                            }
                            if (isNaN(this.amove)) {
                                this.amove = 0
                            }
                            this.exgrip = Math.round(this.mesh.outputMagnitudes[3])
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[4])) {
                                this.screwshot = 1
                                this.downspike = 0
                                this.hortsmash = 0
                            }
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[5])) {
                                this.downspike = 1
                                this.screwshot = 0
                                this.hortsmash = 0
                            }
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[6])) {
                                this.hortsmash = 1
                                this.screwshot = 0
                                this.downspike = 0
                            }
                            this.rightshot = Math.round(this.mesh.outputMagnitudes[7])
                            this.leftshot = Math.round(this.mesh.outputMagnitudes[8])
                            this.storeshield = Math.round(this.mesh.outputMagnitudes[9])
                        }
                    }
                }
                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 2
                    } else {
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                    }
                }

                if (!this.hasOwnProperty('mesh')) {
                    if (this.dmove == 1) {
                        this.face = 1
                        if (object == this.body) {
                            object.x += speed
                            this.righthand.x += speed
                            this.lefthand.x += speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    if (this.amove == 1) {
                        this.face = -1
                        if (object == this.body) {
                            object.x -= speed
                            this.righthand.x -= speed
                            this.lefthand.x -= speed
                        }
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }
                } else {

                    if (object == this.body) {
                        object.x += speed * this.dmove
                        this.righthand.x += speed * this.dmove
                        this.lefthand.x += speed * this.dmove
                    }
                    if (object == this.body) {
                        object.x -= speed * this.amove
                        this.righthand.x -= speed * this.amove
                        this.lefthand.x -= speed * this.amove
                    }


                    if (this.dmove > this.amove) {
                        this.face = 1
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    } else {
                        this.face = -1
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }
                }

                // if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                // if (controller.gamepad.axesStatus[0] > .1) {
                //     this.face = 1
                // }

                // if (controller.gamepad.axesStatus[1] < -.1) {
                //     this.face = -1
                // }
                // }

            }
            // if (this.dmomu > 0 || this.amomu > 0) {
            //     this.lefthand.anchored = 0
            //     this.righthand.anchored = 0
            // }

            if (this.exgrip == 1) {
                this.righthand.anchored = 0
                this.lefthand.anchored = 0
            }
        }
        AI() {
            this.idify()
            if (this.inactive == 1) {
                return
            }
            this.breaks()
            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--

            this.blasting = this.body.fired
            this.body.fired--
            this.lefthand.fired--

            this.breaktimer--

            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.rightshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }


            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        this.wmove = 1
                                        this.screwshot = 1
                                    }
                                }
                            }
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 50 && this.body.y < boys[t].body.y) {
                        this.downspike = 1
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {
                        this.hortsmash = 1
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < 70 && this.body.y > boys[t].body.y) {
                        this.screwshot = 1
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == 1) {
                                this.hortsmash = 1
                            }
                        }
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == -1) {
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .09) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                this.leftshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.leftshot = 0
                                    }
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                this.rightshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.rightshot = 0
                                    }
                                }
                            }
                        }
                    }


                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                this.screwshot = 1
            }


            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            this.storeshield = 1
                        }
                    }
                }
            }
            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }

            if (AItoggle == 1 || localPlayToggle == 1) {
                if (meshtoggle == 1 && this.hasOwnProperty('mesh')) {
                    if (boys.length == 2) {
                        this.meshinputs = []


                        this.meshinputs.push(this.damage)
                        this.meshinputs.push(Math.max(this.breaktimer, -1))
                        this.meshinputs.push(this.grounded)
                        this.meshinputs.push(this.shield)
                        this.meshinputs.push(this.shieldpower)
                        this.meshinputs.push(this.lefthand.anchored)
                        this.meshinputs.push(this.righthand.anchored)
                        this.meshinputs.push(Math.max(this.lefthand.fired, 0))
                        this.meshinputs.push(Math.max(this.righthand.fired, 0))
                        this.meshinputs.push(Math.max(this.body.fired, 0))
                        this.meshinputs.push(Math.max(this.blasting, 0))
                        this.meshinputs.push(this.face)
                        this.meshinputs.push(this.jumping)
                        this.meshinputs.push(Math.max(this.jumpcount, -20))
                        this.meshinputs.push(this.safe)
                        for (let k = 0; k < this.nodes.length; k++) {

                            const x = (this.nodes[k].x - (canvas.width * (invscale * .5))) / (canvas.width * (invscale * .5))
                            const y = (this.nodes[k].y - (canvas.height * (invscale * .5))) / (canvas.height * (invscale * .5))
                            this.meshinputs.push(x)
                            this.meshinputs.push(y)
                            this.meshinputs.push(this.nodes[k].radius)
                            this.meshinputs.push(this.nodes[k].xmom)
                            this.meshinputs.push(this.nodes[k].ymom)
                        }



                        for (let t = 0; t < boys.length; t++) {
                            if (this != boys[t]) {
                                this.meshinputs.push(boys[t].damage)
                                this.meshinputs.push(Math.max(boys[t].breaktimer, -1))
                                this.meshinputs.push(boys[t].grounded)
                                this.meshinputs.push(boys[t].shield)
                                this.meshinputs.push(boys[t].shieldpower)
                                this.meshinputs.push(boys[t].lefthand.anchored)
                                this.meshinputs.push(boys[t].righthand.anchored)
                                this.meshinputs.push(Math.max(boys[t].lefthand.fired, 0))
                                this.meshinputs.push(Math.max(boys[t].righthand.fired, 0))
                                this.meshinputs.push(Math.max(boys[t].body.fired, 0))
                                this.meshinputs.push(Math.max(boys[t].blasting, 0))
                                this.meshinputs.push(boys[t].face)
                                this.meshinputs.push(boys[t].jumping)
                                this.meshinputs.push(Math.max(boys[t].jumpcount, -20))
                                this.meshinputs.push(boys[t].safe)
                                for (let k = 0; k < boys[t].nodes.length; k++) {
                                    const x = (boys[t].nodes[k].x - (canvas.width * (invscale * .5))) / (canvas.width * (invscale * .5))
                                    const y = (boys[t].nodes[k].y - (canvas.height * (invscale * .5))) / (canvas.height * (invscale * .5))


                                    this.meshinputs.push(x)
                                    this.meshinputs.push(y)
                                    this.meshinputs.push(boys[t].nodes[k].radius)
                                    this.meshinputs.push(boys[t].nodes[k].xmom)
                                    this.meshinputs.push(boys[t].nodes[k].ymom)
                                }
                            }
                        }
                        this.mesh.changeInputs(this.meshinputs)

                        const errors = [this.wmove, this.dmove, this.amove, this.exgrip, this.screwshot, this.downspike, this.hortsmash, this.rightshot, this.leftshot, this.storeshield]
                        // this.mesh.errorReduce(errors, boys.indexOf(this))
                        if (keysPressed['r']) {
                            //////////console.log(JSON.stringify(this.mesh))
                            //////////console.log((this.mesh))
                            //////////console.log((this))
                        }
                    }

                    if (meshRun == 1) {
                        this.wmove = Math.round(this.mesh.outputMagnitudes[0])
                        this.amove = Math.round(this.mesh.outputMagnitudes[1])
                        this.dmove = Math.round(this.mesh.outputMagnitudes[2])
                        if (isNaN(this.dmove)) {
                            this.dmove = 0
                        }
                        if (isNaN(this.amove)) {
                            this.amove = 0
                        }
                        this.exgrip = Math.round(this.mesh.outputMagnitudes[3])
                        if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[4])) {
                            this.screwshot = 1
                            this.downspike = 0
                            this.hortsmash = 0
                        }
                        if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[5])) {
                            this.downspike = 1
                            this.screwshot = 0
                            this.hortsmash = 0
                        }
                        if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[6])) {
                            this.hortsmash = 1
                            this.screwshot = 0
                            this.downspike = 0
                        }
                        this.rightshot = Math.round(this.mesh.outputMagnitudes[7])
                        this.leftshot = Math.round(this.mesh.outputMagnitudes[8])
                        this.storeshield = Math.round(this.mesh.outputMagnitudes[9])
                    }
                }
            }
            if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        this.shieldpower -= .63
                        this.shield = 1
                        this.shielddraw = 1
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shotdraw = 0
            }
            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.hasOwnProperty('mesh')) {

                } else {

                    if (this.body.y < 950) {
                        this.wmove = 0
                        this.screwshot = 0
                    }
                    if (this.body.y < 1250) {
                        if (this.body.ymom < 0) {
                            this.wmove = 0
                            this.screwshot = 0
                        }
                    }
                }
                if (this.screwshot == 1) {
                    if (this.body.fired <= 0) {
                        if (this.screwangle == 0) {
                            this.screwmomentum = Math.PI / 5
                            this.screwtimer = 42
                            this.jumping = 1
                            this.lefthand.fired = 30
                            this.righthand.fired = 30
                            // this.degripr()
                            // this.degripl()
                            this.body.fired = 42
                            this.lefthand.anchored = -10
                            this.righthand.anchored = -10
                            this.body.ymom = -jumplimit //-this.speed * 3
                        }
                    }
                }
                if (this.downspike == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0


                            this.righthand.ymom = (this.punchspeed * 15.1) + this.body.ymom * 2
                            this.righthand.xmom = -((this.punchspeed * 2.1)) //+ this.body.xmom)


                            // this.righthand.ymom = (this.punchspeed * 12) //+ this.body.ymom
                            // this.righthand.xmom = -(this.punchspeed * 2.1) //+ this.body.xmom


                            this.righthand.fired = 18
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0

                            this.lefthand.ymom = (this.punchspeed * 15.1) + this.body.ymom * 2
                            this.lefthand.xmom = ((this.punchspeed * 2.1))// + this.body.xmom)

                            // this.lefthand.ymom = (this.punchspeed * 12) //+ this.body.ymom
                            // this.lefthand.xmom = (this.punchspeed * 2.1) //+ this.body.xmom
                            this.lefthand.fired = 18
                        }
                    }
                }
                if (this.hortsmash == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.fleeing = 0
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.ymom = (this.punchspeed * 5) + (this.body.ymom * 2)
                            this.righthand.xmom = (this.punchspeed * 11.1) //+ this.body.xmom
                            this.righthand.fired = 18
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.fleeing = 0
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = (this.punchspeed * 5) + (this.body.ymom * 2)
                            this.lefthand.xmom = -(this.punchspeed * 11.1) //+ this.body.xmom
                            this.lefthand.fired = 18
                        }
                    }
                }


                if (this.righthand.fired <= 0) {
                    if (this.righthand.anchored == 0) {
                        if (this.rightshot == 1) {
                            if (this.face == 1) {
                                this.shot = new Shot(this.righthand.x, this.righthand.y, this.charge * .66, "#00FFFF", this.speed * 2, 0)
                                if (this.charge > 80) {
                                    this.shot.color = "#88FFFF"
                                }
                                // if(this.wasfalse[1] == 0){
                                if (this.charge >= 100) {
                                    this.charge = 0
                                    this.righthand.xmom = 10
                                    this.righthand.ymom = 0
                                    this.shots.push(this.shot)
                                    if (this.grounded != 1) {
                                        this.body.xmom -= 5
                                    }
                                }
                                if (this.righthand.anchored == 0) {
                                    this.righthand.xmom += 1
                                    this.righthand.ymom -= 1
                                    this.charge += 3.5
                                }
                                this.shotdraw = 1
                            }
                        }
                        if (this.leftshot == 1) {
                            if (this.face == -1) {
                                if (this.lefthand.anchored == 0) {
                                    this.shot = new Shot(this.lefthand.x, this.lefthand.y, this.charge * .66, "#00FFFF", -this.speed * 2, 0)
                                    if (this.charge > 80) {
                                        this.shot.color = "#88FFFF"
                                    }
                                    if (this.charge >= 100) {
                                        this.charge = 0
                                        this.lefthand.xmom = -10
                                        this.lefthand.ymom = 0
                                        this.shots.push(this.shot)
                                        if (this.grounded != 1) {
                                            this.body.xmom += 5
                                        }
                                    }
                                    if (this.lefthand.anchored == 0) {
                                        this.lefthand.xmom -= 1
                                        this.lefthand.ymom -= 1
                                        this.charge += 3.5
                                    }
                                    this.shotdraw = 1

                                }
                            }
                        }
                    }
                }

            }

        }
        fightcontrol() {
            if (this.inactive == 1) {
                return
            }
            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()




            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--

            this.blasting = this.body.fired
            this.body.fired--
            this.lefthand.fired--


            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            this.breaktimer--
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                this.shieldpower -= .63
                                this.shield = 1
                                this.shielddraw = 1
                            }
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }



            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shotdraw = 0
            }
            if (this.breaktimer <= 0 && this.shield == 0) {
                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                    if (this.righthand.fired <= 0) {
                        if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {

                            if (this.face == 1) {
                                if (this.righthand.anchored == 0) {
                                    this.shot = new Shot(this.righthand.x, this.righthand.y, this.charge * .66, "#00FFFF", this.speed * 2, 0)
                                    if (this.charge > 80) {
                                        this.shot.color = "#88FFFF"
                                    }
                                    // if(this.wasfalse[1] == 0){
                                    if (this.charge >= 100) {
                                        this.charge = 0
                                        this.righthand.xmom = 10
                                        this.righthand.ymom = 0
                                        this.shots.push(this.shot)
                                        if (this.grounded != 1) {
                                            this.body.xmom -= 5
                                        }
                                    }
                                    if (this.righthand.anchored == 0) {
                                        this.righthand.xmom += 1
                                        this.righthand.ymom -= 1
                                        this.charge += 3.5
                                    }
                                    this.shotdraw = 1
                                }
                            }
                            if (this.face == -1) {
                                if (this.lefthand.anchored == 0) {
                                    this.shot = new Shot(this.lefthand.x, this.lefthand.y, this.charge * .66, "#00FFFF", -this.speed * 2, 0)
                                    if (this.charge > 80) {
                                        this.shot.color = "#88FFFF"
                                    }
                                    if (this.charge >= 100) {
                                        this.charge = 0
                                        this.lefthand.xmom = -10
                                        this.lefthand.ymom = 0
                                        this.shots.push(this.shot)
                                        if (this.grounded != 1) {
                                            this.body.xmom += 5
                                        }
                                    }
                                    if (this.lefthand.anchored == 0) {
                                        this.lefthand.xmom -= 1
                                        this.lefthand.ymom -= 1
                                        this.charge += 3.5
                                    }
                                    this.shotdraw = 1

                                }
                            }
                        }
                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {
                        if (this.body.fired <= 0) {
                            if (this.screwangle == 0) {
                                this.screwmomentum = Math.PI / 5
                                this.screwtimer = 42
                                this.jumping = 1
                                this.lefthand.fired = 30
                                this.righthand.fired = 30
                                // this.degripr()
                                // this.degripl()
                                this.body.fired = 42
                                this.lefthand.anchored = -10
                                this.righthand.anchored = -10
                                this.body.ymom = -jumplimit  //-this.speed * 3

                                this.idify()
                            }
                        }
                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.ymom = (this.punchspeed * 15.1) + this.body.ymom * 2
                                this.righthand.xmom = -((this.punchspeed * 2.1)) // + this.body.xmom)
                                this.righthand.fired = 18
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = (this.punchspeed * 15.1) + this.body.ymom * 2
                                this.lefthand.xmom = (this.punchspeed * 2.1) // + this.body.xmom
                                this.lefthand.fired = 18
                                this.idify()
                            }
                        }
                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.ymom = (this.punchspeed * 5) + (this.body.ymom * 2)
                                this.righthand.xmom = (this.punchspeed * 11.1) //+ this.body.xmom
                                this.righthand.fired = 18
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = (this.punchspeed * 5) + (this.body.ymom * 2)
                                this.lefthand.xmom = -(this.punchspeed * 11.1) //+ this.body.xmom
                                this.lefthand.fired = 18
                                this.idify()
                            }
                        }
                    }
                } else {
                    if (Math.random() < .001) {
                        //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                    }
                }
            }



        }
        degripl() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        degripr() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        collideStage() {
            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {
            if (this.inactive == 1) {
                return
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.grounded = 0
            this.frame++
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.shots.length; t++) {
                    this.shots[t].move()
                    if (this.shots[t].marked <= 0) {
                        this.shots[t].draw()
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].draw()
                        }
                    }
                }
            }

            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].marked == 1) {
                    this.shots.splice(t, 1)
                } else {
                    this.shots[t].marked--
                }
            }
            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.collideStage()
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].color = invertColor(this.body.color)
                if (this.hasOwnProperty('mesh')) {
                    this.links[t].color = invertColor(this.mesh.name)
                }
                this.links[t].draw()
            }
            for (let t = 0; t < this.nodes.length; t++) {
                if (this.hasOwnProperty('mesh')) {
                    this.nodes[t].color = this.mesh.name
                }
                this.nodes[t].draw()
            }

            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }
            if (this.screwangle != 0) {
                for (let t = 0; t < 25; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - ((Math.random() - .5) * this.body.radius * 2), 3, invertColor(this.body.color))
                    if (spot.doesPerimeterTouch(this.body)) {
                        spot.draw()
                    }
                }
            }

            canvas_context.font = "42px arial"
            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 70)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            if(minigameSelected != 4){
                canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 70)
            canvas_context.fillStyle = "white"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 110)
            }
            }

            const link = new Line(this.body.x, this.body.y, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y + Math.sin(this.screwangle), invertColor(this.body.color), this.body.radius * .2)

            canvas_context.lineWidth = this.strokeWidth
            canvas_context.strokeStyle = invertColor(this.body.color)
            canvas_context.beginPath();
            canvas_context.arc(((link.x1 + link.x2) * .5) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .4, this.screwangle, (Math.PI * 1) + this.screwangle, false)
            canvas_context.fillStyle = invertColor(this.body.color)
            canvas_context.fill()
            canvas_context.stroke();
            if (this.screwangle == 0) {
                link.draw()
            }


            // canvas_context.fillText(`_ ${this.shotdraw}`, this.body.x - 20, this.body.y - 300)
            if (this.shotdraw == 1) {
                if (this.face == 1) {
                    this.shot = new Shot(this.righthand.x, this.righthand.y, this.charge * .66, "#00FFFF", this.speed * 2, 0)
                } else {
                    this.shot = new Shot(this.lefthand.x, this.lefthand.y, this.charge * .66, "#00FFFF", this.speed * 2, 0)
                }
                if (this.charge > 80) {
                    this.shot.color = "#88FFFF"
                }

                this.shot.draw()
            }
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.lefthand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
        }
        operate() {

            if (this.inactive == 1) {
                return
            }
            if (this.righthand.anchored == 1) {
                if (this.body.x > this.righthand.x) {
                    this.righthand.anchored = -10
                }
            }
            if (this.lefthand.anchored == 1) {
                if (this.body.x < this.lefthand.x) {
                    this.lefthand.anchored = -10
                }
            }

            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            }
            // }
            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.leftshoulder.ymom * .99
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.rightshoulder.ymom * .99
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     // this.body.sxmom *= 0
                    //     this.body.xmom *= .5
                    // }
                }
                this.body.ymom += this.gravity
            } else {

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            } else {
                //this.collideStage()
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            } else {
                //this.collideStage()
            }
            this.righthand.ymom += this.gravity
            this.lefthand.ymom += this.gravity


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            this.body.xmom *= .99
            this.body.ymom *= .99

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].frictiveMove(this)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].smove(this)
                }
            }

            this.lefthand.xmom += (this.lefthand.x - this.body.x) / 80
            this.righthand.xmom += (this.righthand.x - this.body.x) / 80
            this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40
            this.fixupshoulder()

            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

            // this.leftshoulder.xmom *= 0
            // this.leftshoulder.ymom *= 0

            // this.rightshoulder.xmom *= 0
            // this.rightshoulder.ymom *= 0




            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            // if (this.controller == 0) {

            if (boys.indexOf(this) <= humanPlayers) {

                // this.AI()
                this.fightcontrol()
            } else {
                this.AI()
            }
            // }
        }
    }



    class Blastgirl {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                this.ping = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 2
                this.serverID = serverID
                this.shotdraw = 0
                this.id = controller
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 0
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shot = new Brick(-1, -1, 1, 1)
                this.striker = 10000
                this.name = "Blastgirl"
                this.blasting = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.storeshield = 0
                this.wasfalse = []
                for (let t = 0; t < 100; t++) {
                    this.wasfalse.push(1)
                }
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = 0
                this.screwangle = 0
                this.charge = 0
                this.shots = []
                this.color = getRandomColor()
                if (controller == 0) {
                    this.color = "#ffAA00"
                }
                if (controller == 1) {
                    this.color = "#ff0000"
                }
                this.body = new Shotb(400 + (Math.random() * 2560), 500, 55, this.color)
                this.controller = controller
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.armlength = 15
                this.shoulderwidth = 58
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 11.5
                this.punchspeed = 5
                this.grounded = 0
                this.frame = 0
                this.jumping = 1


                this.nodes.push(this.body)
                this.leftshoulder = new Shotb(this.body.x - (this.body.radius + this.shoulderwidth), 350, 17, "magenta", 0, 0, .999)
                this.rightshoulder = new Shotb(this.body.x + (this.body.radius + this.shoulderwidth), 350, 17, "#FF0000", 0, 0, .999)
                this.lefthand = new Shotb(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 24, "magenta", 0, 0, .85)
                this.righthand = new Shotb(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 24, "#FF0000", 0, 0, .85)
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.gravity = 1
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.body.fired = 0
                this.screwmomentum = 0
                this.screwtimer = 0
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {
                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]
                }
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    this.nodes[t] = new Shotb(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }
                    this.nodes[t].id = idsto
                }

                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                    this.shots[t] = new Shot(this.shots[t].x, this.shots[t].y, this.shots[t].radius, this.shots[t].color, this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                    this.shots[t].id = idsto
                }
                this.id = args["id"]
                this.frame = args['frame']
                this.armlength = 15
                this.shoulderwidth = 58
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }
                this.rightshoulder = this.nodes[2]
                this.leftshoulder = this.nodes[1]
                this.righthand = this.nodes[3]
                this.lefthand = this.nodes[4]

                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }
            }
        }

        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            object.ymom = -this.speed * 1 * 2
                        } else {
                            if (this.lefthand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                            if (this.righthand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 2
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            const copy = new Blastgirl(this.controller)

            if( minigameSelected == 9){
                    const now = new Date()
                    campaigntimestart = now.getTime()
                    stage.blastgirlclimbscore = 0
                }
            copy.id = this.id
            copy.frame = this.frame
            copy.body.color = this.body.color
            if (this.inactive == 1) {
                copy.inactive = 1
            } copy.serverID = this.serverID
            copy.striker = this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

            return copy
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }


            if (this.screwangle != 0) {

                this.leftshoulder.x = this.body.x + ((((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle)))))
                this.leftshoulder.y = this.body.y + (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle))))

                this.rightshoulder.x = this.body.x + (((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle))))
                this.rightshoulder.y = this.body.y + (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle))))

                this.leftshoulder.color = this.body.color
                this.rightshoulder.color = this.body.color
                this.lefthand.color = this.body.color
                this.righthand.color = this.body.color


                if (this.lefthand.anchored !== 1) {
                    this.lefthand.x = this.leftshoulder.x
                    this.lefthand.y = this.leftshoulder.y
                    // this.lefthand.xmom *=  this.lefthand.friction
                    // this.lefthand.ymom *=  this.lefthand.friction
                    // this.leftshoulder.xmom *= 0
                    // this.leftshoulder.ymom *= 0
                }
                if (this.righthand.anchored !== 1) {
                    this.righthand.x = this.rightshoulder.x
                    this.righthand.y = this.rightshoulder.y
                    // this.righthand.xmom *=  this.righthand.friction
                    // this.righthand.ymom *=  this.righthand.friction
                    // this.rightshoulder.xmom *= 0
                    // this.rightshoulder.ymom *= 0
                }

                if (this.body.ymom < -vsmashlimit) {
                    this.body.ymom = -vsmashlimit
                }
                if (this.body.ymom > vsmashlimit) {
                    this.body.ymom = vsmashlimit
                }


                // this.lefthand.xmom += (this.lefthand.x - this.body.x) / 100
                // this.righthand.xmom += (this.righthand.x - this.body.x) / 100

                // this.lefthand.ymom += (this.lefthand.y - this.body.y) / 100
                // this.righthand.ymom += (this.righthand.y - this.body.y) / 100


            } else {
                this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth * .3)
                this.leftshoulder.y = this.body.y - (this.shoulderwidth * .7)

                this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth * .3)
                this.rightshoulder.y = this.body.y - (this.shoulderwidth * .7)

                this.leftshoulder.color = this.body.color
                this.rightshoulder.color = this.body.color
                this.lefthand.color = this.body.color
                this.righthand.color = this.body.color


                if (this.lefthand.anchored == 0) {
                    this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth * .3)))
                    this.lefthand.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                    this.leftshoulder.xmom *= 0
                    this.leftshoulder.ymom *= 0
                }
                if (this.righthand.anchored == 0) {
                    this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth * .3)))
                    this.righthand.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                    this.rightshoulder.xmom *= 0
                    this.rightshoulder.ymom *= 0
                }

                if (this.body.ymom < -vsmashlimit) {
                    this.body.ymom = -vsmashlimit
                }



            }


            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }

        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (this.shield == 1) {
                                            this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                        } else {
                                            this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 200)) + (boys[t].shots[k].xmom * baselaunch)) * 2
                                            this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 200)) + (boys[t].shots[k].ymom * baselaunch)) * 2) - (10 * (this.damage / 200))
                                            this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                            this.breaktimer = 0
                                        }
                                        boys[t].shots[k].marked = 1
                                    }
                                }
                            }



                            if (boys[t].hasOwnProperty('radball')) {
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }

                            const enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }


                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 200)) + (boys[t].bananahand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 200)) + (boys[t].bananahand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 200)) + (boys[t].middlehand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 200)) + (boys[t].middlehand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 200)) + (boys[t].righthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 200)) + (boys[t].righthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14

                                            this.shotIDs.push(boys[t].righthand2.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 200)) + (boys[t].lefthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 200)) + (boys[t].lefthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 200)) + (boys[t].righthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 200)) + (boys[t].righthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 200)) + (boys[t].lefthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 200)) + (boys[t].lefthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)

                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }


                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 200)) + (boys[t].righthand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 200)) + (boys[t].righthand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].lefthand.fired > 14) {
                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)

                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            } else {
                                                this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 200)) + (boys[t].lefthand.xmom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 200)) + (boys[t].lefthand.ymom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)) * 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }

                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 200)) + (boys[t].body.xmom * baselaunch) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].body.ymom * (this.damage / 200)) + (boys[t].body.ymom * baselaunch)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                            this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                            this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                            this.fixupshoulder()
                        }
                        // boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        // boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        // this.fixupshoulder()
                        // boys[f].fixupshoulder()
                        // this.body.ymom *= .99
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2
                this.lefthand.ymom = -this.speed * 2
                this.righthand.ymom = -this.speed * 2
                this.jumpcount = 100

            }
        }

        doJump(object, speed) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -speed * 2
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 2
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {
            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 950) {
                this.wmove = 0
                this.screwshot = 0
            }
            if (this.body.y < 1250) {
                if (this.body.ymom < 0) {
                    this.wmove = 0
                    this.screwshot = 0
                }
            }
            this.jumpcount--

            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }

            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }

        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                this.fleeing = 1
            }
            if (this.charge > 90) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {

                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        this.wmove = 1
                                        this.screwshot = 1
                                    }
                                }
                            }
                        }
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + Math.max(this.body.radius, boys[t].body.radius))) {
                        this.wmove = 1
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        if (Math.random() < .2) {
                            this.wmove = 1
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }


            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    this.screwshot = 1
                    this.wmove = 1
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    this.screwshot = 1
                }
            }
            this.exgrip = 0
            for (let t = 0; t < boys.length; t++) {
                if (this.amomu <= 0 && this.dmomu <= 0) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].brick.center.y > this.brick.center.y) {
                            if (boys[t].body.x < this.body.x) {
                                this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                this.amomu += 15
                                this.exgrip = 1
                            } else {
                                this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                this.dmomu += 15
                                this.exgrip = 1
                            }
                        }
                    }
                } else {
                    this.exgrip = 1
                }
            }


            if (this.dmom > 0) {
                this.screwshot = 1
                this.dmove = 1
                this.wmove = 1
                this.amove = 0
                this.amom = 0
            } else {

                if (this.dmomu > 0) {
                    this.dmove = 1
                    this.amove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }
            if (this.amom > 0) {
                this.screwshot = 1
                this.dmom = 0
                this.amove = 1
                this.wmove = 1
                this.dmove = 0
            } else {
                if (this.amomu > 0) {
                    this.amove = 1
                    this.dmove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }

            if (this.safe == 0) {
                if (this.under == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                }
                if (this.body.x > (this.brick.center.x)) {
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                } else {
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }

            if (this.trapped == 0) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]
                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        const runtimeR = xdisR / this.speed
                                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .95)) {//&& this.body.fired < 3.8 * runtimeR) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        const runtimeL = xdisL / this.speed
                                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .95)) {// && this.body.fired < 3.8 * runtimeL) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }
                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        const runtimeR = xdisR / this.speed
                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .8)) {// && this.body.fired < 1.8 * runtimeR) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1 // erooro?
                                this.wmove = 1
                            }
                        }
                    } else {
                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        const runtimeL = xdisL / this.speed
                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .8)) {// && this.body.fired < 1.8 * runtimeL) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1 // erooro?
                                this.wmove = 1
                            }
                        }
                    }
                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }

            if (this.body.y < 950) {
                this.wmove = 0
                this.screwshot = 0
            }
            if (this.body.y < 1250) {
                if (this.body.ymom < 0) {
                    this.wmove = 0
                    this.screwshot = 0
                }
            }
            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            if (this.dmomu <= 0 && this.amomu <= 0) {
                                                this.screwshot = 1
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        this.amom = this.dmom
                        this.dmom = 0
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        this.dmom = this.amom
                        this.amom = 0
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }

                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 2
                    } else {
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                    }
                }
                if (this.dmove == 1) {
                    this.face = 1
                    if (object == this.body) {
                        object.x += speed
                        this.righthand.x += speed
                        this.lefthand.x += speed
                    }
                    if (this.righthand.anchored == 1) {
                        this.degripr()
                        this.jumping = 1
                    }
                }
                // if (keysPressed['s']) {
                //     object.y += speed
                //     this.degrip()
                // }
                if (this.amove == 1) {
                    this.face = -1
                    if (object == this.body) {
                        object.x -= speed
                        this.righthand.x -= speed
                        this.lefthand.x -= speed
                    }
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        this.degripl()
                        this.jumping = 1
                    }
                }


                // if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                // if (controller.gamepad.axesStatus[0] > .1) {
                //     this.face = 1
                // }

                // if (controller.gamepad.axesStatus[1] < -.1) {
                //     this.face = -1
                // }
                // }

            }
            // if (this.dmomu > 0 || this.amomu > 0) {
            //     this.lefthand.anchored = 0
            //     this.righthand.anchored = 0
            // }

            if (this.exgrip == 1) {
                this.righthand.anchored = 0
                this.lefthand.anchored = 0
            }
        }
        AI() {
            this.idify()
            if (this.inactive == 1) {
                return
            }
            this.breaks()
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].marked == 1) {
                    this.shots.splice(t, 1)
                } else {
                    this.shots[t].marked--
                }
            }

            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.charge--
            if (this.charge <= 0) {
                this.charge = 0
            }
            this.body.fired -= .25
            this.lefthand.fired--

            this.breaktimer--
            // if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] ||  keysPressed['e']) {

            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.rightshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }





            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {


                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.dmomu <= 0 && this.amomu <= 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 50 && this.body.y < boys[t].body.y) {
                        this.downspike = 1
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {
                        this.downspike = 1
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < 70 && this.body.y > boys[t].body.y) {
                        if (this.dmomu <= 0 && this.amomu <= 0) {
                            this.screwshot = 1
                        }
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == 1) {
                                this.hortsmash = 1
                            }
                        }
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == -1) {
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .09) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                this.leftshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.leftshot = 0
                                    }
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                this.rightshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.rightshot = 0
                                    }
                                }
                            }
                        }
                    }


                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (this.under == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                } else {
                    this.wmove = 1
                }
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.dmomu <= 0 && this.amomu <= 0) {
                                            this.screwshot = 1
                                            this.wmove = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        this.shieldpower -= .63
                        this.shield = 1
                        this.shielddraw = 1
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }

            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.body.fired > 0) {
                    this.body.ymom -= this.body.fired * .018
                }
                if (this.body.y < 950) {
                    this.wmove = 0
                    this.screwshot = 0
                }
                if (this.body.y < 1250) {
                    if (this.body.ymom < 0) {
                        this.wmove = 0
                        this.screwshot = 0
                    }
                }
                if (this.screwshot == 1) {
                    if (this.body.fired <= 0) {
                        if (this.screwangle == 0) {
                            this.jumping = 1
                            this.screwangle = Math.PI * 1.5
                            this.screwtimer = 50
                            this.lefthand.ymom = -70
                            this.righthand.ymom = -70
                            this.lefthand.xmom = 25
                            this.righthand.xmom = -25
                            this.lefthand.fired = 40
                            this.righthand.fired = 40
                            this.body.fired = 50
                            this.lefthand.anchored = -10
                            this.righthand.anchored = -10
                            this.body.ymom = -jumplimit
                        }
                    }
                }
                if (this.downspike == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.ymom = this.punchspeed * 18
                            this.righthand.xmom = -this.punchspeed * -5.1
                            this.righthand.fired = 18
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = this.punchspeed * 18
                            this.lefthand.xmom = this.punchspeed * -5.1
                            this.lefthand.fired = 18
                        }
                    }
                }
                if (this.hortsmash == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.shot = new Shot(this.rightshoulder.x, this.rightshoulder.y, 20, "#FFAA00", this.speed * 1.2, -this.speed * 1.4)
                            this.shot.gravity = 1
                            this.shots.push(this.shot)
                            this.fleeing = 0
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.ymom = this.punchspeed * 5
                            this.righthand.xmom = this.punchspeed * 18.1
                            this.righthand.fired = 19
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.shot = new Shot(this.leftshoulder.x, this.leftshoulder.y, 20, "#FFAA00", - this.speed * 1.2, -this.speed * 1.4)
                            this.shot.gravity = 1
                            this.shots.push(this.shot)
                            this.fleeing = 0
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = this.punchspeed * 5
                            this.lefthand.xmom = -this.punchspeed * 18.1
                            this.lefthand.fired = 19
                        }
                    }
                }

                if (this.righthand.fired <= 0) {
                    if (this.righthand.anchored == 0) {
                        if (this.rightshot == 1) {
                            if (this.face == 1) {
                                if (this.righthand.anchored == 0) {
                                    this.shot = new Shot(this.righthand.x, this.righthand.y, 40, "#FF0000", this.speed * (1.9), 0)
                                    // if(this.wasfalse[1] == 0){
                                    this.shot.gravity = -.1
                                    this.shot.countdown = 100
                                    if (this.charge <= 0) {
                                        this.righthand.fired = 10
                                        if (this.righthand.anchored == 0) {
                                            this.charge += 40.5
                                        }
                                        this.shots.push(this.shot)
                                        if (this.grounded != 1) {
                                            this.body.xmom -= .5
                                        }
                                    } else {
                                        // if (this.charge < 104) {
                                        //     this.charge = 200
                                        // }
                                    }
                                }
                            }
                        }
                        if (this.leftshot == 1) {
                            if (this.face == -1) {
                                if (this.lefthand.anchored == 0) {
                                    this.shot = new Shot(this.lefthand.x, this.lefthand.y, 40, "#FF0000", -this.speed * (1.9), 0)
                                    this.shot.gravity = -.1
                                    this.shot.countdown = 100
                                    if (this.charge <= 0) {
                                        this.lefthand.fired = 10
                                        if (this.lefthand.anchored == 0) {
                                            this.charge += 40.5
                                        }
                                        this.shots.push(this.shot)
                                        if (this.grounded != 1) {
                                            this.body.xmom -= .5
                                        }
                                    }
                                }
                            }
                        }
                    }
                }

            }

        }
        fightcontrol() {
            if (this.inactive == 1) {
                return
            }

            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()


            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].marked == 1) {
                    this.shots.splice(t, 1)
                } else {
                    this.shots[t].marked--
                }
            }

            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.charge--
            if (this.charge <= 0) {
                this.charge = 0
            }
            this.body.fired -= .25
            if(minigameSelected == 9){
            this.body.fired -= .15
            }
            this.lefthand.fired--


            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            this.breaktimer--
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }

            if (this.breaktimer <= 0 && this.shield == 0) {
                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {



                    if (this.righthand.fired <= 0) {
                        if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {
                            if (this.face == 1) {
                                if (this.righthand.anchored == 0) {
                                    this.shot = new Shot(this.righthand.x, this.righthand.y, 40, "#FF0000", this.speed * (1.9), 0)
                                    // if(this.wasfalse[1] == 0){
                                    this.shot.gravity = -.1
                                    this.shot.countdown = 100
                                    if (this.charge <= 0) {
                                        this.righthand.fired = 10
                                        if (this.righthand.anchored == 0) {
                                            this.charge += 40.5
                                        }
                                        this.shots.push(this.shot)
                                        if (this.grounded != 1) {
                                            this.body.xmom -= .5
                                        }
                                    }
                                }
                            }
                            if (this.face == -1) {
                                if (this.lefthand.anchored == 0) {
                                    this.shot = new Shot(this.lefthand.x, this.lefthand.y, 40, "#FF0000", -this.speed * (1.9), 0)
                                    this.shot.gravity = -.1
                                    this.shot.countdown = 100
                                    if (this.charge <= 0) {
                                        this.lefthand.fired = 10
                                        if (this.lefthand.anchored == 0) {
                                            this.charge += 40.5
                                        }
                                        this.shots.push(this.shot)
                                        if (this.grounded != 1) {
                                            this.body.xmom -= .5
                                        }
                                    }
                                }
                            }
                        }
                    }

                    if (this.body.fired > 0) {
                        this.body.ymom -= this.body.fired * .018
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {
                        if (this.screwangle == 0) {

                            if (this.body.fired <= 0) {
                                this.jumping = 1
                                this.screwangle = Math.PI * 1.5
                                this.screwtimer = 50
                                this.lefthand.fired = 40
                                this.righthand.fired = 40
                                this.lefthand.ymom = -70
                                this.righthand.ymom = -70
                                this.lefthand.xmom = 25
                                this.righthand.xmom = -25
                                this.body.fired = 50
                                this.lefthand.anchored = -10
                                this.righthand.anchored = -10
                                this.body.ymom = -jumplimit
                                this.idify()
                            }
                        }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.ymom = this.punchspeed * 18
                                this.righthand.xmom = -this.punchspeed * -5.1
                                this.righthand.fired = 18
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = this.punchspeed * 18
                                this.lefthand.xmom = this.punchspeed * -5.1
                                this.lefthand.fired = 18
                                this.idify()
                            }
                        }
                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.shot = new Shot(this.rightshoulder.x, this.rightshoulder.y, 20, "#FFAA00", this.speed * 1.2, -this.speed * 1.4)
                                this.shot.gravity = 1
                                this.shots.push(this.shot)
                                this.fleeing = 0
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.ymom = this.punchspeed * 5
                                this.righthand.xmom = this.punchspeed * 18.1
                                this.righthand.fired = 19
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.shot = new Shot(this.leftshoulder.x, this.leftshoulder.y, 20, "#FFAA00", - this.speed * 1.2, -this.speed * 1.4)
                                this.shot.gravity = 1
                                this.shots.push(this.shot)
                                this.fleeing = 0
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = this.punchspeed * 5
                                this.lefthand.xmom = -this.punchspeed * 18.1
                                this.lefthand.fired = 19
                                this.idify()
                            }
                        }
                    }
                }
            }
        }
        degripl() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        degripr() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        collideStage() {
            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {
            if (this.inactive == 1) {
                return
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.grounded = 0
            this.frame++
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.shots.length; t++) {
                    if (typeof this.shots[t].gravity == "number") {
                        this.shots[t].ymom += this.shots[t].gravity
                    }
                    if (typeof this.shots[t].countdown == "number") {
                        this.shots[t].countdown--
                        this.shots[t].gravity = Math.cos(this.shots[t].countdown * (Math.PI / 4)) * 20
                        if (this.shots[t].countdown <= 0) {
                            this.shots[t].marked = 1
                        }
                    }
                    this.shots[t].move()
                    if (this.shots[t].marked <= 0) {
                        this.shots[t].draw()
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].draw()
                        }
                    }
                }
            }
            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.collideStage()
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].color = invertColor(this.body.color)
                this.links[t].draw()
            }
            for (let t = 0; t < this.nodes.length; t++) {
                this.nodes[t].draw()
            }

            // if (this.controller == 0) {

            const link = new Line(this.body.x, this.body.y, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y + Math.sin(this.screwangle), invertColor(this.body.color), this.body.radius * .2)

            canvas_context.lineWidth = this.strokeWidth
            canvas_context.strokeStyle = (this.body.color)
            canvas_context.beginPath();
            canvas_context.arc(((link.x1 + link.x2) * .5) + Math.cos(this.screwangle), link.y1 + this.body.radius * .1, this.body.radius * .4, this.screwangle, (Math.PI * 1) + this.screwangle, true)
            canvas_context.fillStyle = (this.body.color)
            canvas_context.fill()
            canvas_context.stroke();
            canvas_context.beginPath();
            canvas_context.arc(((link.x1 + link.x2) * .5) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .4, this.screwangle, (Math.PI * 1) + this.screwangle, false)
            canvas_context.fillStyle = (this.body.color)
            canvas_context.fill()
            canvas_context.stroke();
            // if (this.screwangle == 0) {
            //     link.draw()
            // }
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.lefthand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
            canvas_context.font = "42px arial"
            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 70)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 70)
            canvas_context.fillStyle = "white"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 110)
            }
            // if (this != boys[0]) {
            //     canvas_context.fillText(`${Math.round(this.dmomu)},${Math.round(this.amomu)}`, this.body.x - 20, this.body.y - 150)
            //     canvas_context.fillText(`Under:${Math.round(this.under)},Safe:${Math.round(this.safe)}`, this.body.x - 20, this.body.y - 200)
            //     canvas_context.fillText(`Height:${Math.round(this.brick.edgeright.y)}`, this.body.x - 20, this.body.y - 250)
            //     if (this.fleeing == 1) {
            //         canvas_context.fillText(`fleeing`, this.body.x - 20, this.body.y - 100)
            //     }
            // }


        }
        operate() {

            if (this.inactive == 1) {
                return
            }
            if (this.righthand.anchored == 1) {
                if (this.body.x > this.righthand.x) {
                    this.righthand.anchored = -10
                }
            }
            if (this.lefthand.anchored == 1) {
                if (this.body.x < this.lefthand.x) {
                    this.lefthand.anchored = -10
                }
            }

            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {
            if (boys.indexOf(this) <= humanPlayers) {
                // if (this.breaktimer < 0) {
                //     this.AImove(this.body, this.speed, this.gamepad)

                //     if (this.righthand.anchored == 0) {
                //         this.AImove(this.righthand, this.speed, this.gamepad)
                //     }
                //     if (this.lefthand.anchored == 0) {
                //         this.AImove(this.lefthand, this.speed, this.gamepad)
                //     }
                //     this.doubleJump()
                // }
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            }
            // }
            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.leftshoulder.ymom * .99
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.rightshoulder.ymom * .99
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     // this.body.sxmom *= 0
                    //     this.body.xmom *= .5
                    // }
                }
                this.body.ymom += this.gravity
            } else {

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            } else {
                //this.collideStage()
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            } else {
                //this.collideStage()
            }
            this.righthand.ymom += this.gravity
            this.lefthand.ymom += this.gravity


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            this.body.xmom *= .99
            this.body.ymom *= .99

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].frictiveMove(this)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].smove(this)
                }
            }

            this.lefthand.xmom += (this.lefthand.x - this.body.x) / 80
            this.righthand.xmom += (this.righthand.x - this.body.x) / 80
            this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40
            this.fixupshoulder()

            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

            // this.leftshoulder.xmom *= 0
            // this.leftshoulder.ymom *= 0

            // this.rightshoulder.xmom *= 0
            // this.rightshoulder.ymom *= 0

            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            if (boys.indexOf(this) <= humanPlayers) {

                // this.AI()
                this.fightcontrol()
            } else {
                this.AI()
            }
            // }
            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }
            if (this.screwangle != 0) {
                const link1 = new Line(this.rightshoulder.x, this.rightshoulder.y, this.rightshoulder.x + 50, this.rightshoulder.y + 50, invertColor(this.body.color), 8)
                const link2 = new Line(this.leftshoulder.x, this.leftshoulder.y, this.leftshoulder.x - 50, this.leftshoulder.y + 50, invertColor(this.body.color), 8)
                link1.draw()
                link2.draw()
            }

        }
    }




    class Jox {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                this.ping = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 3
                this.serverID = serverID
                this.shotdraw = 0
                this.id = controller
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 0
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shot = {}
                this.striker = 10000
                this.name = "Jox"
                this.blasting = 0
                this.reflecting = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.storeshield = 0
                this.wasfalse = []
                for (let t = 0; t < 100; t++) {
                    this.wasfalse.push(1)
                }
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = 0
                this.screwangle = 0
                this.charge = 0
                this.shots = []

                this.color = getRandomColor()
                if (controller == 0) {
                    this.color = "#ffAA00"
                }
                if (controller == 1) {
                    this.color = "#ff0000"
                }
                this.body = new ShotC(400 + (Math.random() * 2560), 500, 39.5, this.color)
                this.controller = controller
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.armlength = 12
                this.shoulderwidth = 12
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 11.5
                this.punchspeed = 5
                this.grounded = 0
                this.frame = 0
                this.jumping = 1


                this.nodes.push(this.body)
                this.leftshoulder = new ShotC(this.body.x - (this.body.radius + this.shoulderwidth), 350, 12, "magenta", 0, 0, .999)
                this.rightshoulder = new ShotC(this.body.x + (this.body.radius + this.shoulderwidth), 350, 12, "#FF0000", 0, 0, .999)
                this.lefthand = new ShotC(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 19, "magenta", 0, 0, .85)
                this.righthand = new ShotC(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 19, "#FF0000", 0, 0, .85)
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.gravity = 1
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.body.fired = 0
                this.screwmomentum = 0
                this.screwtimer = 0
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {
                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]
                }
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                this.jumpcount = args['jumpcount']
                this.armlength = 12
                this.shoulderwidth = 12

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    this.nodes[t] = new ShotC(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }
                    this.nodes[t].id = idsto
                }

                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                    this.shots[t] = new ShotC(this.shots[t].x, this.shots[t].y, this.shots[t].radius, this.shots[t].color, this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                    this.shots[t].id = idsto
                }
                this.id = args["id"]
                this.frame = args['frame']
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }
                this.rightshoulder = this.nodes[2]
                this.leftshoulder = this.nodes[1]
                this.righthand = this.nodes[3]
                this.lefthand = this.nodes[4]

                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }
            }
        }
        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            object.ymom = -this.speed * 1 * 2
                        } else {
                            if (this.lefthand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                            if (this.righthand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 2
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            const copy = new Jox(this.controller)
            if(minigameSelected == 2){
                stage.joxwallscore = 0
                stage.joxwalltick = 70
                stage.walls = []
            }
            copy.id = this.id
            copy.frame = this.frame
            copy.body.color = this.body.color
            if (this.inactive == 1) {
                copy.inactive = 1
            } copy.serverID = this.serverID
            copy.striker = this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

            return copy
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }

            if (this.screwtimer <= 0) {

                this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth * .3)
                this.leftshoulder.y = this.body.y + (this.shoulderwidth * .7)

                this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth * .3)
                this.rightshoulder.y = this.body.y + (this.shoulderwidth * .7)

                this.leftshoulder.color = this.body.color
                this.rightshoulder.color = this.body.color
                this.lefthand.color = this.body.color
                this.righthand.color = this.body.color


                if (this.lefthand.anchored == 0) {
                    this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth * .3)))
                    this.lefthand.y -= this.leftshoulder.y - (this.body.y + (this.shoulderwidth * .7))
                    this.leftshoulder.xmom *= 0
                    this.leftshoulder.ymom *= 0
                }
                if (this.righthand.anchored == 0) {
                    this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth * .3)))
                    this.righthand.y -= this.rightshoulder.y - (this.body.y + (this.shoulderwidth * .7))
                    this.rightshoulder.xmom *= 0
                    this.rightshoulder.ymom *= 0
                }

                if (this.body.ymom < -vsmashlimit) {
                    this.body.ymom = -vsmashlimit
                }

            } else {



                this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth * 4)
                this.leftshoulder.y = this.body.y + (this.shoulderwidth * .7)

                this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth * 4)
                this.rightshoulder.y = this.body.y + (this.shoulderwidth * .7)

                this.leftshoulder.color = this.body.color
                this.rightshoulder.color = this.body.color
                this.lefthand.color = this.body.color
                this.righthand.color = this.body.color


                if (this.lefthand.anchored == 0) {
                    this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth * 4)))
                    this.lefthand.y -= this.leftshoulder.y - (this.body.y + (this.shoulderwidth * .7))
                    this.leftshoulder.xmom *= 0
                    this.leftshoulder.ymom *= 0
                }
                if (this.righthand.anchored == 0) {
                    this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth * 4)))
                    this.righthand.y -= this.rightshoulder.y - (this.body.y + (this.shoulderwidth * .7))
                    this.rightshoulder.xmom *= 0
                    this.rightshoulder.ymom *= 0
                }

                if (this.body.ymom < -vsmashlimit) {
                    this.body.ymom = -vsmashlimit
                }
            }






            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }

        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (this.reflecting <= 0) {
                                            if (AItoggle == 0  && localPlayToggle == 0) {
                                                this.striker = boys[t].serverID
                                            } else if (AItoggle == 1 || localPlayToggle == 1) {
                                                this.striker = t
                                            }
                                            this.struck = 1
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 200)) + (boys[t].shots[k].xmom * baselaunch)) * 2
                                                this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 200)) + (boys[t].shots[k].ymom * baselaunch)) * 2) - (10 * (this.damage / 200))
                                                this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                                this.breaktimer = 0
                                            }
                                            boys[t].shots[k].marked = 1
                                        } else {
                                            boys[t].shots[k].ymom *= -1
                                            boys[t].shots[k].xmom *= -1
                                            boys[t].shots[k].marked = 0
                                            this.shots.push(boys[t].shots[k])
                                            boys[t].shots.splice(k, 1)
                                        }
                                    }
                                }
                            }



                            if (boys[t].hasOwnProperty('radball')) {
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }

                            const enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }


                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 200)) + (boys[t].bananahand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 200)) + (boys[t].bananahand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 200)) + (boys[t].middlehand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 200)) + (boys[t].middlehand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {

                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 200)) + (boys[t].righthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 200)) + (boys[t].righthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14

                                            this.shotIDs.push(boys[t].righthand2.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 200)) + (boys[t].lefthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 200)) + (boys[t].lefthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 200)) + (boys[t].righthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 200)) + (boys[t].righthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 200)) + (boys[t].lefthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 200)) + (boys[t].lefthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)

                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }

                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 200)) + (boys[t].righthand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 200)) + (boys[t].righthand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].lefthand.fired > 14) {

                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)

                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            } else {
                                                this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 200)) + (boys[t].lefthand.xmom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 200)) + (boys[t].lefthand.ymom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)) * 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 200)) + (boys[t].body.xmom * baselaunch) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].body.ymom * (this.damage / 200)) + (boys[t].body.ymom * baselaunch)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        this.fixupshoulder()
                        boys[f].fixupshoulder()
                        this.body.ymom *= .99
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2
                this.lefthand.ymom = -this.speed * 2
                this.righthand.ymom = -this.speed * 2
                this.jumpcount = 100

            }
        }
        doJump(object, speed) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -speed * 2
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 2
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {
            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 1500) {
                this.wmove = 0
                this.screwshot = 0
            }
            this.jumpcount--

            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }

            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }

        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                this.fleeing = 1
            }
            if (this.charge > 90) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + Math.max(this.body.radius, boys[t].body.radius))) {
                        this.wmove = 1
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 5) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 5) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 5) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 5) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        if (Math.random() < .2) {
                            this.wmove = 1
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }

            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    this.screwshot = 1
                    this.wmove = 1
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    this.screwshot = 1
                }
            }
            this.exgrip = 0
            for (let t = 0; t < boys.length; t++) {
                if (this.amomu <= 0 && this.dmomu <= 0) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].brick.center.y > this.brick.center.y) {
                            if (boys[t].body.x < this.body.x) {
                                this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                this.amomu += 15
                                this.exgrip = 1
                            } else {
                                this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                this.dmomu += 15
                                this.exgrip = 1
                            }
                        }
                    }
                } else {
                    this.exgrip = 1
                }
            }





            if (this.dmom > 0) {
                if (Math.random() < .003) {
                    this.screwshot = 1
                }
                this.dmove = 1
                this.wmove = 1
                //this.amomu = 0
                //this.dmomu = 0
            }
            if (this.amom > 0) {
                if (Math.random() < .003) {
                    this.screwshot = 1
                }
                this.amove = 1
                this.wmove = 1
                //this.amomu = 0
                //this.dmomu = 0
            }

            if (this.dmomu > 0) {
                this.dmove = 1
                this.amove = 0
                //this.amomu = 0
                this.screwshot = 0
                this.righthand.anchored = - 5
                this.lefthand.anchored = - 5
                if (Math.random() < .5) {
                    this.wmove = 0
                }
            }
            if (this.amomu > 0) {
                this.amove = 1
                this.dmove = 0
                //this.dmomu = 0
                this.screwshot = 0
                this.righthand.anchored = - 5
                this.lefthand.anchored = - 5
                if (Math.random() < .5) {
                    this.wmove = 0
                }
            }

            if (this.safe == 0) {
                if (this.under == 0) {
                    this.screwshot = 1
                }
                if (this.body.x > (this.brick.center.x)) {
                    this.leftshot = 1
                    this.rightshot = 0
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                } else {
                    this.rightshot = 1
                    this.leftshot = 0
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }

            if (this.trapped == 0) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]
                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        const runtimeR = xdisR / this.speed
                                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .9)) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        const runtimeL = xdisL / this.speed
                                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .9)) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }
                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        const runtimeR = xdisR / this.speed
                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .9)) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1
                                this.wmove = 1
                            }
                        }
                    } else {
                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        const runtimeL = xdisL / this.speed
                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .9)) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1
                                this.wmove = 1
                            }
                        }
                    }
                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }

            if (this.body.y < 1500) {
                this.wmove = 0
                this.screwshot = 0
            }
            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                        break
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }


                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }

                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 2
                    } else {
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                    }
                }
                if (this.dmove == 1) {
                    this.face = 1
                    if (object == this.body) {
                        object.x += speed
                        this.righthand.x -= speed
                        this.lefthand.x -= speed
                    }
                    if (this.righthand.anchored == 1) {
                        this.degripr()
                        this.jumping = 1
                    }
                }
                // if (keysPressed['s']) {
                //     object.y += speed
                //     this.degrip()
                // }
                if (this.amove == 1) {
                    this.face = -1
                    if (object == this.body) {
                        object.x -= speed
                        this.righthand.x -= speed
                        this.lefthand.x -= speed
                    }
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        this.degripl()
                        this.jumping = 1
                    }
                }


                // if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                // if (controller.gamepad.axesStatus[0] > .1) {
                //     this.face = 1
                // }

                // if (controller.gamepad.axesStatus[1] < -.1) {
                //     this.face = -1
                // }
                // }

            }
            // if (this.dmomu > 0 || this.amomu > 0) {
            //     this.lefthand.anchored = 0
            //     this.righthand.anchored = 0
            // }

            if (this.exgrip == 1) {
                this.righthand.anchored = 0
                this.lefthand.anchored = 0
            }

        }
        AI() {
            this.idify()
            if (this.inactive == 1) {
                return
            }
            this.breaks()

            if (this.screwtimer > 0) {
                this.screwtimer--
                if (this.screwtimer <= 65) {
                    if (this.screwtimer >= 30) {
                        this.body.ymom = -jumplimit
                    }
                }
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.reflecting--
            this.blasting--
            if (this.blasting == 0) {
                this.body.xmom *= .5
            }
            this.righthand.fired--
            this.charge--
            if (this.charge <= 0) {
                this.charge = 0
            }
            this.body.fired -= 1
            this.lefthand.fired--

            this.breaktimer--

            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01) {
                this.rightshot = 0
            }
            if (Math.random() < .01) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {


                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.hortsmash = 1
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.body.y > 1500) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 50 && this.body.y < boys[t].body.y) {
                        this.downspike = 1
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {
                        this.downspike = 1
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < 70 && (this.body.y - boys[t].body.y) > 100) {
                        this.screwshot = 1
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == 1) {
                                this.hortsmash = 1
                            }
                        }
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == -1) {
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .09) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < 30 && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                if (Math.abs(this.body.x - boys[t].body.x) > 100) {
                                    this.leftshot = 1
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < 30 && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                if (Math.abs(this.body.x - boys[t].body.x) > 100) {
                                    this.rightshot = 1
                                }
                            }
                        }
                    }


                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }

            if (this.safe == 0) {
                this.screwshot = 1
                if (this.under == 0) {
                    this.screwshot = 1
                } else {
                    this.wmove = 1
                }
            }

            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        this.shieldpower -= .63
                        this.shield = 1
                        this.shielddraw = 1
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }

            if (this.breaktimer <= 0 && this.shield == 0) {


                if (this.body.y < 1500) {
                    this.wmove = 0
                    this.screwshot = 0
                }
                if (this.screwshot == 1) {
                    if (this.body.fired <= 0) {
                        if (this.screwangle == 0) {
                            this.jumping = 1
                            this.screwangle = Math.PI * 1.5
                            this.screwtimer = 75
                            this.lefthand.ymom = -70
                            this.righthand.ymom = -70
                            this.lefthand.xmom = 25
                            this.righthand.xmom = -25
                            this.lefthand.fired = 40
                            this.righthand.fired = 40
                            this.body.fired = 75
                            this.lefthand.anchored = -10
                            this.righthand.anchored = -10
                            this.body.ymom = -jumplimit
                        }
                    }
                }
                if (this.downspike == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.ymom = this.punchspeed * 12
                            this.righthand.xmom = -this.punchspeed * - 10.1
                            this.righthand.fired = 18
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = this.punchspeed * 12
                            this.lefthand.xmom = this.punchspeed * - 10.1
                            this.lefthand.fired = 18
                        }
                    }
                }
                if (this.hortsmash == 1) {
                    if (this.reflecting <= -10) {
                        this.reflecting = 20
                        this.lefthand.xmom = this.punchspeed * -23.5
                        this.lefthand.fired = 19
                        this.righthand.xmom = -this.punchspeed * -23.5
                        this.righthand.fired = 19
                        this.righthand.ymom = this.punchspeed * 3
                        this.lefthand.ymom = this.punchspeed * 3
                    }
                }



                if (this.body.x < 35 * 20) {
                    this.leftshot = 0
                }
                if (this.body.x > (canvas.width * invscale) - 35 * 20) {
                    this.rightshot = 0
                }

                if (this.blasting <= -45) {
                    if (this.rightshot == 1) {
                        if (this.face == 1) {
                            if (this.righthand.anchored == 0) {
                                if (this.charge <= 0) {
                                    this.righthand.fired = 19
                                    if (this.righthand.anchored == 0) {
                                        this.charge += 40.5
                                    }
                                    this.body.xmom = 35
                                    if (this.body.ymom > 0) {
                                        this.body.ymom = -1
                                    }
                                    this.grounded = 0
                                    this.jumping = 1
                                    this.body.fired = 31 // 20
                                    this.blasting = 20
                                }
                            }
                        }
                    }
                    if (this.leftshot == 1) {
                        if (this.face == -1) {
                            if (this.lefthand.anchored == 0) {
                                if (this.charge <= 0) {
                                    this.lefthand.fired = 19
                                    if (this.lefthand.anchored == 0) {
                                        this.charge += 40.5
                                    }
                                    this.body.xmom = -35
                                    if (this.body.ymom > 0) {
                                        this.body.ymom = -1
                                    }
                                    this.grounded = 0
                                    this.jumping = 1
                                    this.body.fired = 31 // 20
                                    this.blasting = 20
                                }
                            }
                        }
                    }
                }

            }

        }
        fightcontrol() {
            if (this.inactive == 1) {
                return
            }

            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()


            if (this.screwtimer > 0) {
                this.screwtimer--
                if (this.screwtimer <= 65) {
                    if (this.screwtimer >= 30) {
                        this.body.ymom = -jumplimit
                    }
                }
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.reflecting--
            this.blasting--
            if (this.blasting == 0) {
                this.body.xmom *= .5
            }
            this.righthand.fired--
            this.charge--
            if (this.charge <= 0) {
                this.charge = 0
            }
            this.body.fired -= 1
            this.lefthand.fired--


            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            this.breaktimer--
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }

            if (this.breaktimer <= 0 && this.shield == 0) {
                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {



                    if (this.blasting <= -45) {
                        if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {
                            if (this.face == 1) {
                                if (this.righthand.anchored == 0) {
                                    if (this.charge <= 0) {
                                        this.righthand.fired = 19
                                        if (this.righthand.anchored == 0) {
                                            this.charge += 40.5
                                        }
                                        this.body.xmom = 35
                                        if (this.body.ymom > 0) {
                                            this.body.ymom = -1
                                        }
                                        this.grounded = 0
                                        this.jumping = 1
                                        this.body.fired = 31 // 20
                                        this.blasting = 20
                                    }
                                }
                            }
                            if (this.face == -1) {
                                if (this.lefthand.anchored == 0) {
                                    if (this.charge <= 0) {
                                        this.lefthand.fired = 19
                                        if (this.lefthand.anchored == 0) {
                                            this.charge += 40.5
                                        }
                                        this.body.xmom = -35
                                        if (this.body.ymom > 0) {
                                            this.body.ymom = -1
                                        }
                                        this.grounded = 0
                                        this.jumping = 1
                                        this.body.fired = 31 // 20
                                        this.blasting = 20
                                    }
                                }
                            }
                        }
                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {

                        if (this.screwangle == 0) {
                            if (this.body.fired <= 0) {
                                this.jumping = 1
                                this.screwangle = Math.PI * 1.5
                                this.screwtimer = 75
                                this.lefthand.fired = 40
                                this.righthand.fired = 40
                                this.lefthand.ymom = -70
                                this.righthand.ymom = -70
                                this.lefthand.xmom = 25
                                this.righthand.xmom = -25
                                this.body.fired = 75
                                this.lefthand.anchored = -10
                                this.righthand.anchored = -10
                                this.body.ymom = -jumplimit
                                this.idify()
                            }
                        }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.ymom = this.punchspeed * 12
                                this.righthand.xmom = -this.punchspeed * - 10.1
                                this.righthand.fired = 18
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = this.punchspeed * 12
                                this.lefthand.xmom = this.punchspeed * - 10.1
                                this.lefthand.fired = 18
                                this.idify()
                            }
                        }
                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
                        if (this.reflecting <= -10) {
                            this.reflecting = 20
                            this.lefthand.xmom = this.punchspeed * -23.5
                            this.lefthand.fired = 19
                            this.righthand.xmom = -this.punchspeed * -23.5
                            this.righthand.ymom = this.punchspeed * 3
                            this.lefthand.ymom = this.punchspeed * 3
                            this.righthand.fired = 19
                            this.idify()
                        }
                    }
                }
            }
        }
        degripl() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        degripr() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        collideStage() {
            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {
            if (this.inactive == 1) {
                return
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.grounded = 0
            this.frame++

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.shots.length; t++) {
                    if (typeof this.shots[t].gravity == "number") {
                        this.shots[t].ymom += this.shots[t].gravity
                    }
                    if (typeof this.shots[t].countdown == "number") {
                        this.shots[t].countdown--
                        this.shots[t].gravity = Math.cos(this.shots[t].countdown * (Math.PI / 4)) * 20
                        if (this.shots[t].countdown <= 0) {
                            this.shots[t].marked = 1
                        }
                    }
                    this.shots[t].move()
                    if (this.shots[t].marked <= 0) {
                        this.shots[t].color = this.body.color
                        this.shots[t].draw()
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].color = this.body.color
                            this.shots[t].draw()
                        }
                    }
                }
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].marked == 1) {
                    this.shots.splice(t, 1)
                } else {
                    this.shots[t].marked--
                }
            }
            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.collideStage()
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].color = invertColor(this.body.color)
                this.links[t].draw()
            }
            for (let t = 0; t < this.nodes.length; t++) {
                this.nodes[t].draw()
            }

            // }
            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }
            // if (this.screwangle != 0) {
            //         const link1 = new Line(this.rightshoulder.x, this.rightshoulder.y, this.rightshoulder.x+50, this.rightshoulder.y+50,  invertColor(this.body.color), 8)
            //         const link2 = new Line(this.leftshoulder.x, this.leftshoulder.y, this.leftshoulder.x-50, this.leftshoulder.y+50,  invertColor(this.body.color), 8)
            //         link1.draw()
            //         link2.draw()
            // }

            // if (this.controller == 0) {

            const link = new Line(this.body.x, this.body.y, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y + Math.sin(this.screwangle), invertColor(this.body.color), this.body.radius * .2)

            canvas_context.lineWidth = this.strokeWidth
            canvas_context.strokeStyle = invertColorx(this.body.color)
            canvas_context.fillStyle = invertColorx(this.body.color)
            canvas_context.beginPath();
            canvas_context.fillRect(((this.body.x - (this.body.radius * .4 * (-this.face)))) - ((this.body.radius * .4)), this.body.y - (this.body.radius * .4), (this.body.radius * .8), (this.body.radius * .8))
            canvas_context.fill()
            canvas_context.strokeStyle = invertColorx(this.body.color)
            canvas_context.fillStyle = invertColor(this.body.color)
            canvas_context.beginPath();
            canvas_context.fillRect(((this.body.x - (this.body.radius * .2 * (-this.face)))) - ((this.body.radius * .2)), this.body.y - (this.body.radius * .2), (this.body.radius * .4), (this.body.radius * .4))
            canvas_context.fill()
            canvas_context.stroke();
            // if (this.screwangle == 0) {
            //     link.draw()
            // }

            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.lefthand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
            canvas_context.font = "42px arial"
            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 70)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            if(minigameSelected != 2){
                canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 70)
            canvas_context.fillStyle = "white"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 110)
            }
            }
            // if (this != boys[0]) {
            //     canvas_context.fillText(`${Math.round(this.dmomu)},${Math.round(this.amomu)}`, this.body.x - 20, this.body.y - 150)
            //     canvas_context.fillText(`Under:${Math.round(this.under)},Safe:${Math.round(this.safe)}`, this.body.x - 20, this.body.y - 200)
            //     canvas_context.fillText(`Height:${Math.round(this.brick.edgeright.y)}`, this.body.x - 20, this.body.y - 250)
            //     if (this.fleeing == 1) {
            //         canvas_context.fillText(`fleeing`, this.body.x - 20, this.body.y - 100)
            //     }
            // }

            if (this.reflecting > 0) {
                const polygot = new Polygon(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.lefthand.radius, getRandomColor(), 7, 0, 0, (Math.PI / 2))
                polygot.draw()
            }

        }
        operate() {

            if (this.inactive == 1) {
                return
            }
            if (this.righthand.anchored == 1) {
                if (this.body.x > this.righthand.x) {
                    this.righthand.anchored = -10
                }
            }
            if (this.lefthand.anchored == 1) {
                if (this.body.x < this.lefthand.x) {
                    this.lefthand.anchored = -10
                }
            }

            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {
            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            }
            // }
            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                if (this.blasting <= 0) {
                    this.body.xmom *= .95
                }
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.leftshoulder.ymom * .99
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.rightshoulder.ymom * .99
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     // this.body.sxmom *= 0
                    //     this.body.xmom *= .5
                    // }
                }
                this.body.ymom += this.gravity
            } else {

                this.jumpcount = 0
                this.jumping -= .5

                if (this.blasting <= 0) {
                    this.body.xmom *= .7
                }

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            } else {
                // //this.collideStage()
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            } else {
                // //this.collideStage()
            }
            this.righthand.ymom += this.gravity
            this.lefthand.ymom += this.gravity


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            this.body.xmom *= .99
            this.body.ymom *= .99

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].frictiveMove(this)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].smove(this)
                }
            }
            this.lefthand.xmom += (this.lefthand.x - this.body.x) / 80
            this.righthand.xmom += (this.righthand.x - this.body.x) / 80
            this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40
            this.fixupshoulder()

            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

            // this.leftshoulder.xmom *= 0
            // this.leftshoulder.ymom *= 0

            // this.rightshoulder.xmom *= 0
            // this.rightshoulder.ymom *= 0





            //this.collideStage()
            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            if (boys.indexOf(this) <= humanPlayers) {

                // this.AI()
                this.fightcontrol()
            } else {
                this.AI()
            }
        }
    }



    class Dummy {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                this.ping = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 10
                this.shotdraw = 0
                this.serverID = serverID
                this.id = controller
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 0
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shot = new Brick(-1, -1, 1, 1)
                this.striker = 10000
                this.name = "Dummy"
                this.blasting = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.storeshield = 0
                this.wasfalse = []
                for (let t = 0; t < 100; t++) {
                    this.wasfalse.push(1)
                }
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = 0
                this.screwangle = 0
                this.charge = 0
                this.shots = []

                this.color = getRandomColor()
                if (controller == 0) {
                    this.color = "#ffAA00"
                }
                if (controller == 1) {
                    this.color = "#ff0000"
                }
                if(minigameSelected == 3){
                this.body = new Shot(400 + (Math.random() * 2560), 500, 75, this.color)
                }else if(minigameSelected == 8){
                this.body = new Shot(400 + (Math.random() * 2560), 500, 105, this.color)
                }else{
                this.body = new Shotb(400 + (Math.random() * 2560), 500, 75, this.color)
                }
                this.controller = controller
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.armlength = 1
                this.shoulderwidth = 1
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 11.5
                this.punchspeed = 5
                this.frame = 0
                this.grounded = 0
                this.jumping = 1

                this.nodes.push(this.body)
                this.leftshoulder = new Shotb(this.body.x - (this.body.radius + this.shoulderwidth), 350, 17, "magenta", 0, 0, .999)
                this.rightshoulder = new Shotb(this.body.x + (this.body.radius + this.shoulderwidth), 350, 17, "#FF0000", 0, 0, .999)
                this.lefthand = new Shotb(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 24, "magenta", 0, 0, .85)
                this.righthand = new Shotb(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 24, "#FF0000", 0, 0, .85)
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.gravity = 1
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.body.fired = 0
                this.screwmomentum = 0
                this.screwtimer = 0
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {
                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]
                }
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    this.nodes[t] = new Shotb(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }
                    this.nodes[t].id = idsto
                }

                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                    this.shots[t] = new Shotb(this.shots[t].x, this.shots[t].y, this.shots[t].radius, this.shots[t].color, this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                    this.shots[t].id = idsto

                }
                this.id = args["id"]
                this.frame = args['frame']
                this.armlength = 1
                this.shoulderwidth = 1
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }
                this.rightshoulder = this.nodes[2]
                this.leftshoulder = this.nodes[1]
                this.righthand = this.nodes[3]
                this.lefthand = this.nodes[4]

                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }

            }
        }

        playerMove(object) {
            // if(minigameSelected == 3){
                return
            // }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            object.ymom = -this.speed * 1 * 2
                        } else {
                            if (this.lefthand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                            if (this.righthand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 2
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            const copy = new Dummy(this.controller)


            copy.id = this.id
            copy.frame = this.frame
            copy.body.color = this.body.color
            if (this.inactive == 1) {
                copy.inactive = 1
            } copy.serverID = this.serverID
            copy.striker = this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

        if(minigameSelected == 5 || minigameSelected == 7){
            copy.life = this.life
        }

                if(minigameSelected == 7){
                    copy.body.y = 2000
                    copy.body.radius = 150
                    if(Math.random() < 0.15){
                        copy.body.radius = 40
                        copy.body.color = "#FFAA00"
                    }else{
                        copy.body.color = "#FF0000"
                    }
            copy.life = 350
                }
            if(minigameSelected == 3){
                let angle = 0
                for(let t = 0;t<8;t++){
                    const circ = new Shot(this.body.x, this.body.y, 25, this.body.color, Math.cos(angle)*22, Math.sin(angle)*22)
                    circ.life = 22
                    if(stage.popslength+8 > (stage.pops.length)){
                        stage.pops.push(circ)
                    }
                    angle += (Math.PI/4)
                }
                copy.body.radius*= 2
                copy.body.gravity = 1.5
                copy.body.color = getRandomColor()
                copy.body.radius += (Math.random()-.5)*50


                const now = new Date()
                    campaigntime = now.getTime() - campaigntimestart
                    let seconds = campaigntime
                    seconds = Math.floor(seconds / 1000)  
                    if(seconds < 60){
                        stage.joulepopscore++
                    }
                stage.mostrecentpopcolor = getRandomLightColor()
            }

            return copy
        }
        control() {
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }
            this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth * .3)
            this.leftshoulder.y = this.body.y - (this.shoulderwidth * .7)

            this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth * .3)
            this.rightshoulder.y = this.body.y - (this.shoulderwidth * .7)

            this.leftshoulder.color = this.body.color
            this.rightshoulder.color = this.body.color
            this.lefthand.color = this.body.color
            this.righthand.color = this.body.color


            if (this.lefthand.anchored == 0) {
                this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth * .3)))
                this.lefthand.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                this.leftshoulder.xmom *= 0
                this.leftshoulder.ymom *= 0
            }
            if (this.righthand.anchored == 0) {
                this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth * .3)))
                this.righthand.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                this.rightshoulder.xmom *= 0
                this.rightshoulder.ymom *= 0
            }

            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
        }

        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            if(minigameSelected == 3){
                for(let t =0;t<stage.pops.length;t++){
                    if(this.body.doesPerimeterTouch(stage.pops[t])){
                        this.body.radius -= 190.5 / stage.pops[t].radius
                        if(this.body.radius < 30){
                                                boys[boys.indexOf(this)] = this.copy()
                                                break
                                            }
                    }
                }
            }
            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (this.shield == 1) {
                                            //shieldaud1.play()
                                            this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                        } else {

                                            if(minigameSelected == 7){

                                                const now = new Date()
                                                campaigntime = now.getTime() - campaigntimestart
                                                let seconds = campaigntime
                                                seconds = Math.floor(seconds / 1000)    
                                                if(seconds<60){
                                                    stage.coreboywhackscore++
                                                boys[boys.indexOf(this)] = this.copy()
                                                if(this.body.color == "#FFAA00"){
                                                    stage.coreboywhackscore+= 5
                                                }
                                                }

                                                break
                                            }
                                            //punchaud1.playbackrate = 2
                                            //punchaud1.play()
                                            this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 200)) + (boys[t].shots[k].xmom * baselaunch)) * 2
                                            this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 200)) + (boys[t].shots[k].ymom * baselaunch)) * 2) - (10 * (this.damage / 200))
                                            this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                            this.breaktimer = 0
                                        }
                                        boys[t].shots[k].marked = 1
                                    }
                                }
                            }



                            if (boys[t].hasOwnProperty('radball')) {

                                if(minigameSelected == 3){
                                    if (boys[t].radball.doesPerimeterTouch(this.body)) {
                                            this.body.radius-= 190.5 / boys[t].radball.radius
                                            if(this.body.radius < 30){
                                                boys[boys.indexOf(this)] = this.copy()
                                                break
                                            }
                                        }
                                    }
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }

                            const enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }


                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 200)) + (boys[t].bananahand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 200)) + (boys[t].bananahand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 200)) + (boys[t].middlehand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 200)) + (boys[t].middlehand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                //shieldaud1.play()
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                //punchaud1.playbackrate = 2
                                                //punchaud1.play()
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 200)) + (boys[t].righthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 200)) + (boys[t].righthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14

                                            this.shotIDs.push(boys[t].righthand2.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            //shieldaud1.play()
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            //punchaud1.playbackrate = 2
                                            //punchaud1.play()
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 200)) + (boys[t].lefthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 200)) + (boys[t].lefthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            //shieldaud1.play()
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            //punchaud1.playbackrate = 2
                                            //punchaud1.play()
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 200)) + (boys[t].righthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 200)) + (boys[t].righthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            //shieldaud1.play()
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            //punchaud1.playbackrate = 2
                                            //punchaud1.play()
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 200)) + (boys[t].lefthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 200)) + (boys[t].lefthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)

                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }

                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                //shieldaud1.play()
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                //punchaud1.playbackrate = 2
                                                //punchaud1.play()
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 200)) + (boys[t].righthand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 200)) + (boys[t].righthand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].lefthand.fired > 14) {

                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)
                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                //shieldaud1.play()
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            } else {
                                                //punchaud1.playbackrate = 2
                                                //punchaud1.play()
                                                this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 200)) + (boys[t].lefthand.xmom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 200)) + (boys[t].lefthand.ymom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)) * 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }

                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                //shieldaud1.play()
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                //punchaud1.playbackrate = 2
                                                //punchaud1.play()
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 200)) + (boys[t].body.xmom * baselaunch) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].body.ymom * (this.damage / 200)) + (boys[t].body.ymom * baselaunch)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        this.fixupshoulder()
                        boys[f].fixupshoulder()
                        
                        if(minigameSelected !== 8){
                            this.body.ymom *= .99
                        }else{
                            this.body.xmom *= .89
}
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2
                this.lefthand.ymom = -this.speed * 2
                this.righthand.ymom = -this.speed * 2
                this.jumpcount = 100
            }
        }
        doJump(object, speed) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -speed * 2
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 2
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {
            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            this.jumpcount--

            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {

            if (this.inactive == 1) {
                return
            }
            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }

        AImove(object, speed) {
        }
        AI() {
            this.idify()
        }
        fightcontrol() {
        }
        degripl() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        degripr() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        collideStage() {
            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
        }
        draw() {
            if (this.inactive == 1) {
                return
            }
            if(minigameSelected == 8){
                this.gravity = .75 //- Math.min(0.45, (this.damage*.0025))
                this.body.radius = 200// + Math.min(115, (this.damage*.2))
                this.body.friction = .95
                this.damage = 200
            }

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.grounded = 0
            this.frame++
            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.collideStage()
            this.body.draw()
            const link = new Line(this.body.x, this.body.y, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y + Math.sin(this.screwangle), invertColor(this.body.color), this.body.radius * .2)

            canvas_context.lineWidth = this.strokeWidth
            canvas_context.strokeStyle = (this.body.color)
            canvas_context.beginPath();
            canvas_context.arc(((link.x1 + link.x2) * .5) + Math.cos(this.screwangle), link.y1 - this.body.radius * .35, this.body.radius * .35, this.screwangle, (Math.PI * 1) + this.screwangle, false)
            canvas_context.fillStyle = (this.body.color)
            canvas_context.fill()
            canvas_context.stroke();
            canvas_context.beginPath();
            canvas_context.arc(((link.x1 + link.x2) * .5) + Math.cos(this.screwangle), link.y1 + this.body.radius * .35, this.body.radius * .35, this.screwangle, (Math.PI * 1) + this.screwangle, true)
            canvas_context.fillStyle = (this.body.color)
            canvas_context.fill()
            canvas_context.stroke();
            // if (this.screwangle == 0) {
            //     link.draw()
            // }
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.lefthand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
            canvas_context.font = "42px arial"
            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 100)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            if(minigameSelected == 3 || minigameSelected == 5|| minigameSelected == 7 || minigameSelected == 8){


                if(minigameSelected == 5 || minigameSelected == 7 ){
                    canvas_context.fillStyle = "white"
                    canvas_context.fillText(`${Math.round(this.life*.1)}`, this.body.x - 20, this.body.y - 100)
                }

            }else{
            canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 100)
            canvas_context.fillStyle = "white"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 110)
            }

        }
            // if (this != boys[0]) {
            //     canvas_context.fillText(`${Math.round(this.dmomu)},${Math.round(this.amomu)}`, this.body.x - 20, this.body.y - 150)
            //     canvas_context.fillText(`Under:${Math.round(this.under)},Safe:${Math.round(this.safe)}`, this.body.x - 20, this.body.y - 200)
            //     canvas_context.fillText(`Height:${Math.round(this.brick.edgeright.y)}`, this.body.x - 20, this.body.y - 250)
            //     if (this.fleeing == 1) {
            //         canvas_context.fillText(`fleeing`, this.body.x - 20, this.body.y - 100)
            //     }
            // }


        }
        operate() {
            if (this.inactive == 1) {
                return
            }

            if (this.righthand.anchored == 1) {
                if (this.body.x > this.righthand.x) {
                    this.righthand.anchored = -10
                }
            }
            if (this.lefthand.anchored == 1) {
                if (this.body.x < this.lefthand.x) {
                    this.lefthand.anchored = -10
                }
            }

            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {

            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            }
            // }
            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.leftshoulder.ymom * .99
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.rightshoulder.ymom * .99
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     // this.body.sxmom *= 0
                    //     this.body.xmom *= .5
                    // }
                }
                this.body.ymom += this.gravity
            } else {

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            } else {
                //this.collideStage()
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            } else {
                //this.collideStage()
            }
            this.righthand.ymom += this.gravity
            this.lefthand.ymom += this.gravity


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            this.body.xmom *= .99
            this.body.ymom *= .99

            this.body.frictiveMove(this)
            this.body.smove()

            this.lefthand.xmom += (this.lefthand.x - this.body.x) / 80
            this.righthand.xmom += (this.righthand.x - this.body.x) / 80
            this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40
            this.fixupshoulder()
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }
            if (this.screwangle != 0) {
                const link1 = new Line(this.rightshoulder.x, this.rightshoulder.y, this.rightshoulder.x + 50, this.rightshoulder.y + 50, invertColor(this.body.color), 8)
                const link2 = new Line(this.leftshoulder.x, this.leftshoulder.y, this.leftshoulder.x - 50, this.leftshoulder.y + 50, invertColor(this.body.color), 8)
                link1.draw()
                link2.draw()
            }

        }
    }


    class ScorchedMass {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                this.ping = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 4
                this.serverID = serverID
                this.shotdraw = 0
                this.id = controller
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 0
                this.detonate = 0
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shielddraw = 0
                this.shot = {}
                this.safe = 1
                this.striker = 10000
                this.name = "Scorched Mass"
                this.blasting = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.storeshield = 0
                this.wasfalse = []
                for (let t = 0; t < 100; t++) {
                    this.wasfalse.push(1)
                }
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = 0
                this.screwangle = 0
                this.charge = 0
                this.shots = []


                this.color = getRandomColor()
                if (controller == 0) {
                    this.color = "#ffAA00"
                }
                if (controller == 1) {
                    this.color = "#ff0000"
                }
                this.body = new ShotD(400 + (Math.random() * 2560), 500, 39.5, this.color)

                this.controller = controller
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.armlength = 34  // 40
                this.shoulderwidth = 18
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 12.8 //12.5
                this.punchspeed = 7.1 // 5 // 5.7 //6.1
                this.frame = 0
                this.grounded = 0
                this.jumping = 1
                this.nodes.push(this.body)
                this.leftshoulder = new Circle(this.body.x - (this.body.radius + this.shoulderwidth), 350, 10, "magenta", 0, 0, .999)
                this.rightshoulder = new Circle(this.body.x + (this.body.radius + this.shoulderwidth), 350, 10, "#FF0000", 0, 0, .999)
                this.lefthand = new ShotD(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 23.5, "magenta", 0, 0, .85)
                this.righthand = new ShotD(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 23.5, "#FF0000", 0, 0, .85)
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.gravity = 1.2
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.body.fired = 0
                this.screwmomentum = 0
                this.screwtimer = 0
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {

                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]
                }
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    this.nodes[t] = new ShotD(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }
                    this.nodes[t].id = idsto
                }
                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                    this.shots[t] = new ShotD(this.shots[t].x, this.shots[t].y, this.shots[t].radius, this.shots[t].color, this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                    this.shots[t].id = idsto

                }
                this.id = args["id"]
                this.frame = args['frame']
                this.armlength = 34  // 40
                this.shoulderwidth = 18
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }
                this.rightshoulder = this.nodes[2]
                this.leftshoulder = this.nodes[1]
                this.righthand = this.nodes[3]
                this.lefthand = this.nodes[4]

                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }
            }
        }

        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            object.ymom = -this.speed * 1 * 2
                        } else {
                            if (this.lefthand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                            if (this.righthand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 2
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            const copy = new ScorchedMass(this.controller)
            copy.id = this.id
            copy.frame = this.frame
            copy.body.color = this.body.color
            if (this.inactive == 1) {
                copy.inactive = 1
            } copy.serverID = this.serverID
            copy.striker = this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

            return copy
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }

            if (this.screwangle != 0) {

                this.leftshoulder.x = this.body.x + ((((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle)))))
                this.leftshoulder.y = this.body.y + (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle))))

                this.rightshoulder.x = this.body.x + (((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle))))
                this.rightshoulder.y = this.body.y + (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle))))

                this.leftshoulder.color = this.body.color
                this.rightshoulder.color = this.body.color
                this.lefthand.color = this.body.color
                this.righthand.color = this.body.color


                if (this.lefthand.anchored == 0) {
                    this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x + (((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle))))))
                    this.lefthand.y -= this.leftshoulder.y - (this.body.y + (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle)))))
                    // this.lefthand.xmom *=  this.lefthand.friction
                    // this.lefthand.ymom *=  this.lefthand.friction
                    this.leftshoulder.xmom *= 0
                    this.leftshoulder.ymom *= 0
                }
                if (this.righthand.anchored == 0) {
                    this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle))))))
                    this.righthand.y -= this.rightshoulder.y - (this.body.y + (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle)))))
                    // this.righthand.xmom *=  this.righthand.friction
                    // this.righthand.ymom *=  this.righthand.friction
                    this.rightshoulder.xmom *= 0
                    this.rightshoulder.ymom *= 0
                }

                if (this.body.ymom < -vsmashlimit) {
                    this.body.ymom = -vsmashlimit
                }
                if (this.body.ymom > vsmashlimit) {
                    this.body.ymom = vsmashlimit
                }


                // this.lefthand.xmom += (this.lefthand.x - this.body.x) / 100
                // this.righthand.xmom += (this.righthand.x - this.body.x) / 100

                // this.lefthand.ymom += (this.lefthand.y - this.body.y) / 100
                // this.righthand.ymom += (this.righthand.y - this.body.y) / 100


            } else {
                this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth * .3)
                this.leftshoulder.y = this.body.y - (this.shoulderwidth * .7)

                this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth * .3)
                this.rightshoulder.y = this.body.y - (this.shoulderwidth * .7)

                this.leftshoulder.color = this.body.color
                this.rightshoulder.color = this.body.color
                this.lefthand.color = this.body.color
                this.righthand.color = this.body.color


                if (this.lefthand.anchored == 0) {
                    this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth * .3)))
                    this.lefthand.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                    this.leftshoulder.xmom *= 0
                    this.leftshoulder.ymom *= 0
                }
                if (this.righthand.anchored == 0) {
                    this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth * .3)))
                    this.righthand.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                    this.rightshoulder.xmom *= 0
                    this.rightshoulder.ymom *= 0
                }

                if (this.body.ymom < -vsmashlimit) {
                    this.body.ymom = -vsmashlimit
                }



            }


            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }

        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (this.shield == 1) {
                                            //shieldaud1.play()
                                            this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                        } else {
                                            this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 200)) + (boys[t].shots[k].xmom * baselaunch)) * 2
                                            this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 200)) + (boys[t].shots[k].ymom * baselaunch)) * 2) - (10 * (this.damage / 200))
                                            this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                            this.breaktimer = 0
                                        }
                                        boys[t].shots[k].marked = 1
                                    }
                                }
                            }



                            if (boys[t].hasOwnProperty('radball')) {
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }

                            const enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }
                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 200)) + (boys[t].bananahand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 200)) + (boys[t].bananahand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 200)) + (boys[t].middlehand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 200)) + (boys[t].middlehand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                //shieldaud1.play()
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 200)) + (boys[t].righthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 200)) + (boys[t].righthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14

                                            this.shotIDs.push(boys[t].righthand2.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            //shieldaud1.play()
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 200)) + (boys[t].lefthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 200)) + (boys[t].lefthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            //shieldaud1.play()
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            //shieldaud1.play()
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 200)) + (boys[t].righthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 200)) + (boys[t].righthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            //shieldaud1.play()
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 200)) + (boys[t].lefthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 200)) + (boys[t].lefthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)

                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }

                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                //shieldaud1.play()
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 200)) + (boys[t].righthand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 200)) + (boys[t].righthand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].lefthand.fired > 14) {
                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)
                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                //shieldaud1.play()
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11)
                                            } else {
                                                this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 200)) + (boys[t].lefthand.xmom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 200)) + (boys[t].lefthand.ymom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)) * 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }

                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                //shieldaud1.play()
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 200)) + (boys[t].body.xmom * baselaunch) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].body.ymom * (this.damage / 200)) + (boys[t].body.ymom * baselaunch)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        this.fixupshoulder()
                        boys[f].fixupshoulder()
                        this.body.ymom *= .99
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2
                this.lefthand.ymom = -this.speed * 2
                this.righthand.ymom = -this.speed * 2
                this.jumpcount = 100
                //////////////////// ////////////////////////////////////////////console.log(this)
            }
        }
        doJump(object, speed) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -speed * 2
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 2
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {
            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            this.jumpcount--

            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }

            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }

        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                // this.fleeing = 1
            }
            if (this.charge > 92) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }


            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + Math.max(this.body.radius, boys[t].body.radius))) {
                        this.wmove = 1
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        if (Math.random() < .2) {
                            this.wmove = 1
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }

            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    this.screwshot = 1
                    this.wmove = 1
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    this.screwshot = 1
                }
            }
            this.exgrip = 0
            if (this.under == 0) {
                for (let t = 0; t < boys.length; t++) {
                    if (this.amomu <= 0 && this.dmomu <= 0) {
                        if (this != boys[t] && boys[t]) {
                            if (boys[t].brick.center.y > this.brick.center.y) {
                                if (boys[t].body.x < this.body.x) {
                                    this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                    this.amomu += 15
                                    this.exgrip = 1
                                } else {
                                    this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                    this.dmomu += 15
                                    this.exgrip = 1
                                }
                            }
                        }
                    } else {
                        this.exgrip = 1
                    }
                }
            }



            if (this.dmom > 0) {
                this.screwshot = 1
                this.dmove = 1
                this.wmove = 1
                this.amove = 0
                this.amom = 0
            } else {

                if (this.dmomu > 0) {
                    this.dmove = 1
                    this.amove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }
            if (this.amom > 0) {
                this.screwshot = 1
                this.dmom = 0
                this.amove = 1
                this.wmove = 1
                this.dmove = 0
            } else {
                if (this.amomu > 0) {
                    this.amove = 1
                    this.dmove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }


            if (this.safe == 0) {
                this.screwshot = 1
                if (this.body.x > (this.brick.center.x)) {
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                } else {
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }


            if (this.trapped == 0 && ((this.dmomu <= 0) && (this.amomu <= 0)) && ((this.dmom <= 0) && (this.amom <= 0))) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]
                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        const runtimeR = xdisR / this.speed
                                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .850)) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        const runtimeL = xdisL / this.speed
                                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .850)) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }
                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        const runtimeR = xdisR / this.speed
                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .855)) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1
                                this.wmove = 1
                            }
                        }
                    } else {
                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        const runtimeL = xdisL / this.speed
                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .855)) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1
                                this.wmove = 1
                            }
                        }
                    }
                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                //
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        ////////////////////////// ////////////////////////////////////////////console.log(this.brick.center.x, this.body.x)
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }

            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }


                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }
                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 2
                    } else {
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                    }
                }
                if (this.dmove == 1) {
                    this.face = 1
                    if (object == this.body) {
                        object.x += speed
                        this.righthand.x += speed
                        this.lefthand.x += speed
                    }
                    if (this.righthand.anchored == 1) {
                        this.degripr()
                        this.jumping = 1
                    }
                }
                // if (keysPressed['s']) {
                //     object.y += speed
                //     this.degrip()
                // }
                if (this.amove == 1) {
                    this.face = -1
                    if (object == this.body) {
                        object.x -= speed
                        this.righthand.x -= speed
                        this.lefthand.x -= speed
                    }
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        this.degripl()
                        this.jumping = 1
                    }
                }


                // if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                // if (controller.gamepad.axesStatus[0] > .1) {
                //     this.face = 1
                // }

                // if (controller.gamepad.axesStatus[1] < -.1) {
                //     this.face = -1
                // }
                // }

            }
            // if (this.dmomu > 0 || this.amomu > 0) {
            //     this.lefthand.anchored = 0
            //     this.righthand.anchored = 0
            // }

            if (this.exgrip == 1) {
                this.righthand.anchored = 0
                this.lefthand.anchored = 0
            }
        }
        AI() {
            this.idify()
            if (this.inactive == 1) {
                return
            }
            this.breaks()
            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--

            this.blasting = this.body.fired
            this.body.fired--
            this.lefthand.fired--

            this.breaktimer--

            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.rightshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }

            let bombs = 0
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    if (boys[k] && this != boys[k]) {
                        if (this.shots[t].stuck == 1) {
                            bombs++
                            const link = new LineOP(this.shots[t], boys[k].body)
                            if (link.sqrDis() < (200 * 200)) {
                                this.downspike = 1
                            }
                        }
                    }
                }
            }
            if (bombs == 0) {
                if (Math.random() < .005) {  //01
                    this.downspike = 1
                }
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        this.wmove = 1
                                        this.screwshot = 1
                                    }
                                }
                            }
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 50 && this.body.y < boys[t].body.y) {
                        if (this.amomu <= 0 && this.dmomu <= 0) {
                            this.downspike = 1
                        }
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {
                        this.hortsmash = 1
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < 90 && this.body.y > boys[t].body.y) {
                        this.screwshot = 1
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == 1) {
                                this.hortsmash = 1
                            }
                        }
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == -1) {
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .09) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                this.leftshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.leftshot = 0
                                    }
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                this.rightshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.rightshot = 0
                                    }
                                }
                            }
                        }
                    }


                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                this.downspike = 1
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            this.storeshield = 1
                        }
                    }
                }
            }
            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        this.shieldpower -= .63
                        this.shield = 1
                        this.shielddraw = 1
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shotdraw = 0
            }
            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.body.y < 900) {
                    this.wmove = 0
                    this.screwshot = 0
                    this.downspike = 0
                }
                if (this.screwshot == 1) {
                    if (this.body.fired <= 0) {
                        if (this.screwangle == 0) {
                            this.screwmomentum = Math.PI / 5
                            this.screwtimer = 42
                            this.jumping = 1
                            this.lefthand.fired = 30
                            this.righthand.fired = 30
                            // this.degripr()
                            // this.degripl()
                            this.body.fired = 42
                            this.lefthand.anchored = -10
                            this.righthand.anchored = -10
                            this.body.ymom = -jumplimit //-this.speed * 3
                        }
                    }
                }
                if (this.downspike == 1) {
                    if (this.lefthand.fired <= 0) {
                        if (this.righthand.fired <= 0) {
                            this.shot = new ShotC(this.body.x, this.body.y, 24, "#FF0000", 0, (this.speed * 1.5))
                            this.shot.bomb = 1
                            this.detonate = 1
                            this.shots.push(this.shot)
                            if (this.body.ymom > -jumplimit) {
                                this.body.ymom -= this.speed * 1.2
                                if (this.body.ymom < -jumplimit) {
                                    this.body.ymom = -jumplimit
                                }
                            } else {
                            }
                            this.lefthand.fired = 20 //28
                            this.righthand.fired = 20 //28
                        }
                    }
                }
                if (this.hortsmash == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.fleeing = 0
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.ymom = (this.punchspeed * 5) + (this.body.ymom * 2)
                            this.righthand.xmom = (this.punchspeed * 11.1) //+ this.body.xmom
                            this.righthand.fired = 18
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.fleeing = 0
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = (this.punchspeed * 5) + (this.body.ymom * 2)
                            this.lefthand.xmom = -(this.punchspeed * 11.1) //+ this.body.xmom
                            this.lefthand.fired = 18
                        }
                    }
                }

                if (this.righthand.fired <= 0) {
                    if (this.righthand.anchored == 0) {
                        if (this.rightshot == 1) {
                            if (this.face == 1) {
                                this.shot = new Shot(this.righthand.x, this.righthand.y, this.charge * .91, "#FF4400", this.speed * 3, 0)
                                if (this.charge > 80) {
                                    this.shot.color = "#FF9944"
                                }
                                // if(this.wasfalse[1] == 0){
                                if (this.charge >= 100) {
                                    this.charge = 0
                                    this.righthand.xmom = 15
                                    this.righthand.ymom = 0
                                    this.shots.push(this.shot)
                                    if (this.grounded != 1) {
                                        this.body.xmom -= 5
                                    }
                                }
                                if (this.righthand.anchored == 0) {
                                    this.righthand.xmom += 1
                                    this.righthand.ymom -= 1
                                    this.charge += 1.9 //1.5
                                }
                                this.shotdraw = 1
                            }
                        }
                        if (this.leftshot == 1) {
                            if (this.face == -1) {
                                if (this.lefthand.anchored == 0) {
                                    this.shot = new Shot(this.lefthand.x, this.lefthand.y, this.charge * .91, "#FF4400", -this.speed * 3, 0)
                                    if (this.charge > 80) {
                                        this.shot.color = "#FF9944"
                                    }
                                    if (this.charge >= 100) {
                                        this.charge = 0
                                        this.lefthand.xmom = -15
                                        this.lefthand.ymom = 0
                                        this.shots.push(this.shot)
                                        if (this.grounded != 1) {
                                            this.body.xmom += 5
                                        }
                                    }
                                    if (this.lefthand.anchored == 0) {
                                        this.lefthand.xmom -= 1
                                        this.lefthand.ymom -= 1
                                        this.charge += 1.9 //1.5
                                    }
                                    this.shotdraw = 1

                                }
                            }
                        }
                    }
                }

            }

        }
        fightcontrol() {
            if (this.inactive == 1) {
                return
            }
            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()




            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.blasting = this.body.fired
            this.body.fired--
            this.lefthand.fired--

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            this.breaktimer--
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }


            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shotdraw = 0
            }
            if (this.breaktimer <= 0 && this.shield == 0) {
                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {


                    if (this.righthand.fired <= 0) {
                        if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {

                            if (this.face == 1) {
                                if (this.righthand.anchored == 0) {
                                    this.shot = new Shot(this.righthand.x, this.righthand.y, this.charge * .91, "#FF4400", this.speed * 3, 0)
                                    if (this.charge > 80) {
                                        this.shot.color = "#FF9944"
                                    }
                                    // if(this.wasfalse[1] == 0){
                                    if (this.charge >= 100) {
                                        this.charge = 0
                                        this.righthand.xmom = 15
                                        this.righthand.ymom = 0
                                        this.shots.push(this.shot)
                                        if (this.grounded != 1) {
                                            this.body.xmom -= 5
                                        }
                                    }
                                    if (this.righthand.anchored == 0) {
                                        this.righthand.xmom += 1
                                        this.righthand.ymom -= 1
                                        this.charge += 1.9 //1.5
                                    }
                                    this.shotdraw = 1
                                }
                            }
                            if (this.face == -1) {
                                if (this.lefthand.anchored == 0) {
                                    this.shot = new Shot(this.lefthand.x, this.lefthand.y, this.charge * .91, "#FF4400", -this.speed * 3, 0)
                                    if (this.charge > 80) {
                                        this.shot.color = "#FF9944"
                                    }
                                    if (this.charge >= 100) {
                                        this.charge = 0
                                        this.lefthand.xmom = -15
                                        this.lefthand.ymom = 0
                                        this.shots.push(this.shot)
                                        if (this.grounded != 1) {
                                            this.body.xmom += 5
                                        }
                                    }
                                    if (this.lefthand.anchored == 0) {
                                        this.lefthand.xmom -= 1
                                        this.lefthand.ymom -= 1
                                        this.charge += 1.9 //1.5
                                    }
                                    this.shotdraw = 1

                                }
                            }
                        }
                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {
                        if (this.body.fired <= 0) {
                            if (this.screwangle == 0) {
                                this.screwmomentum = Math.PI / 5
                                this.screwtimer = 42
                                this.jumping = 1
                                this.lefthand.fired = 30
                                this.righthand.fired = 30
                                // this.degripr()
                                // this.degripl()
                                this.body.fired = 42
                                this.lefthand.anchored = -10
                                this.righthand.anchored = -10
                                this.body.ymom = -jumplimit  //-this.speed * 3
                                this.idify()
                            }
                        }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {
                        if (this.lefthand.fired <= 0) {
                            if (this.righthand.fired <= 0) {
                                this.shot = new ShotC(this.body.x, this.body.y, 24, "#FF0000", 0, (this.speed * 1.5))
                                this.shot.bomb = 1
                                this.detonate = 1
                                this.shots.push(this.shot)
                                if (this.body.ymom > -jumplimit) {
                                    this.body.ymom -= this.speed * 1.2
                                    if (this.body.ymom < -jumplimit) {
                                        this.body.ymom = -jumplimit
                                    }
                                } else {
                                }
                                this.lefthand.fired = 20 //28
                                this.righthand.fired = 20 //28
                                this.idify()
                            }
                        }
                    }


                    if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.fleeing = 0
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.ymom = (this.punchspeed * 5) + (this.body.ymom * 2)
                                this.righthand.xmom = (this.punchspeed * 11.1) //+ this.body.xmom
                                this.righthand.fired = 18
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.fleeing = 0
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = (this.punchspeed * 5) + (this.body.ymom * 2)
                                this.lefthand.xmom = -(this.punchspeed * 11.1) //+ this.body.xmom
                                this.lefthand.fired = 18
                                this.idify()
                            }
                        }
                    }
                }
            }
        }
        degripl() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        degripr() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        collideStage() {
            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {
            if (this.inactive == 1) {
                return
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.grounded = 0
            this.frame++
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                for (let t = 0; t < this.shots.length; t++) {

                    if (this.shots[t].bomb == 1) {
                        if (this.shots[t].stuck != 1) {
                            for (let k = 0; k < stage.bricks.length; k++) {
                                stage.bricks[k].stick(this.shots[t])
                            }
                            for (let k = 0; k < stage.walls.length; k++) {
                                stage.walls[k].stick(this.shots[t])
                            }
                            this.shots[t].move()
                        } else {
                            if (this.detonate == 1) {
                                const angle = Math.PI / 6
                                this.shots[t].marked = 1
                                for (let f = 0; f < 12; f++) {
                                    const bullet = new ShotC(this.shots[t].x, this.shots[t].y, 13, getRandomColor(), Math.cos(angle * f) * 21, Math.sin(angle * f) * 21)
                                    bullet.life = 13
                                    this.shots.push(bullet)
                                }
                            }
                        }
                    } else {
                        this.shots[t].life--
                        if (this.shots[t].life <= 0) {
                            this.shots[t].marked = 1
                        }
                        this.shots[t].move()
                    }
                    if (this.shots[t].marked <= 0) {
                        this.shots[t].draw()
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].draw()
                        }
                    }
                }
            }
            this.detonate = 0
            for (let j = 0; j < this.shots.length; j++) {
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked == 1) {
                        this.shots.splice(t, 1)
                    } else {
                        this.shots[t].marked--
                    }
                }
            }

            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.collideStage()
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].color = invertColor(this.body.color)
                this.links[t].draw()
            }
            for (let t = 0; t < this.nodes.length; t++) {
                this.nodes[t].draw()
            }

            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }
            if (this.screwangle != 0) {
                for (let t = 0; t < 25; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - ((Math.random() - .5) * this.body.radius * 2), 3, "#ffffff")
                    if (spot.doesPerimeterTouch(this.body)) {
                        spot.draw()
                    }
                }
            }
            canvas_context.font = "42px arial"

            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 70)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`

            canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 70)

            canvas_context.fillStyle = "FFFFFF"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 110)
            }
        
            // canvas_context.fillText(`Height:${Math.round(this.brick.edgeright.y)}`, this.body.x - 20, this.body.y - 250)
            // canvas_context.fillText(`Safe:${Math.round(this.safe)}`, this.body.x - 20, this.body.y - 200)
            // // if (this != boys[0]) {
            //     canvas_context.fillText(`M ${Math.round(this.dmove)},${Math.round(this.amove)}`, this.body.x - 20, this.body.y - 100)
            //     canvas_context.fillText(`U ${Math.round(this.dmomu)},${Math.round(this.amomu)}`, this.body.x - 20, this.body.y - 150)
            //     canvas_context.fillText(`Under:${Math.round(this.under)},Safe:${Math.round(this.safe)}`, this.body.x - 20, this.body.y - 200)
            //     canvas_context.fillText(`_ ${Math.round(this.dmom)},${Math.round(this.amom)}`, this.body.x - 20, this.body.y - 300)
            //     if (this.fleeing == 1) {
            //         canvas_context.fillText(`fleeing`, this.body.x - 20, this.body.y - 100)
            //     }
            // }


            const link = new Line(this.body.x, this.body.y + this.body.radius * .2, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y + Math.sin(this.screwangle) + this.body.radius * .2, "#FFFFFF", this.body.radius * .5)

            canvas_context.lineWidth = this.strokeWidth
            canvas_context.strokeStyle = "#FFFFFF" //invertColor(this.body.color)
            canvas_context.beginPath();
            canvas_context.arc(((link.x1 + link.x2) * .5) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .4, this.screwangle - 1, (Math.PI * 1) + this.screwangle + 1, false)
            canvas_context.fillStyle = "#FFFFFF"//invertColor(this.body.color)
            // canvas_context.fill()
            canvas_context.stroke();
            if (this.screwangle == 0) {
                link.draw()
            }

            if (this.shotdraw == 1) {

                if (this.face == -1) {
                    this.shot = new Shot(this.lefthand.x, this.lefthand.y, this.charge * .91, "#FF4400", -this.speed * 3, 0)
                } else if (this.face == 1) {
                    this.shot = new Shot(this.righthand.x, this.righthand.y, this.charge * .91, "#FF4400", -this.speed * 3, 0)
                }
                this.shot.draw()
            }
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.lefthand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
        }
        operate() {
            if (this.inactive == 1) {
                return
            }
            if (this.righthand.anchored == 1) {
                if (this.body.x > this.righthand.x) {
                    this.righthand.anchored = -10
                }
            }
            if (this.lefthand.anchored == 1) {
                if (this.body.x < this.lefthand.x) {
                    this.lefthand.anchored = -10
                }
            }

            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {

            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            }
            // }
            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.leftshoulder.ymom * .99
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.rightshoulder.ymom * .99
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     // this.body.sxmom *= 0
                    //     this.body.xmom *= .5
                    // }
                }
                this.body.ymom += this.gravity
            } else {

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            } else {
                //this.collideStage()
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            } else {
                //this.collideStage()
            }
            this.righthand.ymom += this.gravity
            this.lefthand.ymom += this.gravity


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            this.body.xmom *= .99
            this.body.ymom *= .99

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].frictiveMove(this)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].smove(this)
                }
            }
            this.lefthand.xmom += (this.lefthand.x - this.body.x) / 80
            this.righthand.xmom += (this.righthand.x - this.body.x) / 80
            this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40
            this.fixupshoulder()

            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

            // this.leftshoulder.xmom *= 0
            // this.leftshoulder.ymom *= 0

            // this.rightshoulder.xmom *= 0
            // this.rightshoulder.ymom *= 0




            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            // if (this.controller == 0) {

            if (boys.indexOf(this) <= humanPlayers) {

                // this.AI()
                this.fightcontrol()
            } else {
                this.AI()
            }
            // }
        }
    }





    class AsigMan {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                this.ping = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 5
                this.serverID = serverID
                this.shotdraw = 0
                this.id = controller
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 0
                this.countering = -1
                this.radsto = 50
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shot = {}
                this.striker = 10000
                this.name = "Adobrasig Man"
                this.blasting = 0
                this.recovering = 0
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.storeshield = 0
                this.face = 0
                this.shots = []
                this.wasfalse = []

                this.color = getRandomColor()
                if (controller == 0) {
                    this.color = "#ffAA00"
                }
                if (controller == 1) {
                    this.color = "#ff0000"
                }
                this.body = new Circle(400 + (Math.random() * 2560), 500, this.radsto, this.color)
                this.controller = controller
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.armlength = 30 // 40
                this.shoulderwidth = 33
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 10.1 //10.5  //10.8
                if(minigameSelected == 8){
                    this.speed = 11.420
                }
                this.punchspeed = 6.9 // 6.9 //7.9
                this.grounded = 0
                this.frame = 0
                this.jumping = 1
                this.nodes.push(this.body)
                this.leftshoulder = new Circle(this.body.x - (this.body.radius + this.shoulderwidth), 350, 10, "magenta", 0, 0, .999)
                this.rightshoulder = new Circle(this.body.x + (this.body.radius + this.shoulderwidth), 350, 10, "#FF0000", 0, 0, .999)
                this.leftshoulder2 = new Circle(this.body.x - (this.body.radius + this.shoulderwidth), 350, 10, "magenta", 0, 0, .999)
                this.rightshoulder2 = new Circle(this.body.x + (this.body.radius + this.shoulderwidth), 350, 10, "#FF0000", 0, 0, .999)
                this.leftshoulder3 = new Circle(this.body.x - (this.body.radius + this.shoulderwidth), 350, 10, "magenta", 0, 0, .999)
                this.rightshoulder3 = new Circle(this.body.x + (this.body.radius + this.shoulderwidth), 350, 10, "#FF0000", 0, 0, .999)
                this.lefthand = new Circle(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 30, "magenta", 0, 0, .85)
                this.righthand = new Circle(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 30, "#FF0000", 0, 0, .85)
                this.lefthand2 = new Circle(this.leftshoulder2.x, (this.leftshoulder2.y + this.armlength), 20, "magenta", 0, 0, .85)
                this.righthand2 = new Circle(this.rightshoulder2.x, (this.rightshoulder2.y + this.armlength), 20, "#FF0000", 0, 0, .85)
                this.lefthand3 = new Circle(this.leftshoulder3.x, (this.leftshoulder3.y + this.armlength), 20, "magenta", 0, 0, .85)
                this.righthand3 = new Circle(this.rightshoulder3.x, (this.rightshoulder3.y + this.armlength), 20, "#FF0000", 0, 0, .85)
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.leftshoulder2)
                this.nodes.push(this.rightshoulder2)
                this.nodes.push(this.leftshoulder3)
                this.nodes.push(this.rightshoulder3)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.nodes.push(this.righthand2)
                this.nodes.push(this.lefthand2)
                this.nodes.push(this.righthand3)
                this.nodes.push(this.lefthand3)
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm2 = new LineOP(this.leftshoulder2, this.lefthand2, invertColor(this.body.color), 10)
                this.rightarm2 = new LineOP(this.rightshoulder2, this.righthand2, invertColor(this.body.color), 10)
                this.links.push(this.leftarm2)
                this.links.push(this.rightarm2)
                this.leftarm3 = new LineOP(this.leftshoulder3, this.lefthand3, invertColor(this.body.color), 8)
                this.rightarm3 = new LineOP(this.rightshoulder3, this.righthand3, invertColor(this.body.color), 8)
                this.links.push(this.leftarm3)
                this.links.push(this.rightarm3)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm2 = new SpringOP(this.leftshoulder2, this.lefthand2, this.armlength, 10)
                this.rightarm2 = new SpringOP(this.rightshoulder2, this.righthand2, this.armlength, 10)
                this.springs.push(this.leftarm2)
                this.springs.push(this.rightarm2)
                this.leftarm3 = new SpringOP(this.leftshoulder3, this.lefthand3, this.armlength, 8)
                this.rightarm3 = new SpringOP(this.rightshoulder3, this.righthand3, this.armlength, 8)
                this.springs.push(this.leftarm3)
                this.springs.push(this.rightarm3)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.gravity = 1.1
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.righthand2.fired = 0
                this.lefthand2.fired = 0
                this.righthand3.fired = 0
                this.lefthand3.fired = 0
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = 0
                this.bodyx = this.body.x
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {

                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]
                }

                this.radsto = 50
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    this.nodes[t] = new Circle(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }
                    this.nodes[t].id = idsto
                }

                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                    this.shots[t] = new Circle(this.shots[t].x, this.shots[t].y, this.shots[t].radius, this.shots[t].color, this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                    this.shots[t].id = idsto

                }
                this.id = args["id"]
                this.frame = args['frame']

                this.armlength = 30
                this.shoulderwidth = 33
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.leftshoulder = this.nodes[1]
                this.rightshoulder = this.nodes[2]
                this.leftshoulder2 = this.nodes[3]
                this.rightshoulder2 = this.nodes[4]
                this.leftshoulder3 = this.nodes[5]
                this.rightshoulder3 = this.nodes[6]
                this.righthand = this.nodes[7]
                this.lefthand = this.nodes[8]
                this.righthand2 = this.nodes[9]
                this.lefthand2 = this.nodes[10]
                this.righthand3 = this.nodes[11]
                this.lefthand3 = this.nodes[12]




                this.links = []
                this.springs = []
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)


                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm2 = new LineOP(this.leftshoulder2, this.lefthand2, invertColor(this.body.color), 10)
                this.rightarm2 = new LineOP(this.rightshoulder2, this.righthand2, invertColor(this.body.color), 10)
                this.links.push(this.leftarm2)
                this.links.push(this.rightarm2)
                this.leftarm3 = new LineOP(this.leftshoulder3, this.lefthand3, invertColor(this.body.color), 8)
                this.rightarm3 = new LineOP(this.rightshoulder3, this.righthand3, invertColor(this.body.color), 8)
                this.links.push(this.leftarm3)
                this.links.push(this.rightarm3)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm2 = new SpringOP(this.leftshoulder2, this.lefthand2, this.armlength, 10)
                this.rightarm2 = new SpringOP(this.rightshoulder2, this.righthand2, this.armlength, 10)
                this.springs.push(this.leftarm2)
                this.springs.push(this.rightarm2)
                this.leftarm3 = new SpringOP(this.leftshoulder3, this.lefthand3, this.armlength, 8)
                this.rightarm3 = new SpringOP(this.rightshoulder3, this.righthand3, this.armlength, 8)
                this.springs.push(this.leftarm3)
                this.springs.push(this.rightarm3)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)

                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }
            }
        }

        // playerMove(object) {
        //     if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

        //         if (this.shield == 0) {
        //             if (keysPressed['s']) {
        //                 this.righthand.anchored = 0
        //                 this.lefthand.anchored = 0
        //             } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
        //                 this.righthand.anchored = 0
        //                 this.lefthand.anchored = 0
        //             }

        //             if (keysPressed['w']) {
        //                 if (this.grounded == 1) {
        //                     this.jumping = 1
        //                     object.ymom = -this.speed * 1 * 2
        //                 } else {
        //                     if (this.lefthand.anchored == 1) {
        //                         this.degripl()
        //                         this.jumping = 1
        //                         object.ymom -= this.speed
        //                     }
        //                     if (this.righthand.anchored == 1) {
        //                         this.degripr()
        //                         this.jumping = 1
        //                         object.ymom -= this.speed
        //                     }
        //                 }
        //             }
        //             if (keysPressed['d']) {
        //                 this.face = 1
        //                 object.x += this.speed
        //                 if (this.righthand.anchored == 1) {
        //                     this.degripr()
        //                     this.jumping = 1
        //                 }
        //             }
        //             // if (keysPressed['s']) {
        //             //     object.y += this.speed
        //             //     this.degrip()
        //             // }
        //             if (keysPressed['a']) {
        //                 this.face = -1
        //                 object.x -= this.speed
        //                 if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
        //                     this.degripl()
        //                     this.jumping = 1
        //                 }
        //             }


        //             if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
        //                 if (this.gamepad.gamepad.axesStatus[0] > .05) {
        //                     this.face = 1
        //                 }

        //                 if (this.gamepad.gamepad.axesStatus[0] < -.05) {
        //                     this.face = -1
        //                 }
        //             }

        //             if (typeof object != 'undefined') {
        //                 if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
        //                     if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
        //                         // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
        //                         // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
        //                         if (this.grounded == 1) {
        //                             object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
        //                             if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
        //                                 object.ymom = -this.speed * 1 * 2
        //                                 this.jumping = 1
        //                             }
        //                         } else {


        //                             if (this.gamepad.gamepad.axesStatus[0] < -.5) {
        //                                 if (this.lefthand.anchored == 1) {
        //                                     this.degripl()
        //                                     this.jumping = 1
        //                                     object.ymom -= this.speed
        //                                 } else {
        //                                     object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
        //                                 }
        //                             }
        //                             if (this.gamepad.gamepad.axesStatus[0] > .5) {
        //                                 this.face = 1
        //                                 if (this.righthand.anchored == 1) {
        //                                     this.degripr()
        //                                     this.jumping = 1
        //                                     object.ymom -= this.speed
        //                                 } else {
        //                                     object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
        //                                 }
        //                             }


        //                             if (this.gamepad.gamepad.axesStatus[1] < -.5) {
        //                                 this.face = -1
        //                                 if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
        //                                     this.degripr()
        //                                     this.degripl()
        //                                     this.jumping = 1
        //                                     object.ymom -= this.speed
        //                                 }

        //                             }
        //                         }
        //                         // }
        //                     }
        //                 }
        //             }
        //         }
        //     } else {
        //         if (Math.random() < .001) {
        //             //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
        //         }
        //     }
        // }

        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            object.ymom = -this.speed * 1 * 2.5
                        } else {
                            if (this.lefthand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                            if (this.righthand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 2.5
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = this.striker

            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            if (this.inactive == 1) {
                return
            }
            ////////////////////////////////console.log("caseF")

            const copy = new AsigMan(this.controller)
            copy.id = this.id
            copy.frame = this.frame
            if (typeof this.colorsto != "undefined") {
                copy.body.color = this.colorsto
            } else {
                copy.body.color = this.body.color
            } copy.serverID = this.serverID
            copy.striker = this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

            if(minigameSelected == 8){
                if(boys.indexOf(this) == 0){
                    for(let t = 0 ;t<copy.nodes.length;t++){
                        copy.nodes[t].x = 500
                        copy.nodes[t].y = 500
                    }
                }
                if(boys.indexOf(this) == 1){
                    for(let t = 0 ;t<copy.nodes.length;t++){
                        copy.nodes[t].x = 3100
                        copy.nodes[t].y = 500
                    }
                }
            }
            return copy
        }
        control() {
            gamepad_control_controller_proto(this.center, this.speed + (this.speed * (this.grounded * .5)), this.controller)
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }

            this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            this.leftshoulder.y = this.body.y - (this.shoulderwidth)
            this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            this.rightshoulder.y = this.body.y - (this.shoulderwidth)

            this.leftshoulder2.x = this.body.x - (this.body.radius + this.shoulderwidth)
            this.leftshoulder2.y = this.body.y - (this.shoulderwidth)
            this.rightshoulder2.x = this.body.x + (this.body.radius + this.shoulderwidth)
            this.rightshoulder2.y = this.body.y - (this.shoulderwidth)

            this.leftshoulder3.x = this.body.x - (this.body.radius + this.shoulderwidth)
            this.leftshoulder3.y = this.body.y - (this.shoulderwidth)
            this.rightshoulder3.x = this.body.x + (this.body.radius + this.shoulderwidth)
            this.rightshoulder3.y = this.body.y - (this.shoulderwidth)

            this.leftshoulder.color = this.body.color
            this.rightshoulder.color = this.body.color
            this.lefthand.color = this.body.color
            this.righthand.color = this.body.color
            this.lefthand2.color = this.body.color
            this.righthand2.color = this.body.color
            this.lefthand3.color = this.body.color
            this.righthand3.color = this.body.color


            if (this.lefthand.anchored == 0) {
                this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth)))
                this.lefthand.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth))
                this.leftshoulder.xmom *= 0
                this.leftshoulder.ymom *= 0
                this.lefthand2.x = this.lefthand2.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth)))
                this.lefthand2.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth))
                this.lefthand3.x = this.lefthand3.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth)))
                this.lefthand3.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth))
            }
            if (this.righthand.anchored == 0) {
                this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth)))
                this.righthand.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth))
                this.rightshoulder.xmom *= 0
                this.rightshoulder.ymom *= 0
                this.righthand2.x = this.righthand2.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth)))
                this.righthand2.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth))
                this.righthand3.x = this.righthand3.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth)))
                this.righthand3.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth))
            }

            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }



            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2.5
                this.lefthand.ymom = -this.speed * 2.5
                this.righthand.ymom = -this.speed * 2.5
                this.lefthand2.ymom = -this.speed * 2.5
                this.righthand2.ymom = -this.speed * 2.5
                this.lefthand3.ymom = -this.speed * 2.5
                this.righthand3.ymom = -this.speed * 2.5
                this.jumpcount = 100

            }
        }

        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }
            const storage = {}
            if (this.countering > 0) {
                storage.ymom = this.body.ymom
                storage.xmom = this.body.xmom
                storage.damage = this.damage
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {

                    for (let k = 0; k < boys[t].shots.length; k++) {
                        if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                            if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                this.shotIDs.push(boys[t].shots[k].id)
                                if (AItoggle == 0  && localPlayToggle == 0) {
                                    this.striker = boys[t].serverID
                                } else if (AItoggle == 1 || localPlayToggle == 1) {
                                    this.striker = t
                                }
                                this.struck = 1
                                if (this.shield == 1) {
                                    this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                } else {
                                    this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 213)) + (boys[t].shots[k].xmom * (baselaunch * 1.1234))) * 2
                                    this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 213)) + (boys[t].shots[k].ymom * (baselaunch * 1.1234))) * 2) - (10 * (this.damage / 213))
                                    this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                    this.breaktimer = 0
                                }
                                boys[t].shots[k].marked = 1
                            }
                        }
                    }



                    if (boys[t].hasOwnProperty('radball')) {
                        if (boys[t].radball.isPointInside(this.body)) {
                            if (AItoggle == 0  && localPlayToggle == 0) {
                                this.striker = boys[t].serverID
                            } else if (AItoggle == 1 || localPlayToggle == 1) {
                                this.striker = t
                            }
                            this.struck = 1
                            if (this.shield == 1) {
                                this.shieldpower -= 5
                            } else {
                                this.damage += 73.5 / boys[t].radball.radius
                                this.breaktimer = -1
                            }

                            //this.shotIDs.push(boys[t].radball.id)
                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                this.lefthand.anchored = -20
                                this.righthand.anchored = -20
                            }
                            if (this.body.ymom < -vsmashlimit) {
                                this.body.ymom = -vsmashlimit
                            }
                            if (this.body.ymom > vsmashlimit) {
                                this.body.ymom = vsmashlimit
                            }
                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                //  this.body.move(this)
                            }
                            this.fixupshoulder()
                        }
                    }
                    const enemycheckline = new LineOP(this.body, boys[t].body)
                    if (enemycheckline.sqrDis() > 310000) {
                        continue
                    }


                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                    if (typeof boys[t].lefthand2 != "undefined") {
                        boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                        boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                        boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                        boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                        if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                            if (AItoggle == 0  && localPlayToggle == 0) {
                                this.striker = boys[t].serverID
                            } else if (AItoggle == 1 || localPlayToggle == 1) {
                                this.striker = t
                            }
                            this.struck = 1
                            if (boys[t].righthand2.fired > 14) {
                                if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                    if (this.shield == 1) {
                                        this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                    } else {
                                        this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 213)) + (boys[t].righthand2.xmom * (baselaunch * 1.1234))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                        this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 213)) + (boys[t].righthand2.ymom * (baselaunch * 1.1234))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                        this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                        this.breaktimer = 0
                                    }
                                    boys[t].righthand2.fired = 14

                                    this.shotIDs.push(boys[t].righthand2.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.countering > 0) {
                                    } else {
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                    }
                                    this.fixupshoulder()
                                }
                            }
                        }
                        if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                            if (AItoggle == 0  && localPlayToggle == 0) {
                                this.striker = boys[t].serverID
                            } else if (AItoggle == 1 || localPlayToggle == 1) {
                                this.striker = t
                            }
                            this.struck = 1
                            if (boys[t].lefthand2.fired > 14) {
                                if (this.shield == 1) {
                                    this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                } else {
                                    this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 213)) + (boys[t].lefthand2.xmom * (baselaunch * 1.1234))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                    this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 213)) + (boys[t].lefthand2.ymom * (baselaunch * 1.1234))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                    this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                    this.breaktimer = 0
                                }
                                boys[t].lefthand2.fired = 14
                                this.shotIDs.push(boys[t].lefthand2.id)
                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                    this.lefthand.anchored = -20
                                    this.righthand.anchored = -20
                                }
                                if (this.body.ymom < -vsmashlimit) {
                                    this.body.ymom = -vsmashlimit
                                }
                                if (this.body.ymom > vsmashlimit) {
                                    this.body.ymom = vsmashlimit
                                }
                                if (this.countering > 0) {
                                } else {
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        this.body.move(this)
                                    }
                                }
                                this.fixupshoulder()

                            }
                        }
                        if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                            if (AItoggle == 0  && localPlayToggle == 0) {
                                this.striker = boys[t].serverID
                            } else if (AItoggle == 1 || localPlayToggle == 1) {
                                this.striker = t
                            }
                            this.struck = 1
                            if (boys[t].righthand3.fired > 14) {
                                if (this.shield == 1) {
                                    this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                } else {
                                    this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 213)) + (boys[t].righthand3.xmom * (baselaunch * 1.1234))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                    this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 213)) + (boys[t].righthand3.ymom * (baselaunch * 1.1234))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                    this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                    this.breaktimer = 0
                                }
                                boys[t].righthand3.fired = 14
                                this.shotIDs.push(boys[t].righthand3.id)
                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                    this.lefthand.anchored = -20
                                    this.righthand.anchored = -20
                                }
                                if (this.body.ymom < -vsmashlimit) {
                                    this.body.ymom = -vsmashlimit
                                }
                                if (this.body.ymom > vsmashlimit) {
                                    this.body.ymom = vsmashlimit
                                }
                                if (this.countering > 0) {
                                } else {
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        this.body.move(this)
                                    }
                                }
                                this.fixupshoulder()
                            }
                        }
                        if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                            if (AItoggle == 0  && localPlayToggle == 0) {
                                this.striker = boys[t].serverID
                            } else if (AItoggle == 1 || localPlayToggle == 1) {
                                this.striker = t
                            }
                            this.struck = 1
                            if (boys[t].lefthand3.fired > 14) {
                                if (this.shield == 1) {
                                    this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                } else {
                                    this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 213)) + (boys[t].lefthand3.xmom * (baselaunch * 1.1234))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                    this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 213)) + (boys[t].lefthand3.ymom * (baselaunch * 1.1234))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                    this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                    this.breaktimer = 0
                                }
                                boys[t].lefthand3.fired = 14
                                this.shotIDs.push(boys[t].lefthand3.id)

                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                    this.lefthand.anchored = -20
                                    this.righthand.anchored = -20
                                }
                                if (this.body.ymom < -vsmashlimit) {
                                    this.body.ymom = -vsmashlimit
                                }
                                if (this.body.ymom > vsmashlimit) {
                                    this.body.ymom = vsmashlimit
                                }
                                if (this.countering > 0) {
                                } else {
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        this.body.move(this)
                                    }
                                }
                                this.fixupshoulder()
                            }
                        }
                    }



                    if (boys[t].hasOwnProperty('bananahand')) {
                        if (boys[t].bananahand.fired > 14) {
                            boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                            if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                if (AItoggle == 0  && localPlayToggle == 0) {
                                    this.striker = boys[t].serverID
                                } else if (AItoggle == 1 || localPlayToggle == 1) {
                                    this.striker = t
                                }
                                this.struck = 1
                                if (boys[t].bananahand.fired > 14) {
                                    if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                        } else {
                                            this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 213)) + (boys[t].bananahand.xmom * (baselaunch * 1.1234))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 242)) + (boys[t].bananahand.ymom * (baselaunch * 1.1234))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].bananahand.fired = 14

                                        this.shotIDs.push(boys[t].bananahand.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }
                        }
                    }
                    if (boys[t].hasOwnProperty('middlehand')) {
                        if (boys[t].middlehand.fired > 14) {
                            boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                            if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                if (AItoggle == 0  && localPlayToggle == 0) {
                                    this.striker = boys[t].serverID
                                } else if (AItoggle == 1 || localPlayToggle == 1) {
                                    this.striker = t
                                }
                                this.struck = 1
                                if (boys[t].middlehand.fired > 14) {
                                    if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                        } else {
                                            this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 213)) + (boys[t].middlehand.xmom * (baselaunch * 1.1234))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 213)) + (boys[t].middlehand.ymom * (baselaunch * 1.1234))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].middlehand.fired = 14

                                        this.shotIDs.push(boys[t].middlehand.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }
                        }
                    }
                    if (boys[t].righthand.fired > 14) {
                        boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                        if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                            if (AItoggle == 0  && localPlayToggle == 0) {
                                this.striker = boys[t].serverID
                            } else if (AItoggle == 1 || localPlayToggle == 1) {
                                this.striker = t
                            }
                            this.struck = 1
                            if (boys[t].righthand.fired > 14) {
                                if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                    if (this.shield == 1) {
                                        this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                    } else {
                                        this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 213)) + (boys[t].righthand.xmom * (baselaunch * 1.1234))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                        this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 213)) + (boys[t].righthand.ymom * (baselaunch * 1.1234))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                        this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                        this.breaktimer = 0
                                    }
                                    boys[t].righthand.fired = 14
                                    this.shotIDs.push(boys[t].righthand.id)

                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }


                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.countering > 0) {
                                    } else {
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                    }
                                    this.fixupshoulder()
                                }
                            }
                        }
                    }
                    if (boys[t].lefthand.fired > 14) {
                        boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)
                        if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                            if (AItoggle == 0  && localPlayToggle == 0) {
                                this.striker = boys[t].serverID
                            } else if (AItoggle == 1 || localPlayToggle == 1) {
                                this.striker = t
                            }
                            this.struck = 1
                            if (boys[t].lefthand.fired > 14) {
                                if (!this.shotIDs.includes(boys[t].lefthand.id)) {

                                    if (this.shield == 1) {
                                        this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11)
                                    } else {
                                        this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 213)) + (boys[t].lefthand.xmom * (baselaunch * 1.1234)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                        this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 213)) + (boys[t].lefthand.ymom * (baselaunch * 1.1234))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                        this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                        this.breaktimer = 0
                                    }
                                    boys[t].lefthand.fired = 14
                                    this.shotIDs.push(boys[t].lefthand.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.countering > 0) {
                                    } else {
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                    }
                                    this.fixupshoulder()
                                }
                            }
                        }
                    }

                    if (boys[t].body.fired > 0) {
                        if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                            if (AItoggle == 0  && localPlayToggle == 0) {
                                this.striker = boys[t].serverID
                            } else if (AItoggle == 1 || localPlayToggle == 1) {
                                this.striker = t
                            }
                            this.struck = 1
                            if (boys[t].body.fired > 0) {
                                if (!this.shotIDs.includes(boys[t].body.id)) {
                                    if (this.shield == 1) {
                                        this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                    } else {
                                        this.body.xmom = ((boys[t].body.xmom * (this.damage / 213)) + (boys[t].body.xmom * (baselaunch * 1.1234)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                        this.body.ymom = ((((boys[t].body.ymom * (this.damage / 213)) + (boys[t].body.ymom * (baselaunch * 1.1234))) * 2)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                        this.damage += (((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                    }
                                    boys[t].body.fired = 0
                                    this.shotIDs.push(boys[t].body.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.countering > 0) {
                                    } else {
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                    }
                                    this.fixupshoulder()
                                }
                            }
                        }
                    }
                    if (this.countering > 0) {
                        const obj = {}
                        obj.ymom = (this.body.ymom - storage.ymom)
                        obj.xmom = (this.body.xmom - storage.xmom)
                        obj.damage = (this.damage - storage.damage)
                        obj.counter = 1
                        obj.striker = boys[t].serverID
                        boys[t].body.ymom -= (this.body.ymom - storage.ymom)
                        boys[t].body.xmom -= (this.body.xmom - storage.xmom)
                        boys[t].damage += (this.damage - storage.damage)
                        boys[t].striker = boys.indexOf(this)
                        worldcounter += (this.damage - storage.damage)
                        this.body.ymom = storage.ymom
                        this.body.xmom = storage.xmom
                        this.damage = storage.damage
                        if (AItoggle == 0  && localPlayToggle == 0) {
                             if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
                        }
                    }

                }
            }


            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    let j = 0
                    while (boys[t].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.body.x += (this.body.x - boys[t].body.x) / (this.body.radius + boys[t].body.radius)
                        this.body.y += (this.body.y - boys[t].body.y) / (this.body.radius + boys[t].body.radius)
                        boys[t].body.x -= (this.body.x - boys[t].body.x) / (this.body.radius + boys[t].body.radius)
                        boys[t].body.y -= (this.body.y - boys[t].body.y) / (this.body.radius + boys[t].body.radius)
                        this.fixupshoulder()
                        boys[t].fixupshoulder()
                        
                        if(minigameSelected !== 8){
                            this.body.ymom *= .99
                        }else{
                            this.body.xmom *= .89
}
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }

        doJump(object, speed) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -speed * 2.5
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 2.5
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {
            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 1200) {
                if (this.body.ymom < 0) {
                    this.wmove = 0
                    this.downspike = 0
                } else if (this.body.y < 800) {
                    this.wmove = 0
                    this.downspike = 0
                }
            }

            this.jumpcount--

            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }
            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }
        fightcontrol() {
            if (this.inactive == 1) {
                return
            }

            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()
            this.righthand.fired--
            this.lefthand.fired--
            this.righthand2.fired--
            this.lefthand2.fired--
            this.righthand3.fired--
            this.lefthand3.fired--
            this.breaktimer--
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }

            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {


                    if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
                        if (this.lefthand.fired <= 0) {
                            if (this.righthand.fired <= 0) {
                                if (this.countering <= -45) {
                                    this.colorsto = this.body.color
                                    this.countering = 6
                                }
                            }
                        }
                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {
                        if (this.face == 1) {
                            if (this.righthand.fired <= 0) {
                                if (this.righthand.anchored == 0) {
                                    this.righthand.ymom = 0
                                    this.righthand.xmom = this.punchspeed * 14
                                    this.righthand.fired = 18
                                    this.idify()
                                }
                            }
                            if (this.righthand2.fired <= 0) {
                                this.righthand2.xmom = this.punchspeed * 14
                                this.righthand2.fired = 18
                                this.idify()
                            }
                            if (this.righthand3.fired <= 0) {
                                this.righthand3.xmom = this.punchspeed * 14
                                this.righthand3.fired = 18
                                this.idify()
                            }
                        }
                        if (this.face == -1) {
                            if (this.lefthand.fired <= 0) {
                                if (this.lefthand.anchored == 0) {
                                    this.lefthand.ymom = 0
                                    this.lefthand.xmom = -this.punchspeed * 14
                                    this.lefthand.fired = 18
                                    this.idify()
                                }
                            }
                            if (this.lefthand2.fired <= 0) {
                                this.lefthand2.xmom = -this.punchspeed * 14
                                this.lefthand2.fired = 18
                                this.idify()
                            }
                            if (this.lefthand3.fired <= 0) {
                                this.lefthand3.xmom = -this.punchspeed * 14
                                this.lefthand3.fired = 18
                                this.idify()
                            }
                        }
                    }


                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.righthand.ymom = -this.punchspeed * 14
                                this.righthand.xmom = 0
                                this.righthand.fired = 18
                                this.idify()
                            }
                        } if (this.righthand2.fired <= 0) {
                            this.righthand2.ymom = -this.punchspeed * 14
                            this.righthand2.xmom = -this.punchspeed * 4
                            this.righthand2.fired = 18
                            this.idify()
                        } if (this.righthand3.fired <= 0) {
                            this.righthand3.ymom = -this.punchspeed * 14
                            this.righthand3.xmom = this.punchspeed * 4
                            this.righthand3.fired = 18
                            this.idify()
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.lefthand.ymom = -this.punchspeed * 14
                                this.lefthand.xmom = -this.punchspeed * 0
                                this.lefthand.fired = 18
                                this.idify()
                            }
                        }
                        if (this.lefthand2.fired <= 0) {
                            this.lefthand2.ymom = -this.punchspeed * 14
                            this.lefthand2.xmom = -this.punchspeed * -4
                            this.lefthand2.fired = 18
                            this.idify()
                        }
                        if (this.lefthand3.fired <= 0) {
                            this.lefthand3.ymom = -this.punchspeed * 14
                            this.lefthand3.xmom = -this.punchspeed * 4
                            this.lefthand3.fired = 18
                            this.idify()
                        }
                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                                this.righthand.xmom = this.punchspeed * 9
                                this.body.ymom -= this.speed * .1625
                                this.righthand.fired = 18
                                this.idify()
                            }
                        }
                        if (this.righthand2.fired <= 0) {
                            this.rightshoulder2.xmom = 0
                            this.rightshoulder2.ymom = 0
                            this.righthand2.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                            this.righthand2.xmom = 0
                            this.body.ymom -= this.speed * .1625
                            this.righthand2.fired = 19
                            this.idify()
                        }
                        if (this.righthand3.fired <= 0) {
                            this.rightshoulder3.xmom = 0
                            this.rightshoulder3.ymom = 0
                            this.righthand3.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                            this.righthand3.xmom = -this.punchspeed * 7
                            this.body.ymom -= this.speed * .1625
                            this.righthand3.fired = 19
                            this.idify()
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                                this.lefthand.xmom = this.punchspeed * -9
                                this.body.ymom -= this.speed * .1625
                                this.lefthand.fired = 18
                                this.idify()
                            }
                        }
                        if (this.lefthand2.fired <= 0) {
                            this.leftshoulder2.xmom = 0
                            this.leftshoulder2.ymom = 0
                            this.lefthand2.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                            this.lefthand2.xmom = 0
                            this.body.ymom -= this.speed * .1625
                            this.lefthand2.fired = 19
                            this.idify()
                        }
                        if (this.lefthand3.fired <= 0) {
                            this.leftshoulder3.xmom = 0
                            this.leftshoulder3.ymom = 0
                            this.lefthand3.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                            this.lefthand3.xmom = -this.punchspeed * -7
                            this.body.ymom -= this.speed * .1625
                            this.lefthand3.fired = 19
                            this.idify()
                        }
                    }
                }
            }
        }

        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                this.fleeing = 1
            }
            if (this.charge > 90) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }

            this.recovering = 0

            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + 35)) {
                        this.wmove = 1
                        //////////////// ////////////////////////////////////////////console.log("caseA")
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        if (Math.random() < .2) {
                            this.wmove = 1
                            //////////////// ////////////////////////////////////////////console.log("caseB")
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }

            this.recovering = 0

            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }

            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .001) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .001) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .001) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .001) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    this.downspike = 1
                    this.wmove = 1
                    //////////////// ////////////////////////////////////////////console.log("caseC")
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    this.downspike = 1
                    //////////////// ////////////////////////////////////////////console.log("caseD")
                }
            }
            this.exgrip = 0
            for (let t = 0; t < boys.length; t++) {
                if (this.amomu <= 0 && this.dmomu <= 0) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].brick.center.y > this.brick.center.y) {
                            if (boys[t].body.x < this.body.x) {
                                this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                this.amomu += 22
                                this.exgrip = 1
                            } else {
                                this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                this.dmomu += 22
                                this.exgrip = 1
                            }
                        }
                    }
                } else {
                    this.exgrip = 1
                }
            }





            if (this.dmom > 0) {
                // this.screwshot = 1
                this.dmove = 1
                if (Math.random() < .5) {
                    this.wmove = 1
                    //////////////// ////////////////////////////////////////////console.log("caseE")
                }
                this.amove = 0
                this.amom = 0
            } else {

                if (this.dmomu > 0) {
                    this.dmove = 1
                    this.amove = 0
                    this.downspike = 0
                    this.wmove = 0
                }
            }
            if (this.amom > 0) {
                // this.screwshot = 1
                this.dmom = 0
                this.amove = 1
                this.wmove = 1
                //////////////// ////////////////////////////////////////////console.log("caseF")
                this.dmove = 0
            } else {
                if (this.amomu > 0) {
                    this.amove = 1
                    this.dmove = 0
                    this.downspike = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }

            if (this.safe == 0) {
                this.downspike = 1
                if (this.body.x > (this.brick.center.x)) {
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //////////////// ////////////////////////////////////////////console.log("caseG")
                    this.amomu = 0
                    this.dmomu = 0
                } else {
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //////////////// ////////////////////////////////////////////console.log("caseH")
                    this.amomu = 0
                    this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }


            if (this.trapped == 0) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]

                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        const runtimeR = xdisR / this.speed
                                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .8)) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.downspike = 1
                                                this.wmove = 1
                                            }
                                            //////////////// ////////////////////////////////////////////console.log("caseI", cancel)
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        const runtimeL = xdisL / this.speed
                                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .8)) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.downspike = 1
                                                this.wmove = 1
                                            }
                                            //////////////// ////////////////////////////////////////////console.log("caseJ", cancel)
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }

                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }

                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        const runtimeR = xdisR / this.speed
                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .87)) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            //problem1
                            if (cancel == 0) {
                                this.downspike = 1
                                this.wmove = 1
                            }
                            //////////////// ////////////////////////////////////////////console.log("caseK", cancel)
                        }
                    } else {
                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        const runtimeL = xdisL / this.speed
                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .87)) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.downspike = 1
                                this.wmove = 1
                            }
                            //problem2
                            //////////////// ////////////////////////////////////////////console.log("caseL", cancel)
                        }
                    }

                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                if (this.safe == 0) {
                    this.downspike = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //////////////// ////////////////////////////////////////////console.log("caseM")
                        this.amomu = 0
                        this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //////////////// ////////////////////////////////////////////console.log("caseN")
                        this.amomu = 0
                        this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }


            if (this.body.y < 1200) {
                if (this.body.ymom < 0) {
                    this.wmove = 0
                    this.downspike = 0
                } else if (this.body.y < 800) {
                    this.wmove = 0
                    this.downspike = 0
                }
            }

            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                        //////////////// ////////////////////////////////////////////console.log("caseO")
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            //////////////// ////////////////////////////////////////////console.log("caseP")
                                            this.downspike = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    this.downspike = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //////////////// ////////////////////////////////////////////console.log("caseQ")
                        this.amomu = 0
                        this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //////////////// ////////////////////////////////////////////console.log("caseR")
                        this.amomu = 0
                        this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }



                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                        //////////////// ////////////////////////////////////////////console.log("caseS")
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1

                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            //////////////// ////////////////////////////////////////////console.log("caseT")
                                            this.downspike = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    this.downspike = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //////////////// ////////////////////////////////////////////console.log("caseU")
                        this.amomu = 0
                        this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //////////////// ////////////////////////////////////////////console.log("caseV")
                        this.amomu = 0
                        this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }


                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }



            if(minigameSelected == 8){
                this.amove = 1
                this.dmove = 0
                this.wmove = 0
                this.exgrip = 1
                if(boys[2].body.x < this.body.x+boys[2].body.radius && boys[2].body.xmom > 0){
                    this.dmove = 1
                    this.amove = 0
                }
                if(boys[2].body.x > this.body.x-boys[2].body.radius ){
                    this.dmove = 1
                    this.amove = 0
                    this.wmove = 1
                }
                if(boys[2].body.x > 1900 && boys[2].body.x < this.body.x ){
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 0
                }
                if(boys[2].body.x < 1900 && this.body.x < 2500 ){
                    this.dmove = 1
                }
                if(this.body.x-(boys[2].body.radius*1.1) < boys[2].body.x){
                    this.wmove = 1
                }
            }


                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 2
                    } else {
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                    }
                }
                if (this.dmove == 1) {
                    this.face = 1
                    if (object == this.body) {
                        object.x += speed
                        this.righthand.x += speed
                        this.lefthand.x += speed
                        this.righthand2.x += speed
                        this.lefthand2.x += speed
                        this.righthand3.x += speed
                        this.lefthand3.x += speed
                    }
                    if (this.righthand.anchored == 1) {
                        this.degripr()
                        this.jumping = 1
                    }
                }
                if (this.amove == 1) {
                    this.face = -1
                    if (object == this.body) {
                        object.x -= speed
                        this.righthand.x -= speed
                        this.lefthand.x -= speed
                        this.righthand2.x -= speed
                        this.lefthand2.x -= speed
                        this.righthand3.x -= speed
                        this.lefthand3.x -= speed
                    }
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        this.degripl()
                        this.jumping = 1
                    }
                }
                if (this.exgrip == 1) {
                    this.righthand.anchored = 0
                    this.lefthand.anchored = 0
                }
            }
        }
        AI() {
            this.idify()
            if (this.inactive == 1) {
                return
            }

            this.breaks()
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].marked == 1) {
                    this.shots.splice(t, 1)
                } else {
                    this.shots[t].marked--
                }
            }

            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }



            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.rightshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {


                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if (link.hypotenuse() + (this.body.radius + boys[t].shots[g].radius) / (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) < 40) { //40?
                            this.hortsmash = 1
                            this.storeshield = 1
                        }
                    }

                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < boys[t].body.radius && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                if (Math.abs(this.body.x - boys[t].body.x) < 212) {
                                    // ////////////// ////////////////////////////////////////////console.log(Math.abs(this.body.x - boys[t].body.x))
                                    if (this.fleeing != 1) {
                                        this.leftshot = 1
                                    }
                                    // if (Math.random() < .1) {
                                    //     this.hortsmash = 1
                                    //     this.leftshot = 0
                                    // }
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < boys[t].body.radius && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                if (Math.abs(this.body.x - boys[t].body.x) < 212) {
                                    // ////////////// ////////////////////////////////////////////console.log(Math.abs(this.body.x - boys[t].body.x))
                                    if (this.fleeing != 1) {
                                        this.rightshot = 1
                                    }
                                    // if (Math.random() < .1) {
                                    //     this.hortsmash = 1
                                    //     this.rightshot = 0
                                    // }
                                }
                            }
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 145 && this.body.y > boys[t].body.y) {
                        this.screwshot = 1
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < 210 && (boys[t].body.y - this.body.y) < 120 && this.body.y < boys[t].body.y) {  //45
                        if (this.amomu <= 0 && this.dmomu <= 0) {
                            this.downspike = 1
                        }
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {

                        if (this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                if (this.fleeing != 1) {
                                    if (Math.abs(this.body.y - boys[t].body.y) < this.body.radius) {
                                        this.leftshot = 1
                                    }
                                }
                            }
                        }

                        if (this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                if (this.fleeing != 1) {
                                    if (Math.abs(this.body.y - boys[t].body.y) < this.body.radius) {
                                        this.rightshot = 1
                                    }
                                }
                            }
                        }
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                if (this.fleeing != 1) {
                                    if (Math.abs(this.body.y - boys[t].body.y) < this.body.radius) {
                                        this.rightshot = 1
                                    }
                                }
                            }
                        }
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                if (this.fleeing != 1) {
                                    if (Math.abs(this.body.y - boys[t].body.y) < this.body.radius) {
                                        this.leftshot = 1
                                    }
                                }
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            const link = ((new LineOP(this.body, boys[t].righthand)).sqrDis()) / ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) * (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)))
                            if (link <= 2) {
                                this.storeshield = 1
                                this.hortsmash = 1
                            }
                        }
                    }
                    if (boys[t].lefthand.fired > 14) {
                        if (this.body.x < boys[t].body.x) {
                            const link = ((new LineOP(this.body, boys[t].lefthand)).sqrDis()) / ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) * (Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)))
                            if (link <= 2) {
                                this.storeshield = 1
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                    this.hortsmash = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }

            if (this.safe == 0) {
                if (this.recovering == 1) {
                    this.downspike = 1
                }
            }

            this.breaks()
            this.righthand.fired--
            this.lefthand.fired--
            this.righthand2.fired--
            this.lefthand2.fired--
            this.righthand3.fired--
            this.lefthand3.fired--
            this.breaktimer--
            if (Math.random() < .1) {
                this.storeshield = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .94) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (boys[t].lefthand.fired > 14) {
                        if (this.body.x < boys[t].body.x) {
                            if (Math.random() < .94) {
                                this.storeshield = 1
                            }
                        }
                    }
                }
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (this.grounded == 1) {
                                if (boys[t].shots[g].stuck != 1) {
                                    this.storeshield = 1
                                } else {
                                    this.wmove = 1
                                }
                            } else {
                                this.hortsmash = 1
                                if (this.body.x < boys[t].shots[g].x) {
                                    if (this.amom <= 0 && this.dmom <= 0) {
                                        this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                        this.amove = 1
                                        this.dmove = 0
                                    }
                                } else {
                                    if (this.amom <= 0 && this.dmom <= 0) {
                                        this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                        this.amove = 0
                                        this.dmove = 1
                                    }
                                }
                            }
                            break
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].shots[g].x) {
                                            if (this.amom <= 0 && this.dmom <= 0) {
                                                this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                this.amove = 1
                                                this.dmove = 0
                                            }
                                        } else {
                                            if (this.amom <= 0 && this.dmom <= 0) {
                                                this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                this.amove = 0
                                                this.dmove = 1
                                            }
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        this.wmove = 1
                                        //////////////// ////////////////////////////////////////////console.log("caseX")
                                        this.downspike = 1
                                    }
                                }
                            }
                        }
                    }
                }
            }

            if(minigameSelected == 8){
                this.storeshield = 0
            }
            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.countering <= -30 && this.lefthand.fired <= 0 && this.righthand.fired <= 0) {
                if (this.storeshield == 1) {
                    this.hortsmash = 1
                }
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            } else if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        if (this.countering < 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }


            let min = 250000
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    const link = new LineOP(this.body, boys[t].body)
                    if (min > link.sqrDis()) {
                        min = link.sqrDis()
                    }
                }
            }
            if (min > 72900) {
                if (this.safe == 1) {
                    this.downspike = 0
                }
                this.screwshot = 0
                this.leftshot = 0
                this.rightshot = 0
            }


            if(minigameSelected == 8){
                this.hortsmash = 0
                this.downspike = 0
                this.screwshot = 0
                this.leftshot = 1
                if(Math.random() < .1){
                    this.screwshot = 1
                }
                if(this.face == 1){
                    this.leftshot = 0
                    this.rightshot = 0
                    this.screwshot = 0
                }
            }




            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.body.y < 1200) {
                    if (this.body.ymom < 0) {
                        this.wmove = 0
                        this.downspike = 0
                    } else if (this.body.y < 800) {
                        this.wmove = 0
                        this.downspike = 0
                    }
                }

                if (this.hortsmash == 1) {
                    if (this.lefthand.fired <= 0) {
                        if (this.righthand.fired <= 0) {
                            if (this.countering <= -45) {
                                this.colorsto = this.body.color
                                this.countering = 6
                            }
                        }
                    }
                }


                if (this.downspike == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                            this.righthand.xmom = this.punchspeed * 9
                            this.body.ymom -= this.speed * .1625
                            this.righthand.fired = 18
                        }
                    }
                    if (this.righthand2.fired <= 0) {
                        this.rightshoulder2.xmom = 0
                        this.rightshoulder2.ymom = 0
                        this.righthand2.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                        this.righthand2.xmom = 0
                        this.body.ymom -= this.speed * .1625
                        this.righthand2.fired = 19
                    }
                    if (this.righthand3.fired <= 0) {
                        this.rightshoulder3.xmom = 0
                        this.rightshoulder3.ymom = 0
                        this.righthand3.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                        this.righthand3.xmom = -this.punchspeed * 7
                        this.body.ymom -= this.speed * .1625
                        this.righthand3.fired = 19
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                            this.lefthand.xmom = this.punchspeed * -9
                            this.body.ymom -= this.speed * .1625
                            this.lefthand.fired = 18
                        }
                    }
                    if (this.lefthand2.fired <= 0) {
                        this.leftshoulder2.xmom = 0
                        this.leftshoulder2.ymom = 0
                        this.lefthand2.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                        this.lefthand2.xmom = 0
                        this.body.ymom -= this.speed * .1625
                        this.lefthand2.fired = 19
                    }
                    if (this.lefthand3.fired <= 0) {
                        this.leftshoulder3.xmom = 0
                        this.leftshoulder3.ymom = 0
                        this.lefthand3.ymom = (this.punchspeed * 14) + this.body.ymom * 2
                        this.lefthand3.xmom = -this.punchspeed * -7
                        this.body.ymom -= this.speed * .1625
                        this.lefthand3.fired = 19
                    }
                }

                if (this.leftshot == 1 || this.rightshot == 1) {
                    if (this.face == 1) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.righthand.ymom = 0
                                this.righthand.xmom = this.punchspeed * 14
                                this.righthand.fired = 18
                            }
                        }
                        if (this.righthand2.fired <= 0) {
                            this.righthand2.xmom = this.punchspeed * 14
                            this.righthand2.fired = 18
                        }
                        if (this.righthand3.fired <= 0) {
                            this.righthand3.xmom = this.punchspeed * 14
                            this.righthand3.fired = 18
                        }
                    }
                    if (this.face == -1) {
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.lefthand.ymom = 0
                                this.lefthand.xmom = -this.punchspeed * 14
                                this.lefthand.fired = 18
                            }
                        }
                        if (this.lefthand2.fired <= 0) {
                            this.lefthand2.xmom = -this.punchspeed * 14
                            this.lefthand2.fired = 18
                        }
                        if (this.lefthand3.fired <= 0) {
                            this.lefthand3.xmom = -this.punchspeed * 14
                            this.lefthand3.fired = 18
                        }
                    }
                }


                if (this.screwshot == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.righthand.ymom = -this.punchspeed * 14
                            this.righthand.xmom = 0
                            this.righthand.fired = 18
                        }
                    } if (this.righthand2.fired <= 0) {
                        this.righthand2.ymom = -this.punchspeed * 14
                        this.righthand2.xmom = -this.punchspeed * 4
                        this.righthand2.fired = 18
                    } if (this.righthand3.fired <= 0) {
                        this.righthand3.ymom = -this.punchspeed * 14
                        this.righthand3.xmom = this.punchspeed * 4
                        this.righthand3.fired = 18
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.lefthand.ymom = -this.punchspeed * 14
                            this.lefthand.xmom = -this.punchspeed * 0
                            this.lefthand.fired = 18
                        }
                    }
                    if (this.lefthand2.fired <= 0) {
                        this.lefthand2.ymom = -this.punchspeed * 14
                        this.lefthand2.xmom = -this.punchspeed * -4
                        this.lefthand2.fired = 18
                    }
                    if (this.lefthand3.fired <= 0) {
                        this.lefthand3.ymom = -this.punchspeed * 14
                        this.lefthand3.xmom = -this.punchspeed * 4
                        this.lefthand3.fired = 18
                    }
                }


            }
        }
        degripl() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        degripr() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        collideStage() {
            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {
            if (this.inactive == 1) {
                return
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.grounded = 0
            this.frame++
            this.countering--
            if (this.countering > 0) {
                this.body.radius += 5
            } else {
                this.body.radius = this.radsto
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.shots.length; t++) {
                    this.shots[t].radius *= 1.02
                    this.shots[t].ymom *= 1.02
                    this.shots[t].move()
                    if (this.shots[t].marked <= 0) {
                        this.shots[t].draw()
                    }
                    if (this.shots[t].radius > 35) {
                        this.shots[t].marked = 1
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].draw()
                        }
                    }
                }
            }

            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].marked == 1) {
                    this.shots.splice(t, 1)
                } else {
                    this.shots[t].marked--
                }
            }
            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.collideStage()
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].color = invertColor(this.body.color)
                this.links[t].draw()
            }
            if (this.countering == 4) {
                this.body.color = invertColor(this.body.color)
            }
            if (this.countering == 0) {
                this.body.color = this.colorsto
            }
            this.rightshoulder.color = invertColor(this.body.color)
            this.rightshoulder2.color = invertColor(this.body.color)
            this.rightshoulder3.color = invertColor(this.body.color)
            this.leftshoulder.color = invertColor(this.body.color)
            this.leftshoulder2.color = invertColor(this.body.color)
            this.leftshoulder3.color = invertColor(this.body.color)
            for (let t = 0; t < this.nodes.length; t++) {
                this.nodes[t].draw()
            }

            // if (this.controller == 0) {
            const link = new Line(this.body.x, this.body.y, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y, invertColor(this.body.color), this.body.radius * .2)

            const linewidthsto = canvas_context.lineWidth
            canvas_context.lineWidth = 15
            canvas_context.strokeStyle = invertColor(this.body.color)
            canvas_context.beginPath();
            canvas_context.arc((link.x1 + link.x2) * .5, link.y1 - this.body.radius * .09, this.body.radius * .4, 0, (Math.PI * 1), false)
            canvas_context.stroke();
            canvas_context.beginPath();
            canvas_context.arc((link.x1 + link.x2) * .5, link.y1 - this.body.radius * .59, this.body.radius * .2, 0, (Math.PI * 1), false)
            canvas_context.stroke();
            // canvas_context.fillStyle = invertColor(this.body.color)
            // canvas_context.fill()
            // link.draw()
            canvas_context.lineWidth = linewidthsto
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.lefthand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
            canvas_context.font = "42px arial"
            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 70)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            if(minigameSelected == 8){

            }else{
                
            canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 70)
            canvas_context.fillStyle = "white"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 110)
            }

        }
            //  canvas_context.fillText(`Height:${Math.round(this.brick.edgeright.y)}`, this.body.x - 20, this.body.y - 250)
            //         canvas_context.fillText(`M D${Math.round(this.dmove)},A${Math.round(this.amove)}`, this.body.x - 20, this.body.y - 110)
            //         canvas_context.fillText(`U D${Math.round(this.dmomu)},A${Math.round(this.amomu)}`, this.body.x - 20, this.body.y - 150)
            //         canvas_context.fillText(`Under:${Math.round(this.under)},Safe:${Math.round(this.safe)}`, this.body.x - 20, this.body.y - 200)
            //         canvas_context.fillText(`_ D${Math.round(this.dmom)},A${Math.round(this.amom)}`, this.body.x - 20, this.body.y - 300)
            //         if (this.fleeing == 1) {
            //             canvas_context.fillText(`fleeing`, this.body.x - 20, this.body.y - 300)
            //         }


            // this.bodyx = this.body.x
        }
        operate() {

            if (this.inactive == 1) {
                return
            }

            if (this.righthand.anchored == 1) {
                if (this.body.x > this.righthand.x) {
                    this.righthand.anchored = -10
                }
            }
            if (this.lefthand.anchored == 1) {
                if (this.body.x < this.lefthand.x) {
                    this.lefthand.anchored = -10
                }
            }

            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {


            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                        this.playerMove(this.righthand2, this.speed, this.gamepad)
                        this.playerMove(this.righthand3, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                        this.playerMove(this.lefthand2, this.speed, this.gamepad)
                        this.playerMove(this.lefthand3, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored <= 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                        this.AImove(this.righthand2, this.speed, this.gamepad)
                        this.AImove(this.righthand3, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored <= 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                        this.AImove(this.lefthand2, this.speed, this.gamepad)
                        this.AImove(this.lefthand3, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            }
            // }

            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.body.ymom *= .7
                    this.body.symom = this.leftshoulder.ymom * .99
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.body.ymom *= .7
                    this.body.symom = this.rightshoulder.ymom * .99
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     this.body.sxmom *= .5
                    // }
                }
                this.body.ymom += this.gravity
            } else {

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            } else {
                //this.collideStage()
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            } else {
                //this.collideStage()
            }
            this.righthand2.ymom += this.gravity * 2
            this.lefthand2.ymom += this.gravity * 2
            this.righthand.xmom += this.gravity * 2
            this.lefthand.xmom -= this.gravity * 2
            this.righthand3.ymom -= this.gravity * 3
            this.lefthand3.ymom -= this.gravity * 3



            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].frictiveMove(this)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].smove(this)
                }
            }
            if (this.lefthand.anchored <= 0) {

                this.lefthand.xmom += (this.lefthand.x - this.body.x) / 80
                this.lefthand2.xmom += (this.lefthand2.x - this.body.x) / 80
                this.lefthand3.xmom += (this.lefthand3.x - this.body.x) / 80
                this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            }

            if (this.righthand.anchored <= 0) {

                this.righthand.xmom += (this.righthand.x - this.body.x) / 80
                this.righthand2.xmom += (this.righthand2.x - this.body.x) / 80
                this.righthand3.xmom += (this.righthand3.x - this.body.x) / 80
                this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40
            }
            this.fixupshoulder()
            for (let t = 0; t < this.nodes.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    if (t != k) {
                        if (this.nodes[t] != this.rightshoulder2 && this.nodes[t] != this.rightshoulder3 && this.nodes[t] != this.rightshoulder && this.nodes[t] != this.leftshoulder && this.nodes[t] != this.leftshoulder2 && this.nodes[t] != this.leftshoulder3 && this.nodes[t] != this.body) {
                            if (this.nodes[k] != this.rightshoulder2 && this.nodes[k] != this.rightshoulder3 && this.nodes[k] != this.rightshoulder && this.nodes[k] != this.leftshoulder && this.nodes[k] != this.leftshoulder2 && this.nodes[k] != this.leftshoulder3 && this.nodes[k] != this.body) {
                                let j = 0
                                while (this.nodes[t].doesPerimeterTouch(this.nodes[k])) {
                                    j++
                                    if (j > 100) {
                                        break
                                    }
                                    if (this.nodes[k].anchored != 1) {
                                        if (this.nodes[t].anchored != 1) {
                                            this.nodes[k].x += (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[k].y += (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[t].x -= (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[t].y -= (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
                                        } else {
                                            break
                                        }
                                    } else {
                                        break
                                    }
                                }
                            }
                        }
                    }
                }
            }

            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

            // this.leftshoulder.xmom *= 0
            // this.leftshoulder.ymom *= 0

            // this.rightshoulder.xmom *= 0
            // this.rightshoulder.ymom *= 0

            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            if (boys.indexOf(this) <= humanPlayers) {

                this.fightcontrol()
            } else {
                this.AI()
            }
            // }
            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }
        }
    }





    class Princess {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                this.ping = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 6
                this.serverID = serverID
                this.shotdraw = 0
                this.id = controller
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 45
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shot = new Brick(-1, -1, 1, 1)
                this.striker = 10000
                this.name = "Princess GeGeGeGee"
                this.blasting = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.storeshield = 0
                this.wasfalse = []
                for (let t = 0; t < 100; t++) {
                    this.wasfalse.push(1)
                }
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = 0
                this.screwangle = 0
                this.charge = 0
                this.shots = []

                this.color = getRandomColor()
                if (controller == 0) {
                    this.color = "#ffAA00"
                }
                if (controller == 1) {
                    this.color = "#ff0000"
                }
                this.body = new ShotP(400 + (Math.random() * 2560), 500, 59, this.color)
                this.controller = controller
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.armlength = 45
                this.shoulderwidth = 45
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 11
                this.punchspeed = 5
                this.grounded = 0
                this.jumping = 1


                this.nodes.push(this.body)
                this.leftshoulder = new ShotP(this.body.x - (this.body.radius + this.shoulderwidth), 350, 17, "magenta", 0, 0, .999)
                this.rightshoulder = new ShotP(this.body.x + (this.body.radius + this.shoulderwidth), 350, 17, "#FF0000", 0, 0, .999)
                this.lefthand = new ShotP(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 34, "magenta", 0, 0, .85)
                this.righthand = new ShotP(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 34, "#FF0000", 0, 0, .85)
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.gravity = .8
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.body.fired = 0
                this.screwmomentum = 0
                this.screwtimer = 0
                this.blasting = 0
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {
                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]
                }
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    this.nodes[t] = new ShotP(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }
                    this.nodes[t].id = idsto
                }

                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                    this.shots[t] = new Shot(this.shots[t].x, this.shots[t].y, this.shots[t].radius, this.shots[t].color, this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                    this.shots[t].id = idsto

                }
                this.id = args["id"]
                this.frame = args['frame']
                this.armlength = 45
                this.shoulderwidth = 45
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }
                this.rightshoulder = this.nodes[2]
                this.leftshoulder = this.nodes[1]
                this.righthand = this.nodes[3]
                this.lefthand = this.nodes[4]

                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }
            }
        }

        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            object.ymom = -this.speed * 1 * 2
                        } else {
                            if (this.lefthand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                            if (this.righthand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 2
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            const copy = new Princess(this.controller)


            if(minigameSelected == 0){
                const now = new Date()
                campaigntimestart = now.getTime() 
            }
            copy.id = this.id
            copy.frame = this.frame
            if (this.inactive == 1) {
                copy.inactive = this.inactive
            }
            copy.body.color = this.body.color
            copy.serverID = this.serverID
            copy.striker = this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

            return copy
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }

            if (this.screwangle != 0) {

                this.leftshoulder.x = this.body.x + ((((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle)))))
                this.leftshoulder.y = this.body.y - (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle))))

                this.rightshoulder.x = this.body.x + (((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle))))
                this.rightshoulder.y = this.body.y - (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle))))

                this.leftshoulder.color = this.body.color
                this.rightshoulder.color = this.body.color
                this.lefthand.color = this.body.color
                this.righthand.color = this.body.color


                if (this.lefthand.anchored !== 1) {
                    this.lefthand.x = this.leftshoulder.x - this.lefthand.radius
                    this.lefthand.y = this.leftshoulder.y + this.lefthand.radius
                    // this.lefthand.xmom *=  this.lefthand.friction
                    // this.lefthand.ymom *=  this.lefthand.friction
                    // this.leftshoulder.xmom *= 0
                    // this.leftshoulder.ymom *= 0
                    this.lefthand.xmom = -5
                    this.lefthand.ymom = 1
                }
                if (this.righthand.anchored !== 1) {
                    this.righthand.x = this.rightshoulder.x + this.righthand.radius
                    this.righthand.y = this.rightshoulder.y + this.righthand.radius
                    // this.righthand.xmom *=  this.righthand.friction
                    // this.righthand.ymom *=  this.righthand.friction
                    // this.rightshoulder.xmom *= 0
                    // this.rightshoulder.ymom *= 0
                    this.righthand.xmom = 5
                    this.righthand.ymom = 1
                }

                if (this.body.ymom < -vsmashlimit) {
                    this.body.ymom = -vsmashlimit
                }
                if (this.body.ymom > vsmashlimit) {
                    this.body.ymom = vsmashlimit
                }


                // this.lefthand.xmom += (this.lefthand.x - this.body.x) / 100
                // this.righthand.xmom += (this.righthand.x - this.body.x) / 100

                // this.lefthand.ymom += (this.lefthand.y - this.body.y) / 100
                // this.righthand.ymom += (this.righthand.y - this.body.y) / 100


            } else {
                this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth * .3)
                this.leftshoulder.y = this.body.y - (this.shoulderwidth * .7)

                this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth * .3)
                this.rightshoulder.y = this.body.y - (this.shoulderwidth * .7)

                this.leftshoulder.color = this.body.color
                this.rightshoulder.color = this.body.color
                this.lefthand.color = this.body.color
                this.righthand.color = this.body.color


                if (this.lefthand.anchored == 0) {
                    this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth * .3)))
                    this.lefthand.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                    this.leftshoulder.xmom *= 0
                    this.leftshoulder.ymom *= 0
                }
                if (this.righthand.anchored == 0) {
                    this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth * .3)))
                    this.righthand.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                    this.rightshoulder.xmom *= 0
                    this.rightshoulder.ymom *= 0
                }

                if (this.body.ymom < -vsmashlimit) {
                    this.body.ymom = -vsmashlimit
                }



            }


            for (let t = 0; t < this.nodes.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    if (t != k) {
                        if (this.nodes[t] != this.rightshoulder && this.nodes[t] != this.leftshoulder) {
                            if (this.nodes[k] != this.rightshoulder && this.nodes[k] != this.leftshoulder) {
                                let j = 0
                                while (this.nodes[t].doesPerimeterTouch(this.nodes[k])) {
                                    j++
                                    if (j > 100) {
                                        break
                                    }
                                    if (this.nodes[k].anchored != 1) {
                                        if (this.nodes[t].anchored != 1) {
                                            this.nodes[k].x += (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[k].y += (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[t].x -= (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[t].y -= (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
                                        } else {
                                            break
                                        }
                                    } else {
                                        break
                                    }
                                }
                            }
                        }
                    }
                }
            }
            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }
        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (minigameSelected == 0) {
                        
                    }else if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    const rline = new LineOP(this.righthand, boys[k].body)
                    const lline = new LineOP(this.lefthand, boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (this.shield == 1) {
                                            this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                        } else {
                                            this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 200)) + (boys[t].shots[k].xmom * baselaunch)) * 2
                                            this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 200)) + (boys[t].shots[k].ymom * baselaunch)) * 2) - (10 * (this.damage / 200))
                                            this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                            this.breaktimer = 0
                                        }
                                        boys[t].shots[k].marked = 1
                                    }
                                }
                            }



                            if (boys[t].hasOwnProperty('radball')) {
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }

                            const enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }



                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 200)) + (boys[t].bananahand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 200)) + (boys[t].bananahand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 200)) + (boys[t].middlehand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 200)) + (boys[t].middlehand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 200)) + (boys[t].righthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 200)) + (boys[t].righthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14
                                            this.shotIDs.push(boys[t].righthand2.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 200)) + (boys[t].lefthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 200)) + (boys[t].lefthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 200)) + (boys[t].righthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 200)) + (boys[t].righthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 200)) + (boys[t].lefthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 200)) + (boys[t].lefthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)

                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }


                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 200)) + (boys[t].righthand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 200)) + (boys[t].righthand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].lefthand.fired > 14) {
                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)

                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            } else {
                                                this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 200)) + (boys[t].lefthand.xmom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 200)) + (boys[t].lefthand.ymom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)) * 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }

                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 200)) + (boys[t].body.xmom * baselaunch) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].body.ymom * (this.damage / 200)) + (boys[t].body.ymom * baselaunch)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        this.fixupshoulder()
                        boys[f].fixupshoulder()
                        
                        if(minigameSelected !== 8){
                            this.body.ymom *= .99
                        }else{
                            this.body.xmom *= .89
}
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2
                this.lefthand.ymom = -this.speed * 2
                this.righthand.ymom = -this.speed * 2
                this.jumpcount = 100

            }
        }
        doJump(object, speed) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -speed * 2
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 2
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {

            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            this.jumpcount--

            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }

            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }

        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                this.fleeing = 1
            }
            if (this.charge > 90) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {

                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        this.wmove = 1
                                        this.screwshot = 1
                                    }
                                }
                            }
                        }
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + Math.max(this.body.radius, boys[t].body.radius))) {
                        this.wmove = 1
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        if (Math.random() < .2) {
                            this.wmove = 1
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }


            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    this.screwshot = 1
                    this.wmove = 1
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    this.screwshot = 1
                }
            }
            this.exgrip = 0
            for (let t = 0; t < boys.length; t++) {
                if (this.amomu <= 0 && this.dmomu <= 0) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].brick.center.y > this.brick.center.y) {
                            if (boys[t].body.x < this.body.x) {
                                this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                this.amomu += 15
                                this.exgrip = 1
                            } else {
                                this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                this.dmomu += 15
                                this.exgrip = 1
                            }
                        }
                    }
                } else {
                    this.exgrip = 1
                }
            }


            if (this.dmom > 0) {
                this.screwshot = 1
                this.dmove = 1
                this.wmove = 1
                this.amove = 0
                this.amom = 0
            } else {

                if (this.dmomu > 0) {
                    this.dmove = 1
                    this.amove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }
            if (this.amom > 0) {
                this.screwshot = 1
                this.dmom = 0
                this.amove = 1
                this.wmove = 1
                this.dmove = 0
            } else {
                if (this.amomu > 0) {
                    this.amove = 1
                    this.dmove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }

            if (this.safe == 0) {
                if (this.under == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                }
                if (this.body.x > (this.brick.center.x)) {
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                } else {
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }

            if (this.trapped == 0) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]
                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        const runtimeR = xdisR / this.speed
                                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .95)) {//&& this.body.fired < 3.8 * runtimeR) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        const runtimeL = xdisL / this.speed
                                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .95)) {// && this.body.fired < 3.8 * runtimeL) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }
                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        const runtimeR = xdisR / this.speed
                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .8)) {// && this.body.fired < 1.8 * runtimeR) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1 //erroor
                                this.wmove = 1
                            }
                        }
                    } else {
                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        const runtimeL = xdisL / this.speed
                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .8)) {// && this.body.fired < 1.8 * runtimeL) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1//error
                                this.wmove = 1
                            }
                        }
                    }
                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }

            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            if (this.dmomu <= 0 && this.amomu <= 0) {
                                                this.screwshot = 1
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        this.amom = this.dmom
                        this.dmom = 0
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        this.dmom = this.amom
                        this.amom = 0
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }
                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 2
                    } else {
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                    }
                }
                if (this.dmove == 1) {
                    this.face = 1
                    if (object == this.body) {
                        object.x += speed
                        this.righthand.x += speed
                        this.lefthand.x += speed
                    }
                    if (this.righthand.anchored == 1) {
                        this.degripr()
                        this.jumping = 1
                    }
                }
                // if (keysPressed['s']) {
                //     object.y += speed
                //     this.degrip()
                // }
                if (this.amove == 1) {
                    this.face = -1
                    if (object == this.body) {
                        object.x -= speed
                        this.righthand.x -= speed
                        this.lefthand.x -= speed
                    }
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        this.degripl()
                        this.jumping = 1
                    }
                }


                // if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                // if (controller.gamepad.axesStatus[0] > .1) {
                //     this.face = 1
                // }

                // if (controller.gamepad.axesStatus[1] < -.1) {
                //     this.face = -1
                // }
                // }

            }
            // if (this.dmomu > 0 || this.amomu > 0) {
            //     this.lefthand.anchored = 0
            //     this.righthand.anchored = 0
            // }

            if (this.exgrip == 1) {
                this.righthand.anchored = 0
                this.lefthand.anchored = 0
            }
        }
        AI() {
            this.idify()

            if (this.inactive == 1) {
                return
            }
            this.breaks()

            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.charge--
            if (this.charge <= 0) {
                this.charge = 0
            }
            this.body.fired -= 1
            this.lefthand.fired--

            this.breaktimer--
            // if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] ||  keysPressed['e']) {

            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.rightshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {


                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.dmomu <= 0 && this.amomu <= 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 50 && this.body.y < boys[t].body.y) {
                        if (this.brick == boys[t].brick) {
                            this.downspike = 1
                        }
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {
                        if (this.brick == boys[t].brick) {
                            this.downspike = 1
                        }
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < 70 && this.body.y > boys[t].body.y) {
                        if (this.dmomu <= 0 && this.amomu <= 0) {
                            this.screwshot = 1
                        }
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == 1) {
                                this.hortsmash = 1
                            }
                        }
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == -1) {
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .09) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                this.leftshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.leftshot = 0
                                    }
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                this.rightshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.rightshot = 0
                                    }
                                }
                            }
                        }
                    }


                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (this.under == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                } else {
                    this.wmove = 1
                }
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.dmomu <= 0 && this.amomu <= 0) {
                                            this.screwshot = 1
                                            this.wmove = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        this.shieldpower -= .63
                        this.shield = 1
                        this.shielddraw = 1
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }

            if (this.body.fired > 30) {
                this.body.ymom -= this.body.fired * .008
            }
            if (this.screwtimer == 30) {
                this.body.fired = 30
                this.body.ymom = 70
            } else if (this.screwtimer <= 30) {
                if (this.screwtimer > 0) {
                    this.body.ymom = 70
                }
            }
            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.body.y < 900) {
                    this.wmove = 0
                    this.screwshot = 0
                }
                if (this.screwshot == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.shot = new Shot(this.rightshoulder.x, this.rightshoulder.y, 30, "#AA00FF", this.speed * -.2, -this.speed * .9)
                            this.shot.gravity = -.7
                            this.shots.push(this.shot)
                            this.fleeing = 0
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.fired = 30
                            this.body.ymom -= this.speed / 2.5
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.shot = new Shot(this.leftshoulder.x, this.leftshoulder.y, 30, "#AA00FF", - this.speed * -.2, -this.speed * .9)
                            this.shot.gravity = -.7
                            this.shots.push(this.shot)
                            this.fleeing = 0
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.fired = 30
                            this.body.ymom -= this.speed / 2.5
                        }
                    }
                }
                if (this.downspike == 1) {
                    //check
                    if (this.screwangle == 0) {
                        if (this.body.fired <= 0) {
                            this.blasting = 0
                            this.jumping = 1
                            this.screwangle = Math.PI * 1.5
                            this.screwtimer = 40
                            this.lefthand.fired = 40
                            this.righthand.fired = 40
                            this.lefthand.ymom = -5
                            this.righthand.ymom = -5
                            this.lefthand.xmom = 5
                            this.righthand.xmom = -5
                            this.body.fired = 10
                            this.lefthand.anchored = -10
                            this.righthand.anchored = -10
                            this.body.ymom = -jumplimit / 3
                        }
                    }
                }
                if (this.hortsmash == 1) {
                    //check
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.ymom = this.punchspeed * 21 + (this.body.ymom * 2)
                            this.righthand.xmom = -this.punchspeed * -5.1
                            this.righthand.fired = 19
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = this.punchspeed * 21 + (this.body.ymom * 2)
                            this.lefthand.xmom = this.punchspeed * -5.1
                            this.lefthand.fired = 19
                        }
                    }
                }
                if (this.rightshot == 1) {
                    //check
                    if (this.righthand.fired <= 0) {
                        if (this.face == 1) {
                            if (this.righthand.anchored == 0) {
                                this.righthand.ymom = this.punchspeed * 8
                                this.righthand.xmom = this.punchspeed * 19.1
                                this.righthand.fired = 19
                                this.body.xmom -= 5
                            }
                        }
                    }
                }
                if (this.leftshot == 1) {
                    //check
                    if (this.lefthand.fired <= 0) {
                        if (this.face == -1) {
                            if (this.lefthand.anchored == 0) {
                                this.lefthand.ymom = this.punchspeed * 8
                                this.lefthand.xmom = this.punchspeed * -19.1
                                this.lefthand.fired = 19
                                this.body.xmom += 5
                            }
                        }
                    }
                }

            }

        }
        fightcontrol() {

            if (this.inactive == 1) {
                return
            }
            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()



            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.charge--
            if (this.charge <= 0) {
                this.charge = 0
            }
            this.body.fired -= 1
            this.lefthand.fired--


            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            this.breaktimer--
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }

            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {


                    if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.face == 1) {
                                if (this.righthand.anchored == 0) {
                                    this.righthand.ymom = this.punchspeed * 8
                                    this.righthand.xmom = this.punchspeed * 19.1
                                    this.righthand.fired = 19
                                    this.body.xmom -= 5
                                    this.idify()
                                }
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.face == -1) {
                                if (this.lefthand.anchored == 0) {
                                    this.lefthand.ymom = this.punchspeed * 8
                                    this.lefthand.xmom = this.punchspeed * -19.1
                                    this.lefthand.fired = 19
                                    this.body.xmom += 5
                                    this.idify()
                                }
                            }
                        }
                    }

                    if (this.body.fired > 30) {
                        this.body.ymom -= this.body.fired * .008
                    }
                    if (this.screwtimer == 30) {
                        this.body.fired = 30
                        this.body.ymom = 100
                    } else if (this.screwtimer <= 30) {
                        if (this.screwtimer > 0) {
                            this.body.ymom = 100
                        }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.shot = new Shot(this.rightshoulder.x, this.rightshoulder.y, 30, "#AA00FF", this.speed * -.2, -this.speed * .9)
                                this.shot.gravity = -.7
                                this.shots.push(this.shot)
                                this.fleeing = 0
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.fired = 30
                                this.body.ymom -= this.speed / 2.5
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.shot = new Shot(this.leftshoulder.x, this.leftshoulder.y, 30, "#AA00FF", - this.speed * -.2, -this.speed * .9)
                                this.shot.gravity = -.7
                                this.shots.push(this.shot)
                                this.fleeing = 0
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.fired = 30
                                this.body.ymom -= this.speed / 2.5
                                this.idify()
                            }
                        }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {

                        if (this.screwangle == 0) {

                            if (this.body.fired <= 0) {
                                this.blasting = 0
                                this.jumping = 1
                                this.screwangle = Math.PI * 1.5
                                this.screwtimer = 40
                                this.lefthand.fired = 40
                                this.righthand.fired = 40
                                this.lefthand.ymom = -5
                                this.righthand.ymom = -5
                                this.lefthand.xmom = 5
                                this.righthand.xmom = -5
                                this.body.fired = 10
                                this.lefthand.anchored = -10
                                this.righthand.anchored = -10
                                this.body.ymom = -jumplimit / 3
                                this.idify()
                            }
                        }


                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.ymom = this.punchspeed * 21 + (this.body.ymom * 2)
                                this.righthand.xmom = -this.punchspeed * -5.1
                                this.righthand.fired = 19
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = this.punchspeed * 21 + (this.body.ymom * 2)
                                this.lefthand.xmom = this.punchspeed * -5.1
                                this.lefthand.fired = 19
                                this.idify()
                            }
                        }
                    }
                }
            }
        }
        degripl() {

            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        degripr() {

            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        collideStage() {

            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {

            if (this.inactive == 1) {
                return
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.blasting--
            if (this.grounded == 1) {
                if (this.screwtimer > 5) {
                    this.screwangle = 0
                    this.screwtimer = 0
                    // this.body.fired = 5
                }
            }
            this.grounded = 0
            this.frame++

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.shots.length; t++) {
                    if (typeof this.shots[t].gravity == "number") {
                        if (this.shots[t].ymom > -(vsmashlimit / 1.15)) {
                            this.shots[t].ymom += this.shots[t].gravity / 1.2
                            this.shots[t].radius -= .5
                            if (this.shots[t].radius < 10) {
                                this.shots[t].radius = 10
                            }
                        } else {
                            this.shots[t].marked = 1
                        }
                    }
                    if (typeof this.shots[t].countdown == "number") {
                        this.shots[t].countdown--
                        this.shots[t].gravity = Math.cos(this.shots[t].countdown * (Math.PI / 4)) * 20
                        if (this.shots[t].countdown <= 0) {
                            this.shots[t].marked = 1
                        }
                    }
                    this.shots[t].move()
                    if (this.shots[t].marked <= 0) {
                        this.shots[t].draw()
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].draw()
                        }
                    }
                }
            }

            for (let j = 0; j < 10; j++) {
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked == 1) {
                        this.shots.splice(t, 1)
                    } else {
                        this.shots[t].marked--
                    }
                }
            }
            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.collideStage()
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].color = invertColor(this.body.color)
                this.links[t].draw()
            }
            for (let t = 0; t < this.nodes.length; t++) {
                this.nodes[t].draw()
                if (this.nodes[t] == this.body) {
                    const link = new Line(this.body.x, this.body.y, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y + Math.sin(this.screwangle), invertColor(this.body.color), this.body.radius * .2)
                    canvas_context.lineWidth = this.strokeWidth
                    canvas_context.strokeStyle = invertColor(this.body.color)
                    canvas_context.beginPath();
                    canvas_context.arc(((link.x1 + link.x2 + this.body.x) * (1 / 3)) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .35, (this.screwangle * this.face) + (this.face / 2), (Math.PI * 1) + (this.screwangle * this.face) + (this.face / 2), true)
                    canvas_context.fillStyle = invertColor(this.body.color)
                    canvas_context.fill()
                    canvas_context.stroke();
                }
            }

            // if (this.controller == 0) {

            // if (this.screwangle == 0) {
            //     link.draw()
            // }
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.lefthand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
            canvas_context.font = "42px arial"
            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            if(minigameSelected != 0){
            canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 70)
            canvas_context.fillStyle = "white"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 110)
            }
            }


        }
        operate() {

            if (this.inactive == 1) {
                return
            }
            if (this.righthand.anchored == 1) {
                if (this.body.x > this.righthand.x) {
                    this.righthand.anchored = -10
                }
            }
            if (this.lefthand.anchored == 1) {
                if (this.body.x < this.lefthand.x) {
                    this.lefthand.anchored = -10
                }
            }

            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {
            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            }
            // }
            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.leftshoulder.ymom * .99
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.rightshoulder.ymom * .99
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     // this.body.sxmom *= 0
                    //     this.body.xmom *= .5
                    // }
                }
                this.body.ymom += this.gravity
            } else {

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            } else {
                //this.collideStage()
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            } else {
                //this.collideStage()
            }
            this.righthand.ymom += this.gravity
            this.lefthand.ymom += this.gravity


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            this.body.xmom *= .99
            this.body.ymom *= .99

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].frictiveMove(this)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].smove(this)
                }
            }
            this.lefthand.xmom += (this.lefthand.x - this.body.x) / 40
            this.righthand.xmom += (this.righthand.x - this.body.x) / 40
            this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40
            this.fixupshoulder()

            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            if (boys.indexOf(this) <= humanPlayers) {

                // this.AI()
                this.fightcontrol()
            } else {
                this.AI()
            }
            // }
            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }

        }
    }



    class Rhopho {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                this.ping = 0
                this.pounding = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 7
                this.frame = 0
                this.serverID = serverID
                this.shotdraw = 0
                this.id = controller
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 0
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shot = new Brick(-1, -1, 1, 1)
                this.striker = 10000
                this.name = "Rhopho"
                this.blasting = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.storeshield = 0
                this.wasfalse = []
                for (let t = 0; t < 100; t++) {
                    this.wasfalse.push(1)
                }
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = 0
                this.screwangle = 0
                this.charge = 0
                this.shots = []

                this.color = getRandomColor()
                if (controller == 0) {
                    this.color = "#ffAA00"
                }
                if (controller == 1) {
                    this.color = "#ff0000"
                }
                this.body = new ShotR(400 + (Math.random() * 2560), 500, 65, this.color)
                this.controller = controller
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.armlength = 28
                this.shoulderwidth = 20
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 13
                this.punchspeed = 5.5
                this.grounded = 1
                this.jumping = 1


                this.nodes.push(this.body)
                this.leftshoulder = new ShotR(this.body.x - (this.body.radius + this.shoulderwidth), 350, 17, "#FF0000", 0, 0, .999)
                this.rightshoulder = new ShotR(this.body.x + (this.body.radius + this.shoulderwidth), 350, 17, "#FF0000", 0, 0, .999)
                this.middleshoulder = new ShotR(this.body.x, 350 - (this.shoulderwidth + this.body.radius), 12, "#FF0000", 0, 0, .999)
                this.lefthand = new ShotR(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 27, "#FF0000", 0, 0, .85)
                this.righthand = new ShotR(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 27, "#FF0000", 0, 0, .85)
                this.middlehand = new ShotR(this.middleshoulder.x, (this.middleshoulder.y + this.armlength), 33, "#FF0000", 0, 0, .85)
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.middleshoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.nodes.push(this.middlehand)
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.middlecollar = new LineOP(this.middleshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.links.push(this.middlecollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.links.push(this.middlearm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.middlearm = new SpringOP(this.middleshoulder, this.middlehand, this.armlength * 1.2, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.springs.push(this.middlearm)
                this.gravity = .95
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.middlehand.fired = 0
                this.body.fired = 0
                this.screwmomentum = 0
                this.screwtimer = 0
                this.blasting = 0
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {
                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]
                }
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    this.nodes[t] = new ShotR(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }
                    this.nodes[t].id = idsto
                }

                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                    this.shots[t] = new ShotR(this.shots[t].x, this.shots[t].y, this.shots[t].radius, this.shots[t].color, this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                    this.shots[t].id = idsto

                }
                this.id = args["id"]
                this.frame = args['frame']
                this.armlength = 28
                this.shoulderwidth = 20
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }
                this.leftshoulder = this.nodes[1]
                this.rightshoulder = this.nodes[2]
                this.middleshoulder = this.nodes[3]
                this.righthand = this.nodes[4]
                this.lefthand = this.nodes[5]
                this.middlehand = this.nodes[6]
                // this.leftcollar = this.nodes[7]
                // this.rightcollar = this.nodes[7]
                // this.middlecollar = this.nodes[8]
                // this.leftarm = this.nodes[9]
                // this.rightarm = this.nodes[10]
                // this.middlearm = this.nodes[11]
                // this.leftarm = this.nodes[12]
                // this.rightarm = this.nodes[31]
                // this.middlearm = this.nodes[14]

                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                this.middlecollar = new LineOP(this.middleshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.middlecollar = new LineOP(this.middleshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.links.push(this.middlecollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.links.push(this.middlearm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.middlearm = new SpringOP(this.middleshoulder, this.middlehand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.springs.push(this.middlearm)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }
            }
            ////////////////////////////////////console.log(this)
        }

        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            ////////////////////////////////////console.log(object.ymom,this.body.ymom)
                            object.ymom = -this.speed * 1 * 2
                            ////////////////////////////////////console.log(object.ymom,this.body.ymom)
                        } else {
                            if (this.lefthand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed // not as high as the axes?
                            }
                            if (this.righthand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 2
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        // this.face = -1
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            const copy = new Rhopho(this.controller)
            copy.id = this.id
            copy.frame = this.frame
            if (this.inactive == 1) {
                copy.inactive = this.inactive
            }
            copy.body.color = this.body.color
            copy.serverID = this.serverID
            copy.striker = this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

            return copy
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }

            this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth * .3)
            this.leftshoulder.y = this.body.y - (this.shoulderwidth * .7)

            this.middleshoulder.x = this.body.x
            this.middleshoulder.y = this.body.y - ((this.shoulderwidth * 1) + this.body.radius)

            this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth * .3)
            this.rightshoulder.y = this.body.y - (this.shoulderwidth * .7)


            this.leftshoulder.color = this.body.color
            this.rightshoulder.color = this.body.color
            this.middleshoulder.color = this.body.color
            this.lefthand.color = this.body.color
            this.righthand.color = this.body.color
            this.middlehand.color = this.body.color



            if (this.lefthand.anchored == 0) {
                this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth * .3)))
                this.lefthand.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                this.leftshoulder.xmom *= 0
                this.leftshoulder.ymom *= 0
            }
            if (this.righthand.anchored == 0) {
                this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth * .3)))
                this.righthand.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                this.rightshoulder.xmom *= 0
                this.rightshoulder.ymom *= 0
            }


            // this.middlehand.x = this.middlehand.x + (this.middleshoulder.x - (this.body.x))
            this.middlehand.y -= this.middleshoulder.y - (this.body.y - ((this.shoulderwidth * 1) + this.body.radius))
            this.middleshoulder.xmom *= 0
            this.middleshoulder.ymom *= 0


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }




            for (let t = 0; t < this.nodes.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    if (t != k) {
                        if (this.nodes[t] != this.rightshoulder && this.nodes[t] != this.leftshoulder && this.nodes[t] != this.middleshoulder) {
                            if (this.nodes[k] != this.rightshoulder && this.nodes[k] != this.leftshoulder && this.nodes[k] != this.middleshoulder) {
                                let j = 0
                                while (this.nodes[t].doesPerimeterTouch(this.nodes[k])) {
                                    j++
                                    if (j > 100) {
                                        break
                                    }
                                    if (this.nodes[k].anchored != 1) {
                                        if (this.nodes[t].anchored != 1) {
                                            this.nodes[k].x += (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[k].y += (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[t].x -= (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[t].y -= (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
                                        } else {
                                            break
                                        }
                                    } else {
                                        break
                                    }
                                }
                            }
                        }
                    }
                }
            }
            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }
        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.middlehand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    const rline = new LineOP(this.righthand, boys[k].body)
                    const lline = new LineOP(this.lefthand, boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (this.shield == 1) {
                                            this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                        } else {
                                            this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 171)) + (boys[t].shots[k].xmom * baselaunch)) * 2
                                            this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 171)) + (boys[t].shots[k].ymom * baselaunch)) * 2) - (10 * (this.damage / 171))
                                            this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                            this.breaktimer = 0
                                        }
                                        boys[t].shots[k].marked = 1
                                    }
                                }
                            }


                            if (boys[t].hasOwnProperty('radball')) {
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }

                            const enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }



                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 171)) + (boys[t].bananahand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 171)) + (boys[t].bananahand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 171)) + (boys[t].middlehand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 171)) + (boys[t].middlehand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 171)) + (boys[t].righthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 171)) + (boys[t].righthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14
                                            this.shotIDs.push(boys[t].righthand2.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 171)) + (boys[t].lefthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 171)) + (boys[t].lefthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 171)) + (boys[t].righthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 171)) + (boys[t].righthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 171)) + (boys[t].lefthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 171)) + (boys[t].lefthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)

                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }

                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 171)) + (boys[t].righthand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 171)) + (boys[t].righthand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].lefthand.fired > 14) {
                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)
                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            } else {
                                                this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 171)) + (boys[t].lefthand.xmom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 171)) + (boys[t].lefthand.ymom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)) * 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 171)) + (boys[t].body.xmom * baselaunch) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].body.ymom * (this.damage / 171)) + (boys[t].body.ymom * baselaunch)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        this.fixupshoulder()
                        boys[f].fixupshoulder()
                        this.body.ymom *= .99
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2
                this.lefthand.ymom = -this.speed * 2
                this.righthand.ymom = -this.speed * 2
                this.middlehand.ymom = -this.speed * 2
                this.jumpcount = 100

            }
        }
        doJump(object, speed) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -this.speed * 2
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 2
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {

            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            this.jumpcount--

            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                    this.doJump(this.middlehand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }

            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }

        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                this.fleeing = 1
            }
            if (this.charge > 90) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {

                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        this.wmove = 1
                                        this.screwshot = 1
                                    }
                                }
                            }
                        }
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + Math.max(this.body.radius, boys[t].body.radius))) {
                        this.wmove = 1
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        if (Math.random() < .2) {
                            this.wmove = 1
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }


            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    this.screwshot = 1
                    this.wmove = 1
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    this.screwshot = 1
                }
            }
            this.exgrip = 0
            for (let t = 0; t < boys.length; t++) {
                if (this.amomu <= 0 && this.dmomu <= 0) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].brick.center.y > this.brick.center.y) {
                            if (boys[t].body.x < this.body.x) {
                                this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                this.amomu += 15
                                this.exgrip = 1
                            } else {
                                this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                this.dmomu += 15
                                this.exgrip = 1
                            }
                        }
                    }
                } else {
                    this.exgrip = 1
                }
            }


            if (this.dmom > 0) {
                this.screwshot = 1
                this.dmove = 1
                this.wmove = 1
                this.amove = 0
                this.amom = 0
            } else {

                if (this.dmomu > 0) {
                    this.dmove = 1
                    this.amove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }
            if (this.amom > 0) {
                this.screwshot = 1
                this.dmom = 0
                this.amove = 1
                this.wmove = 1
                this.dmove = 0
            } else {
                if (this.amomu > 0) {
                    this.amove = 1
                    this.dmove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }

            if (this.safe == 0) {
                if (this.under == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                }
                if (this.body.x > (this.brick.center.x)) {
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                } else {
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }

            if (this.trapped == 0) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]
                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        const runtimeR = xdisR / this.speed
                                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .95)) {//&& this.body.fired < 3.8 * runtimeR) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        const runtimeL = xdisL / this.speed
                                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .95)) {// && this.body.fired < 3.8 * runtimeL) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }
                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        const runtimeR = xdisR / this.speed
                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .8)) {// && this.body.fired < 1.8 * runtimeR) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1 //erroor
                                this.wmove = 1
                            }
                        }
                    } else {
                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        const runtimeL = xdisL / this.speed
                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .8)) {// && this.body.fired < 1.8 * runtimeL) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1//error
                                this.wmove = 1
                            }
                        }
                    }
                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }

            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            if (this.dmomu <= 0 && this.amomu <= 0) {
                                                this.screwshot = 1
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        this.amom = this.dmom
                        this.dmom = 0
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        this.dmom = this.amom
                        this.amom = 0
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }


                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 2
                    } else {
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                    }
                }
                if (this.dmove == 1) {
                    this.face = 1
                    if (object == this.body) {
                        object.x += speed
                        this.righthand.x += speed
                        this.lefthand.x += speed
                        this.middlehand.x += speed
                    }
                    if (this.righthand.anchored == 1) {
                        this.degripr()
                        this.jumping = 1
                    }
                }
                // if (keysPressed['s']) {
                //     object.y += speed
                //     this.degrip()
                // }
                if (this.amove == 1) {
                    this.face = -1
                    if (object == this.body) {
                        object.x -= speed
                        this.righthand.x -= speed
                        this.lefthand.x -= speed
                        this.middlehand.x -= speed
                    }
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        this.degripl()
                        this.jumping = 1
                    }
                }


                // if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                // if (controller.gamepad.axesStatus[0] > .1) {
                //     this.face = 1
                // }

                // if (controller.gamepad.axesStatus[1] < -.1) {
                //     this.face = -1
                // }
                // }

            }
            // if (this.dmomu > 0 || this.amomu > 0) {
            //     this.lefthand.anchored = 0
            //     this.righthand.anchored = 0
            // }

            if (this.exgrip == 1) {
                this.righthand.anchored = 0
                this.lefthand.anchored = 0
            }
        }
        AI() {
            this.idify()

            if (this.inactive == 1) {
                return
            }
            this.breaks()

            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.middlehand.fired--
            this.lefthand.fired--
            this.charge--
            if (this.charge <= 0) {
                this.charge = 0
            }
            this.body.fired -= 1

            this.breaktimer--
            // if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] ||  keysPressed['e']) {

            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.rightshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {


                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.dmomu <= 0 && this.amomu <= 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 50 && this.body.y < boys[t].body.y) {
                        if (this.brick == boys[t].brick) {
                            this.downspike = 1
                        }
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {
                        if (this.brick == boys[t].brick) {
                            this.downspike = 1
                        }
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < 70 && this.body.y > boys[t].body.y) {
                        if (this.dmomu <= 0 && this.amomu <= 0) {
                            this.screwshot = 1
                        }
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == 1) {
                                this.hortsmash = 1
                            }
                        }
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == -1) {
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .09) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                this.leftshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.leftshot = 0
                                    }
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                this.rightshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.rightshot = 0
                                    }
                                }
                            }
                        }
                    }


                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (this.under == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                } else {
                    this.wmove = 1
                }
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.dmomu <= 0 && this.amomu <= 0) {
                                            this.screwshot = 1
                                            this.wmove = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        this.shieldpower -= .63
                        this.shield = 1
                        this.shielddraw = 1
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }

            if (this.body.fired > 30) {
                this.body.ymom -= this.body.fired * .008
            }
            if (this.screwtimer == 30) {
                this.body.fired = 30
                this.body.ymom = 75
            } else if (this.screwtimer <= 30) {
                if (this.screwtimer > 0) {
                    this.body.ymom = 75
                }
            }
            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.body.y < 900) {
                    this.wmove = 0
                    this.screwshot = 0
                }
                if (this.screwshot == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.fired = 19
                            this.righthand.ymom = this.punchspeed * -20
                            this.righthand.xmom = this.punchspeed * -4
                            this.idify()
                        }
                    }
                    if (this.middlehand.fired <= 0) {
                        this.middleshoulder.xmom = 0
                        this.middleshoulder.ymom = 0
                        this.middlehand.fired = 19
                        this.middlehand.ymom = this.punchspeed * -20
                        this.idify()
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = this.punchspeed * -20
                            this.lefthand.xmom = this.punchspeed * 4
                            this.lefthand.fired = 19
                            this.idify()
                        }
                    }
                }
                if (this.downspike == 1) {

                    if (this.screwangle == 0) {

                        if (this.body.fired <= 0) {
                            this.jumping = 1
                            this.screwangle = Math.PI * 1.5
                            this.screwtimer = 40
                            this.body.fired = 40
                            if (this.grounded != 1) {
                                this.pounding = 1
                            } else {
                                if (this.righthand.fired <= 0) {
                                    if (this.righthand.anchored == 0) {
                                        this.righthand.ymom = this.punchspeed * 8
                                        this.righthand.xmom = this.punchspeed * 19.1
                                        this.righthand.fired = 19
                                        this.body.xmom -= 5
                                        this.idify()
                                    }
                                }
                                if (this.lefthand.fired <= 0) {
                                    if (this.lefthand.anchored == 0) {
                                        this.lefthand.ymom = this.punchspeed * 8
                                        this.lefthand.xmom = this.punchspeed * -19.1
                                        this.lefthand.fired = 19
                                        this.idify()
                                    }
                                }

                                if (this.middlehand.fired <= 0) {
                                    this.middleshoulder.xmom = 0
                                    this.middleshoulder.ymom = 0
                                    this.middlehand.fired = 19
                                    this.middlehand.ymom = this.punchspeed * -20
                                    this.idify()
                                }
                            }
                            this.idify()
                        }
                    }



                }
                if (this.hortsmash == 1) {


                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.ymom = this.punchspeed * 21 + (this.body.ymom * 2)
                            this.righthand.xmom = -this.punchspeed * -5.1
                            this.righthand.fired = 19
                            this.body.ymom -= this.speed * .1
                            this.idify()
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = this.punchspeed * 21 + (this.body.ymom * 2)
                            this.lefthand.xmom = this.punchspeed * -5.1
                            this.lefthand.fired = 19
                            this.body.ymom -= this.speed * .1
                            this.idify()
                        }
                    }
                    if (this.middlehand.fired <= 0) {
                        this.middleshoulder.xmom = 0
                        this.middleshoulder.ymom = 0
                        this.middlehand.ymom = this.punchspeed * 21

                        if (this.face == 1) {
                            this.middlehand.xmom = this.punchspeed * 6
                        }

                        if (this.face == -1) {
                            this.middlehand.xmom = -this.punchspeed * 6
                        }
                        this.middlehand.fired = 19
                        this.body.ymom -= this.speed * .1
                        this.idify()
                    }


                }

                if (this.rightshot == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.face == 1) {
                            if (this.righthand.anchored == 0) {
                                this.righthand.ymom = this.punchspeed * 8
                                this.righthand.xmom = this.punchspeed * 19.1
                                this.righthand.fired = 19
                                this.body.xmom -= 5
                                this.idify()
                            }
                        }
                    }
                    if (this.middlehand.fired <= 0) {
                        if (this.face == 1) {
                            if (this.lefthand.anchored == 0) {
                                this.middlehand.xmom = this.punchspeed * 19.1
                            }
                        }
                        if (this.face == -1) {
                            this.middlehand.xmom = this.punchspeed * -19.1
                        }
                        this.idify()
                        this.middlehand.ymom = this.punchspeed * -4
                        this.middlehand.fired = 19
                    }
                }

                if (this.leftshot == 1) {
                    if (this.middlehand.fired <= 0) {
                        if (this.face == 1) {
                            if (this.lefthand.anchored == 0) {
                                this.middlehand.xmom = this.punchspeed * 19.1
                            }
                        }
                        if (this.face == -1) {
                            this.middlehand.xmom = this.punchspeed * -19.1
                        }
                        this.idify()
                        this.middlehand.ymom = this.punchspeed * -4
                        this.middlehand.fired = 19
                    }

                    if (this.lefthand.fired <= 0) {
                        if (this.face == -1) {
                            if (this.lefthand.anchored == 0) {
                                this.lefthand.ymom = this.punchspeed * 8
                                this.lefthand.xmom = this.punchspeed * -19.1
                                this.lefthand.fired = 19
                                this.idify()
                            }
                        }
                    }
                }

            }

        }
        fightcontrol() {

            if (this.inactive == 1) {
                return
            }
            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()



            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.middlehand.fired--
            this.charge--
            if (this.charge <= 0) {
                this.charge = 0
            }
            this.body.fired -= 1
            this.lefthand.fired--


            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            this.breaktimer--
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }

            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {


                    if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.face == 1) {
                                if (this.righthand.anchored == 0) {
                                    this.righthand.ymom = this.punchspeed * 8
                                    this.righthand.xmom = this.punchspeed * 19.1
                                    this.righthand.fired = 19
                                    this.body.xmom -= 5
                                    this.idify()
                                }
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.face == -1) {
                                if (this.lefthand.anchored == 0) {
                                    this.lefthand.ymom = this.punchspeed * 8
                                    this.lefthand.xmom = this.punchspeed * -19.1
                                    this.lefthand.fired = 19
                                    this.idify()
                                }
                            }
                        }
                        if (this.middlehand.fired <= 0) {
                            if (this.face == 1) {
                                if (this.lefthand.anchored == 0) {
                                    this.middlehand.xmom = this.punchspeed * 19.1
                                }
                            }
                            if (this.face == -1) {
                                this.middlehand.xmom = this.punchspeed * -19.1
                            }
                            this.idify()
                            this.middlehand.ymom = this.punchspeed * -4
                            this.middlehand.fired = 19
                        }
                    }

                    if (this.body.fired > 30) {
                        this.body.ymom -= this.body.fired * .008
                    }
                    if (this.screwtimer == 30) {
                        this.body.fired = 30
                        this.body.ymom = 75
                    } else if (this.screwtimer <= 30) {
                        if (this.screwtimer > 0) {
                            this.body.ymom = 75
                        }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.fired = 19
                                this.righthand.ymom = this.punchspeed * -20
                                this.righthand.xmom = this.punchspeed * -4
                                this.idify()
                            }
                        }
                        if (this.middlehand.fired <= 0) {
                            this.middleshoulder.xmom = 0
                            this.middleshoulder.ymom = 0
                            this.middlehand.fired = 19
                            this.middlehand.ymom = this.punchspeed * -20
                            this.idify()
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = this.punchspeed * -20
                                this.lefthand.xmom = this.punchspeed * 4
                                this.lefthand.fired = 19
                                this.idify()
                            }
                        }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {

                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.ymom = this.punchspeed * 21 + (this.body.ymom * 2)
                                this.righthand.xmom = -this.punchspeed * -5.1
                                this.righthand.fired = 19
                                this.body.ymom -= this.speed * .1
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = this.punchspeed * 21 + (this.body.ymom * 2)
                                this.lefthand.xmom = this.punchspeed * -5.1
                                this.lefthand.fired = 19
                                this.body.ymom -= this.speed * .1
                                this.idify()
                            }
                        }
                        if (this.middlehand.fired <= 0) {
                            this.middleshoulder.xmom = 0
                            this.middleshoulder.ymom = 0
                            this.middlehand.ymom = this.punchspeed * 21

                            if (this.face == 1) {
                                this.middlehand.xmom = this.punchspeed * 6
                            }

                            if (this.face == -1) {
                                this.middlehand.xmom = -this.punchspeed * 6
                            }
                            this.middlehand.fired = 19
                            this.body.ymom -= this.speed * .1
                            this.idify()
                        }


                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
                        if (this.screwangle == 0) {

                            if (this.body.fired <= 0) {
                                this.jumping = 1
                                this.screwangle = Math.PI * 1.5
                                this.screwtimer = 40
                                this.body.fired = 40
                                if (this.grounded != 1) {
                                    this.pounding = 1
                                } else {
                                    if (this.righthand.fired <= 0) {
                                        if (this.righthand.anchored == 0) {
                                            this.righthand.ymom = this.punchspeed * 8
                                            this.righthand.xmom = this.punchspeed * 19.1
                                            this.righthand.fired = 19
                                            this.body.xmom -= 5
                                            this.idify()
                                        }
                                    }
                                    if (this.lefthand.fired <= 0) {
                                        if (this.lefthand.anchored == 0) {
                                            this.lefthand.ymom = this.punchspeed * 8
                                            this.lefthand.xmom = this.punchspeed * -19.1
                                            this.lefthand.fired = 19
                                            this.idify()
                                        }
                                    }

                                    if (this.middlehand.fired <= 0) {
                                        this.middleshoulder.xmom = 0
                                        this.middleshoulder.ymom = 0
                                        this.middlehand.fired = 19
                                        this.middlehand.ymom = this.punchspeed * -20
                                        this.idify()
                                    }
                                }
                                this.idify()
                            }
                        }

                    }
                }
            }
        }
        degripl() {

            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        degripr() {

            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        collideStage() {

            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {

            if (this.inactive == 1) {
                return
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.body.anchored = 0
            this.middlehand.anchored = 0
            this.blasting--
            if (this.grounded == 1) {
                if (this.screwtimer > 5) {
                    this.screwangle = 0
                    this.screwtimer = 0
                    // this.body.fired = 5
                }
            }
            this.grounded = 0
            this.frame++

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.shots.length; t++) {
                    if (typeof this.shots[t].gravity == "number") {
                        if (this.shots[t].ymom > -(vsmashlimit / 1.15)) {
                            this.shots[t].ymom += this.shots[t].gravity / 1.2
                            this.shots[t].radius -= .5
                            if (this.shots[t].radius < 10) {
                                this.shots[t].radius = 10
                            }
                        } else {
                            this.shots[t].marked = 1
                        }
                    }
                    if (typeof this.shots[t].countdown == "number") {
                        this.shots[t].countdown--
                        this.shots[t].gravity = Math.cos(this.shots[t].countdown * (Math.PI / 4)) * 20
                        if (this.shots[t].countdown <= 0) {
                            this.shots[t].marked = 1
                        }
                    }
                    this.shots[t].move()
                    if (this.shots[t].marked <= 0) {
                        this.shots[t].draw()
                    }

                    this.shots[t].life--
                    if (this.shots[t].life <= 0) {
                        this.shots[t].marked = 1
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].draw()
                        }
                    }
                }
            }

            for (let j = 0; j < 10; j++) {
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked == 1) {
                        this.shots.splice(t, 1)
                    } else {
                        this.shots[t].marked--
                    }
                }
            }
            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.middlearm = new LineOP(this.middleshoulder, this.middlehand, invertColor(this.body.color), 8)
            this.collideStage()
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].color = invertColor(this.body.color)
                this.links[t].draw()
            }
            for (let t = 0; t < this.nodes.length; t++) {
                this.nodes[t].draw()
                if (this.nodes[t] == this.body) {
                    const link = new Line(this.body.x, this.body.y, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y + Math.sin(this.screwangle), invertColor(this.body.color), this.body.radius * .2)
                    canvas_context.lineWidth = this.strokeWidth
                    canvas_context.strokeStyle = "#000000"
                    canvas_context.beginPath();
                    canvas_context.arc(((link.x1 + link.x2 + this.body.x) * (1 / 3)) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .35, (this.screwangle * this.face) + (this.face / 2), (Math.PI * 1) + (this.screwangle * this.face) + (this.face / 2), true)
                    canvas_context.fillStyle = "#00FF00"
                    canvas_context.fill()
                    canvas_context.stroke();
                    canvas_context.lineWidth = this.strokeWidth
                    canvas_context.strokeStyle = "#000000"
                    canvas_context.beginPath();
                    canvas_context.arc(((link.x1 + link.x2 + this.body.x) * (1 / 3)) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .35, (this.screwangle * this.face) + (this.face / 2), (Math.PI * 1) + (this.screwangle * this.face) + (this.face / 2), false)
                    canvas_context.fillStyle = "#00FF00"
                    canvas_context.fill()
                    canvas_context.stroke();
                }
            }

            // if (this.controller == 0) {

            // if (this.screwangle == 0) {
            //     link.draw()
            // }
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.middlehand)).hypotenuse(), (new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.middlehand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
            canvas_context.font = "42px arial"
            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 200)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            if(minigameSelected != 5){
                canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 200)
            canvas_context.fillStyle = "white"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 240)
            }

            }

        }
        operate() {

            if (this.inactive == 1) {
                return
            }
            if (this.righthand.anchored == 1) {
                if (this.body.x > this.righthand.x) {
                    this.righthand.anchored = -10
                }
            }
            if (this.lefthand.anchored == 1) {
                if (this.body.x < this.lefthand.x) {
                    this.lefthand.anchored = -10
                }
            }

            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {
            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }

                    this.playerMove(this.middlehand, this.speed, this.gamepad)
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.AImove(this.middlehand, this.speed, this.gamepad)
                    this.doubleJump()
                }
            }
            // }
            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.leftshoulder.ymom * .99
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.rightshoulder.ymom * .99
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     // this.body.sxmom *= 0
                    //     this.body.xmom *= .5
                    // }
                }
                this.body.ymom += this.gravity
            } else {
                if (this.pounding == 1) {
                    this.pounding = 0
                    const shot1 = new ShotC(this.body.x, this.body.y + this.body.radius, 21, "#00FF00", this.speed * 2, 0)
                    shot1.life = 50
                    const shot2 = new ShotC(this.body.x, this.body.y + this.body.radius, 21, "#00FF00", - this.speed * 2, 0)
                    shot2.life = 50
                    this.shots.push(shot1)
                    this.shots.push(shot2)
                }

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            }
            this.righthand.ymom += this.gravity
            this.lefthand.ymom += this.gravity
            this.middlehand.ymom += this.gravity


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            this.body.xmom *= .99
            this.body.ymom *= .99

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].frictiveMove(this)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].smove(this)
                }
            }
            this.lefthand.xmom += (this.lefthand.x - this.body.x) / 40
            this.righthand.xmom += (this.righthand.x - this.body.x) / 40
            this.middlehand.ymom += (this.middlehand.y - this.body.y) / 20
            this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40
            this.middleshoulder.ymom -= (this.middleshoulder.y - this.body.y) / 40
            this.fixupshoulder()

            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            if (boys.indexOf(this) <= humanPlayers) {

                // this.AI()
                this.fightcontrol()
            } else {
                this.AI()
            }
            // }
            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }

        }
    }





    class Banandroid {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                this.ping = 0
                this.nograv = 0
                this.pounding = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 8
                this.frame = 0
                this.serverID = serverID
                this.shotdraw = 0
                this.id = controller
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 0
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shot = new Brick(-1, -1, 1, 1)
                this.striker = 10000
                this.name = "Banandroid"
                this.blasting = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.storeshield = 0
                this.wasfalse = []
                for (let t = 0; t < 100; t++) {
                    this.wasfalse.push(1)
                }
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = 0
                this.screwangle = 0
                this.charge = 0
                this.charge2 = 0
                this.shots = []

                this.color = getRandomColor()
                if (controller == 0) {
                    this.color = "#ffAA00"
                }
                if (controller == 1) {
                    this.color = "#ff0000"
                }
                this.body = new ShotN(400 + (Math.random() * 2560), 500, 54, this.color)
                this.controller = controller
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.armlength = 35 //40
                this.shoulderwidth = 20
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 13.5 //14
                this.punchspeed = 6.1 // 6.5
                this.grounded = 1
                this.jumping = 1


                this.nodes.push(this.body)
                this.leftshoulder = new Circle(this.body.x - (this.body.radius + this.shoulderwidth), 350, 7, "#FF0000", 0, 0, .999)
                this.rightshoulder = new Circle(this.body.x + (this.body.radius + this.shoulderwidth), 350, 7, "#FF0000", 0, 0, .999)
                this.middleshoulder = new Circle(this.body.x + (this.body.radius + this.shoulderwidth), 350, 4, "#FF0000", 0, 0, .999)
                this.bananashoulder = new Circle(this.body.x - (this.body.radius + this.shoulderwidth), 350, 4, "#FF0000", 0, 0, .999)
                this.lefthand = new Circle(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 29, "#FF0000", 0, 0, .85)
                this.righthand = new Circle(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 29, "#FF0000", 0, 0, .85)
                this.middlehand = new Circle(this.middleshoulder.x, (this.middleshoulder.y + this.armlength), 18.5, "#FF0000", 0, 0, .85)
                this.bananahand = new Circle(this.bananashoulder.x, (this.bananashoulder.y + this.armlength), 18.5, "#FF0000", 0, 0, .85)
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.middleshoulder)
                this.nodes.push(this.bananashoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.nodes.push(this.middlehand)
                this.nodes.push(this.bananahand)
                // this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                // this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                // this.middlecollar = new LineOP(this.middleshoulder, this.body, this.body.color, 8)
                // this.links.push(this.leftcollar)
                // this.links.push(this.rightcollar)
                // this.links.push(this.middlecollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, invertColor(this.body.color), 8)
                this.bananarm = new LineOP(this.bananashoulder, this.bananahand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.links.push(this.middlearm)
                this.links.push(this.bananarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.middlearm = new SpringOP(this.middleshoulder, this.middlehand, this.armlength * 1, 8)
                this.bananarm = new SpringOP(this.bananashoulder, this.bananahand, this.armlength * 1, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.springs.push(this.middlearm)
                this.springs.push(this.bananarm)
                this.gravity = .95
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.middlehand.fired = 0
                this.bananahand.fired = 0
                this.body.fired = 0
                this.screwmomentum = 0
                this.screwtimer = 0
                this.blasting = 0
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {
                let keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]
                }
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    let idsto = this.nodes[t].id
                    if (t == 0) {
                        this.nodes[t] = new ShotN(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)

                    } else {
                        this.nodes[t] = new Circle(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)

                    }
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }

                    this.nodes[t].id = idsto
                }

                for (let t = 0; t < this.shots.length; t++) {
                    let idsto = this.shots[t].id
                    this.shots[t] = new ShotR(this.shots[t].x, this.shots[t].y, this.shots[t].radius, this.shots[t].color, this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                    this.shots[t].id = idsto

                }
                this.id = args["id"]
                this.frame = args['frame']
                this.armlength = 35
                this.shoulderwidth = 20
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }
                this.leftshoulder = this.nodes[1]
                this.rightshoulder = this.nodes[2]
                this.middleshoulder = this.nodes[3]
                this.bananashoulder = this.nodes[4]
                this.righthand = this.nodes[5]
                this.lefthand = this.nodes[6]
                this.middlehand = this.nodes[7]
                this.bananahand = this.nodes[8]
                // this.leftcollar = this.nodes[7]
                // this.rightcollar = this.nodes[7]
                // this.middlecollar = this.nodes[8]
                // this.leftarm = this.nodes[9]
                // this.rightarm = this.nodes[10]
                // this.middlearm = this.nodes[11]
                // this.leftarm = this.nodes[12]
                // this.rightarm = this.nodes[31]
                // this.middlearm = this.nodes[14]

                // this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                // this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                // this.middlecollar = new LineOP(this.middleshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, (this.nodes[0].color), 8)
                this.bananarm = new LineOP(this.bananashoulder, this.bananahand, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                // this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                // this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                // this.middlecollar = new LineOP(this.middleshoulder, this.body, this.body.color, 8)
                // this.links.push(this.leftcollar)
                // this.links.push(this.rightcollar)
                // this.links.push(this.middlecollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, (this.body.color), 8)
                this.bananarm = new LineOP(this.bananashoulder, this.bananahand, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.links.push(this.middlearm)
                this.links.push(this.bananarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.middlearm = new SpringOP(this.middleshoulder, this.middlehand, this.armlength, 8)
                this.bananarm = new SpringOP(this.bananashoulder, this.bananahand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.springs.push(this.middlearm)
                this.springs.push(this.bananarm)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }
            }
            ////////////////////////////////////console.log(this)
        }

        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            ////////////////////////////////////console.log(object.ymom,this.body.ymom)
                            object.ymom = -this.speed * 1 * 2
                            ////////////////////////////////////console.log(object.ymom,this.body.ymom)
                        } else {
                            if (this.lefthand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed // not as high as the axes?
                            }
                            if (this.righthand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 2
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        // this.face = -1
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            let obj = {}
            obj.kill = 1
            obj.striker = this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            let copy = new Banandroid(this.controller)
            copy.id = this.id
            copy.frame = this.frame
            if (this.inactive == 1) {
                copy.inactive = this.inactive
            }
            copy.body.color = this.body.color
            copy.serverID = this.serverID
            copy.striker = this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            //////////////////////////////////console.log(copy)
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

            return copy
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }

            this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth * .3)
            this.leftshoulder.y = this.body.y - (this.shoulderwidth * .7)

            this.middleshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth * .3)
            this.middleshoulder.y = this.body.y - (this.rightshoulder.radius * 2)

            this.bananashoulder.x = this.body.x - (this.body.radius + this.shoulderwidth * .3)
            this.bananashoulder.y = this.body.y - (this.rightshoulder.radius * 2)

            this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth * .3)
            this.rightshoulder.y = this.body.y - (this.shoulderwidth * .7)


            this.leftshoulder.color = this.body.color
            this.rightshoulder.color = this.body.color
            this.bananashoulder.color = this.body.color
            this.middleshoulder.color = this.body.color
            this.lefthand.color = this.body.color
            this.righthand.color = this.body.color
            this.middlehand.color = this.body.color
            this.bananahand.color = this.body.color



            if (this.lefthand.anchored == 0) {
                this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth * .3)))
                this.lefthand.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                this.leftshoulder.xmom *= 0
                this.leftshoulder.ymom *= 0
            }
            if (this.righthand.anchored == 0) {
                this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth * .3)))
                this.righthand.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                this.rightshoulder.xmom *= 0
                this.rightshoulder.ymom *= 0
            }


            this.middlehand.x = this.middlehand.x + (this.middleshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth * .3)))
            this.middlehand.y -= this.middleshoulder.y - (this.body.y - (this.rightshoulder.radius * 2))
            this.middleshoulder.xmom *= 0
            this.middleshoulder.ymom *= 0


            this.bananahand.x = this.bananahand.x - (this.middleshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth * .3)))
            this.bananahand.y -= this.middleshoulder.y - (this.body.y - (this.rightshoulder.radius * 2))
            this.bananashoulder.xmom *= 0
            this.bananashoulder.ymom *= 0


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }




            for (let t = 0; t < this.nodes.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    if (t != k) {
                        if (this.nodes[t] != this.rightshoulder && this.nodes[t] != this.leftshoulder && this.nodes[t] != this.middleshoulder) {
                            if (this.nodes[k] != this.rightshoulder && this.nodes[k] != this.leftshoulder && this.nodes[k] != this.middleshoulder) {
                                let j = 0
                                while (this.nodes[t].doesPerimeterTouch(this.nodes[k])) {
                                    j++
                                    if (j > 100) {
                                        break
                                    }
                                    if (this.nodes[k].anchored != 1) {
                                        if (this.nodes[t].anchored != 1) {
                                            if (this.nodes[t] != this.body) {
                                                this.nodes[t].x -= (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
                                                this.nodes[t].y -= (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
                                            }
                                            if (this.nodes[k] != this.body) {
                                                this.nodes[k].x += (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
                                                this.nodes[k].y += (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
                                            }
                                        } else {
                                            break
                                        }
                                    } else {
                                        break
                                    }
                                }
                            }
                        }
                    }
                }
            }
            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }
        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.middlehand.id = parseFloat(Math.random().toFixed(5))
            this.bananahand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    let line = new LineOP(this.shots[t], boys[k].body)
                    let rline = new LineOP(this.righthand, boys[k].body)
                    let lline = new LineOP(this.lefthand, boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            let armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (this.shield == 1) {
                                            this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                        } else {
                                            this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 200)) + (boys[t].shots[k].xmom * baselaunch)) * 2
                                            this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 200)) + (boys[t].shots[k].ymom * baselaunch)) * 2) - (10 * (this.damage / 200))
                                            this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                            this.breaktimer = 0
                                        }
                                        boys[t].shots[k].marked = 1
                                    }
                                }
                            }


                            if (boys[t].hasOwnProperty('radball')) {
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }

                            let enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }


                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 200)) + (boys[t].bananahand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 200)) + (boys[t].bananahand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 200)) + (boys[t].middlehand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 200)) + (boys[t].middlehand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 200)) + (boys[t].righthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 200)) + (boys[t].righthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14
                                            this.shotIDs.push(boys[t].righthand2.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 200)) + (boys[t].lefthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 200)) + (boys[t].lefthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 200)) + (boys[t].righthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 200)) + (boys[t].righthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 200)) + (boys[t].lefthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 200)) + (boys[t].lefthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)

                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }

                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 200)) + (boys[t].righthand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 200)) + (boys[t].righthand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].lefthand.fired > 14) {
                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)
                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            } else {
                                                this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 200)) + (boys[t].lefthand.xmom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 200)) + (boys[t].lefthand.ymom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)) * 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 200)) + (boys[t].body.xmom * baselaunch) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].body.ymom * (this.damage / 200)) + (boys[t].body.ymom * baselaunch)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        this.fixupshoulder()
                        boys[f].fixupshoulder()
                        this.body.ymom *= .99
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2
                this.lefthand.ymom = -this.speed * 2
                this.righthand.ymom = -this.speed * 2
                this.middlehand.ymom = -this.speed * 2
                this.bananahand.ymom = -this.speed * 2
                this.jumpcount = 100

            }
        }
        doJump(object, speed) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -this.speed * 2
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 2
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {

            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            this.jumpcount--

            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                    this.doJump(this.middlehand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }

            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }

        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                this.fleeing = 1
            }
            if (this.charge > 90) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {

                    for (let g = 0; g < boys[t].shots.length; g++) {
                        let link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        this.wmove = 1
                                        this.screwshot = 1
                                    }
                                }
                            }
                        }
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + Math.max(this.body.radius, boys[t].body.radius))) {
                        this.wmove = 1
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        if (Math.random() < .2) {
                            this.wmove = 1
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }


            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    this.screwshot = 1
                    this.wmove = 1
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    this.screwshot = 1
                }
            }
            this.exgrip = 0
            for (let t = 0; t < boys.length; t++) {
                if (this.amomu <= 0 && this.dmomu <= 0) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].brick.center.y > this.brick.center.y) {
                            if (boys[t].body.x < this.body.x) {
                                this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                this.amomu += 15
                                this.exgrip = 1
                            } else {
                                this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                this.dmomu += 15
                                this.exgrip = 1
                            }
                        }
                    }
                } else {
                    this.exgrip = 1
                }
            }


            if (this.dmom > 0) {
                this.screwshot = 1
                this.dmove = 1
                this.wmove = 1
                this.amove = 0
                this.amom = 0
            } else {

                if (this.dmomu > 0) {
                    this.dmove = 1
                    this.amove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }
            if (this.amom > 0) {
                this.screwshot = 1
                this.dmom = 0
                this.amove = 1
                this.wmove = 1
                this.dmove = 0
            } else {
                if (this.amomu > 0) {
                    this.amove = 1
                    this.dmove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }

            if (this.safe == 0) {
                if (this.under == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                }
                if (this.body.x > (this.brick.center.x)) {
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                } else {
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }

            if (this.trapped == 0) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]
                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        let xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        let runtimeR = xdisR / this.speed
                                        let droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .95)) {//&& this.body.fired < 3.8 * runtimeR) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        let xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        let runtimeL = xdisL / this.speed
                                        let droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .95)) {// && this.body.fired < 3.8 * runtimeL) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }
                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        let xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        let runtimeR = xdisR / this.speed
                        let droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .8)) {// && this.body.fired < 1.8 * runtimeR) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1 //erroor
                                this.wmove = 1
                            }
                        }
                    } else {
                        let xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        let runtimeL = xdisL / this.speed
                        let droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .8)) {// && this.body.fired < 1.8 * runtimeL) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1//error
                                this.wmove = 1
                            }
                        }
                    }
                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }

            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            let link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            if (this.dmomu <= 0 && this.amomu <= 0) {
                                                this.screwshot = 1
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        this.amom = this.dmom
                        this.dmom = 0
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        this.dmom = this.amom
                        this.amom = 0
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }
                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 2
                    } else {
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                    }
                }
                if (this.dmove == 1) {
                    this.face = 1
                    if (object == this.body) {
                        object.x += speed
                        this.righthand.x += speed
                        this.lefthand.x += speed
                        this.middlehand.x += speed
                        this.bananahand.x += speed
                    }
                    if (this.righthand.anchored == 1) {
                        this.degripr()
                        this.jumping = 1
                    }
                }
                // if (keysPressed['s']) {
                //     object.y += speed
                //     this.degrip()
                // }
                if (this.amove == 1) {
                    this.face = -1
                    if (object == this.body) {
                        object.x -= speed
                        this.righthand.x -= speed
                        this.lefthand.x -= speed
                        this.middlehand.x -= speed
                    }
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        this.degripl()
                        this.jumping = 1
                    }
                }


                // if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                // if (controller.gamepad.axesStatus[0] > .1) {
                //     this.face = 1
                // }

                // if (controller.gamepad.axesStatus[1] < -.1) {
                //     this.face = -1
                // }
                // }

            }
            // if (this.dmomu > 0 || this.amomu > 0) {
            //     this.lefthand.anchored = 0
            //     this.righthand.anchored = 0
            // }

            if (this.exgrip == 1) {
                this.righthand.anchored = 0
                this.lefthand.anchored = 0
            }
        }
        AI() {
            this.idify()

            if (this.inactive == 1) {
                return
            }
            this.breaks()

            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.middlehand.fired--
            this.bananahand.fired--
            this.nograv--
            this.lefthand.fired--
            // this.charge--
            // if (this.charge <= 0) {
            //     this.charge = 0
            // }
            this.body.fired -= 1

            this.breaktimer--
            // if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] ||  keysPressed['e']) {

            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.rightshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {


                    for (let g = 0; g < boys[t].shots.length; g++) {
                        let link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.dmomu <= 0 && this.amomu <= 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 50 && this.body.y < boys[t].body.y) {
                        if (this.brick == boys[t].brick) {
                            this.downspike = 1
                        }
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {
                        if (this.brick == boys[t].brick) {
                            this.downspike = 1
                        }
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < 70 && this.body.y > boys[t].body.y) {
                        if (this.dmomu <= 0 && this.amomu <= 0) {
                            this.screwshot = 1
                        }
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == 1) {
                                this.hortsmash = 1
                            }
                        }
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == -1) {
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .09) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                this.leftshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.leftshot = 0
                                    }
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                this.rightshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.rightshot = 0
                                    }
                                }
                            }
                        }
                    }


                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (this.under == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                } else {
                    this.wmove = 1
                }
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        let link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.dmomu <= 0 && this.amomu <= 0) {
                                            this.screwshot = 1
                                            this.wmove = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        this.shieldpower -= .63
                        this.shield = 1
                        this.shielddraw = 1
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }

            if (this.body.fired > 30) {
                this.body.ymom -= this.body.fired * .008
            }
            if (this.screwtimer == 30) {
                this.body.fired = 30
                this.body.ymom = 0
            } else if (this.screwtimer <= 30) {
                if (this.screwtimer > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.body.y < 900) {
                    this.wmove = 0
                    this.screwshot = 0
                }




                if (this.rightshot == 1 || this.leftshot == 1) {


                    if (this.rightshot == 1) {
                        if (this.righthand.fired <= 0) {
                            if (this.face == 1) {
                                if (this.righthand.fired <= 0) {
                                    if (this.righthand.anchored == 0) {
                                        if (this.righthand.anchored == 0) {
                                            this.righthand.xmom += 1
                                            this.charge += 3.5
                                            this.shot = new Shot(this.righthand.x, this.righthand.y, this.charge * .54, "#00FF00", this.speed * 2, 0)
                                            if (this.charge > 80) {
                                                this.shot.color = "#FFFF00"
                                            }
                                            // if(this.wasfalse[1] == 0){
                                            if (this.charge >= 100) {
                                                this.charge = 0
                                                this.righthand.xmom = 10
                                                this.righthand.ymom = 0
                                                this.shots.push(this.shot)
                                                if (this.grounded != 1) {
                                                    this.body.xmom -= 4
                                                }
                                            }
                                        }
                                    }
                                }
                                this.shot2 = new Shot(this.middlehand.x, this.middlehand.y, this.charge2 * .40, "#00FF00", this.speed * 3, 0)
                                if (this.charge2 > 95) {
                                    this.shot2.color = "#FFFF00"
                                }
                                this.middlehand.xmom -= 1
                                this.middlehand.ymom -= 1
                                this.charge2 += .8
                                if (this.charge2 >= 100) {
                                    this.charge2 = 0
                                    this.middlehand.xmom = -10
                                    this.middlehand.ymom = 0
                                    this.shots.push(this.shot2)
                                    if (this.grounded != 1) {
                                        this.body.xmom -= 3
                                    }
                                }
                                this.shotdraw = 1
                            }
                        }
                    }
                    if (this.leftshot == 1) {
                        if (this.lefthand.fired <= 0) {
                            if (this.face == -1) {
                                if (this.lefthand.anchored == 0) {
                                    this.shot = new Shot(this.lefthand.x, this.lefthand.y, this.charge * .54, "#00FF00", -this.speed * 2, 0)
                                    if (this.charge > 80) {
                                        this.shot.color = "#FFFF00"
                                    }
                                    if (this.charge2 > 95) {
                                        this.shot2.color = "#FFFF00"
                                    }
                                    this.charge += 3.5
                                    this.lefthand.xmom -= 1
                                    if (this.charge >= 100) {
                                        this.charge = 0
                                        this.lefthand.xmom = -10
                                        this.lefthand.ymom = 0
                                        this.shots.push(this.shot)
                                        if (this.grounded != 1) {
                                            this.body.xmom += 4
                                        }
                                    }
                                }

                                this.shot2 = new Shot(this.bananahand.x, this.bananahand.y, this.charge2 * .40, "#00FF00", -this.speed * 3, 0)
                                if (this.charge2 >= 100) {
                                    this.charge2 = 0
                                    this.bananahand.xmom = -10
                                    this.bananahand.ymom = 0
                                    this.shots.push(this.shot2)
                                    if (this.grounded != 1) {
                                        this.body.xmom += 3
                                    }
                                }
                                this.bananahand.xmom -= 1
                                this.bananahand.ymom -= 1
                                this.charge2 += .8
                                this.shotdraw = 1
                            }
                        }
                    }
                }
                if (this.body.fired > 30) {
                    this.body.ymom -= this.body.fired * .008
                }
                if (this.screwtimer == 30) {
                    this.body.fired = 30
                    this.body.ymom = 0
                } else if (this.screwtimer <= 30) {
                    if (this.screwtimer > 0) {
                        this.body.ymom = 0
                    }
                }

                if (this.hortsmash == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.fired = 19
                            this.righthand.ymom = this.punchspeed * -20
                            this.righthand.xmom = this.punchspeed * -4
                            this.idify()
                        }
                    }
                    if (this.middlehand.fired <= 0) {
                        this.middleshoulder.xmom = 0
                        this.middleshoulder.ymom = 0
                        this.middlehand.fired = 19
                        this.middlehand.ymom = this.punchspeed * -20
                        this.idify()
                    }
                    if (this.bananahand.fired <= 0) {
                        this.bananashoulder.xmom = 0
                        this.bananashoulder.ymom = 0
                        this.bananahand.fired = 19
                        this.bananahand.ymom = this.punchspeed * -20
                        this.idify()
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = this.punchspeed * -20
                            this.lefthand.xmom = this.punchspeed * 4
                            this.lefthand.fired = 19
                            this.idify()
                        }
                    }
                }


                if (this.screwshot == 1) {
                    if (this.nograv <= -70) {
                        this.nograv = 70
                        if (this.body.ymom > 0) {
                            this.body.ymom = 0
                        }
                    }
                }
                if (this.downspike == 1) {

                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.ymom = this.punchspeed * 21 + (this.body.ymom * 2)
                            this.righthand.xmom = -this.punchspeed * -5.1
                            this.righthand.fired = 19
                            this.body.ymom -= this.speed * .1
                            this.idify()
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = this.punchspeed * 21 + (this.body.ymom * 2)
                            this.lefthand.xmom = this.punchspeed * -5.1
                            this.lefthand.fired = 19
                            this.body.ymom -= this.speed * .1
                            this.idify()
                        }
                    }
                    if (this.middlehand.fired <= 0) {
                        this.middleshoulder.xmom = 0
                        this.middleshoulder.ymom = 0
                        this.middlehand.ymom = this.punchspeed * 4

                        this.middlehand.xmom = this.punchspeed * 18
                        this.middlehand.fired = 19
                        this.body.ymom -= this.speed * .1
                        this.idify()
                    }
                    if (this.bananahand.fired <= 0) {
                        this.bananashoulder.xmom = 0
                        this.bananashoulder.ymom = 0
                        this.bananahand.ymom = this.punchspeed * 4
                        this.bananahand.xmom = -this.punchspeed * 18
                        this.bananahand.fired = 19
                        this.body.ymom -= this.speed * .1
                        this.idify()
                    }


                }


                // if (this.rightshot == 1) {
                //     //check
                //     if (this.righthand.fired <= 0) {
                //         if (this.face == 1) {
                //             if (this.righthand.anchored == 0) {
                //                 this.righthand.ymom = this.punchspeed * 8
                //                 this.righthand.xmom = this.punchspeed * 19.1
                //                 this.righthand.fired = 19
                //                 this.body.xmom -= 5
                //             }
                //         }
                //     }
                // }
                // if (this.leftshot == 1) {
                //     //check
                //     if (this.lefthand.fired <= 0) {
                //         if (this.face == -1) {
                //             if (this.lefthand.anchored == 0) {
                //                 this.lefthand.ymom = this.punchspeed * 8
                //                 this.lefthand.xmom = this.punchspeed * -19.1
                //                 this.lefthand.fired = 19
                //                 this.body.xmom += 5
                //             }
                //         }
                //     }
                // }

            }

        }
        fightcontrol() {

            if (this.inactive == 1) {
                return
            }
            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()



            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.middlehand.fired--
            this.bananahand.fired--
            this.nograv--
            this.charge--
            if (this.charge <= 0) {
                this.charge = 0
            }
            this.body.fired -= 1
            this.lefthand.fired--


            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            this.breaktimer--
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }

            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {


                    if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {


                        if (this.righthand.fired <= 0) {
                            if (this.face == 1) {
                                if (this.righthand.fired <= 0) {
                                    if (this.righthand.anchored == 0) {
                                        if (this.righthand.anchored == 0) {
                                            this.righthand.xmom += 1
                                            this.charge += 3.5
                                            this.shot = new Shot(this.righthand.x, this.righthand.y, this.charge * .54, "#00FF00", this.speed * 2, 0)
                                            if (this.charge > 80) {
                                                this.shot.color = "#FFFF00"
                                            }
                                            // if(this.wasfalse[1] == 0){
                                            if (this.charge >= 100) {
                                                this.charge = 0
                                                this.righthand.xmom = 10
                                                this.righthand.ymom = 0
                                                this.shots.push(this.shot)
                                                if (this.grounded != 1) {
                                                    this.body.xmom -= 4
                                                }
                                            }
                                        }
                                    }
                                }
                                this.shot2 = new Shot(this.middlehand.x, this.middlehand.y, this.charge2 * .40, "#00FF00", this.speed * 3, 0)
                                if (this.charge2 > 95) {
                                    this.shot2.color = "#FFFF00"
                                }
                                this.middlehand.xmom -= 1
                                this.middlehand.ymom -= 1
                                this.charge2 += .8
                                if (this.charge2 >= 100) {
                                    this.charge2 = 0
                                    this.middlehand.xmom = -10
                                    this.middlehand.ymom = 0
                                    this.shots.push(this.shot2)
                                    if (this.grounded != 1) {
                                        this.body.xmom -= 3
                                    }
                                }
                                this.shotdraw = 1
                            }
                        }

                        if (this.lefthand.fired <= 0) {
                            if (this.face == -1) {
                                if (this.lefthand.anchored == 0) {
                                    this.shot = new Shot(this.lefthand.x, this.lefthand.y, this.charge * .54, "#00FF00", -this.speed * 2, 0)
                                    if (this.charge > 80) {
                                        this.shot.color = "#FFFF00"
                                    }
                                    if (this.charge2 > 95) {
                                        this.shot2.color = "#FFFF00"
                                    }
                                    this.charge += 3.5
                                    this.lefthand.xmom -= 1
                                    if (this.charge >= 100) {
                                        this.charge = 0
                                        this.lefthand.xmom = -10
                                        this.lefthand.ymom = 0
                                        this.shots.push(this.shot)
                                        if (this.grounded != 1) {
                                            this.body.xmom += 4
                                        }
                                    }
                                }

                                this.shot2 = new Shot(this.bananahand.x, this.bananahand.y, this.charge2 * .40, "#00FF00", -this.speed * 3, 0)
                                if (this.charge2 >= 100) {
                                    this.charge2 = 0
                                    this.bananahand.xmom = -10
                                    this.bananahand.ymom = 0
                                    this.shots.push(this.shot2)
                                    if (this.grounded != 1) {
                                        this.body.xmom += 3
                                    }
                                }
                                this.bananahand.xmom -= 1
                                this.bananahand.ymom -= 1
                                this.charge2 += .8
                                this.shotdraw = 1
                            }
                        }
                    }

                    if (this.body.fired > 30) {
                        this.body.ymom -= this.body.fired * .008
                    }
                    if (this.screwtimer == 30) {
                        this.body.fired = 30
                        this.body.ymom = 0
                    } else if (this.screwtimer <= 30) {
                        if (this.screwtimer > 0) {
                            this.body.ymom = 0
                        }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.fired = 19
                                this.righthand.ymom = this.punchspeed * -20
                                this.righthand.xmom = this.punchspeed * -4
                                this.idify()
                            }
                        }
                        if (this.middlehand.fired <= 0) {
                            this.middleshoulder.xmom = 0
                            this.middleshoulder.ymom = 0
                            this.middlehand.fired = 19
                            this.middlehand.ymom = this.punchspeed * -20
                            this.idify()
                        }
                        if (this.bananahand.fired <= 0) {
                            this.bananashoulder.xmom = 0
                            this.bananashoulder.ymom = 0
                            this.bananahand.fired = 19
                            this.bananahand.ymom = this.punchspeed * -20
                            this.idify()
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = this.punchspeed * -20
                                this.lefthand.xmom = this.punchspeed * 4
                                this.lefthand.fired = 19
                                this.idify()
                            }
                        }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {

                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.ymom = this.punchspeed * 21 + (this.body.ymom * 2)
                                this.righthand.xmom = -this.punchspeed * -5.1
                                this.righthand.fired = 19
                                this.body.ymom -= this.speed * .1
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = this.punchspeed * 21 + (this.body.ymom * 2)
                                this.lefthand.xmom = this.punchspeed * -5.1
                                this.lefthand.fired = 19
                                this.body.ymom -= this.speed * .1
                                this.idify()
                            }
                        }
                        if (this.middlehand.fired <= 0) {
                            this.middleshoulder.xmom = 0
                            this.middleshoulder.ymom = 0
                            this.middlehand.ymom = this.punchspeed * 4

                            this.middlehand.xmom = this.punchspeed * 18
                            this.middlehand.fired = 19
                            this.body.ymom -= this.speed * .1
                            this.idify()
                        }
                        if (this.bananahand.fired <= 0) {
                            this.bananashoulder.xmom = 0
                            this.bananashoulder.ymom = 0
                            this.bananahand.ymom = this.punchspeed * 4
                            this.bananahand.xmom = -this.punchspeed * 18
                            this.bananahand.fired = 19
                            this.body.ymom -= this.speed * .1
                            this.idify()
                        }


                    }

                }
            }

            if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
                if (this.nograv <= -70) {
                    this.nograv = 70
                    if (this.body.ymom > 0) {
                        this.body.ymom = 0
                    }
                }
            }
        }
        degripl() {

            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        degripr() {

            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        collideStage() {

            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {

            if (this.inactive == 1) {
                return
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.body.anchored = 0
            this.middlehand.anchored = 0
            this.bananahand.anchored = 0
            this.blasting--
            if (this.grounded == 1) {
                if (this.screwtimer > 5) {
                    this.screwangle = 0
                    this.screwtimer = 0
                    // this.body.fired = 5
                }
            }
            this.grounded = 0
            this.frame++

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.shots.length; t++) {
                    if (typeof this.shots[t].gravity == "number") {
                        if (this.shots[t].ymom > -(vsmashlimit / 1.15)) {
                            this.shots[t].ymom += this.shots[t].gravity / 1.2
                            this.shots[t].radius -= .5
                            if (this.shots[t].radius < 10) {
                                this.shots[t].radius = 10
                            }
                        } else {
                            this.shots[t].marked = 1
                        }
                    }
                    if (typeof this.shots[t].countdown == "number") {
                        this.shots[t].countdown--
                        this.shots[t].gravity = Math.cos(this.shots[t].countdown * (Math.PI / 4)) * 20
                        if (this.shots[t].countdown <= 0) {
                            this.shots[t].marked = 1
                        }
                    }
                    this.shots[t].move()
                    if (this.shots[t].marked <= 0) {
                        this.shots[t].draw()
                    }

                    this.shots[t].life--
                    if (this.shots[t].life <= 0) {
                        this.shots[t].marked = 1
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].draw()
                        }
                    }
                }
            }

            for (let j = 0; j < 10; j++) {
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked == 1) {
                        this.shots.splice(t, 1)
                    } else {
                        this.shots[t].marked--
                    }
                }
            }
            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.middlearm = new LineOP(this.middleshoulder, this.middlehand, invertColor(this.body.color), 8)
            this.bananarm = new LineOP(this.bananashoulder, this.bananahand, invertColor(this.body.color), 8)
            this.collideStage()
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].color = invertColor(this.body.color)
                this.links[t].draw()
            }
            for (let t = 0; t < this.nodes.length; t++) {
                this.nodes[t].draw()
                if (this.nodes[t] == this.body) {
                    let link = new Line(this.body.x, this.body.y, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y + Math.sin(this.screwangle), invertColor(this.body.color), this.body.radius * .2)
                    // canvas_context.lineWidth = this.strokeWidth
                    // canvas_context.strokeStyle = "#000000"
                    // canvas_context.beginPath();
                    // canvas_context.arc(((link.x1 + link.x2 + this.body.x) * (1 / 3)) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .35, (this.screwangle * this.face) + (this.face / 2), (Math.PI * 1) + (this.screwangle * this.face) + (this.face / 2), true)
                    // canvas_context.fillStyle = "#00FF00"
                    // canvas_context.fill()
                    // canvas_context.stroke();
                    // canvas_context.lineWidth = this.strokeWidth
                    // canvas_context.strokeStyle = "#000000"
                    // canvas_context.beginPath();
                    // canvas_context.arc(((link.x1 + link.x2 + this.body.x) * (1 / 3)) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .35, (this.screwangle * this.face) + (this.face / 2), (Math.PI * 1) + (this.screwangle * this.face) + (this.face / 2), false)
                    // canvas_context.fillStyle = "#00FF00"
                    // canvas_context.fill()
                    // canvas_context.stroke();


                    canvas_context.fillStyle = invertColorx(this.body.color)
                    let x = ((link.x1 + link.x2 + this.body.x) * (1 / 3)) - ((this.body.radius * .6) * (this.face))
                    if (this.face == 1) {
                        x += this.body.radius * .7
                    }
                    if (this.face == -1) {
                        x -= this.body.radius * .7
                    }
                    canvas_context.fillRect(x - 11.5, (link.y1 - this.body.radius * .1) - 11.5, 23, 23)
                }
            }

            // if (this.controller == 0) {

            // if (this.screwangle == 0) {
            //     link.draw()
            // }
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.middlehand)).hypotenuse(), (new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.middlehand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
            canvas_context.font = "42px arial"
            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 200)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 75)
            canvas_context.fillStyle = "white"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 110)
            }
            if (this.shotdraw == 1) {
                if (this.face == 1) {
                    this.shot = new Shot(this.righthand.x, this.righthand.y, this.charge * .54, "#00FF00", this.speed * 2, 0)
                } else {
                    this.shot = new Shot(this.lefthand.x, this.lefthand.y, this.charge * .54, "#00FF00", this.speed * 2, 0)
                }
                if (this.face == 1) {
                    this.shot2 = new Shot(this.middlehand.x, this.middlehand.y, this.charge2 * .40, "#00FF00", this.speed * 2, 0)
                } else {
                    this.shot2 = new Shot(this.bananahand.x, this.bananahand.y, this.charge2 * .40, "#00FF00", this.speed * 2, 0)
                }

                if (this.charge > 80) {
                    this.shot.color = "#FFFF00"
                }

                if (this.charge2 > 95) {
                    this.shot2.color = "#FFFF00"
                }

                this.shot.draw()
                this.shot2.draw()
            }
        }
        operate() {

            if (this.inactive == 1) {
                return
            }
            if (this.righthand.anchored == 1) {
                if (this.body.x > this.righthand.x) {
                    this.righthand.anchored = -10
                }
            }
            if (this.lefthand.anchored == 1) {
                if (this.body.x < this.lefthand.x) {
                    this.lefthand.anchored = -10
                }
            }

            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {
            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }

                    this.playerMove(this.middlehand, this.speed, this.gamepad)
                    this.playerMove(this.bananahand, this.speed, this.gamepad)
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.AImove(this.middlehand, this.speed, this.gamepad)
                    this.AImove(this.bananahand, this.speed, this.gamepad)
                    this.doubleJump()
                }
            }
            // }
            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.leftshoulder.ymom * .99
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.rightshoulder.ymom * .99
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     // this.body.sxmom *= 0
                    //     this.body.xmom *= .5
                    // }
                }
                this.body.ymom += this.gravity
            } else {
                if (this.pounding == 1) {
                    this.pounding = 0
                    let shot1 = new ShotC(this.body.x, this.body.y + this.body.radius, 21, "#00FF00", this.speed * 2, 0)
                    shot1.life = 50
                    let shot2 = new ShotC(this.body.x, this.body.y + this.body.radius, 21, "#00FF00", - this.speed * 2, 0)
                    shot2.life = 50
                    this.shots.push(shot1)
                    this.shots.push(shot2)
                }

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            }
            if (this.nograv <= 0) {
                this.righthand.ymom += this.gravity
                this.lefthand.ymom += this.gravity
                this.middlehand.ymom += this.gravity
                this.bananahand.ymom += this.gravity
            } else {
                //////////////////////////////////console.log("hum")
                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            this.body.xmom *= .99
            this.body.ymom *= .99

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].frictiveMove(this)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].smove(this)
                }
            }
            this.lefthand.xmom += (this.lefthand.x - this.body.x) / 40
            this.righthand.xmom += (this.righthand.x - this.body.x) / 40
            this.middlehand.ymom += (this.middlehand.y - this.body.y) / 18
            this.middlehand.xmom += (this.middlehand.x - this.body.x) / 20
            this.bananahand.ymom += (this.bananahand.y - this.body.y) / 18
            this.bananahand.xmom += (this.bananahand.x - this.body.x) / 20
            this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40
            // this.middleshoulder.ymom -= (this.middleshoulder.y - this.body.y) / 40
            // this.middleshoulder.xmom += (this.middleshoulder.x - this.body.x) / 40
            this.fixupshoulder()

            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            if (boys.indexOf(this) <= humanPlayers) {

                // this.AI()
                this.fightcontrol()
            } else {
                this.AI()
            }
            // }
            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    let spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }

        }
    }


    class Gwompei {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                this.shotclock = 0
                this.armAngle =0
                this.armspin = .05
                this.ping = 0
                this.nograv = 0
                this.pounding = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 8
                this.frame = 0
                this.serverID = serverID
                this.shotdraw = 0
                this.id = controller
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 24
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shot = new Brick(-1, -1, 1, 1)
                this.striker = 10000
                this.name = "Gwomp"
                this.gwomp = 1
                this.blasting = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.storeshield = 0
                this.wasfalse = []
                for (let t = 0; t < 100; t++) {
                    this.wasfalse.push(1)
                }
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = 0
                this.screwangle = 0
                this.charge = 0
                this.charge2 = 0
                this.shots = []

                this.color = getRandomColor()
                if (controller == 0) {
                    this.color = "#ffAA00"
                }
                if (controller == 1) {
                    this.color = "#ff0000"
                }
                this.body = new ShotGW(400 + (Math.random() * 2560), 500, 48, this.color)
                this.controller = controller
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.armlength = 18 //40
                this.shoulderwidth = 20
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 15.95 //14
                this.punchspeed = 5.1 // 6.5
                this.grounded = 1
                this.jumping = 1


                this.nodes.push(this.body)
                this.leftshoulder = new Shot(this.body.x - (this.body.radius + this.shoulderwidth), 350, 5.6, "#FF0000", 0, 0, .999)
                this.rightshoulder = new Shot(this.body.x + (this.body.radius + this.shoulderwidth), 350, 5.6, "#FF0000", 0, 0, .999)
                this.middleshoulder = new Shot(this.body.x + (this.body.radius + this.shoulderwidth), 350, 5.6, "#FF0000", 0, 0, .999)
                this.bananashoulder = new Shot(this.body.x - (this.body.radius + this.shoulderwidth), 350, 5.6, "#FF0000", 0, 0, .999)
                this.middleshoulder2 = new Shot(this.body.x + (this.body.radius + this.shoulderwidth), 350,5.6, "#FF0000", 0, 0, .999)
                this.bananashoulder2 = new Shot(this.body.x - (this.body.radius + this.shoulderwidth), 350, 5.6, "#FF0000", 0, 0, .999)
                this.lefthand = new Shot(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 19.5, "#FF0000", 0, 0, .85)
                this.righthand = new Shot(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 19.5, "#FF0000", 0, 0, .85)
                this.middlehand = new Shot(this.middleshoulder.x, (this.middleshoulder.y + this.armlength), 19.5, "#FF0000", 0, 0, .85)
                this.bananahand = new Shot(this.bananashoulder.x, (this.bananashoulder.y + this.armlength), 19.5, "#FF0000", 0, 0, .85)
                this.middlehand2 = new Shot(this.middleshoulder2.x, (this.middleshoulder2.y + this.armlength), 19.5, "#FF0000", 0, 0, .85)
                this.bananahand2 = new Shot(this.bananashoulder2.x, (this.bananashoulder2.y + this.armlength), 19.5, "#FF0000", 0, 0, .85)
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.middleshoulder)
                this.nodes.push(this.bananashoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.nodes.push(this.middlehand)
                this.nodes.push(this.bananahand)
                this.nodes.push(this.middlehand2)
                this.nodes.push(this.bananahand2)
                this.nodes.push(this.middleshoulder2)
                this.nodes.push(this.bananashoulder2)
                // this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                // this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                // this.middlecollar = new LineOP(this.middleshoulder, this.body, this.body.color, 8)
                // this.links.push(this.leftcollar)
                // this.links.push(this.rightcollar)
                // this.links.push(this.middlecollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, invertColor(this.body.color), 8)
                this.bananarm = new LineOP(this.bananashoulder, this.bananahand, invertColor(this.body.color), 8)
                this.middlearm2 = new LineOP(this.middleshoulder2, this.middlehand2, invertColor(this.body.color), 8)
                this.bananarm2 = new LineOP(this.bananashoulder2, this.bananahand2, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.links.push(this.middlearm)
                this.links.push(this.bananarm)
                this.links.push(this.middlearm2)
                this.links.push(this.bananarm2)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.middlearm = new SpringOP(this.middleshoulder, this.middlehand, this.armlength * 1, 8)
                this.bananarm = new SpringOP(this.bananashoulder, this.bananahand, this.armlength * 1, 8)
                this.middlearm2 = new SpringOP(this.middleshoulder2, this.middlehand2, this.armlength * 1, 8)
                this.bananarm2 = new SpringOP(this.bananashoulder2, this.bananahand2, this.armlength * 1, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.springs.push(this.middlearm)
                this.springs.push(this.bananarm)
                this.springs.push(this.middlearm2)
                this.springs.push(this.bananarm2)
                this.gravity = 1.3456
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.middlehand.fired = 0
                this.bananahand.fired = 0
                this.middlehand2.fired = 0
                this.bananahand2.fired = 0
                this.body.fired = 0
                this.screwmomentum = 0
                this.screwtimer = 0
                this.blasting = 0
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {
                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]
                }
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    if (t == 0) {
                        this.nodes[t] = new ShotGW(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, colors[this.controller], this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)
                        this.nodes[t].angle += this.armAngle
                    } else {
                        this.nodes[t] = new Shot(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, colors[this.controller], this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)
                        this.nodes[t].angle += this.armAngle
                    }
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }

                    this.nodes[t].id = idsto
                }

                this.id = args["id"]
                this.frame = args['frame']
                this.armlength = 32
                this.shoulderwidth = 20
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                        this.shots[t] = new ShotGW(this.shots[t].x, this.shots[t].y, this.shots[t].radius,  colors[this.controller], this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                        this.shots[t].angle+=this.armAngle
                        this.shots[t].id = idsto
                }
                this.leftshoulder = this.nodes[1]
                this.rightshoulder = this.nodes[2]
                this.middleshoulder = this.nodes[3]
                this.bananashoulder = this.nodes[4]
                this.righthand = this.nodes[5]
                this.lefthand = this.nodes[6]
                this.middlehand = this.nodes[7]
                this.bananahand = this.nodes[8]
                this.middlehand2 = this.nodes[9]
                this.bananahand2 = this.nodes[10]
                this.middleshoulder2 = this.nodes[11]
                this.bananashoulder2 = this.nodes[12]
                this.middlehand2.color = colors[this.controller]
                this.bananahand2.color = colors[this.controller]
                this.middleshoulder2.color = colors[this.controller]
                this.bananashoulder2.color = colors[this.controller]
                // this.leftcollar = this.nodes[7]
                // this.rightcollar = this.nodes[7]
                // this.middlecollar = this.nodes[8]
                // this.leftarm = this.nodes[9]
                // this.rightarm = this.nodes[10]
                // this.middlearm = this.nodes[11]
                // this.leftarm = this.nodes[12]
                // this.rightarm = this.nodes[31]
                // this.middlearm = this.nodes[14]

                // this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                // this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                // this.middlecollar = new LineOP(this.middleshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, (this.nodes[0].color), 8)
                this.bananarm = new LineOP(this.bananashoulder, this.bananahand, (this.nodes[0].color), 8)
                this.middlearm2 = new LineOP(this.middleshoulder2, this.middlehand2, (this.nodes[0].color), 8)
                this.bananarm2 = new LineOP(this.bananashoulder2, this.bananahand2, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                // this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                // this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                // this.middlecollar = new LineOP(this.middleshoulder, this.body, this.body.color, 8)
                // this.links.push(this.leftcollar)
                // this.links.push(this.rightcollar)
                // this.links.push(this.middlecollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, (this.body.color), 8)
                this.bananarm = new LineOP(this.bananashoulder, this.bananahand, (this.body.color), 8)
                this.middlearm2 = new LineOP(this.middleshoulder2, this.middlehand2, (this.body.color), 8)
                this.bananarm2 = new LineOP(this.bananashoulder2, this.bananahand2, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.links.push(this.middlearm)
                this.links.push(this.bananarm)
                this.links.push(this.middlearm2)
                this.links.push(this.bananarm2)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.middlearm = new SpringOP(this.middleshoulder, this.middlehand, this.armlength, 8)
                this.bananarm = new SpringOP(this.bananashoulder, this.bananahand, this.armlength, 8)
                this.middlearm2 = new SpringOP(this.middleshoulder2, this.middlehand2, this.armlength, 8)
                this.bananarm2 = new SpringOP(this.bananashoulder2, this.bananahand2, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.springs.push(this.middlearm)
                this.springs.push(this.bananarm)
                this.springs.push(this.middlearm2)
                this.springs.push(this.bananarm2)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }

                this.gwomp = 1
            }
            ////////////////////////////////////console.log(this)
        }

        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                        this.bananahand.anchored = 0
                        this.middlehand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                        this.bananahand.anchored = 0
                        this.middlehand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            ////////////////////////////////////console.log(object.ymom,this.body.ymom)
                            object.ymom = -this.speed * 1 * 2
                            ////////////////////////////////////console.log(object.ymom,this.body.ymom)
                        } else {
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed // not as high as the axes?
                            }else if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed*.8
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed*.8
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 2
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)*.8
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        // this.face = -1
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            const copy = new Gwompei(this.controller)
            copy.id = this.id
            copy.frame = this.frame
            if (this.inactive == 1) {
                copy.inactive = this.inactive
            }
            copy.body.color = this.body.color
            copy.serverID = this.serverID
            copy.striker = this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            //////////////////////////////////console.log(copy)
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

            return copy
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }


            this.leftshoulder.x = (this.body.x + ((this.body.radius+this.leftshoulder.radius)*Math.cos(this.armAngle+((Math.PI*.6666)*.5))))
            this.leftshoulder.y = (this.body.y + ((this.body.radius+this.leftshoulder.radius)*Math.sin(this.armAngle+((Math.PI*.6666)*.5))))
            this.middleshoulder.x = (this.body.x + ((this.body.radius+this.middleshoulder.radius)*Math.cos(this.armAngle)))
            this.middleshoulder.y = (this.body.y + ((this.body.radius+this.middleshoulder.radius)*Math.sin(this.armAngle)))
            this.bananashoulder.x = (this.body.x + ((this.body.radius+this.bananashoulder.radius)*Math.cos(this.armAngle+((Math.PI*.6666)))))
            this.bananashoulder.y = (this.body.y + ((this.body.radius+this.bananashoulder.radius)*Math.sin(this.armAngle+((Math.PI*.6666)))))
            this.rightshoulder.x = (this.body.x + ((this.body.radius+this.rightshoulder.radius)*Math.cos(this.armAngle+((Math.PI*.6666)*1.5))))
            this.rightshoulder.y = (this.body.y + ((this.body.radius+this.rightshoulder.radius)*Math.sin(this.armAngle+((Math.PI*.6666)*1.5))))


            this.middleshoulder2.x = (this.body.x + ((this.body.radius+this.middleshoulder2.radius)*Math.cos(this.armAngle+(2*(Math.PI*.6666)))))
            this.middleshoulder2.y = (this.body.y + ((this.body.radius+this.middleshoulder2.radius)*Math.sin(this.armAngle+(2*(Math.PI*.6666)))))
            this.bananashoulder2.x = (this.body.x + ((this.body.radius+this.bananashoulder2.radius)*Math.cos(this.armAngle+(2.5*(Math.PI*.6666)))))
            this.bananashoulder2.y = (this.body.y + ((this.body.radius+this.bananashoulder2.radius)*Math.sin(this.armAngle+(2.5*(Math.PI*.6666)))))

            this.leftshoulder.color = this.body.color
            this.rightshoulder.color = this.body.color
            this.bananashoulder.color = this.body.color
            this.middleshoulder.color = this.body.color
            this.bananashoulder2.color = this.body.color
            this.middleshoulder2.color = this.body.color
            this.lefthand.color = this.body.color
            this.righthand.color = this.body.color
            this.middlehand.color = this.body.color
            this.bananahand.color = this.body.color
            this.middlehand2.color = this.body.color
            this.bananahand2.color = this.body.color



            if (this.lefthand.anchored == 0) {
                this.lefthand.x = this.lefthand.x + (this.leftshoulder.x -(this.body.x + ((this.body.radius+this.leftshoulder.radius)*Math.cos(this.armAngle+((Math.PI*.6666)*.5)))))
                this.lefthand.y -= this.leftshoulder.y - (this.body.y + ((this.body.radius+this.leftshoulder.radius)*Math.sin(this.armAngle+((Math.PI*.6666)*.5))))
                this.leftshoulder.xmom *= 0
                this.leftshoulder.ymom *= 0
            }
            if (this.righthand.anchored == 0) {
                this.righthand.x = this.righthand.x + (this.rightshoulder.x -  (this.body.x + ((this.body.radius+this.rightshoulder.radius)*Math.cos(this.armAngle+((Math.PI*.6666)*1.5)))))
                this.righthand.y -= this.rightshoulder.y -  (this.body.y + ((this.body.radius+this.rightshoulder.radius)*Math.sin(this.armAngle+((Math.PI*.6666)*1.5))))
                this.rightshoulder.xmom *= 0
                this.rightshoulder.ymom *= 0
            }


                this.middlehand.x = this.middlehand.x + (this.middleshoulder.x -  (this.body.x + ((this.body.radius+this.middleshoulder.radius)*Math.cos(this.armAngle+((Math.PI*.6666)*.0)))))
                this.middlehand.y -= this.middleshoulder.y -  (this.body.y + ((this.body.radius+this.middleshoulder.radius)*Math.sin(this.armAngle+((Math.PI*.6666)*.0))))
                if (this.middlehand.anchored == 0) {
                    this.middleshoulder.xmom *= 0
                    this.middleshoulder.ymom *= 0
                }

                this.bananahand.x = this.bananahand.x - (this.bananashoulder.x - (this.body.x + ((this.body.radius+this.bananashoulder.radius)*Math.cos(this.armAngle+((Math.PI*.6666))))))
                this.bananahand.y -= this.bananashoulder.y - (this.body.y + ((this.body.radius+this.bananashoulder.radius)*Math.sin(this.armAngle+((Math.PI*.6666)))))

                if(this.bananahand.anchored == 0){
                    this.bananashoulder.xmom *= 0
                this.bananashoulder.ymom *= 0
                }
                if(this.bananahand2.anchored == 0){
                    this.bananashoulder2.xmom *= 0
                this.bananashoulder2.ymom *= 0
                }
                if (this.middlehand2.anchored == 0) {
                    this.middleshoulder2.xmom *= 0
                    this.middleshoulder2.ymom *= 0
                }






            this.middlehand2.x = this.middlehand2.x + (this.middleshoulder2.x -  (this.body.x + ((this.body.radius+this.middleshoulder2.radius)*Math.cos(this.armAngle+((Math.PI*.6666)*2)))))
            this.middlehand2.y -= this.middleshoulder2.y -  (this.body.y + ((this.body.radius+this.middleshoulder2.radius)*Math.sin(this.armAngle+((Math.PI*.6666)*2))))
            if (this.middlehand2.anchored == 0) {
                this.middleshoulder2.xmom *= 0
                this.middleshoulder2.ymom *= 0
            }

            this.bananahand2.x = this.bananahand2.x - (this.bananashoulder2.x - (this.body.x + ((this.body.radius+this.bananashoulder2.radius)*Math.cos(this.armAngle+(2.5*(Math.PI*.6666))))))
            this.bananahand2.y -= this.bananashoulder2.y - (this.body.y + ((this.body.radius+this.bananashoulder2.radius)*Math.sin(this.armAngle+(2.5*(Math.PI*.6666)))))
         
            if(this.bananahand2.anchored == 0){
                this.bananashoulder2.xmom *= 0
            this.bananashoulder2.ymom *= 0
            }


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }




            // for (let t = 0; t < this.nodes.length; t++) {
            //     for (let k = 0; k < this.nodes.length; k++) {
            //         if (t != k) {
            //             if (this.nodes[t] != this.rightshoulder && this.nodes[t] != this.leftshoulder && this.nodes[t] != this.middleshoulder) {
            //                 if (this.nodes[k] != this.rightshoulder && this.nodes[k] != this.leftshoulder && this.nodes[k] != this.middleshoulder) {
            //                     let j = 0
            //                     while (this.nodes[t].doesPerimeterTouch(this.nodes[k])) {
            //                         j++
            //                         if (j > 100) {
            //                             break
            //                         }
            //                         if (this.nodes[k].anchored != 1) {
            //                             if (this.nodes[t].anchored != 1) {
            //                                 if (this.nodes[t] != this.body) {
            //                                     this.nodes[t].x -= (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
            //                                     this.nodes[t].y -= (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
            //                                 }
            //                                 if (this.nodes[k] != this.body) {
            //                                     this.nodes[k].x += (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
            //                                     this.nodes[k].y += (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
            //                                 }
            //                             } else {
            //                                 break
            //                             }
            //                         } else {
            //                             break
            //                         }
            //                     }
            //                 }
            //             }
            //         }
            //     }
            // }
            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }
        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.middlehand.id = parseFloat(Math.random().toFixed(5))
            this.bananahand.id = parseFloat(Math.random().toFixed(5))
            this.middlehand2.id = parseFloat(Math.random().toFixed(5))
            this.bananahand2.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    const rline = new LineOP(this.righthand, boys[k].body)
                    const lline = new LineOP(this.lefthand, boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (this.shield == 1) {
                                            this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                        } else {
                                            this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 200)) + (boys[t].shots[k].xmom * baselaunch)) * 2
                                            this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 200)) + (boys[t].shots[k].ymom * baselaunch)) * 2) - (10 * (this.damage / 200))
                                            this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                            this.breaktimer = 0
                                        }
                                        boys[t].shots[k].marked = 1
                                    }
                                }
                            }


                            if (boys[t].hasOwnProperty('radball')) {
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
this.bananahand2.anchored = -20
                                        this.middlehand.anchored = -20
this.middlehand2.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }

                            const enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }


                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 200)) + (boys[t].bananahand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 200)) + (boys[t].bananahand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
this.bananahand2.anchored = -20
                                        this.middlehand.anchored = -20
this.middlehand2.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 200)) + (boys[t].middlehand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 200)) + (boys[t].middlehand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
this.bananahand2.anchored = -20
                                        this.middlehand.anchored = -20
this.middlehand2.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 200)) + (boys[t].righthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 200)) + (boys[t].righthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14
                                            this.shotIDs.push(boys[t].righthand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
this.bananahand2.anchored = -20
                                        this.middlehand.anchored = -20
this.middlehand2.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 200)) + (boys[t].lefthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 200)) + (boys[t].lefthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
this.bananahand2.anchored = -20
                                        this.middlehand.anchored = -20
this.middlehand2.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 200)) + (boys[t].righthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 200)) + (boys[t].righthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
this.bananahand2.anchored = -20
                                        this.middlehand.anchored = -20
this.middlehand2.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 200)) + (boys[t].lefthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 200)) + (boys[t].lefthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)


                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
this.bananahand2.anchored = -20
                                        this.middlehand.anchored = -20
this.middlehand2.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }

                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 200)) + (boys[t].righthand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 200)) + (boys[t].righthand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
this.bananahand2.anchored = -20
                                        this.middlehand.anchored = -20
this.middlehand2.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].lefthand.fired > 14) {
                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)
                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            } else {
                                                this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 200)) + (boys[t].lefthand.xmom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 200)) + (boys[t].lefthand.ymom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)) * 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
this.bananahand2.anchored = -20
                                        this.middlehand.anchored = -20
this.middlehand2.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 200)) + (boys[t].body.xmom * baselaunch) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].body.ymom * (this.damage / 200)) + (boys[t].body.ymom * baselaunch)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
this.bananahand2.anchored = -20
                                        this.middlehand.anchored = -20
this.middlehand2.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        this.fixupshoulder()
                        boys[f].fixupshoulder()
                        this.body.ymom *= .99
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2
                this.lefthand.ymom = -this.speed * 2
                this.righthand.ymom = -this.speed * 2
                this.middlehand.ymom = -this.speed * 2
                this.bananahand.ymom = -this.speed * 2
                this.jumpcount = 100

            }
        }
        doJump(object, speed) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -this.speed * 2
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 2
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {

            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            this.jumpcount--

            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                    this.doJump(this.middlehand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }

            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }

        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                this.fleeing = 1
            }
            if (this.charge > 90) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {

                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        this.wmove = 1
                                        this.screwshot = 1
                                    }
                                }
                            }
                        }
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + Math.max(this.body.radius, boys[t].body.radius))) {
                        this.wmove = 1
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                        
                        if (Math.random() < .2) {
                            this.wmove = 1
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }


            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    this.screwshot = 1
                    this.wmove = 1
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    this.screwshot = 1
                }
            }
            this.exgrip = 0
            for (let t = 0; t < boys.length; t++) {
                if (this.amomu <= 0 && this.dmomu <= 0) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].brick.center.y > this.brick.center.y) {
                            if (boys[t].body.x < this.body.x) {
                                this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                this.amomu += 15
                                this.exgrip = 1
                            } else {
                                this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                this.dmomu += 15
                                this.exgrip = 1
                            }
                        }
                    }
                } else {
                    this.exgrip = 1
                }
            }


            if (this.dmom > 0) {
                this.screwshot = 1
                this.dmove = 1
                this.wmove = 1
                this.amove = 0
                this.amom = 0
            } else {

                if (this.dmomu > 0) {
                    this.dmove = 1
                    this.amove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }
            if (this.amom > 0) {
                this.screwshot = 1
                this.dmom = 0
                this.amove = 1
                this.wmove = 1
                this.dmove = 0
            } else {
                if (this.amomu > 0) {
                    this.amove = 1
                    this.dmove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }

            if (this.safe == 0) {
                if (this.under == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                }
                if (this.body.x > (this.brick.center.x)) {
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                } else {
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }

            if (this.trapped == 0) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]
                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        const runtimeR = xdisR / this.speed
                                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .95)) {//&& this.body.fired < 3.8 * runtimeR) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        const runtimeL = xdisL / this.speed
                                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .95)) {// && this.body.fired < 3.8 * runtimeL) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }
                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        const runtimeR = xdisR / this.speed
                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .8)) {// && this.body.fired < 1.8 * runtimeR) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1 //erroor
                                this.wmove = 1
                            }
                        }
                    } else {
                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        const runtimeL = xdisL / this.speed
                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .8)) {// && this.body.fired < 1.8 * runtimeL) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1//error
                                this.wmove = 1
                            }
                        }
                    }
                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }

            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            if (this.dmomu <= 0 && this.amomu <= 0) {
                                                this.screwshot = 1
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        this.amom = this.dmom
                        this.dmom = 0
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        this.dmom = this.amom
                        this.amom = 0
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }
                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 2
                    } else {
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed
                        }else if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                    }
                }
                if (this.dmove == 1) {
                    this.face = 1
                    if (object == this.body) {
                        object.x += speed*.8
                        this.righthand.x += speed*.8
                        this.lefthand.x += speed*.8
                        this.middlehand.x += speed*.8
                        this.bananahand.x += speed*.8
                    }
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                        this.degripr()
                        this.jumping = 1
                    }
                }
                // if (keysPressed['s']) {
                //     object.y += speed
                //     this.degrip()
                // }
                if (this.amove == 1) {
                    this.face = -1
                    if (object == this.body) {
                        object.x -= speed*.8
                        this.righthand.x -= speed*.8
                        this.lefthand.x -= speed*.8
                        this.middlehand.x -= speed*.8
                        this.bananahand.x -= speed*.8
                    }
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1 || this.bananahand2.anchored == 1|| this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {
                        this.degripl()
                        this.jumping = 1
                    }
                }


                // if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                // if (controller.gamepad.axesStatus[0] > .1) {
                //     this.face = 1
                // }

                // if (controller.gamepad.axesStatus[1] < -.1) {
                //     this.face = -1
                // }
                // }

            }
            // if (this.dmomu > 0 || this.amomu > 0) {
            //     this.lefthand.anchored = 0
            //     this.righthand.anchored = 0
            // }

            if (this.exgrip == 1) {
                this.righthand.anchored = 0
                this.lefthand.anchored = 0
                        this.bananahand.anchored = 0
                        this.middlehand.anchored = 0
            }
        }
        AI() {
            this.idify()

            if (this.inactive == 1) {
                return
            }
            this.breaks()

            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.middlehand.fired--
            this.bananahand.fired--
            this.middlehand2.fired--
            this.bananahand2.fired--
            this.shotclock--
            this.nograv--
            this.lefthand.fired--
            // this.charge--
            // if (this.charge <= 0) {
            //     this.charge = 0
            // }
            this.body.fired -= 1

            this.breaktimer--
            // if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] ||  keysPressed['e']) {

            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.rightshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {


                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.dmomu <= 0 && this.amomu <= 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 50 && this.body.y < boys[t].body.y) {
                        if (this.brick == boys[t].brick) {
                            this.downspike = 1
                        }
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {
                        if (this.brick == boys[t].brick) {
                            this.downspike = 1
                        }
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < 70 && this.body.y > boys[t].body.y) {
                        if (this.dmomu <= 0 && this.amomu <= 0) {
                            this.screwshot = 1
                        }
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == 1) {
                                this.hortsmash = 1
                            }
                        }
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == -1) {
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .09) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                this.leftshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.leftshot = 0
                                    }
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                this.rightshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.rightshot = 0
                                    }
                                }
                            }
                        }
                    }


                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (this.under == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                } else {
                    this.wmove = 1
                }
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.dmomu <= 0 && this.amomu <= 0) {
                                            this.screwshot = 1
                                            this.wmove = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        this.shieldpower -= .63
                        this.shield = 1
                        this.shielddraw = 1
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }

            if (this.body.fired > 30) {
                this.body.ymom -= this.body.fired * .008
            }
            if (this.screwtimer == 30) {
                this.body.fired = 30
                this.body.ymom = 0
            } else if (this.screwtimer <= 30) {
                if (this.screwtimer > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.body.y < 900) {
                    this.wmove = 0
                    this.screwshot = 0
                }

                    if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {
                        if(this.middlehand.fired <= 0){
                            if(this.middlehand.anchored <= 0){
                            this.middlehand.fired = 19
                            this.middlehand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.bananahand.fired <= 0){
                            if(this.bananahand.anchored <= 0){
                            this.bananahand.fired = 19
                            this.bananahand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                                if(this.middlehand2.fired <= 0){
                            if(this.middlehand2.anchored <= 0){
                            this.middlehand2.fired = 19
                            this.middlehand2.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.bananahand2.fired <= 0){
                            if(this.bananahand2.anchored <= 0){
                            this.bananahand2.fired = 19
                            this.bananahand2.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.righthand.fired <= 0){
                            if(this.righthand.anchored <= 0){
                            this.righthand.fired = 19
                            this.righthand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.lefthand.fired <= 0){
                            if(this.lefthand.anchored <= 0){
                            this.lefthand.fired = 19
                            this.lefthand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                    }

                    if (this.body.fired > 30) {
                        this.body.ymom -= this.body.fired * .008
                    }
                    if (this.screwtimer == 30) {
                        this.body.fired = 30
                        this.body.ymom = 0
                    } else if (this.screwtimer <= 30) {
                        if (this.screwtimer > 0) {
                            this.body.ymom = 0
                        }
                    }
                    if (this.screwshot == 1) {
                        if(this.shotclock <= 0){
                            this.shot = new ShotGW( this.body.x, this.body.y, 35, this.body.color, 0,  -7)
                            this.shot.homing = 1
                            this.shots.push(this.shot)
                            this.shotclock = 50
                        }
                    }
                    if (this.hortsmash == 1) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored <= 0) {
                                this.righthand.fired = 19
                                let armlink1 = new LineOP(this.righthand, this.body)
                                let armlink1dis = armlink1.hypotenuse()
                                let armlink1angle = armlink1.angle()
                                this.righthand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.righthand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.rightshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                                this.rightshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                                this.idify()
                            }
                        }
                        if (this.bananahand2.fired <= 0) {
                            if (this.bananahand2.anchored <= 0) {
                                this.bananahand2.fired = 19
                                let armlink1 = new LineOP(this.bananahand2, this.body)
                                let armlink1dis = armlink1.hypotenuse()
                                let armlink1angle = armlink1.angle()
                                this.bananahand2.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.bananahand2.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.bananahand2.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                                this.bananahand2.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                                this.idify()
                            }
                        }
                        if (this.middlehand2.fired <= 0) {
                            if (this.righthand.anchored <= 0) {
                                this.middlehand2.fired = 19
                                let armlink1 = new LineOP(this.middlehand2, this.body)
                                let armlink1dis = armlink1.hypotenuse()
                                let armlink1angle = armlink1.angle()
                                this.middlehand2.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.middlehand2.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.middlehand2.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                                this.middlehand2.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored <= 0) {

                                this.lefthand.fired = 19
                                let armlink1 = new LineOP(this.lefthand, this.body)
                                let armlink1dis = armlink1.hypotenuse()
                                let armlink1angle = armlink1.angle()
                                this.lefthand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.lefthand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.leftshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                                this.leftshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15

                                this.idify()
                            }
                        }
                        if (this.middlehand.fired <= 0) {
                            
                            this.middlehand.fired = 19
                            if (this.middlehand.anchored <= 0) {
                            let armlink1 = new LineOP(this.middlehand, this.body)
                            let armlink1dis = armlink1.hypotenuse()
                            let armlink1angle = armlink1.angle()
                            this.middlehand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.middlehand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.middleshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                            this.middleshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                            this.idify()
                        }
                        }
                        if (this.bananahand.fired <= 0) {
                            if (this.bananahand.anchored <= 0) {
                                this.bananahand.fired = 19
                            let armlink1 = new LineOP(this.bananahand, this.body)
                            let armlink1dis = armlink1.hypotenuse()
                            let armlink1angle = armlink1.angle()
                            this.bananahand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.bananahand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.bananashoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                            this.bananashoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                            this.idify()
                            }
                        }


                    }

                }
            

                    if(this.leftshot == 1 || this.rightshot == 1){
                        if(this.middlehand.fired <= 0){
                            if(this.middlehand.anchored <= 0){
                            this.middlehand.fired = 19
                            this.middlehand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.bananahand.fired <= 0){
                            if(this.bananahand.anchored <= 0){
                            this.bananahand.fired = 19
                            this.bananahand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                                if(this.middlehand2.fired <= 0){
                            if(this.middlehand2.anchored <= 0){
                            this.middlehand2.fired = 19
                            this.middlehand2.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.bananahand2.fired <= 0){
                            if(this.bananahand2.anchored <= 0){
                            this.bananahand2.fired = 19
                            this.bananahand2.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.righthand.fired <= 0){
                            if(this.righthand.anchored <= 0){
                            this.righthand.fired = 19
                            this.righthand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.lefthand.fired <= 0){
                            if(this.lefthand.anchored <= 0){
                            this.lefthand.fired = 19
                            this.lefthand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }

                    }


            if (this.safe == 0 || (this.hortsmash == 0 && this.downspike == 0 && this.leftshot == 0 && this.rightshot == 0 && this.screwshot == 0) || this.downspike == 1) {
                for(let t = 0;t<this.springs.length;t++){
                    this.springs[t].length = 9
                }
                this.speed = 21
                this.body.radius = 25
                this.lefthand.radius = 10
                this.righthand.radius = 10
                this.middlehand.radius = 10
                this.bananahand.radius = 10
                this.middlehand2.radius = 10
                this.bananahand2.radius = 10
                this.punchspeed = 2.1
            }else{
     for(let t = 0;t<this.springs.length;t++){
                    this.springs[t].length = 18
                }
                this.speed = 15.95
                this.body.radius = 48
                this.punchspeed = 5.1

                this.lefthand.radius = 19.5
                this.righthand.radius = 19.5
                this.middlehand.radius = 19.5
                this.bananahand.radius = 19.5
                this.middlehand2.radius = 19.5
                this.bananahand2.radius = 19.5
                }

            }

    
        fightcontrol() {

            if (this.inactive == 1) {
                return
            }
            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()



            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.middlehand.fired--
            this.bananahand.fired--
            this.middlehand2.fired--
            this.bananahand2.fired--
            this.shotclock--
            this.nograv--
            this.charge--
            if (this.charge <= 0) {
                this.charge = 0
            }
            this.body.fired -= 1
            this.lefthand.fired--


            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            this.breaktimer--
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }

            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {


                    if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {
                        if(this.middlehand.fired <= 0){
                            if(this.middlehand.anchored <= 0){
                            this.middlehand.fired = 19
                            this.middlehand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.bananahand.fired <= 0){
                            if(this.bananahand.anchored <= 0){
                            this.bananahand.fired = 19
                            this.bananahand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                                if(this.middlehand2.fired <= 0){
                            if(this.middlehand2.anchored <= 0){
                            this.middlehand2.fired = 19
                            this.middlehand2.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.bananahand2.fired <= 0){
                            if(this.bananahand2.anchored <= 0){
                            this.bananahand2.fired = 19
                            this.bananahand2.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.righthand.fired <= 0){
                            if(this.righthand.anchored <= 0){
                            this.righthand.fired = 19
                            this.righthand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.lefthand.fired <= 0){
                            if(this.lefthand.anchored <= 0){
                            this.lefthand.fired = 19
                            this.lefthand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                    }

                    if (this.body.fired > 30) {
                        this.body.ymom -= this.body.fired * .008
                    }
                    if (this.screwtimer == 30) {
                        this.body.fired = 30
                        this.body.ymom = 0
                    } else if (this.screwtimer <= 30) {
                        if (this.screwtimer > 0) {
                            this.body.ymom = 0
                        }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {
                        if(this.shotclock <= 0){
                            this.shot = new ShotGW( this.body.x, this.body.y, 35, this.body.color, 0,  -7)
                            this.shot.homing = 1
                            this.shots.push(this.shot)
                            this.shotclock = 50
                            // if(this.shots.length > 10){
                            //     this.shots.splice(0,1)
                            // }
               }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored <= 0) {
                                this.righthand.fired = 19
                                let armlink1 = new LineOP(this.righthand, this.body)
                                let armlink1dis = armlink1.hypotenuse()
                                let armlink1angle = armlink1.angle()
                                this.righthand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.righthand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.rightshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                                this.rightshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                                this.idify()
                            }
                        }
                        if (this.bananahand2.fired <= 0) {
                            if (this.bananahand2.anchored <= 0) {
                                this.bananahand2.fired = 19
                                let armlink1 = new LineOP(this.bananahand2, this.body)
                                let armlink1dis = armlink1.hypotenuse()
                                let armlink1angle = armlink1.angle()
                                this.bananahand2.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.bananahand2.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.bananahand2.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                                this.bananahand2.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                                this.idify()
                            }
                        }
                        if (this.middlehand2.fired <= 0) {
                            if (this.righthand.anchored <= 0) {
                                this.middlehand2.fired = 19
                                let armlink1 = new LineOP(this.middlehand2, this.body)
                                let armlink1dis = armlink1.hypotenuse()
                                let armlink1angle = armlink1.angle()
                                this.middlehand2.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.middlehand2.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.middlehand2.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                                this.middlehand2.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored <= 0) {

                                this.lefthand.fired = 19
                                let armlink1 = new LineOP(this.lefthand, this.body)
                                let armlink1dis = armlink1.hypotenuse()
                                let armlink1angle = armlink1.angle()
                                this.lefthand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.lefthand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.leftshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                                this.leftshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15

                                this.idify()
                            }
                        }
                        if (this.middlehand.fired <= 0) {
                            
                            this.middlehand.fired = 19
                            if (this.middlehand.anchored <= 0) {
                            let armlink1 = new LineOP(this.middlehand, this.body)
                            let armlink1dis = armlink1.hypotenuse()
                            let armlink1angle = armlink1.angle()
                            this.middlehand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.middlehand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.middleshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                            this.middleshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                            this.idify()
                        }
                        }
                        if (this.bananahand.fired <= 0) {
                            if (this.bananahand.anchored <= 0) {
                                this.bananahand.fired = 19
                            let armlink1 = new LineOP(this.bananahand, this.body)
                            let armlink1dis = armlink1.hypotenuse()
                            let armlink1angle = armlink1.angle()
                            this.bananahand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.bananahand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.bananashoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                            this.bananashoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                            this.idify()
                            }
                        }


                    }

                }
            }

            if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
                for(let t = 0;t<this.springs.length;t++){
                    this.springs[t].length = 9
                }
                this.speed = 21
                this.body.radius = 25
                this.lefthand.radius = 10
                this.righthand.radius = 10
                this.middlehand.radius = 10
                this.bananahand.radius = 10
                this.middlehand2.radius = 10
                this.bananahand2.radius = 10
                this.punchspeed = 2.1
            }else{
     for(let t = 0;t<this.springs.length;t++){
                    this.springs[t].length = 18
                }
                this.speed = 15.95
                this.body.radius = 48
                this.punchspeed = 5.1

                this.lefthand.radius = 19.5
                this.righthand.radius = 19.5
                this.middlehand.radius = 19.5
                this.bananahand.radius = 19.5
                this.middlehand2.radius = 19.5
                this.bananahand2.radius = 19.5
                }
        }
        degripl() {

            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                        this.lefthand.anchored = -10
                        this.middlehand.anchored = -10
this.middlehand2.anchored = -10
                        this.bananahand.anchored = -10
this.bananahand2.anchored = -10
                        this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }else if (this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {

                        if (this.body.ymom > 0) {
                            this.body.ymom = 0
                        }
                        this.body.ymom -= this.speed
                        this.lefthand.anchored = -10
                        this.middlehand.anchored = -10
this.middlehand2.anchored = -10
                        this.bananahand.anchored = -10
this.bananahand2.anchored = -10
                        this.righthand.anchored = -10
                        for (let t = 0; t < this.springs.length; t++) {
                            this.springs[t].balance()
                        }
                        for (let t = 0; t < this.nodes.length; t++) {
                            this.nodes[t].move(this)
                        }
                        }else if (this.bananahand.anchored == 1 || this.bananahand2.anchored == 1) {

                                if (this.body.ymom > 0) {
                                    this.body.ymom = 0
                                }
                                this.body.ymom -= this.speed
                                this.lefthand.anchored = -10
                                this.middlehand.anchored = -10
this.middlehand2.anchored = -10
                                this.bananahand.anchored = -10
this.bananahand2.anchored = -10
                                this.righthand.anchored = -10
                                for (let t = 0; t < this.springs.length; t++) {
                                    this.springs[t].balance()
                                }
                                for (let t = 0; t < this.nodes.length; t++) {
                                    this.nodes[t].move(this)
                                }
                                }else if (this.righthand.anchored == 1) {

                                if (this.body.ymom > 0) {
                                    this.body.ymom = 0
                                }
                                this.body.ymom -= this.speed
                                this.lefthand.anchored = -10
                                this.middlehand.anchored = -10
this.middlehand2.anchored = -10
                                this.bananahand.anchored = -10
this.bananahand2.anchored = -10
                                this.righthand.anchored = -10
                                for (let t = 0; t < this.springs.length; t++) {
                                    this.springs[t].balance()
                                }
                                for (let t = 0; t < this.nodes.length; t++) {
                                    this.nodes[t].move(this)
                                }
                                }


        }
        degripr() {

            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

            if (this.body.ymom > 0) {
                this.body.ymom = 0
            }
            this.body.ymom -= this.speed
            this.lefthand.anchored = -10
            this.righthand.anchored = -10
                this.middlehand.anchored = -10
this.middlehand2.anchored = -10
                this.bananahand.anchored = -10
this.bananahand2.anchored = -10
            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].balance()
            }
            for (let t = 0; t < this.nodes.length; t++) {
                this.nodes[t].move(this)
            }
            }else if (this.middlehand.anchored == 1 || this.middlehand2.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.middlehand.anchored = -10
this.middlehand2.anchored = -10
                this.bananahand.anchored = -10
this.bananahand2.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
                }else if (this.bananahand.anchored == 1 || this.bananahand2.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.middlehand.anchored = -10
this.middlehand2.anchored = -10
                this.bananahand.anchored = -10
this.bananahand2.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
                }else if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.middlehand.anchored = -10
this.middlehand2.anchored = -10
                this.bananahand.anchored = -10
this.bananahand2.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
                }


        }
        collideStage() {

            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {

            if (this.inactive == 1) {
                return
            }

                for (let t = 0; t < this.shots.length; t++) {
                    this.shots[t].color = this.body.color
                }


            // for (let t = 0; t < this.shots.length; t++) {
            //         if(this.shots[t].bomb == 1){
            //             let link = new LineOP(this.body, this.shots[t], this.body.color, 3)
            //             link.width = Math.min(Math.max(1000/link.hypotenuse(), 1),15)
            //             if(link.hypotenuse() < 400){
            //                 link.draw()
            //             }
            //         }
            // }


            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.body.anchored = 0
            // this.middlehand.anchored = 0
            // this.bananahand.anchored = 0
            this.blasting--
            if (this.grounded == 1) {
                if (this.screwtimer > 5) {
                    this.screwangle = 0
                    this.screwtimer = 0
                    // this.body.fired = 5
                }
            }
            this.grounded = 0
            this.frame++

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.shots.length; t++) {
               


                    if (typeof this.shots[t].gravity == "number") {
                        if (this.shots[t].ymom > -(vsmashlimit / 1.15)) {
                            this.shots[t].ymom += this.shots[t].gravity / 1.2
                            this.shots[t].radius -= .5
                            if (this.shots[t].radius < 10) {
                                this.shots[t].radius = 10
                            }
                        } else {
                            this.shots[t].marked = 1
                        }
                    }
                    if (typeof this.shots[t].countdown == "number") {
                        this.shots[t].countdown--
                        this.shots[t].gravity = Math.cos(this.shots[t].countdown * (Math.PI / 4)) * 20
                        if (this.shots[t].countdown <= 0) {
                            this.shots[t].marked = 1
                        }
                    }
                        this.shots[t].move()

                        if(this.shots[t].homing == 1){
                            let min = 100000
                            let target = {}
                            for(let r=0;r<boys.length;r++){
                                if(this!=boys[r]){
                                    let link = new LineOP(this.shots[t], boys[r].body)
                                    if(min > link.hypotenuse()){
                                        min = link.hypotenuse()
                                        target = boys[r]
                                    }

                            for(let g=0;g<boys[r].shots.length;g++){

                                let link = new LineOP(this.shots[t], boys[r].shots[g])
                                    if(min > link.hypotenuse()){
                                        min = link.hypotenuse()
                                        target = boys[r].shots[g]
                                    }

                            }
                                }
                            }
                            if(min < 800){
                                if(typeof target.body != "undefined"){
                                    let link = new LineOP(this.shots[t], target.body)
                                    this.shots[t].xmom -= (this.shots[t].x-target.body.x)/Math.max((link.hypotenuse()-800), 400)
                                    this.shots[t].ymom -= (this.shots[t].y-target.body.y)/Math.max((link.hypotenuse()-800), 400)
                                    let j = 0
                                    while(Math.abs(this.shots[t].xmom) + Math.abs(this.shots[t].ymom) > 20){
                                        this.shots[t].xmom*=.95
                                        this.shots[t].ymom*=.95
                                        j++
                                        if(j > 1000){
                                            break
                                        }
                                    }
                                }else  if(typeof target.x != "undefined"){

                                //     if(this.shots[t].doesPerimeterTouch(target)){
                                //     this.shots[t].marked = 1
                                // }
                                    let link = new LineOP(this.shots[t], target)
                                    this.shots[t].xmom -= (this.shots[t].x-target.x)/Math.max((link.hypotenuse()-800), 400)
                                    this.shots[t].ymom -= (this.shots[t].y-target.y)/Math.max((link.hypotenuse()-800), 400)
                                    let j = 0
                                    while(Math.abs(this.shots[t].xmom) + Math.abs(this.shots[t].ymom) > 20){
                                        this.shots[t].xmom*=.95
                                        this.shots[t].ymom*=.95
                                        j++
                                        if(j > 1000){
                                            break
                                        }
                                    }
                                }
                            }


                        }

                    if (this.shots[t].marked <= 0) {
                        this.shots[t].draw()
                    }

                    this.shots[t].life--
                    if (this.shots[t].life <= 0) {
                        this.shots[t].marked = 1
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {



                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].draw()
                        }
                    }
                }
            }

            for (let j = 0; j < 10; j++) {
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked == 1) {
                        this.shots.splice(t, 1)
                    } else {
                        this.shots[t].marked--
                    }
                }
            }
            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.middlearm = new LineOP(this.middleshoulder, this.middlehand, invertColor(this.body.color), 8)
            this.bananarm = new LineOP(this.bananashoulder, this.bananahand, invertColor(this.body.color), 8)
            this.collideStage()
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].color = invertColor(this.body.color)
                this.links[t].draw()
            }
            for (let t = 0; t < this.nodes.length; t++) {
                this.nodes[t].draw()
                if (this.nodes[t] == this.body) {
                    const link = new Line(this.body.x, this.body.y, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y + Math.sin(this.screwangle), invertColor(this.body.color), this.body.radius * .2)
                    // canvas_context.lineWidth = this.strokeWidth
                    // canvas_context.strokeStyle = "#000000"
                    // canvas_context.beginPath();
                    // canvas_context.arc(((link.x1 + link.x2 + this.body.x) * (1 / 3)) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .35, (this.screwangle * this.face) + (this.face / 2), (Math.PI * 1) + (this.screwangle * this.face) + (this.face / 2), true)
                    // canvas_context.fillStyle = "#00FF00"
                    // canvas_context.fill()
                    // canvas_context.stroke();
                    // canvas_context.lineWidth = this.strokeWidth
                    // canvas_context.strokeStyle = "#000000"
                    // canvas_context.beginPath();
                    // canvas_context.arc(((link.x1 + link.x2 + this.body.x) * (1 / 3)) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .35, (this.screwangle * this.face) + (this.face / 2), (Math.PI * 1) + (this.screwangle * this.face) + (this.face / 2), false)
                    // canvas_context.fillStyle = "#00FF00"
                    // canvas_context.fill()
                    // canvas_context.stroke();


                    canvas_context.fillStyle = invertColor(this.body.color)
                    let x = ((link.x1 + link.x2 + this.body.x) * (1 / 3)) - ((this.body.radius * .6) * (this.face))
                    if (this.face == 1) {
                        x += this.body.radius * .89
                    }
                    if (this.face == -1) {
                        x -= this.body.radius * .89
                    }
                    canvas_context.fillRect(x - 12, (link.y1 + this.body.radius * .0) - 11.5, 24, 24)
                    let circ = new ShotGW(x, link.y1, this.body.radius*.25, (this.body.color))
                    circ.draw()
                }
            }

            // if (this.controller == 0) {

            // if (this.screwangle == 0) {
            //     link.draw()
            // }
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.middlehand)).hypotenuse(), (new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.middlehand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
            canvas_context.font = "42px arial"
            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 200)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 75)
            canvas_context.fillStyle = "white"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 110)
            }
            if (this.shotdraw == 1) {
                if (this.face == 1) {
                    this.shot = new Shot(this.righthand.x, this.righthand.y, this.charge * .54, "#00FF00", this.speed * 2, 0)
                } else {
                    this.shot = new Shot(this.lefthand.x, this.lefthand.y, this.charge * .54, "#00FF00", this.speed * 2, 0)
                }
                if (this.face == 1) {
                    this.shot2 = new Shot(this.middlehand.x, this.middlehand.y, this.charge2 * .40, "#00FF00", this.speed * 2, 0)
                } else {
                    this.shot2 = new Shot(this.bananahand.x, this.bananahand.y, this.charge2 * .40, "#00FF00", this.speed * 2, 0)
                }

                if (this.charge > 80) {
                    this.shot.color = "#FFFF00"
                }

                if (this.charge2 > 95) {
                    this.shot2.color = "#FFFF00"
                }

                this.shot.draw()
                this.shot2.draw()
            }
        }
        operate() {

            if (this.inactive == 1) {
                return
            }

            // this.armAngle += this.armspin*this.face
            // if (this.righthand.anchored == 1) { // disabled for spin?
            //     if (this.body.x > this.righthand.x) {
            //         this.righthand.anchored = -10
            //     }
            // }
            // if (this.lefthand.anchored == 1) {
            //     if (this.body.x < this.lefthand.x) {
            //         this.lefthand.anchored = -10
            //     }
            // }




            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1 && this.middlehand.anchored != 1 && this.bananahand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {
            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }
                    if (this.middlehand.anchored == 0) {
                    this.playerMove(this.middlehand, this.speed, this.gamepad)
                    }
                    if (this.middlehand2.anchored == 0) {
                    this.playerMove(this.middlehand2, this.speed, this.gamepad)
                    }

                    if (this.bananahand.anchored == 0) {
                    this.playerMove(this.bananahand, this.speed, this.gamepad)
                    }

                    if (this.bananahand2.anchored == 0) {
                    this.playerMove(this.bananahand2, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }

            if (this.middlehand2.anchored == 0) {
            this.AImove(this.middlehand2, this.speed, this.gamepad)
            }

            if (this.bananahand2.anchored == 0) {
            this.AImove(this.bananahand2, this.speed, this.gamepad)
            }

            if (this.middlehand.anchored == 0) {
            this.AImove(this.middlehand, this.speed, this.gamepad)
            }

            if (this.bananahand.anchored == 0) {
            this.AImove(this.bananahand, this.speed, this.gamepad)
            }
                    this.doubleJump()
                }
            }
            // }
            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1 || this.middlehand.anchored == 1 || this.middlehand2.anchored == 1 || this.bananahand.anchored == 1 || this.bananahand2.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.righthand.anchored = -10
                    this.bananahand.anchored = -10
                    this.bananahand2.anchored = -10
                    this.middlehand.anchored = -10
                    this.middlehand2.anchored = -10

                    this.body.ymom *= .1
                    this.body.symom = this.leftshoulder.ymom * .99
                this.body.ymom -= this.gravity*2
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.bananahand.anchored = -10
                    this.bananahand2.anchored = -10
                    this.middlehand.anchored = -10
                    this.middlehand2.anchored = -10
                    this.lefthand.anchored = -10
                    this.body.ymom *= .1
                    this.body.symom = this.rightshoulder.ymom * .99
                this.body.ymom -= this.gravity*2
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else if (this.middlehand.anchored == 1) {
                    this.body.ymom *= .1
                    this.righthand.anchored = -10
                    this.bananahand.anchored = -10
                    this.middlehand2.anchored = -10
                    this.bananahand2.anchored = -10
                    this.lefthand.anchored = -10
                    this.body.symom = this.middleshoulder.ymom * .99
                this.body.ymom -= this.gravity*2
                    this.body.sxmom = this.middleshoulder.xmom * .99
                }  else if (this.middlehand2.anchored == 1) {
                    this.body.ymom *= .1
                    this.righthand.anchored = -10
                    this.bananahand.anchored = -10
                    this.bananahand2.anchored = -10
                    this.middlehand.anchored = -10
                    this.lefthand.anchored = -10
                    this.body.symom = this.middleshoulder.ymom * .99
                    this.body.ymom -= this.gravity*2
                    this.body.sxmom = this.middleshoulder.xmom * .99
                } else if (this.bananahand.anchored == 1 ) {
                    this.body.ymom *= .1
                    this.righthand.anchored = -10
                    this.lefthand.anchored = -10
                    this.middlehand.anchored = -10
                    this.middlehand2.anchored = -10
                    this.bananahand2.anchored = -10
                    this.body.ymom -= this.gravity*2
                    this.body.symom = this.bananashoulder.ymom * .99
                    this.body.sxmom = this.bananashoulder.xmom * .99 //bananananananananana
                }else if (this.bananahand2.anchored == 1) {
                    this.body.ymom *= .1
                    this.bananahand.anchored = -10 
                    this.righthand.anchored = -10
                    this.lefthand.anchored = -10
                    this.middlehand.anchored = -10
                    this.middlehand2.anchored = -10
                    this.body.ymom -= this.gravity*2
                    this.body.symom = this.bananashoulder.ymom * .99
                    this.body.sxmom = this.bananashoulder.xmom * .99 //bananananananananana
                } else {
                this.body.ymom += this.gravity
                }
            } else {
                    this.righthand.anchored = -5
                    this.lefthand.anchored = -5
                    this.middlehand.anchored = -5
                    this.bananahand2.anchored = -5
                    this.middlehand2.anchored = -5
                    this.bananahand.anchored = -5
                if (this.pounding == 1) {
                    this.pounding = 0
                    const shot1 = new ShotC(this.body.x, this.body.y + this.body.radius, 21, "#00FF00", this.speed * 2, 0)
                    shot1.life = 50
                    const shot2 = new ShotC(this.body.x, this.body.y + this.body.radius, 21, "#00FF00", - this.speed * 2, 0)
                    shot2.life = 50
                    this.shots.push(shot1)
                    this.shots.push(shot2)
                }

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            }
            if (this.bananahand.anchored <= -1) {
                this.bananahand.anchored++
            }
            if (this.middlehand.anchored <= -1) {
                this.middlehand.anchored++
            }
            if (this.nograv <= 0) {
                // this.righthand.ymom += this.gravity
                // this.lefthand.ymom += this.gravity
                // this.middlehand.ymom += this.gravity
                // this.bananahand.ymom += this.gravity
            } else {
                //////////////////////////////////console.log("hum")
                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            this.body.xmom *= .99
            this.body.ymom *= .99


            for (let t = 0; t < this.shots.length; t++) {
                    if(this.shots[t].bomb == 1){
                        let link = new LineOP(this.body, this.shots[t], this.body.color, 3)
                        link.width = Math.min(Math.max(1000/link.hypotenuse(), 1),15)
                        if(link.hypotenuse() <= 400){
                            this.body.ymom-=(this.punchspeed*.07)
                            this.body.xmom*=.99
                        }
                    }
            }

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].frictiveMove(this)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].smove(this)
                }
            }
            // this.lefthand.xmom += (this.lefthand.x - this.body.x) / 40
            // this.righthand.xmom += (this.righthand.x - this.body.x) / 40
            // this.middlehand.ymom += (this.middlehand.y - this.body.y) / 18
            // this.middlehand.xmom += (this.middlehand.x - this.body.x) / 20
            // this.bananahand.ymom += (this.bananahand.y - this.body.y) / 18
            // this.bananahand.xmom += (this.bananahand.x - this.body.x) / 20
            // this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            // this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40

            let armlink1 = new LineOP(this.lefthand, this.body)
            let armlink1dis = armlink1.hypotenuse()
            let armlink1angle = armlink1.angle()
            this.lefthand.xmom += (Math.cos(armlink1angle)*armlink1dis)*.175
            this.lefthand.ymom += (Math.sin(armlink1angle)*armlink1dis)*.175
            this.leftshoulder.xmom = ((Math.cos(armlink1angle)*armlink1dis)*.15)-(((Math.cos(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.leftshoulder.ymom = ((Math.sin(armlink1angle)*armlink1dis)*.15)-(((Math.sin(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.leftshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
            this.leftshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15

            armlink1 = new LineOP(this.righthand, this.body)
            armlink1dis = armlink1.hypotenuse()
            armlink1angle = armlink1.angle()
            this.righthand.xmom += (Math.cos(armlink1angle)*armlink1dis)*.175
            this.righthand.ymom += (Math.sin(armlink1angle)*armlink1dis)*.175
            this.rightshoulder.xmom = ((Math.cos(armlink1angle)*armlink1dis)*.15)-(((Math.cos(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.rightshoulder.ymom = ((Math.sin(armlink1angle)*armlink1dis)*.15)-(((Math.sin(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.rightshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
            this.rightshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15

            armlink1 = new LineOP(this.bananahand, this.body)
            armlink1dis = armlink1.hypotenuse()
            armlink1angle = armlink1.angle()
            this.bananahand.xmom += (Math.cos(armlink1angle)*armlink1dis)*.175
            this.bananahand.ymom += (Math.sin(armlink1angle)*armlink1dis)*.175
            this.bananashoulder.xmom = ((Math.cos(armlink1angle)*armlink1dis)*.15)-(((Math.cos(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.bananashoulder.ymom = ((Math.sin(armlink1angle)*armlink1dis)*.15)-(((Math.sin(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.bananashoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
            this.bananashoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15

            armlink1 = new LineOP(this.middlehand, this.body)
            armlink1dis = armlink1.hypotenuse()
            armlink1angle = armlink1.angle()
            this.middlehand.xmom += (Math.cos(armlink1angle)*armlink1dis)*.175
            this.middlehand.ymom += (Math.sin(armlink1angle)*armlink1dis)*.175
            this.middleshoulder.xmom = ((Math.cos(armlink1angle)*armlink1dis)*.15)-(((Math.cos(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.middleshoulder.ymom = ((Math.sin(armlink1angle)*armlink1dis)*.15)-(((Math.sin(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.middleshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
            this.middleshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15

            
            armlink1 = new LineOP(this.middlehand2, this.body)
            armlink1dis = armlink1.hypotenuse()
            armlink1angle = armlink1.angle()
            this.middlehand2.xmom += (Math.cos(armlink1angle)*armlink1dis)*.175
            this.middlehand2.ymom += (Math.sin(armlink1angle)*armlink1dis)*.175
            this.middleshoulder2.xmom = ((Math.cos(armlink1angle)*armlink1dis)*.15)-(((Math.cos(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.middleshoulder2.ymom = ((Math.sin(armlink1angle)*armlink1dis)*.15)-(((Math.sin(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.middleshoulder2.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
            this.middleshoulder2.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15



            armlink1 = new LineOP(this.bananahand2, this.body)
            armlink1dis = armlink1.hypotenuse()
            armlink1angle = armlink1.angle()
            this.bananahand2.xmom += (Math.cos(armlink1angle)*armlink1dis)*.175
            this.bananahand2.ymom += (Math.sin(armlink1angle)*armlink1dis)*.175
            this.bananashoulder2.xmom = ((Math.cos(armlink1angle)*armlink1dis)*.15)-(((Math.cos(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.bananashoulder2.ymom = ((Math.sin(armlink1angle)*armlink1dis)*.15)-(((Math.sin(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.bananashoulder2.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
            this.bananashoulder2.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15


            // this.middleshoulder.ymom -= (this.middleshoulder.y - this.body.y) / 40
            // this.middleshoulder.xmom += (this.middleshoulder.x - this.body.x) / 40
            this.fixupshoulder()

            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            if (boys.indexOf(this) <= humanPlayers) {

                // this.AI()
                this.fightcontrol()
            } else {
                this.AI()
            }
            // }
            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }

        }
    }




    class Pinwheelian {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                this.shotclock = 0
                this.armAngle = Math.PI*.5
                this.armspin = .05
                this.ping = 0
                this.nograv = 0
                this.pounding = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 8
                this.frame = 0
                this.serverID = serverID
                this.shotdraw = 0
                this.id = controller
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 54
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shot = new Brick(-1, -1, 1, 1)
                this.striker = 10000
                this.name = "Pinwheelian"
                this.pinwheel = 1
                this.blasting = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.storeshield = 0
                this.wasfalse = []
                for (let t = 0; t < 100; t++) {
                    this.wasfalse.push(1)
                }
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = 0
                this.screwangle = 0
                this.charge = 0
                this.charge2 = 0
                this.shots = []

                this.color = getRandomColor()
                if (controller == 0) {
                    this.color = "#ffAA00"
                }
                if (controller == 1) {
                    this.color = "#ff0000"
                }
                this.body = new ShotFP(400 + (Math.random() * 2560), 500, 48, this.color)
                this.controller = controller
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.armlength = 32 //40
                this.shoulderwidth = 20
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 11.95 //14
                this.punchspeed = 6.1 // 6.5
                this.grounded = 1
                this.jumping = 1


                this.nodes.push(this.body)
                this.leftshoulder = new ShotFP(this.body.x - (this.body.radius + this.shoulderwidth), 350, 9.6, "#FF0000", 0, 0, .999)
                this.rightshoulder = new ShotFP(this.body.x + (this.body.radius + this.shoulderwidth), 350, 9.6, "#FF0000", 0, 0, .999)
                this.middleshoulder = new ShotFP(this.body.x + (this.body.radius + this.shoulderwidth), 350, 9.6, "#FF0000", 0, 0, .999)
                this.bananashoulder = new ShotFP(this.body.x - (this.body.radius + this.shoulderwidth), 350, 9.6, "#FF0000", 0, 0, .999)
                this.lefthand = new ShotFP(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 24.5, "#FF0000", 0, 0, .85)
                this.righthand = new ShotFP(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 24.5, "#FF0000", 0, 0, .85)
                this.middlehand = new ShotFP(this.middleshoulder.x, (this.middleshoulder.y + this.armlength), 24.5, "#FF0000", 0, 0, .85)
                this.bananahand = new ShotFP(this.bananashoulder.x, (this.bananashoulder.y + this.armlength), 24.5, "#FF0000", 0, 0, .85)
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.middleshoulder)
                this.nodes.push(this.bananashoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.nodes.push(this.middlehand)
                this.nodes.push(this.bananahand)
                // this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                // this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                // this.middlecollar = new LineOP(this.middleshoulder, this.body, this.body.color, 8)
                // this.links.push(this.leftcollar)
                // this.links.push(this.rightcollar)
                // this.links.push(this.middlecollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, invertColor(this.body.color), 8)
                this.bananarm = new LineOP(this.bananashoulder, this.bananahand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.links.push(this.middlearm)
                this.links.push(this.bananarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.middlearm = new SpringOP(this.middleshoulder, this.middlehand, this.armlength * 1, 8)
                this.bananarm = new SpringOP(this.bananashoulder, this.bananahand, this.armlength * 1, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.springs.push(this.middlearm)
                this.springs.push(this.bananarm)
                this.gravity = 1.2345
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.middlehand.fired = 0
                this.bananahand.fired = 0
                this.body.fired = 0
                this.screwmomentum = 0
                this.screwtimer = 0
                this.blasting = 0
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {
                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]
                }
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    if (t == 0) {
                        this.nodes[t] = new ShotFP(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)

                    } else {
                        this.nodes[t] = new ShotFP(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)

                    }
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }

                    this.nodes[t].id = idsto
                }

                this.id = args["id"]
                this.frame = args['frame']
                this.armlength = 32
                this.shoulderwidth = 20
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                    if(this.shots[t].bomb == 1){
                        this.shots[t] = new ShotFMP(this, this.shots[t].x, this.shots[t].y, this.shots[t].radius,  colors[this.controller], this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                        this.shots[t].angle+=this.armAngle
                        this.shots[t].id = idsto
                        this.shots[t].bomb = 1
                    }else{
                        this.shots[t] = new ShotFP(this.shots[t].x, this.shots[t].y, this.shots[t].radius,  colors[this.controller], this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                        this.shots[t].id = idsto
                    }
                }
                this.leftshoulder = this.nodes[1]
                this.rightshoulder = this.nodes[2]
                this.middleshoulder = this.nodes[3]
                this.bananashoulder = this.nodes[4]
                this.righthand = this.nodes[5]
                this.lefthand = this.nodes[6]
                this.middlehand = this.nodes[7]
                this.bananahand = this.nodes[8]
                // this.leftcollar = this.nodes[7]
                // this.rightcollar = this.nodes[7]
                // this.middlecollar = this.nodes[8]
                // this.leftarm = this.nodes[9]
                // this.rightarm = this.nodes[10]
                // this.middlearm = this.nodes[11]
                // this.leftarm = this.nodes[12]
                // this.rightarm = this.nodes[31]
                // this.middlearm = this.nodes[14]

                // this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                // this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                // this.middlecollar = new LineOP(this.middleshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, (this.nodes[0].color), 8)
                this.bananarm = new LineOP(this.bananashoulder, this.bananahand, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                // this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                // this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                // this.middlecollar = new LineOP(this.middleshoulder, this.body, this.body.color, 8)
                // this.links.push(this.leftcollar)
                // this.links.push(this.rightcollar)
                // this.links.push(this.middlecollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, (this.body.color), 8)
                this.bananarm = new LineOP(this.bananashoulder, this.bananahand, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.links.push(this.middlearm)
                this.links.push(this.bananarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.middlearm = new SpringOP(this.middleshoulder, this.middlehand, this.armlength, 8)
                this.bananarm = new SpringOP(this.bananashoulder, this.bananahand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.springs.push(this.middlearm)
                this.springs.push(this.bananarm)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }

                this.pinwheel = 1
            }
            ////////////////////////////////////console.log(this)
        }

        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                        this.bananahand.anchored = 0
                        this.middlehand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                        this.bananahand.anchored = 0
                        this.middlehand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            ////////////////////////////////////console.log(object.ymom,this.body.ymom)
                            object.ymom = -this.speed * 1 * 2
                            ////////////////////////////////////console.log(object.ymom,this.body.ymom)
                        } else {
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed // not as high as the axes?
                            }else if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed*.8
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed*.8
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 2
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)*.8
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        // this.face = -1
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            const copy = new Pinwheelian(this.controller)
            copy.id = this.id
            copy.frame = this.frame
            if (this.inactive == 1) {
                copy.inactive = this.inactive
            }
            copy.body.color = this.body.color
            copy.serverID = this.serverID
            copy.striker = this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            //////////////////////////////////console.log(copy)
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

            return copy
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }


            this.leftshoulder.x = (this.body.x + ((this.body.radius+this.leftshoulder.radius)*Math.cos(this.armAngle+(Math.PI*.5))))
            this.leftshoulder.y = (this.body.y + ((this.body.radius+this.leftshoulder.radius)*Math.sin(this.armAngle+(Math.PI*.5))))
            this.middleshoulder.x = (this.body.x + ((this.body.radius+this.middleshoulder.radius)*Math.cos(this.armAngle)))
            this.middleshoulder.y = (this.body.y + ((this.body.radius+this.middleshoulder.radius)*Math.sin(this.armAngle)))
            this.bananashoulder.x = (this.body.x + ((this.body.radius+this.bananashoulder.radius)*Math.cos(this.armAngle+(Math.PI))))
            this.bananashoulder.y = (this.body.y + ((this.body.radius+this.bananashoulder.radius)*Math.sin(this.armAngle+(Math.PI))))
            this.rightshoulder.x = (this.body.x + ((this.body.radius+this.rightshoulder.radius)*Math.cos(this.armAngle+(Math.PI*1.5))))
            this.rightshoulder.y = (this.body.y + ((this.body.radius+this.rightshoulder.radius)*Math.sin(this.armAngle+(Math.PI*1.5))))

            this.leftshoulder.color = this.body.color
            this.rightshoulder.color = this.body.color
            this.bananashoulder.color = this.body.color
            this.middleshoulder.color = this.body.color
            this.lefthand.color = this.body.color
            this.righthand.color = this.body.color
            this.middlehand.color = this.body.color
            this.bananahand.color = this.body.color



            if (this.lefthand.anchored == 0) {
                this.lefthand.x = this.lefthand.x + (this.leftshoulder.x -(this.body.x + ((this.body.radius+this.leftshoulder.radius)*Math.cos(this.armAngle+(Math.PI*.5)))))
                this.lefthand.y -= this.leftshoulder.y - (this.body.y + ((this.body.radius+this.leftshoulder.radius)*Math.sin(this.armAngle+(Math.PI*.5))))
                this.leftshoulder.xmom *= 0
                this.leftshoulder.ymom *= 0
            }
            if (this.righthand.anchored == 0) {
                this.righthand.x = this.righthand.x + (this.rightshoulder.x -  (this.body.x + ((this.body.radius+this.rightshoulder.radius)*Math.cos(this.armAngle+(Math.PI*1.5)))))
                this.righthand.y -= this.rightshoulder.y -  (this.body.y + ((this.body.radius+this.rightshoulder.radius)*Math.sin(this.armAngle+(Math.PI*1.5))))
                this.rightshoulder.xmom *= 0
                this.rightshoulder.ymom *= 0
            }


            this.middlehand.x = this.middlehand.x + (this.middleshoulder.x -  (this.body.x + ((this.body.radius+this.middleshoulder.radius)*Math.cos(this.armAngle+(Math.PI*.0)))))
            this.middlehand.y -= this.middleshoulder.y -  (this.body.y + ((this.body.radius+this.middleshoulder.radius)*Math.sin(this.armAngle+(Math.PI*.0))))
            if (this.middlehand.anchored == 0) {
                this.middleshoulder.xmom *= 0
                this.middleshoulder.ymom *= 0
            }

            this.bananahand.x = this.bananahand.x - (this.bananashoulder.x - (this.body.x + ((this.body.radius+this.bananashoulder.radius)*Math.cos(this.armAngle+(Math.PI)))))
            this.bananahand.y -= this.bananashoulder.y - (this.body.y + ((this.body.radius+this.bananashoulder.radius)*Math.sin(this.armAngle+(Math.PI))))
         
            if(this.bananahand.anchored == 0){
                this.bananashoulder.xmom *= 0
            this.bananashoulder.ymom *= 0
            }


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }




            // for (let t = 0; t < this.nodes.length; t++) {
            //     for (let k = 0; k < this.nodes.length; k++) {
            //         if (t != k) {
            //             if (this.nodes[t] != this.rightshoulder && this.nodes[t] != this.leftshoulder && this.nodes[t] != this.middleshoulder) {
            //                 if (this.nodes[k] != this.rightshoulder && this.nodes[k] != this.leftshoulder && this.nodes[k] != this.middleshoulder) {
            //                     let j = 0
            //                     while (this.nodes[t].doesPerimeterTouch(this.nodes[k])) {
            //                         j++
            //                         if (j > 100) {
            //                             break
            //                         }
            //                         if (this.nodes[k].anchored != 1) {
            //                             if (this.nodes[t].anchored != 1) {
            //                                 if (this.nodes[t] != this.body) {
            //                                     this.nodes[t].x -= (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
            //                                     this.nodes[t].y -= (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
            //                                 }
            //                                 if (this.nodes[k] != this.body) {
            //                                     this.nodes[k].x += (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
            //                                     this.nodes[k].y += (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
            //                                 }
            //                             } else {
            //                                 break
            //                             }
            //                         } else {
            //                             break
            //                         }
            //                     }
            //                 }
            //             }
            //         }
            //     }
            // }
            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }
        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.middlehand.id = parseFloat(Math.random().toFixed(5))
            this.bananahand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    const rline = new LineOP(this.righthand, boys[k].body)
                    const lline = new LineOP(this.lefthand, boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (this.shield == 1) {
                                            this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                        } else {
                                            this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 200)) + (boys[t].shots[k].xmom * baselaunch)) * 2
                                            this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 200)) + (boys[t].shots[k].ymom * baselaunch)) * 2) - (10 * (this.damage / 200))
                                            this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                            this.breaktimer = 0
                                        }
                                        boys[t].shots[k].marked = 1
                                    }
                                }
                            }


                            if (boys[t].hasOwnProperty('radball')) {
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
                                        this.middlehand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }

                            const enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }


                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 200)) + (boys[t].bananahand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 200)) + (boys[t].bananahand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
                                        this.middlehand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 200)) + (boys[t].middlehand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 200)) + (boys[t].middlehand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
                                        this.middlehand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }

                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 200)) + (boys[t].righthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 200)) + (boys[t].righthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14
                                            this.shotIDs.push(boys[t].righthand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
                                        this.middlehand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 200)) + (boys[t].lefthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 200)) + (boys[t].lefthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
                                        this.middlehand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 200)) + (boys[t].righthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 200)) + (boys[t].righthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
                                        this.middlehand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 200)) + (boys[t].lefthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 200)) + (boys[t].lefthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)


                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
                                        this.middlehand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }

                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 200)) + (boys[t].righthand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 200)) + (boys[t].righthand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
                                        this.middlehand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].lefthand.fired > 14) {
                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)
                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            } else {
                                                this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 200)) + (boys[t].lefthand.xmom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 200)) + (boys[t].lefthand.ymom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)) * 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
                                        this.middlehand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 200)) + (boys[t].body.xmom * baselaunch) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].body.ymom * (this.damage / 200)) + (boys[t].body.ymom * baselaunch)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                        this.bananahand.anchored = -20
                                        this.middlehand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        this.fixupshoulder()
                        boys[f].fixupshoulder()
                        this.body.ymom *= .99
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2
                this.lefthand.ymom = -this.speed * 2
                this.righthand.ymom = -this.speed * 2
                this.middlehand.ymom = -this.speed * 2
                this.bananahand.ymom = -this.speed * 2
                this.jumpcount = 100

            }
        }
        doJump(object, speed) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -this.speed * 2
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 2
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {

            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            this.jumpcount--

            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                    this.doJump(this.middlehand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }

            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }

        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                this.fleeing = 1
            }
            if (this.charge > 90) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {

                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        this.wmove = 1
                                        this.screwshot = 1
                                    }
                                }
                            }
                        }
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + Math.max(this.body.radius, boys[t].body.radius))) {
                        this.wmove = 1
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                        
                        if (Math.random() < .2) {
                            this.wmove = 1
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }


            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    this.screwshot = 1
                    this.wmove = 1
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    this.screwshot = 1
                }
            }
            this.exgrip = 0
            for (let t = 0; t < boys.length; t++) {
                if (this.amomu <= 0 && this.dmomu <= 0) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].brick.center.y > this.brick.center.y) {
                            if (boys[t].body.x < this.body.x) {
                                this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                this.amomu += 15
                                this.exgrip = 1
                            } else {
                                this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                this.dmomu += 15
                                this.exgrip = 1
                            }
                        }
                    }
                } else {
                    this.exgrip = 1
                }
            }


            if (this.dmom > 0) {
                this.screwshot = 1
                this.dmove = 1
                this.wmove = 1
                this.amove = 0
                this.amom = 0
            } else {

                if (this.dmomu > 0) {
                    this.dmove = 1
                    this.amove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }
            if (this.amom > 0) {
                this.screwshot = 1
                this.dmom = 0
                this.amove = 1
                this.wmove = 1
                this.dmove = 0
            } else {
                if (this.amomu > 0) {
                    this.amove = 1
                    this.dmove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }

            if (this.safe == 0) {
                if (this.under == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                }
                if (this.body.x > (this.brick.center.x)) {
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                } else {
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }

            if (this.trapped == 0) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]
                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        const runtimeR = xdisR / this.speed
                                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .95)) {//&& this.body.fired < 3.8 * runtimeR) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        const runtimeL = xdisL / this.speed
                                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .95)) {// && this.body.fired < 3.8 * runtimeL) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }
                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        const runtimeR = xdisR / this.speed
                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .8)) {// && this.body.fired < 1.8 * runtimeR) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1 //erroor
                                this.wmove = 1
                            }
                        }
                    } else {
                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        const runtimeL = xdisL / this.speed
                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .8)) {// && this.body.fired < 1.8 * runtimeL) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1//error
                                this.wmove = 1
                            }
                        }
                    }
                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }

            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            if (this.dmomu <= 0 && this.amomu <= 0) {
                                                this.screwshot = 1
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        this.amom = this.dmom
                        this.dmom = 0
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        this.dmom = this.amom
                        this.amom = 0
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }
                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 2
                    } else {
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed
                        }else if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                    }
                }
                if (this.dmove == 1) {
                    this.face = 1
                    if (object == this.body) {
                        object.x += speed*.8
                        this.righthand.x += speed*.8
                        this.lefthand.x += speed*.8
                        this.middlehand.x += speed*.8
                        this.bananahand.x += speed*.8
                    }
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                        this.degripr()
                        this.jumping = 1
                    }
                }
                // if (keysPressed['s']) {
                //     object.y += speed
                //     this.degrip()
                // }
                if (this.amove == 1) {
                    this.face = -1
                    if (object == this.body) {
                        object.x -= speed*.8
                        this.righthand.x -= speed*.8
                        this.lefthand.x -= speed*.8
                        this.middlehand.x -= speed*.8
                        this.bananahand.x -= speed*.8
                    }
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1|| this.bananahand.anchored == 1|| this.middlehand.anchored == 1) {
                        this.degripl()
                        this.jumping = 1
                    }
                }


                // if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                // if (controller.gamepad.axesStatus[0] > .1) {
                //     this.face = 1
                // }

                // if (controller.gamepad.axesStatus[1] < -.1) {
                //     this.face = -1
                // }
                // }

            }
            // if (this.dmomu > 0 || this.amomu > 0) {
            //     this.lefthand.anchored = 0
            //     this.righthand.anchored = 0
            // }

            if (this.exgrip == 1) {
                this.righthand.anchored = 0
                this.lefthand.anchored = 0
                        this.bananahand.anchored = 0
                        this.middlehand.anchored = 0
            }
        }
        AI() {
            this.idify()

            if (this.inactive == 1) {
                return
            }
            this.breaks()

            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.middlehand.fired--
            this.bananahand.fired--
            this.shotclock--
            this.nograv--
            this.lefthand.fired--
            // this.charge--
            // if (this.charge <= 0) {
            //     this.charge = 0
            // }
            this.body.fired -= 1

            this.breaktimer--
            // if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] ||  keysPressed['e']) {

            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.rightshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {


                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.dmomu <= 0 && this.amomu <= 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 50 && this.body.y < boys[t].body.y) {
                        if (this.brick == boys[t].brick) {
                            this.downspike = 1
                        }
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {
                        if (this.brick == boys[t].brick) {
                            this.downspike = 1
                        }
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < 70 && this.body.y > boys[t].body.y) {
                        if (this.dmomu <= 0 && this.amomu <= 0) {
                            this.screwshot = 1
                        }
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == 1) {
                                this.hortsmash = 1
                            }
                        }
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == -1) {
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .09) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                this.leftshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.leftshot = 0
                                    }
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                this.rightshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.rightshot = 0
                                    }
                                }
                            }
                        }
                    }


                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (this.under == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                } else {
                    this.wmove = 1
                }
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.dmomu <= 0 && this.amomu <= 0) {
                                            this.screwshot = 1
                                            this.wmove = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        this.shieldpower -= .63
                        this.shield = 1
                        this.shielddraw = 1
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }

            if (this.body.fired > 30) {
                this.body.ymom -= this.body.fired * .008
            }
            if (this.screwtimer == 30) {
                this.body.fired = 30
                this.body.ymom = 0
            } else if (this.screwtimer <= 30) {
                if (this.screwtimer > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.body.y < 900) {
                    this.wmove = 0
                    this.screwshot = 0
                }




                if (this.rightshot == 1 || this.leftshot == 1) {
                      
                        if(this.middlehand.fired <= 0){
                            if(this.middlehand.anchored <= 0){
                            this.middlehand.fired = 19
                            this.middlehand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.bananahand.fired <= 0){
                            if(this.bananahand.anchored <= 0){
                            this.bananahand.fired = 19
                            this.bananahand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.righthand.fired <= 0){
                            if(this.righthand.anchored <= 0){
                            this.righthand.fired = 19
                            this.righthand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.lefthand.fired <= 0){
                            if(this.lefthand.anchored <= 0){
                            this.lefthand.fired = 19
                            this.lefthand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                }
                if (this.body.fired > 30) {
                    this.body.ymom -= this.body.fired * .008
                }
                if (this.screwtimer == 30) {
                    this.body.fired = 30
                    this.body.ymom = 0
                } else if (this.screwtimer <= 30) {
                    if (this.screwtimer > 0) {
                        this.body.ymom = 0
                    }
                }
                
                
                if (this.hortsmash == 1) { 
                    if(this.middlehand.fired <= 0){
                            if(this.middlehand.anchored <= 0){
                            this.middlehand.fired = 19
                            this.middlehand.ymom = (-1*this.punchspeed*15)
                                this.idify()
                            }
                        }
                        if(this.bananahand.fired <= 0){
                            if(this.bananahand.anchored <= 0){
                            this.bananahand.fired = 19
                            this.bananahand.ymom = (-1*this.punchspeed*15)
                                this.idify()
                            }
                        }
                        if(this.righthand.fired <= 0){
                            if(this.righthand.anchored <= 0){
                            this.righthand.fired = 19
                            this.righthand.ymom = (-1*this.punchspeed*15)
                                this.idify()
                            }
                        }
                        if(this.lefthand.fired <= 0){
                            if(this.lefthand.anchored <= 0){
                            this.lefthand.fired = 19
                            this.lefthand.ymom = (-1*this.punchspeed*15)
                                this.idify()
                            }
                        }
                }

                for(let t = 0;t<boys.length;t++){
                    let link = new LineOP(boys[t].body, this.body)
                    if(link.hypotenuse() > 0 && link.hypotenuse() < 600){
                        this.screwshot = 1
                    }
                }

                if (this.screwshot == 1) {
                    if(this.shotclock <= 0){
                            this.shot = new ShotFMP(this, this.body.x, this.body.y, 35, this.body.color, (Math.random()-.5)*this.punchspeed*4, (Math.random()-.5)*this.punchspeed*4)
                            this.shot.bomb = 1
                            this.shots.push(this.shot)
                            // this.body.ymom += 8
                            this.shotclock = 50
                            if(this.shots.length > 5){
                                this.shots.splice(0,1)
                            }
                    }
                }
                if (this.downspike == 1) {    if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored <= 0) {
                                this.righthand.fired = 19
                                let armlink1 = new LineOP(this.righthand, this.body)
                                let armlink1dis = armlink1.hypotenuse()
                                let armlink1angle = armlink1.angle()
                                this.righthand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.righthand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.rightshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                                this.rightshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored <= 0) {

                                this.lefthand.fired = 19
                                let armlink1 = new LineOP(this.lefthand, this.body)
                                let armlink1dis = armlink1.hypotenuse()
                                let armlink1angle = armlink1.angle()
                                this.lefthand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.lefthand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.leftshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                                this.leftshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15

                                this.idify()
                            }
                        }
                        if (this.middlehand.fired <= 0) {
                            
                            this.middlehand.fired = 19
                            if (this.middlehand.anchored <= 0) {
                            let armlink1 = new LineOP(this.middlehand, this.body)
                            let armlink1dis = armlink1.hypotenuse()
                            let armlink1angle = armlink1.angle()
                            this.middlehand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.middlehand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.middleshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                            this.middleshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                            this.idify()
                        }
                        }
                        if (this.bananahand.fired <= 0) {
                            if (this.bananahand.anchored <= 0) {
                                this.bananahand.fired = 19
                            let armlink1 = new LineOP(this.bananahand, this.body)
                            let armlink1dis = armlink1.hypotenuse()
                            let armlink1angle = armlink1.angle()
                            this.bananahand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.bananahand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.bananashoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                            this.bananashoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                            this.idify()
                            }
                        }


                }


                // if (this.rightshot == 1) {
                //     //check
                //     if (this.righthand.fired <= 0) {
                //         if (this.face == 1) {
                //             if (this.righthand.anchored == 0) {
                //                 this.righthand.ymom = this.punchspeed * 8
                //                 this.righthand.xmom = this.punchspeed * 19.1
                //                 this.righthand.fired = 19
                //                 this.body.xmom -= 5
                //             }
                //         }
                //     }
                // }
                // if (this.leftshot == 1) {
                //     //check
                //     if (this.lefthand.fired <= 0) {
                //         if (this.face == -1) {
                //             if (this.lefthand.anchored == 0) {
                //                 this.lefthand.ymom = this.punchspeed * 8
                //                 this.lefthand.xmom = this.punchspeed * -19.1
                //                 this.lefthand.fired = 19
                //                 this.body.xmom += 5
                //             }
                //         }
                //     }
                // }

            }

        }
        fightcontrol() {

            if (this.inactive == 1) {
                return
            }
            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()



            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.middlehand.fired--
            this.bananahand.fired--
            this.shotclock--
            this.nograv--
            this.charge--
            if (this.charge <= 0) {
                this.charge = 0
            }
            this.body.fired -= 1
            this.lefthand.fired--


            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            this.breaktimer--
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }

            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {


                    if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {
                        if(this.middlehand.fired <= 0){
                            if(this.middlehand.anchored <= 0){
                            this.middlehand.fired = 19
                            this.middlehand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.bananahand.fired <= 0){
                            if(this.bananahand.anchored <= 0){
                            this.bananahand.fired = 19
                            this.bananahand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.righthand.fired <= 0){
                            if(this.righthand.anchored <= 0){
                            this.righthand.fired = 19
                            this.righthand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                        if(this.lefthand.fired <= 0){
                            if(this.lefthand.anchored <= 0){
                            this.lefthand.fired = 19
                            this.lefthand.xmom = (this.face*this.punchspeed*19)
                                this.idify()
                            }
                        }
                    }

                    if (this.body.fired > 30) {
                        this.body.ymom -= this.body.fired * .008
                    }
                    if (this.screwtimer == 30) {
                        this.body.fired = 30
                        this.body.ymom = 0
                    } else if (this.screwtimer <= 30) {
                        if (this.screwtimer > 0) {
                            this.body.ymom = 0
                        }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {
                        if(this.middlehand.fired <= 0){
                            if(this.middlehand.anchored <= 0){
                            this.middlehand.fired = 19
                            this.middlehand.ymom = (-1*this.punchspeed*15)
                                this.idify()
                            }
                        }
                        if(this.bananahand.fired <= 0){
                            if(this.bananahand.anchored <= 0){
                            this.bananahand.fired = 19
                            this.bananahand.ymom = (-1*this.punchspeed*15)
                                this.idify()
                            }
                        }
                        if(this.righthand.fired <= 0){
                            if(this.righthand.anchored <= 0){
                            this.righthand.fired = 19
                            this.righthand.ymom = (-1*this.punchspeed*15)
                                this.idify()
                            }
                        }
                        if(this.lefthand.fired <= 0){
                            if(this.lefthand.anchored <= 0){
                            this.lefthand.fired = 19
                            this.lefthand.ymom = (-1*this.punchspeed*15)
                                this.idify()
                            }
                        }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored <= 0) {
                                this.righthand.fired = 19
                                let armlink1 = new LineOP(this.righthand, this.body)
                                let armlink1dis = armlink1.hypotenuse()
                                let armlink1angle = armlink1.angle()
                                this.righthand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.righthand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.rightshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                                this.rightshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored <= 0) {

                                this.lefthand.fired = 19
                                let armlink1 = new LineOP(this.lefthand, this.body)
                                let armlink1dis = armlink1.hypotenuse()
                                let armlink1angle = armlink1.angle()
                                this.lefthand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.lefthand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                                this.leftshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                                this.leftshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15

                                this.idify()
                            }
                        }
                        if (this.middlehand.fired <= 0) {
                            
                            this.middlehand.fired = 19
                            if (this.middlehand.anchored <= 0) {
                            let armlink1 = new LineOP(this.middlehand, this.body)
                            let armlink1dis = armlink1.hypotenuse()
                            let armlink1angle = armlink1.angle()
                            this.middlehand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.middlehand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.middleshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                            this.middleshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                            this.idify()
                        }
                        }
                        if (this.bananahand.fired <= 0) {
                            if (this.bananahand.anchored <= 0) {
                                this.bananahand.fired = 19
                            let armlink1 = new LineOP(this.bananahand, this.body)
                            let armlink1dis = armlink1.hypotenuse()
                            let armlink1angle = armlink1.angle()
                            this.bananahand.xmom += ((Math.cos(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.bananahand.ymom += ((Math.sin(armlink1angle)*armlink1dis)/armlink1dis) * this.punchspeed * 14
                            this.bananashoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
                            this.bananashoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15
                            this.idify()
                            }
                        }


                    }

                }
            }

            if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
               if(this.shotclock <= 0){
                this.shot = new ShotFMP(this, this.body.x, this.body.y, 35, this.body.color, (Math.random()-.5)*this.punchspeed*4, (Math.random()-.5)*this.punchspeed*4)
                            this.shot.bomb = 1
                            this.shots.push(this.shot)
                            // this.body.ymom += 8
                            this.shotclock = 50
                            if(this.shots.length > 5){
                                this.shots.splice(0,1)
                            }
               }
            }
        }
        degripl() {

            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                        this.lefthand.anchored = -10
                        this.middlehand.anchored = -10
                        this.bananahand.anchored = -10
                        this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }else if (this.middlehand.anchored == 1) {

                        if (this.body.ymom > 0) {
                            this.body.ymom = 0
                        }
                        this.body.ymom -= this.speed
                        this.lefthand.anchored = -10
                        this.middlehand.anchored = -10
                        this.bananahand.anchored = -10
                        this.righthand.anchored = -10
                        for (let t = 0; t < this.springs.length; t++) {
                            this.springs[t].balance()
                        }
                        for (let t = 0; t < this.nodes.length; t++) {
                            this.nodes[t].move(this)
                        }
                        }else if (this.bananahand.anchored == 1) {

                                if (this.body.ymom > 0) {
                                    this.body.ymom = 0
                                }
                                this.body.ymom -= this.speed
                                this.lefthand.anchored = -10
                                this.middlehand.anchored = -10
                                this.bananahand.anchored = -10
                                this.righthand.anchored = -10
                                for (let t = 0; t < this.springs.length; t++) {
                                    this.springs[t].balance()
                                }
                                for (let t = 0; t < this.nodes.length; t++) {
                                    this.nodes[t].move(this)
                                }
                                }else if (this.righthand.anchored == 1) {

                                if (this.body.ymom > 0) {
                                    this.body.ymom = 0
                                }
                                this.body.ymom -= this.speed
                                this.lefthand.anchored = -10
                                this.middlehand.anchored = -10
                                this.bananahand.anchored = -10
                                this.righthand.anchored = -10
                                for (let t = 0; t < this.springs.length; t++) {
                                    this.springs[t].balance()
                                }
                                for (let t = 0; t < this.nodes.length; t++) {
                                    this.nodes[t].move(this)
                                }
                                }


        }
        degripr() {

            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

            if (this.body.ymom > 0) {
                this.body.ymom = 0
            }
            this.body.ymom -= this.speed
            this.lefthand.anchored = -10
            this.righthand.anchored = -10
                this.middlehand.anchored = -10
                this.bananahand.anchored = -10
            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].balance()
            }
            for (let t = 0; t < this.nodes.length; t++) {
                this.nodes[t].move(this)
            }
            }else if (this.middlehand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.middlehand.anchored = -10
                this.bananahand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
                }else if (this.bananahand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.middlehand.anchored = -10
                this.bananahand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
                }else if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.middlehand.anchored = -10
                this.bananahand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
                }


        }
        collideStage() {

            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {

            if (this.inactive == 1) {
                return
            }



            // for (let t = 0; t < this.shots.length; t++) {
            //         if(this.shots[t].bomb == 1){
            //             let link = new LineOP(this.body, this.shots[t], this.body.color, 3)
            //             link.width = Math.min(Math.max(1000/link.hypotenuse(), 1),15)
            //             if(link.hypotenuse() < 400){
            //                 link.draw()
            //             }
            //         }
            // }


            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.body.anchored = 0
            // this.middlehand.anchored = 0
            // this.bananahand.anchored = 0
            this.blasting--
            if (this.grounded == 1) {
                if (this.screwtimer > 5) {
                    this.screwangle = 0
                    this.screwtimer = 0
                    // this.body.fired = 5
                }
            }
            this.grounded = 0
            this.frame++

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.shots.length; t++) {
               


                    if (typeof this.shots[t].gravity == "number") {
                        if (this.shots[t].ymom > -(vsmashlimit / 1.15)) {
                            this.shots[t].ymom += this.shots[t].gravity / 1.2
                            this.shots[t].radius -= .5
                            if (this.shots[t].radius < 10) {
                                this.shots[t].radius = 10
                            }
                        } else {
                            this.shots[t].marked = 1
                        }
                    }
                    if (typeof this.shots[t].countdown == "number") {
                        this.shots[t].countdown--
                        this.shots[t].gravity = Math.cos(this.shots[t].countdown * (Math.PI / 4)) * 20
                        if (this.shots[t].countdown <= 0) {
                            this.shots[t].marked = 1
                        }
                    }
                    if(this.shots[t].life > 0){
                        this.shots[t].move()
                    }

                    this.detonate = 0
                    if(this.shots[t].bomb == 1) {
                    for(let h = 0;h<boys.length;h++){
                        if(boys[h] != this){
                            let link = new LineOP(this.shots[t], boys[h].body, this.shots[t].color, 8)
                            if(link.hypotenuse() < 400){
                                this.detonate = 1
                                link.draw()
                            }

                                for(let r = 0;r<boys[h].shots.length;r++){

                                    let link = new LineOP(this.shots[t], boys[h].shots[r], this.shots[t].color, 8)
                                        if(link.hypotenuse() < 300){
                                            this.detonate = 1
                                            link.draw()
                                        }
                                }

                                if(boys[h].hasOwnProperty('radball')){
                                    let link = new LineOP(this.shots[t], boys[h].radball, this.shots[t].color, 8)
                            if(link.hypotenuse() < 300){
                                this.detonate = 1
                                link.draw()
                            }
                                }

                        }
                    }
                }
                    if (this.detonate == 1 && this.shots[t].bomb == 1) {
                                const angle = Math.PI / 6
                                this.shots[t].marked = 1
                                for (let d = 0; d < 12; d++) {
                                    let bullet = new ShotFP(this.shots[t].x, this.shots[t].y, 13, this.body.color, Math.cos(angle * d) * 31, Math.sin(angle * d) * 31)
                                    bullet.life = 13
                                    this.shots.push(bullet)
                                }
                            }
                    if (this.shots[t].marked <= 0) {
                        this.shots[t].draw()
                    }

                    this.shots[t].life--
                    if (this.shots[t].life <= 0) {
                        this.shots[t].marked = 1
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {



                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].draw()
                        }
                    }
                }
            }

            for (let j = 0; j < 10; j++) {
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked == 1) {
                        this.shots.splice(t, 1)
                    } else {
                        this.shots[t].marked--
                    }
                }
            }
            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.middlearm = new LineOP(this.middleshoulder, this.middlehand, invertColor(this.body.color), 8)
            this.bananarm = new LineOP(this.bananashoulder, this.bananahand, invertColor(this.body.color), 8)
            this.collideStage()
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].color = invertColor(this.body.color)
                this.links[t].draw()
            }
            for (let t = 0; t < this.nodes.length; t++) {
                this.nodes[t].draw()
                if (this.nodes[t] == this.body) {
                    const link = new Line(this.body.x, this.body.y, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y + Math.sin(this.screwangle), invertColor(this.body.color), this.body.radius * .2)
                    // canvas_context.lineWidth = this.strokeWidth
                    // canvas_context.strokeStyle = "#000000"
                    // canvas_context.beginPath();
                    // canvas_context.arc(((link.x1 + link.x2 + this.body.x) * (1 / 3)) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .35, (this.screwangle * this.face) + (this.face / 2), (Math.PI * 1) + (this.screwangle * this.face) + (this.face / 2), true)
                    // canvas_context.fillStyle = "#00FF00"
                    // canvas_context.fill()
                    // canvas_context.stroke();
                    // canvas_context.lineWidth = this.strokeWidth
                    // canvas_context.strokeStyle = "#000000"
                    // canvas_context.beginPath();
                    // canvas_context.arc(((link.x1 + link.x2 + this.body.x) * (1 / 3)) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .35, (this.screwangle * this.face) + (this.face / 2), (Math.PI * 1) + (this.screwangle * this.face) + (this.face / 2), false)
                    // canvas_context.fillStyle = "#00FF00"
                    // canvas_context.fill()
                    // canvas_context.stroke();


                    canvas_context.fillStyle = invertColor(this.body.color)
                    let x = ((link.x1 + link.x2 + this.body.x) * (1 / 3)) - ((this.body.radius * .6) * (this.face))
                    if (this.face == 1) {
                        x += this.body.radius * .89
                    }
                    if (this.face == -1) {
                        x -= this.body.radius * .89
                    }
                    canvas_context.fillRect(x - 11.5, (link.y1 - this.body.radius * .18) - 11.5, 23.5, this.body.radius*.36)
                    canvas_context.fillStyle = (this.body.color)
                    canvas_context.fillRect(x - 6.5, (link.y1 - this.body.radius * .1) - 6.5, 14,  this.body.radius*.2)
                }
            }

            // if (this.controller == 0) {

            // if (this.screwangle == 0) {
            //     link.draw()
            // }
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.middlehand)).hypotenuse(), (new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.middlehand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
            canvas_context.font = "42px arial"
            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 200)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 75)
            canvas_context.fillStyle = "white"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 110)
            }
            if (this.shotdraw == 1) {
                if (this.face == 1) {
                    this.shot = new Shot(this.righthand.x, this.righthand.y, this.charge * .54, "#00FF00", this.speed * 2, 0)
                } else {
                    this.shot = new Shot(this.lefthand.x, this.lefthand.y, this.charge * .54, "#00FF00", this.speed * 2, 0)
                }
                if (this.face == 1) {
                    this.shot2 = new Shot(this.middlehand.x, this.middlehand.y, this.charge2 * .40, "#00FF00", this.speed * 2, 0)
                } else {
                    this.shot2 = new Shot(this.bananahand.x, this.bananahand.y, this.charge2 * .40, "#00FF00", this.speed * 2, 0)
                }

                if (this.charge > 80) {
                    this.shot.color = "#FFFF00"
                }

                if (this.charge2 > 95) {
                    this.shot2.color = "#FFFF00"
                }

                this.shot.draw()
                this.shot2.draw()
            }
        }
        operate() {

            if (this.inactive == 1) {
                return
            }

            this.armAngle += this.armspin*this.face
            // if (this.righthand.anchored == 1) { // disabled for spin?
            //     if (this.body.x > this.righthand.x) {
            //         this.righthand.anchored = -10
            //     }
            // }
            // if (this.lefthand.anchored == 1) {
            //     if (this.body.x < this.lefthand.x) {
            //         this.lefthand.anchored = -10
            //     }
            // }




            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1 && this.middlehand.anchored != 1 && this.bananahand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {
            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }
                    if (this.middlehand.anchored == 0) {
                    this.playerMove(this.middlehand, this.speed, this.gamepad)
                    }

                    if (this.bananahand.anchored == 0) {
                    this.playerMove(this.bananahand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }

                    if (this.middlehand.anchored == 0) {
                    this.AImove(this.middlehand, this.speed, this.gamepad)
                    }

                    if (this.bananahand.anchored == 0) {
                    this.AImove(this.bananahand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            }
            // }
            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1 || this.middlehand.anchored == 1 || this.bananahand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.righthand.anchored = -10
                    this.bananahand.anchored = -10
                    this.middlehand.anchored = -10

                    this.body.ymom *= .1
                    this.body.symom = this.leftshoulder.ymom * .99
                this.body.ymom -= this.gravity*2
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.bananahand.anchored = -10
                    this.middlehand.anchored = -10
                    this.lefthand.anchored = -10
                    this.body.ymom *= .1
                    this.body.symom = this.rightshoulder.ymom * .99
                this.body.ymom -= this.gravity*2
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else if (this.middlehand.anchored == 1) {
                    this.body.ymom *= .1
                    this.righthand.anchored = -10
                    this.bananahand.anchored = -10
                    this.lefthand.anchored = -10
                    this.body.symom = this.middleshoulder.ymom * .99
                this.body.ymom -= this.gravity*2
                    this.body.sxmom = this.middleshoulder.xmom * .99
                } else if (this.bananahand.anchored == 1) {
                    this.body.ymom *= .1
                    this.righthand.anchored = -10
                    this.lefthand.anchored = -10
                    this.middlehand.anchored = -10

                this.body.ymom -= this.gravity*2
                    this.body.symom = this.bananashoulder.ymom * .99
                    this.body.sxmom = this.bananashoulder.xmom * .99 //bananananananananana
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     // this.body.sxmom *= 0
                    //     this.body.xmom *= .5
                    // }
                this.body.ymom += this.gravity
                }
            } else {
                    this.righthand.anchored = -5
                    this.lefthand.anchored = -5
                    this.middlehand.anchored = -5
                    this.bananahand.anchored = -5
                if (this.pounding == 1) {
                    this.pounding = 0
                    const shot1 = new ShotC(this.body.x, this.body.y + this.body.radius, 21, "#00FF00", this.speed * 2, 0)
                    shot1.life = 50
                    const shot2 = new ShotC(this.body.x, this.body.y + this.body.radius, 21, "#00FF00", - this.speed * 2, 0)
                    shot2.life = 50
                    this.shots.push(shot1)
                    this.shots.push(shot2)
                }

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            }
            if (this.bananahand.anchored <= -1) {
                this.bananahand.anchored++
            }
            if (this.middlehand.anchored <= -1) {
                this.middlehand.anchored++
            }
            if (this.nograv <= 0) {
                // this.righthand.ymom += this.gravity
                // this.lefthand.ymom += this.gravity
                // this.middlehand.ymom += this.gravity
                // this.bananahand.ymom += this.gravity
            } else {
                //////////////////////////////////console.log("hum")
                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            this.body.xmom *= .99
            this.body.ymom *= .99


            for (let t = 0; t < this.shots.length; t++) {
                    if(this.shots[t].bomb == 1){
                        let link = new LineOP(this.body, this.shots[t], this.body.color, 3)
                        link.width = Math.min(Math.max(1000/link.hypotenuse(), 1),15)
                        if(link.hypotenuse() <= 400){
                            this.body.ymom-=(this.punchspeed*.07)
                            this.body.xmom*=.99
                        }
                    }
            }

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].frictiveMove(this)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].smove(this)
                }
            }
            // this.lefthand.xmom += (this.lefthand.x - this.body.x) / 40
            // this.righthand.xmom += (this.righthand.x - this.body.x) / 40
            // this.middlehand.ymom += (this.middlehand.y - this.body.y) / 18
            // this.middlehand.xmom += (this.middlehand.x - this.body.x) / 20
            // this.bananahand.ymom += (this.bananahand.y - this.body.y) / 18
            // this.bananahand.xmom += (this.bananahand.x - this.body.x) / 20
            // this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            // this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40

            let armlink1 = new LineOP(this.lefthand, this.body)
            let armlink1dis = armlink1.hypotenuse()
            let armlink1angle = armlink1.angle()
            this.lefthand.xmom += (Math.cos(armlink1angle)*armlink1dis)*.05
            this.lefthand.ymom += (Math.sin(armlink1angle)*armlink1dis)*.05
            this.leftshoulder.xmom = ((Math.cos(armlink1angle)*armlink1dis)*.15)-(((Math.cos(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.leftshoulder.ymom = ((Math.sin(armlink1angle)*armlink1dis)*.15)-(((Math.sin(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.leftshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
            this.leftshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15

            armlink1 = new LineOP(this.righthand, this.body)
            armlink1dis = armlink1.hypotenuse()
            armlink1angle = armlink1.angle()
            this.righthand.xmom += (Math.cos(armlink1angle)*armlink1dis)*.05
            this.righthand.ymom += (Math.sin(armlink1angle)*armlink1dis)*.05
            this.rightshoulder.xmom = ((Math.cos(armlink1angle)*armlink1dis)*.15)-(((Math.cos(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.rightshoulder.ymom = ((Math.sin(armlink1angle)*armlink1dis)*.15)-(((Math.sin(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.rightshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
            this.rightshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15

            armlink1 = new LineOP(this.bananahand, this.body)
            armlink1dis = armlink1.hypotenuse()
            armlink1angle = armlink1.angle()
            this.bananahand.xmom += (Math.cos(armlink1angle)*armlink1dis)*.05
            this.bananahand.ymom += (Math.sin(armlink1angle)*armlink1dis)*.05
            this.bananashoulder.xmom = ((Math.cos(armlink1angle)*armlink1dis)*.15)-(((Math.cos(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.bananashoulder.ymom = ((Math.sin(armlink1angle)*armlink1dis)*.15)-(((Math.sin(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.bananashoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
            this.bananashoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15

            armlink1 = new LineOP(this.middlehand, this.body)
            armlink1dis = armlink1.hypotenuse()
            armlink1angle = armlink1.angle()
            this.middlehand.xmom += (Math.cos(armlink1angle)*armlink1dis)*.05
            this.middlehand.ymom += (Math.sin(armlink1angle)*armlink1dis)*.05
            this.middleshoulder.xmom = ((Math.cos(armlink1angle)*armlink1dis)*.15)-(((Math.cos(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.middleshoulder.ymom = ((Math.sin(armlink1angle)*armlink1dis)*.15)-(((Math.sin(armlink1angle+this.armspin)*armlink1dis)*.15))
            this.middleshoulder.xmom -= (Math.cos(armlink1angle)*armlink1dis)*.15
            this.middleshoulder.ymom -= (Math.sin(armlink1angle)*armlink1dis)*.15




            // this.middleshoulder.ymom -= (this.middleshoulder.y - this.body.y) / 40
            // this.middleshoulder.xmom += (this.middleshoulder.x - this.body.x) / 40
            this.fixupshoulder()

            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            if (boys.indexOf(this) <= humanPlayers) {

                // this.AI()
                this.fightcontrol()
            } else {
                this.AI()
            }
            // }
            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }

        }
    }



    class Bunkstanks {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                this.ping = 0
                this.shotclock = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 1
                this.serverID = serverID
                this.shotdraw = 0
                this.id = controller //boys.length
                this.shielddraw = 0
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 85
                if(minigameSelected == 6){
                    this.jumpreduction = 65
                }
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shot = {}
                this.striker = 10000
                this.name = "Funky Bunkstanks"
                this.blasting = 0
                this.recovering = 0
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.storeshield = 0
                this.face = 0
                this.shots = []
                this.wasfalse = []
                this.controller = controller
                this.armlength = 45
                this.shoulderwidth = 18
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 9.5
                this.punchspeed = 6.5
                this.grounded = 0
                this.frame = 0
                this.jumping = 1
                this.jumpcount = 100

                this.color = getRandomColor()
                this.body = new ShotF(400 + (Math.random() * 2560), 500, 60, this.color)

                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.nodes.push(this.body)
                this.leftshoulder = new ShotE(this.body.x - (this.body.radius + this.shoulderwidth), 350, 10, "magenta", 0, 0, .999)
                this.rightshoulder = new ShotE(this.body.x + (this.body.radius + this.shoulderwidth), 350, 10, "#FF0000", 0, 0, .999)
                this.lefthand = new ShotE(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 27, "magenta", 0, 0, .85) //26
                this.righthand = new ShotE(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 27, "#FF0000", 0, 0, .85) //26
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.gravity = 1.3
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = 0
                this.bodyx = this.body.x
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {
                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]

                    // const keys2 = Object.keys(args[keys[t]])
                    // // if(keys2.length > 1){
                    //     for(let j = 0; j<keys2.length;j++){
                    //     this[keys[t]][keys2[j]] = args[keys[t]][keys2[j]]
                    //  }
                }
                // ////////////// ////////////////////////////////////////////console.log(args)
                this.armlength = 45
                this.shoulderwidth = 18
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                // //////////// ////////////////////////////////////////////console.log(this.shotdraw)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    if (t == 0) {
                        this.nodes[t] = new ShotF(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired, this.nodes[t].angle)
                    } else {
                        this.nodes[t] = new ShotE(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)
                    }
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }
                    this.nodes[t].id = idsto
                }

                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                    this.shots[t] = new ShotE(this.shots[t].x, this.shots[t].y, this.shots[t].radius, this.shots[t].color, this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                    this.shots[t].id = idsto

                }
                this.id = args["id"]
                this.frame = args['frame']
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }
                this.rightshoulder = this.nodes[2]
                this.leftshoulder = this.nodes[1]
                this.righthand = this.nodes[3]
                this.lefthand = this.nodes[4]

                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }
            }
        }

        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            object.ymom = -this.speed * 1 * 4
                        } else {
                            if (this.lefthand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                            if (this.righthand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 4
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            const copy = new Bunkstanks(this.controller)
            copy.id = this.id
            copy.frame = this.frame
            copy.body.color = this.body.color
            if (this.inactive == 1) {
                copy.inactive = 1
            } copy.serverID = this.serverID
            copy.striker = this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

            return copy
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }

            this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            this.leftshoulder.y = this.body.y - (this.shoulderwidth * 0)

            this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            this.rightshoulder.y = this.body.y - (this.shoulderwidth * 0)

            this.leftshoulder.color = this.body.color
            this.rightshoulder.color = this.body.color
            this.lefthand.color = this.body.color
            this.righthand.color = this.body.color


            if (this.lefthand.anchored == 0) {
                this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth)))
                this.lefthand.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth * 0))
                this.leftshoulder.xmom *= 0
                this.leftshoulder.ymom *= 0
            }
            if (this.righthand.anchored == 0) {
                this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth)))
                this.righthand.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth * 0))
                this.rightshoulder.xmom *= 0
                this.rightshoulder.ymom *= 0
            }

            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }



            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2
                this.lefthand.ymom = -this.speed * 2
                this.righthand.ymom = -this.speed * 2
                this.jumpcount = 100

            }
        }

        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (this.shield == 1) {
                                            this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                        } else {
                                            this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 200)) + (boys[t].shots[k].xmom * baselaunch)) * 2
                                            this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 200)) + (boys[t].shots[k].ymom * baselaunch)) * 2) - (10 * (this.damage / 200))
                                            this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                            this.breaktimer = 0
                                        }
                                        boys[t].shots[k].marked = 1
                                    }
                                }
                            }


                            if (boys[t].hasOwnProperty('radball')) {
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }

                            const enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }


                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 200)) + (boys[t].bananahand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 200)) + (boys[t].bananahand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 200)) + (boys[t].middlehand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 200)) + (boys[t].middlehand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 200)) + (boys[t].righthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 200)) + (boys[t].righthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14

                                            this.shotIDs.push(boys[t].righthand2.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 200)) + (boys[t].lefthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 200)) + (boys[t].lefthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 200)) + (boys[t].righthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 200)) + (boys[t].righthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 200)) + (boys[t].lefthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 200)) + (boys[t].lefthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)

                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }

                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 200)) + (boys[t].righthand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 200)) + (boys[t].righthand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].lefthand.fired > 14) {
                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)
                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            } else {
                                                this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 200)) + (boys[t].lefthand.xmom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 200)) + (boys[t].lefthand.ymom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)) * 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }

                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 200)) + (boys[t].body.xmom * baselaunch) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].body.ymom * (this.damage / 200)) + (boys[t].body.ymom * baselaunch)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        this.fixupshoulder()
                        boys[f].fixupshoulder()
                        this.body.ymom *= .99
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        doJump(object, speed) {

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    if(minigameSelected == 6){
                    if(-speed * 2 < object.ymom){
                    this.jumping = 1
                    object.ymom = -speed * 2
                    this.jumpcount = 100 - this.jumpreduction
                    }
                    }else{
                    this.jumping = 1
                    object.ymom = -speed * 2
                    this.jumpcount = 100 - this.jumpreduction
                    }
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {

                    if(minigameSelected == 6){
                        if(-this.speed * 1 * 2 < object.ymom){
                        object.ymom = -this.speed * 1 * 2
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                        }
                    }else{

                        object.ymom = -this.speed * 1 * 2
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                    }
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {
            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            this.jumpcount--
            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }
            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }
        fightcontrol() {
            if (this.inactive == 1) {
                return
            }

            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()
            this.righthand.fired--
            this.lefthand.fired--
            this.shotclock--
            this.breaktimer--
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }


            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                    if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {
                        if (this.face == 1) {
                            if (this.righthand.fired <= 0) {
                                if (this.righthand.anchored == 0) {
                                    this.righthand.ymom = -this.punchspeed * 7
                                    this.righthand.xmom = this.punchspeed * 14
                                    this.righthand.fired = 19
                                    if (this.lefthand.fired <= 0) {
                                        this.lefthand.ymom = -((Math.random() * 10) + 8) * this.punchspeed
                                        if (Math.random() < .5) {
                                            this.lefthand.ymom *= -1
                                        }
                                        this.lefthand.xmom = -((Math.random() * 10) + 8) * this.punchspeed
                                        this.lefthand.fired = 19
                                    }
                                    this.idify()
                                }
                            }
                        }
                        if (this.face == -1) {
                            if (this.lefthand.fired <= 0) {
                                if (this.lefthand.anchored == 0) {
                                    this.lefthand.ymom = -this.punchspeed * 7
                                    this.lefthand.xmom = -this.punchspeed * 14
                                    this.lefthand.fired = 19
                                    if (this.righthand.fired <= 0) {
                                        this.righthand.ymom = -((Math.random() * 10) + 8) * this.punchspeed
                                        if (Math.random() < .5) {
                                            this.righthand.ymom *= -1
                                        }
                                        this.righthand.xmom = ((Math.random() * 10) + 8) * this.punchspeed
                                        this.righthand.fired = 19
                                    }
                                    this.idify()
                                }
                            }
                        }
                    }


                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.righthand.ymom = -this.punchspeed * 21
                                this.righthand.xmom = this.punchspeed * -1
                                this.righthand.fired = 19
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.lefthand.ymom = -this.punchspeed * 21
                                this.lefthand.xmom = -this.punchspeed * -1
                                this.lefthand.fired = 19
                                this.idify()
                            }
                        }
                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {
                        if (this.grounded != 1) {
                            if (this.lefthand.fired <= 0) {
                                if (this.lefthand.anchored == 0) {
                                    this.body.ymom -= this.speed / 4
                                }
                            }
                            if (this.righthand.fired <= 0) {
                                if (this.righthand.anchored == 0) {
                                    this.body.ymom -= this.speed / 4
                                }
                            }

                            if (this.righthand.fired <= 0) {
                                if (this.righthand.anchored == 0) {
                                    this.rightshoulder.xmom = 0
                                    this.rightshoulder.ymom = 0
                                    this.righthand.ymom = (this.punchspeed * 21) + this.body.ymom * 2
                                    this.righthand.xmom = this.punchspeed * -2
                                    this.righthand.fired = 19
                                    this.idify()
                                }
                            }
                            if (this.lefthand.fired <= 0) {
                                if (this.lefthand.anchored == 0) {
                                    this.leftshoulder.xmom = 0
                                    this.leftshoulder.ymom = 0
                                    this.lefthand.ymom = (this.punchspeed * 21) + this.body.ymom * 2
                                    this.lefthand.xmom = -this.punchspeed * -2
                                    this.lefthand.fired = 19
                                    this.idify()
                                }
                            }

                        } else {

                            if (this.lefthand.fired <= 0) {
                                if (this.lefthand.anchored == 0) {
                                    this.body.ymom -= this.speed * 2
                                    this.jumping = 1
                                }
                            }
                            if (this.righthand.fired <= 0) {
                                if (this.righthand.anchored == 0) {
                                    this.body.ymom -= this.speed * 2
                                    this.jumping = 1
                                }
                            }

                            if (this.righthand.fired <= 0) {
                                if (this.righthand.anchored == 0) {
                                    this.rightshoulder.xmom = 0
                                    this.rightshoulder.ymom = 0
                                    this.righthand.ymom = -(this.punchspeed * 21) + this.body.ymom * 2
                                    this.righthand.xmom = this.punchspeed * 4
                                    this.righthand.fired = 19
                                    this.idify()
                                }
                            }
                            if (this.lefthand.fired <= 0) {
                                if (this.lefthand.anchored == 0) {
                                    this.leftshoulder.xmom = 0
                                    this.leftshoulder.ymom = 0
                                    this.lefthand.ymom = -(this.punchspeed * 21) + this.body.ymom * 2
                                    this.lefthand.xmom = -this.punchspeed * 4
                                    this.lefthand.fired = 19
                                    this.idify()
                                }
                            }


                        }
                    }


                    if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
                        if (this.shotclock <= 0) {
                            this.shot = new ShotE(this.body.x, this.body.y, 25, "#FFAAAA", 0, -(this.speed * 3.5))
                            this.shot.gravity = 1.5
                            this.shot.accum = 0
                            this.shots.push(this.shot)
                            this.body.ymom += 8
                            this.shotclock = 30

                        }
                    }
                }
            }
        }

        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                this.fleeing = 1
            }
            if (this.charge > 90) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }

            this.recovering = 0

            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + Math.max(this.body.radius, boys[t].body.radius))) {
                        this.wmove = 1
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        if (Math.random() < .2) {
                            this.wmove = 1
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }

            this.recovering = 0

            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }

            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    this.downspike = 1
                    this.wmove = 1
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    this.downspike = 1
                }
            }
            this.exgrip = 0
            for (let t = 0; t < boys.length; t++) {
                if (this.amomu <= 0 && this.dmomu <= 0) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].brick.center.y > this.brick.center.y) {
                            if (boys[t].body.x < this.body.x) {
                                this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                this.amomu += 15
                                this.exgrip = 1
                            } else {
                                this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                this.dmomu += 15
                                this.exgrip = 1
                            }
                        }
                    }
                } else {
                    this.exgrip = 1
                }
            }





            if (this.dmom > 0) {
                this.screwshot = 1
                this.dmove = 1
                this.wmove = 1
                this.amove = 0
                this.amom = 0
            } else {

                if (this.dmomu > 0) {
                    this.dmove = 1
                    this.amove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }
            if (this.amom > 0) {
                this.screwshot = 1
                this.dmom = 0
                this.amove = 1
                this.wmove = 1
                this.dmove = 0
            } else {
                if (this.amomu > 0) {
                    this.amove = 1
                    this.dmove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }

            if (this.safe == 0) {
                this.downspike = 1
                if (this.body.x > (this.brick.center.x)) {
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                } else {
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }


            if (this.trapped == 0) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]
                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        const runtimeR = xdisR / this.speed
                                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .8)) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.downspike = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        const runtimeL = xdisL / this.speed
                                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .8)) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.downspike = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }
                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        const runtimeR = xdisR / this.speed
                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .87)) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.downspike = 1
                                this.wmove = 1
                            }
                        }
                    } else {
                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        const runtimeL = xdisL / this.speed
                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .87)) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.downspike = 1
                                this.wmove = 1
                            }
                        }
                    }

                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }

            if (this.body.y < 900) {
                this.wmove = 0
                this.downspike = 0
            }
            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }



                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1

                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }


                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }

                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 4 // was 2for some reason
                    } else {
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                    }
                }
                if (this.dmove == 1) {
                    this.face = 1
                    if (object == this.body) {
                        object.x += speed
                        this.righthand.x += speed
                        this.lefthand.x += speed
                    }
                    if (this.righthand.anchored == 1) {
                        this.degripr()
                        this.jumping = 1
                    }
                }
                if (this.amove == 1) {
                    this.face = -1
                    if (object == this.body) {
                        object.x -= speed
                        this.righthand.x -= speed
                        this.lefthand.x -= speed
                    }
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        this.degripl()
                        this.jumping = 1
                    }
                }
                if (this.exgrip == 1) {
                    this.righthand.anchored = 0
                    this.lefthand.anchored = 0
                }
            }
        }
        AI() {
            this.idify()
            if (this.inactive == 1) {
                return
            }

            this.breaks()
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].marked == 1) {
                    this.shots.splice(t, 1)
                } else {
                    this.shots[t].marked--
                }
            }

            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }



            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.rightshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {


                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if (link.hypotenuse() + (this.body.radius + boys[t].shots[g].radius) / (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) < 40) {
                            this.storeshield = 1
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 60 && this.body.y < boys[t].body.y) {
                        this.downspike = 1
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y > boys[t].body.y && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {
                        this.hortsmash = 1
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < boys[t].body.radius && this.body.y > boys[t].body.y) {
                        this.screwshot = 1
                    } else if (this.body.y - boys[t].body.y > 100) {
                        if (Math.random() < .01) {
                            this.downspike = 1
                        }
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == 1) {
                                this.hortsmash = 1
                            }
                        }
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == -1) {
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .09) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < boys[t].body.radius && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                if (Math.abs(this.body.x - boys[t].body.x) < 570) {
                                    this.leftshot = 1
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.leftshot = 0
                                    }
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < boys[t].body.radius && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                if (Math.abs(this.body.x - boys[t].body.x) < 570) {
                                    this.rightshot = 1
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.rightshot = 0
                                    }
                                }
                            }
                        }
                    }


                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }

            if (this.safe == 0) {
                if (this.recovering == 1) {
                    this.downspike = 1
                }
            }

            this.breaks()
            this.righthand.fired--
            this.lefthand.fired--
            this.shotclock--
            this.breaktimer--
            if (Math.random() < .1) {
                this.storeshield = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .94) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (boys[t].lefthand.fired > 14) {
                        if (this.body.x < boys[t].body.x) {
                            if (Math.random() < .94) {
                                this.storeshield = 1
                            }
                        }
                    }
                }
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (this.grounded == 1) {
                                if (boys[t].shots[g].stuck != 1) {
                                    this.storeshield = 1
                                } else {
                                    this.wmove = 1
                                }
                            } else {
                                if (this.body.x < boys[t].shots[g].x) {
                                    if (this.amom <= 0 && this.dmom <= 0) {
                                        this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                        this.amove = 1
                                        this.dmove = 0
                                    }
                                } else {
                                    if (this.amom <= 0 && this.dmom <= 0) {
                                        this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                        this.amove = 0
                                        this.dmove = 1
                                    }
                                }
                            }
                            break
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].shots[g].x) {
                                            if (this.amom <= 0 && this.dmom <= 0) {
                                                this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                this.amove = 1
                                                this.dmove = 0
                                            }
                                        } else {
                                            if (this.amom <= 0 && this.dmom <= 0) {
                                                this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                this.amove = 0
                                                this.dmove = 1
                                            }
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        this.wmove = 1
                                        // this.screwshot = 1
                                    }
                                }
                            }
                        }
                    }
                }
            }

            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        this.shieldpower -= .63
                        this.shield = 1
                        this.shielddraw = 1
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }

            if (this.breaktimer <= 0 && this.shield == 0) {


                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                    if (this.leftshot == 1 || this.rightshot == 1) {
                        if (this.face == 1) {
                            if (this.righthand.fired <= 0) {
                                if (this.righthand.anchored == 0) {
                                    this.righthand.ymom = -this.punchspeed * 7
                                    this.righthand.xmom = this.punchspeed * 14
                                    this.righthand.fired = 19
                                    if (this.lefthand.fired <= 0) {
                                        this.lefthand.ymom = -((Math.random() * 10) + 8) * this.punchspeed
                                        if (Math.random() < .5) {
                                            this.lefthand.ymom *= -1
                                        }
                                        this.lefthand.xmom = -((Math.random() * 10) + 8) * this.punchspeed
                                        this.lefthand.fired = 19
                                    }
                                    this.idify()
                                }
                            }
                        }
                        if (this.face == -1) {
                            if (this.lefthand.fired <= 0) {
                                if (this.lefthand.anchored == 0) {
                                    this.lefthand.ymom = -this.punchspeed * 7
                                    this.lefthand.xmom = -this.punchspeed * 14
                                    this.lefthand.fired = 19
                                    if (this.righthand.fired <= 0) {
                                        this.righthand.ymom = -((Math.random() * 10) + 8) * this.punchspeed
                                        if (Math.random() < .5) {
                                            this.righthand.ymom *= -1
                                        }
                                        this.righthand.xmom = ((Math.random() * 10) + 8) * this.punchspeed
                                        this.righthand.fired = 19
                                    }
                                    this.idify()
                                }
                            }
                        }
                    }


                    if (this.hortsmash == 1) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.righthand.ymom = -this.punchspeed * 21
                                this.righthand.xmom = this.punchspeed * -1
                                this.righthand.fired = 19
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.lefthand.ymom = -this.punchspeed * 21
                                this.lefthand.xmom = -this.punchspeed * -1
                                this.lefthand.fired = 19
                                this.idify()
                            }
                        }
                    }

                    if (this.downspike == 1) {
                        if (this.grounded != 1) {

                            if (this.lefthand.fired <= 0) {
                                if (this.lefthand.anchored == 0) {
                                    this.body.ymom -= this.speed / 4
                                }
                            }
                            if (this.righthand.fired <= 0) {
                                if (this.righthand.anchored == 0) {
                                    this.body.ymom -= this.speed / 4
                                }
                            }

                            if (this.righthand.fired <= 0) {
                                if (this.righthand.anchored == 0) {
                                    this.rightshoulder.xmom = 0
                                    this.rightshoulder.ymom = 0
                                    this.righthand.ymom = (this.punchspeed * 21) + this.body.ymom * 2
                                    this.righthand.xmom = this.punchspeed * -2
                                    this.righthand.fired = 19
                                    this.idify()
                                }
                            }
                            if (this.lefthand.fired <= 0) {
                                if (this.lefthand.anchored == 0) {
                                    this.leftshoulder.xmom = 0
                                    this.leftshoulder.ymom = 0
                                    this.lefthand.ymom = (this.punchspeed * 21) + this.body.ymom * 2
                                    this.lefthand.xmom = -this.punchspeed * -2
                                    this.lefthand.fired = 19
                                    this.idify()
                                }
                            }

                        } else {

                            if (this.lefthand.fired <= 0) {
                                if (this.lefthand.anchored == 0) {
                                    this.body.ymom -= this.speed * 2
                                    this.jumping = 1
                                }
                            }
                            if (this.righthand.fired <= 0) {
                                if (this.righthand.anchored == 0) {
                                    this.body.ymom -= this.speed * 2
                                    this.jumping = 1
                                }
                            }

                            if (this.righthand.fired <= 0) {
                                if (this.righthand.anchored == 0) {
                                    this.rightshoulder.xmom = 0
                                    this.rightshoulder.ymom = 0
                                    this.righthand.ymom = -(this.punchspeed * 21) + this.body.ymom * 2
                                    this.righthand.xmom = this.punchspeed * 4
                                    this.righthand.fired = 19
                                    this.idify()
                                }
                            }
                            if (this.lefthand.fired <= 0) {
                                if (this.lefthand.anchored == 0) {
                                    this.leftshoulder.xmom = 0
                                    this.leftshoulder.ymom = 0
                                    this.lefthand.ymom = -(this.punchspeed * 21) + this.body.ymom * 2
                                    this.lefthand.xmom = -this.punchspeed * 4
                                    this.lefthand.fired = 19
                                    this.idify()
                                }
                            }


                        }
                    }


                    if (this.screwshot == 1) {
                        if (this.shotclock <= 0) {
                            this.shot = new ShotE(this.body.x, this.body.y, 25, "#FFAAAA", 0, -(this.speed * 3.5))
                            this.shot.gravity = 1.5
                            this.shot.accum = 0
                            this.shots.push(this.shot)
                            this.body.ymom += 8
                            this.shotclock = 30

                        }
                    }
                }



                // if (this.body.y < 900) {
                //     this.wmove = 0
                //     this.screwshot = 0
                // }


            }
        }
        degripl() {
            if (this.inactive == 1) {
                return
            }

            if (this.lefthand.anchored == 1) {
            if(minigameSelected == 6){
                this.body.ymom = -this.speed*4
                this.lefthand.anchored = -5
                return
            }
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        degripr() {
            if (this.inactive == 1) {
                return
            }

            if (this.righthand.anchored == 1) {
            if(minigameSelected == 6){
                this.body.ymom = -this.speed*4
                this.righthand.anchored = -5
                return
            }
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        collideStage() {
            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {
            if (this.inactive == 1) {
                return
            }

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.grounded = 0
            this.frame++

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.shots.length; t++) {

                    if (this.shots[t].gravity > 0) {
                        this.shots[t].accum += this.shots[t].gravity
                    }
                    if (this.shots[t].accum >= Math.abs(this.shots[t].ymom)) {
                        this.shots[t].accum = 0
                        this.shots[t].gravity = 0
                        this.shots[t].ymom *= -1
                    }
                    this.shots[t].radius *= 1.005
                    this.shots[t].ymom *= 1.005
                    this.shots[t].move()
                    if (this.shots[t].marked <= 0) {
                        this.shots[t].draw()
                    }
                    if (this.shots[t].radius > 50) {
                        this.shots[t].marked = 1
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].draw()
                        }
                    }
                }
            }

            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].marked == 1) {
                    this.shots.splice(t, 1)
                } else {
                    this.shots[t].marked--
                }
            }
            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.collideStage()
            const storageangles = [this.leftarm.angle(), this.rightarm.angle()]
            // for (let t = 0; t < this.links.length; t++) {
            //     this.links[t].color = invertColor(this.body.color)
            //     // this.links[t].draw()
            // }
            const l2 = this.leftshoulder.radius * 2

            const cos1 = Math.cos(storageangles[0] - (Math.PI / 2)) * l2
            const cos2 = Math.cos(storageangles[0] + (Math.PI / 2)) * l2
            const sin2 = Math.sin(storageangles[0] + (Math.PI / 2)) * l2
            const sin1 = Math.sin(storageangles[0] - (Math.PI / 2)) * l2

            const leftnodetop = new Circle(this.lefthand.x + (cos2), this.lefthand.y + (sin2), 10, this.body.color)
            // leftnodetop.draw()

            const leftnodebottom = new Circle(this.lefthand.x + (cos1), this.lefthand.y + (sin1), 10, this.body.color)
            // leftnodebottom.draw()

            const leftnodetops = new Circle(this.leftshoulder.x + (cos2), this.leftshoulder.y + (sin2), 10, this.body.color)
            // leftnodetops.draw()

            const leftnodebottoms = new Circle(this.leftshoulder.x + (cos1), this.leftshoulder.y + (sin1), 10, this.body.color)
            // leftnodebottoms.draw()




            const cos3 = Math.cos(storageangles[1] - (Math.PI / 2)) * l2
            const cos4 = Math.cos(storageangles[1] + (Math.PI / 2)) * l2
            const sin3 = Math.sin(storageangles[1] + (Math.PI / 2)) * l2
            const sin4 = Math.sin(storageangles[1] - (Math.PI / 2)) * l2

            const rightnodetop = new Circle(this.righthand.x + (cos4), this.righthand.y + (sin3), 10, this.body.color)
            // rightnodetop.draw()

            const rightnodebottom = new Circle(this.righthand.x + (cos3), this.righthand.y + (sin4), 10, this.body.color)
            // rightnodebottom.draw()

            const rightnodetops = new Circle(this.rightshoulder.x + (cos4), this.rightshoulder.y + (sin3), 10, this.body.color)
            // rightnodetops.draw()

            const rightnodebottoms = new Circle(this.rightshoulder.x + (cos3), this.rightshoulder.y + (sin4), 10, this.body.color)
            // rightnodebottoms.draw()



            const leftshape1 = (castBetween(leftnodetop, leftnodetops, 3, 4))
            const leftshape2 = (castBetween(leftnodebottom, leftnodebottoms, 4, 4))
            leftshape1.shapes.unshift(this.leftshoulder)
            leftshape2.shapes.push(this.lefthand)
            // //////////////////////////console.log(leftshape1, leftshape2)
            this.invcolor = invertColor(this.body.color)
            canvas_context.lineWidth = 8
            canvas_context.strokeStyle = this.invcolor
            canvas_context.beginPath()

            for (let t = 0; t < leftshape1.shapes.length; t++) {
                // if(t>0){
                const link = new LineOPx(leftshape1.shapes[t], leftshape2.shapes[t], this.invcolor, 8)
                link.draw()
                // }
                if (t > 0) {
                    const link = new LineOPx(leftshape1.shapes[t], leftshape2.shapes[t - 1], this.invcolor, 8)
                    link.draw()
                }

            }
            const linkl = new LineOPx(this.lefthand, leftshape2.shapes[leftshape2.shapes.length - 2], this.invcolor, 8)
            linkl.draw()

            canvas_context.stroke()
            const rightshape1 = (castBetween(rightnodetop, rightnodetops, 3, 4))
            const rightshape2 = (castBetween(rightnodebottom, rightnodebottoms, 4, 4))
            rightshape1.shapes.unshift(this.rightshoulder)
            rightshape2.shapes.push(this.righthand)
            // //////////////////////////console.log(rightshape1, rightshape2)
            canvas_context.beginPath()

            for (let t = 0; t < rightshape1.shapes.length; t++) {
                // if(t>0){
                const link = new LineOPx(rightshape1.shapes[t], rightshape2.shapes[t], this.invcolor, 8)
                link.draw()
                // }
                if (t > 0) {
                    const link = new LineOPx(rightshape1.shapes[t], rightshape2.shapes[t - 1], this.invcolor, 8)
                    link.draw()
                }

            }
            const linkr = new LineOPx(this.righthand, rightshape2.shapes[rightshape2.shapes.length - 2], this.invcolor, 8)
            linkr.draw()


            canvas_context.stroke()

            for (let t = 0; t < this.nodes.length; t++) {
                this.nodes[t].draw()
            }

            // if (this.controller == 0) {
            const link = new Line(this.body.x, this.body.y, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y, this.invcolor, this.body.radius * .2)

            // canvas_context.lineWidth = 0
            // canvas_context.strokeStyle = invertColor(this.body.color)
            // canvas_context.beginPath();
            // canvas_context.arc((link.x1 + link.x2) * .5, link.y1 - this.body.radius * .09, this.body.radius * .4, 0, (Math.PI * 1), true)
            // canvas_context.fillStyle = invertColor(this.body.color)
            // canvas_context.fill()
            // canvas_context.stroke();
            link.draw()
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.lefthand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
            canvas_context.font = "42px arial"

            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 70)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            if(minigameSelected == 6){

            }else{
                canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 70)
            canvas_context.fillStyle = "white"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 110)
            }
            }


            // this.bodyx = this.body.x
        }
        operate() {

            if (this.inactive == 1) {
                return
            }

            if(minigameSelected == 6){
                if(this.body.x < 100){
                    this.body.x = 100
                }
                if(this.body.x > 3000){
                    this.body.x = 3000
                }

            }else{
                if (this.righthand.anchored == 1) {
                if (this.body.x > this.righthand.x) {
                    this.righthand.anchored = -10
                }
            }
            if (this.lefthand.anchored == 1) {
                if (this.body.x < this.lefthand.x) {
                    this.lefthand.anchored = -10
                }
            }
            }

            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {

            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            }
            // }

            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.body.ymom *= .7
                    this.body.symom = this.leftshoulder.ymom * .99
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.body.ymom *= .7
                    this.body.symom = this.rightshoulder.ymom * .99
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     this.body.sxmom *= .5
                    // }
                }
                this.body.ymom += this.gravity
            } else {

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            } else {
                //this.collideStage()
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            } else {
                //this.collideStage()
            }
            this.righthand.ymom += this.gravity
            this.lefthand.ymom += this.gravity



            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].frictiveMove(this)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].smove(this)
                }
            }
            this.lefthand.xmom += (this.lefthand.x - this.body.x) / 80
            this.righthand.xmom += (this.righthand.x - this.body.x) / 80
            this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40
            this.fixupshoulder()

            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

            // this.leftshoulder.xmom *= 0
            // this.leftshoulder.ymom *= 0

            // this.rightshoulder.xmom *= 0
            // this.rightshoulder.ymom *= 0

            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            if (boys.indexOf(this) <= humanPlayers) {

                this.fightcontrol()
            } else {
                this.AI()
            }
            // }
            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }
        }
    }

    class DrSoto {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                this.ping = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 4
                this.serverID = serverID
                this.shotdraw = 0
                this.id = controller
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 0
                this.detonate = 0
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shielddraw = 0
                this.shot = {}
                this.safe = 1
                this.striker = 10000
                this.name = "Doctor Soto"
                this.blasting = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.storeshield = 0
                this.wasfalse = []
                for (let t = 0; t < 100; t++) {
                    this.wasfalse.push(1)
                }
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = 0
                this.screwangle = 0
                this.charge = 0
                this.shots = []


                this.color = getRandomColor()
                if (controller == 0) {
                    this.color = "#ffAA00"
                }
                if (controller == 1) {
                    this.color = "#ff0000"
                }
                this.body = new ShotZ(400 + (Math.random() * 2560), 500, 65.5, this.color)
                this.innerbody = new Circle(400 + (Math.random() * 2560), 500, 42.5, this.color)

                this.controller = controller
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.armlength = 44  // 40
                this.shoulderwidth = 18
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 10.9
                if(minigameSelected == 11){
                    this.speed = 14
                }
                this.punchspeed = 6.4 // 5 // 5.7
                this.frame = 0
                this.grounded = 0
                this.jumping = 1
                this.nodes.push(this.body)
                this.leftshoulder = new Circle(this.body.x - (this.body.radius + this.shoulderwidth), 350, 10, "#FF0000", 0, 0, .999)
                this.rightshoulder = new Circle(this.body.x + (this.body.radius + this.shoulderwidth), 350, 10, "#FF0000", 0, 0, .999)
                this.lefthand = new Circle(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 43.5, "#FF0000", 0, 0, .85)
                this.righthand = new Circle(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 43.5, "#FF0000", 0, 0, .85)
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                // this.links.push(this.leftcollar)
                // this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.gravity = 1.2
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.body.fired = 0
                this.screwmomentum = 0
                this.screwtimer = 0
                this.bullets = []
                for (let t = 0; t < 7; t++) {
                    const bullet = new Bullet(this.body.x - 0 + (t * 1), this.body.y, 12, "#FF0000")
                    this.bullets.push(bullet)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {

                ////////////////////////console.log(args)
                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]
                }
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    this.nodes[t] = new ShotZ(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }
                    this.nodes[t].id = idsto
                }
                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                    this.shots[t] = new CircleS(this.shots[t].x, this.shots[t].y, this.shots[t].radius, this.shots[t].color, this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                    this.shots[t].id = idsto

                }
                for (let t = 0; t < this.bullets.length; t++) {
                    ////////////////////////console.log(this.bullets[t], "pre")
                    const idsto = this.bullets[t].id
                    this.bullets[t] = new Bullet(this.bullets[t].body.x, this.bullets[t].body.y, this.bullets[t].body.radius, this.bullets[t].body.color)
                    this.bullets[t].body = new CircleS(this.bullets[t].body.x, this.bullets[t].body.y, this.bullets[t].body.radius, this.bullets[t].body.color, this.bullets[t].body.xmom, this.bullets[t].body.ymom, this.bullets[t].body.friction)
                    this.bullets[t].body.id = idsto
                    ////////////////////////console.log(this.bullets[t], "post")

                }
                this.id = args["id"]
                this.frame = args['frame']
                this.armlength = 44  // 40
                this.shoulderwidth = 18
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }
                this.rightshoulder = this.nodes[2]
                this.leftshoulder = this.nodes[1]
                this.righthand = this.nodes[3]
                this.lefthand = this.nodes[4]

                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                // this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                // this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                // this.links.push(this.leftcollar)
                // this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }
            }
        }

        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            object.ymom = -this.speed * 1 * 2.5
                        } else {
                            if (this.lefthand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                            if (this.righthand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 2.5
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        playerMoveBullet(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            object.ymom = -this.speed * 1 * 1.4
                        } else {
                            if (this.lefthand.anchored == 1) {
                                object.ymom = -this.speed * 1 * .7
                            }
                            if (this.righthand.anchored == 1) {
                                object.ymom = -this.speed * 1 * .7
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed * .7
                    }

                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed * .7
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed * .7)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 1.4
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            object.ymom = -this.speed * 1 * .7
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed * .7)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            object.ymom = -this.speed * 1 * .7
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed * .7)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            object.ymom = -this.speed * 1 * .7
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        AImoveBullet(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (this.exgrip == 1) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (this.wmove == 1) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            object.ymom = -this.speed * 1 * 1.4
                        } else {
                            if (this.lefthand.anchored == 1) {
                                object.ymom = -this.speed * 1 * .7
                            }
                            if (this.righthand.anchored == 1) {
                                object.ymom = -this.speed * 1 * .7
                            }
                        }
                    }
                    if (this.dmove == 1) {
                        this.face = 1
                        object.x += this.speed * .7
                    }

                    if (this.amove == 1) {
                        this.face = -1
                        object.x -= this.speed * .7
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            const copy = new DrSoto(this.controller)
            if(minigameSelected == 11){

                stage = new Stage(1011)
                const now = new Date()
                campaigntimestart = now.getTime() 
            }
            copy.id = this.id
            copy.frame = this.frame
            copy.body.color = this.body.color
            if (this.inactive == 1) {
                copy.inactive = 1
            } copy.serverID = this.serverID
            copy.striker = this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
                for (let t = 0; t < copy.bullets.length; t++) {
                    copy.bullets[t].body.x = stage.spawnrunner
                }
            }

            return copy
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }

            if (this.screwangle != 0) {

                this.leftshoulder.x = this.body.x + ((((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle)))))
                this.leftshoulder.y = this.body.y + (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle))))

                this.rightshoulder.x = this.body.x + (((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle))))
                this.rightshoulder.y = this.body.y + (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle))))

                this.leftshoulder.color = this.body.color
                this.rightshoulder.color = this.body.color
                this.lefthand.color = this.body.color
                this.righthand.color = this.body.color


                if (this.lefthand.anchored == 0) {
                    this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x + (((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle))))))
                    this.lefthand.y -= this.leftshoulder.y - (this.body.y + (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle)))))
                    // this.lefthand.xmom *=  this.lefthand.friction
                    // this.lefthand.ymom *=  this.lefthand.friction
                    this.leftshoulder.xmom *= 0
                    this.leftshoulder.ymom *= 0
                }
                if (this.righthand.anchored == 0) {
                    this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (((this.body.radius + this.shoulderwidth) * (Math.cos(this.screwangle))))))
                    this.righthand.y -= this.rightshoulder.y - (this.body.y + (((this.body.radius + this.shoulderwidth) * (Math.sin(this.screwangle)))))
                    // this.righthand.xmom *=  this.righthand.friction
                    // this.righthand.ymom *=  this.righthand.friction
                    this.rightshoulder.xmom *= 0
                    this.rightshoulder.ymom *= 0
                }

                if (this.body.ymom < -vsmashlimit) {
                    this.body.ymom = -vsmashlimit
                }
                if (this.body.ymom > vsmashlimit) {
                    this.body.ymom = vsmashlimit
                }


                // this.lefthand.xmom += (this.lefthand.x - this.body.x) / 100
                // this.righthand.xmom += (this.righthand.x - this.body.x) / 100

                // this.lefthand.ymom += (this.lefthand.y - this.body.y) / 100
                // this.righthand.ymom += (this.righthand.y - this.body.y) / 100


            } else {
                this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth * .3)
                this.leftshoulder.y = this.body.y - (this.shoulderwidth * .7)

                this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth * .3)
                this.rightshoulder.y = this.body.y - (this.shoulderwidth * .7)

                this.leftshoulder.color = this.body.color
                this.rightshoulder.color = this.body.color
                this.lefthand.color = this.body.color
                this.righthand.color = this.body.color


                if (this.lefthand.anchored == 0) {
                    this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth * .3)))
                    this.lefthand.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                    this.leftshoulder.xmom *= 0
                    this.leftshoulder.ymom *= 0
                }
                if (this.righthand.anchored == 0) {
                    this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth * .3)))
                    this.righthand.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                    this.rightshoulder.xmom *= 0
                    this.rightshoulder.ymom *= 0
                }

                if (this.body.ymom < -vsmashlimit) {
                    this.body.ymom = -vsmashlimit
                }



            }


            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }

        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (this.shield == 1) {
                                            //shieldaud1.play()
                                            this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                        } else {
                                            this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 200)) + (boys[t].shots[k].xmom * baselaunch)) * 2
                                            this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 200)) + (boys[t].shots[k].ymom * baselaunch)) * 2) - (10 * (this.damage / 200))
                                            this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                            this.breaktimer = 0
                                        }
                                        boys[t].shots[k].marked = 1
                                    }
                                }
                            }


                            if (boys[t].hasOwnProperty('radball')) {
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }

                            const enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }


                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 200)) + (boys[t].bananahand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 200)) + (boys[t].bananahand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 200)) + (boys[t].middlehand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 200)) + (boys[t].middlehand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                //shieldaud1.play()
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 200)) + (boys[t].righthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 200)) + (boys[t].righthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14

                                            this.shotIDs.push(boys[t].righthand2.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            //shieldaud1.play()
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 200)) + (boys[t].lefthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 200)) + (boys[t].lefthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            //shieldaud1.play()
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            //shieldaud1.play()
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 200)) + (boys[t].righthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 200)) + (boys[t].righthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            //shieldaud1.play()
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 200)) + (boys[t].lefthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 200)) + (boys[t].lefthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)

                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }

                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                //shieldaud1.play()
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 200)) + (boys[t].righthand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 200)) + (boys[t].righthand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].lefthand.fired > 14) {
                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)
                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                //shieldaud1.play()
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            } else {
                                                this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 200)) + (boys[t].lefthand.xmom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 200)) + (boys[t].lefthand.ymom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)) * 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }

                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                //shieldaud1.play()
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 200)) + (boys[t].body.xmom * baselaunch) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].body.ymom * (this.damage / 200)) + (boys[t].body.ymom * baselaunch)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        this.fixupshoulder()
                        boys[f].fixupshoulder()
                        this.body.ymom *= .99
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2
                this.lefthand.ymom = -this.speed * 2
                this.righthand.ymom = -this.speed * 2
                this.jumpcount = 100
                //////////////////// ////////////////////////////////////////////console.log(this)
            }
        }
        doJump(object, speed) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -speed * 2
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 2
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {
            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            this.jumpcount--

            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }

            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }

        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                // this.fleeing = 1
            }
            if (this.charge > 92) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }


            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + Math.max(this.body.radius, boys[t].body.radius))) {
                        this.wmove = 1
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        if (Math.random() < .2) {
                            this.wmove = 1
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }

            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    // this.screwshot = 1
                    this.wmove = 1
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    // this.screwshot = 1
                }
            }
            this.exgrip = 0
            if (this.under == 0) {
                for (let t = 0; t < boys.length; t++) {
                    if (this.amomu <= 0 && this.dmomu <= 0) {
                        if (this != boys[t] && boys[t]) {
                            if (boys[t].brick.center.y > this.brick.center.y) {
                                if (boys[t].body.x < this.body.x) {
                                    this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                    this.amomu += 15
                                    this.exgrip = 1
                                } else {
                                    this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                    this.dmomu += 15
                                    this.exgrip = 1
                                }
                            }
                        }
                    } else {
                        this.exgrip = 1
                    }
                }
            }



            if (this.dmom > 0) {
                // this.screwshot = 1
                this.dmove = 1
                this.wmove = 1
                this.amove = 0
                this.amom = 0
            } else {

                if (this.dmomu > 0) {
                    this.dmove = 1
                    this.amove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }
            if (this.amom > 0) {
                // this.screwshot = 1
                this.dmom = 0
                this.amove = 1
                this.wmove = 1
                this.dmove = 0
            } else {
                if (this.amomu > 0) {
                    this.amove = 1
                    this.dmove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }


            if (this.safe == 0) {
                // this.screwshot = 1
                if (this.body.x > (this.brick.center.x)) {
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                } else {
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }


            if (this.trapped == 0 && ((this.dmomu <= 0) && (this.amomu <= 0)) && ((this.dmom <= 0) && (this.amom <= 0))) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]
                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        const runtimeR = xdisR / this.speed
                                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .850)) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                // this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        const runtimeL = xdisL / this.speed
                                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .850)) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                // this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }
                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        const runtimeR = xdisR / this.speed
                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .855)) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                // this.screwshot = 1
                                this.wmove = 1
                            }
                        }
                    } else {
                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        const runtimeL = xdisL / this.speed
                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .855)) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                // this.screwshot = 1
                                this.wmove = 1
                            }
                        }
                    }
                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                //
                if (this.safe == 0) {
                    // this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        ////////////////////////// ////////////////////////////////////////////console.log(this.brick.center.x, this.body.x)
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }

            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            // this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    // this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }


                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }

                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 2
                    } else {
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                    }
                }
                if (this.dmove == 1) {
                    this.face = 1
                    if (object == this.body) {
                        object.x += speed
                        this.righthand.x += speed
                        this.lefthand.x += speed
                    }
                    if (this.righthand.anchored == 1) {
                        this.degripr()
                        this.jumping = 1
                    }
                }
                // if (keysPressed['s']) {
                //     object.y += speed
                //     this.degrip()
                // }
                if (this.amove == 1) {
                    this.face = -1
                    if (object == this.body) {
                        object.x -= speed
                        this.righthand.x -= speed
                        this.lefthand.x -= speed
                    }
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        this.degripl()
                        this.jumping = 1
                    }
                }


                // if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                // if (controller.gamepad.axesStatus[0] > .1) {
                //     this.face = 1
                // }

                // if (controller.gamepad.axesStatus[1] < -.1) {
                //     this.face = -1
                // }
                // }

            }
            // if (this.dmomu > 0 || this.amomu > 0) {
            //     this.lefthand.anchored = 0
            //     this.righthand.anchored = 0
            // }

            if (this.exgrip == 1) {
                this.righthand.anchored = 0
                this.lefthand.anchored = 0
            }
        }
        AI() {
            this.idify()
            if (this.inactive == 1) {
                return
            }
            this.breaks()
            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.body.fired--
            this.lefthand.fired--

            this.breaktimer--

            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.rightshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }

            let bombs = 0
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    if (boys[k] && this != boys[k]) {
                        if (this.shots[t].stuck == 1) {
                            bombs++
                            const link = new LineOP(this.shots[t], boys[k].body)
                            if (link.sqrDis() < (200 * 200)) {
                                this.downspike = 1
                            }
                        }
                    }
                }
            }
            if (bombs == 0) {
                if (Math.random() < .005) {  //01
                    // this.downspike = 1
                }
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        this.wmove = 1
                                        // this.screwshot = 1
                                    }
                                }
                            }
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 50 && this.body.y < boys[t].body.y) {
                        if (this.amomu <= 0 && this.dmomu <= 0) {
                            this.downspike = 1
                        }
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {
                        this.hortsmash = 1
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < boys[t].body.radius && this.body.y > boys[t].body.y) {
                        this.screwshot = 1
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == 1) {
                                this.hortsmash = 1
                            }
                        }
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == -1) {
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .09) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < boys[t].body.radius && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                this.leftshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 570) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.leftshot = 0
                                    }
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < boys[t].body.radius && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                this.rightshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 570) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.rightshot = 0
                                    }
                                }
                            }
                        }
                    }


                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            // if (this.safe == 0) {
            //     this.downspike = 1
            // }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            this.storeshield = 1
                        }
                    }
                }
            }
            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        this.shieldpower -= .63
                        this.shield = 1
                        this.shielddraw = 1
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shotdraw = 0
            }
            if (this.breaktimer <= 0 && this.shield == 0) {



                if (this.righthand.fired <= 0) {
                    if (this.downspike == 1) {
                        if (this.body.fired <= 0) {
                            if (this.bullets.length > 0) {
                                if (this.bullets[0].generating == 0) {
                                    this.shot.bomb = 1
                                    this.detonate = 1
                                    this.bullets[0].body.x = this.body.x
                                    this.bullets[0].body.y = this.body.y
                                    this.bullets[0].body.ymom = jumplimit * 2
                                    this.bullets[0].body.xmom = 0
                                    this.shots.push(this.bullets[0].body)
                                    this.bullets.splice(0, 1)
                                    if (this.body.ymom > -jumplimit) {
                                        this.body.ymom -= this.speed * .3
                                        if (this.body.ymom < -jumplimit) {
                                            this.body.ymom = -jumplimit
                                        }
                                    } else {
                                    }
                                    this.idify()
                                    this.body.fired = 5
                                }
                            }
                        }
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.ymom = (this.punchspeed * 17) + this.body.ymom * 2
                                this.righthand.xmom = this.punchspeed * -1
                                this.righthand.fired = 19
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = (this.punchspeed * 17) + this.body.ymom * 2
                                this.lefthand.xmom = -this.punchspeed * -1
                                this.lefthand.fired = 19
                                this.idify()
                            }
                        }
                    }
                }

                if (this.screwshot == 1) {
                    if (this.body.fired <= 0) {
                        if (this.bullets.length > 0) {
                            if (this.bullets[0].generating == 0) {

                                this.shot.bomb = 1
                                this.detonate = 1
                                this.bullets[0].body.x = this.body.x
                                this.bullets[0].body.y = this.body.y
                                this.bullets[0].body.ymom = -jumplimit * 2
                                this.bullets[0].body.xmom = 0
                                this.shots.push(this.bullets[0].body)
                                this.bullets.splice(0, 1)
                                if (this.body.ymom > -jumplimit) {
                                    // this.body.ymom -= this.speed * .3
                                    if (this.body.ymom < -jumplimit) {
                                        this.body.ymom = -jumplimit
                                    }
                                } else {
                                }
                                this.idify()
                                this.body.fired = 5
                            }
                        }
                    }
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.ymom = -(this.punchspeed * 17) + this.body.ymom * 2
                            this.righthand.xmom = this.punchspeed * -1
                            this.righthand.fired = 19
                            this.idify()
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = -(this.punchspeed * 17) + this.body.ymom * 2
                            this.lefthand.xmom = -this.punchspeed * -1
                            this.lefthand.fired = 19
                            this.idify()
                        }
                    }
                }

                if (this.rightshot == 1 || this.leftshot == 1) {
                    if (this.body.fired <= 0) {
                        if (this.bullets.length > 0) {
                            if (this.face != 0) {
                                if (this.bullets[0].generating == 0) {

                                    this.shot.bomb = 1
                                    this.detonate = 1
                                    this.bullets[0].body.x = this.body.x
                                    this.bullets[0].body.y = this.body.y
                                    this.bullets[0].body.xmom = this.speed * 3.5 * this.face
                                    this.bullets[0].body.ymom = 0
                                    this.shots.push(this.bullets[0].body)
                                    this.bullets.splice(0, 1)
                                    if (this.body.ymom > -jumplimit) {
                                        this.body.ymom -= this.speed * .15
                                        if (this.body.ymom < -jumplimit) {
                                            this.body.ymom = -jumplimit
                                        }
                                    } else {
                                    }
                                    this.idify()
                                    this.body.fired = 5
                                }
                            }
                        }
                    }
                }


                if (this.hortsmash == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.xmom = (this.punchspeed * 18)
                            this.righthand.ymom = this.punchspeed * .9 + this.body.ymom * 2
                            this.righthand.fired = 19
                            this.idify()
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.xmom = (this.punchspeed * -18)
                            this.lefthand.ymom = -this.punchspeed * .9 + this.body.ymom * 2
                            this.lefthand.fired = 19
                            this.idify()
                        }
                    }
                }

            }



        }
        fightcontrol() {
            if (this.inactive == 1) {
                return
            }
            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()




            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.body.fired--
            this.lefthand.fired--

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            this.breaktimer--
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }


            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shotdraw = 0
            }
            if (this.breaktimer <= 0 && this.shield == 0) {
                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {


                    if (this.righthand.fired <= 0) {
                        if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {
                            if (this.body.fired <= 0) {
                                if (this.bullets.length > 0) {
                                    if (this.bullets[0].generating == 0) {

                                        this.shot.bomb = 1
                                        this.detonate = 1
                                        this.bullets[0].body.x = this.body.x
                                        this.bullets[0].body.y = this.body.y
                                        this.bullets[0].body.ymom = jumplimit * 2
                                        this.bullets[0].body.xmom = 0
                                        this.shots.push(this.bullets[0].body)
                                        this.bullets.splice(0, 1)
                                        if (this.body.ymom > -jumplimit) {
                                            this.body.ymom -= this.speed * .3
                                            if (this.body.ymom < -jumplimit) {
                                                this.body.ymom = -jumplimit
                                            }
                                        } else {
                                        }
                                        this.idify()
                                        this.body.fired = 5
                                    }
                                }
                            }
                            if (this.righthand.fired <= 0) {
                                if (this.righthand.anchored == 0) {
                                    this.rightshoulder.xmom = 0
                                    this.rightshoulder.ymom = 0
                                    this.righthand.ymom = (this.punchspeed * 17) + this.body.ymom * 2
                                    this.righthand.xmom = this.punchspeed * -1
                                    this.righthand.fired = 19
                                    this.idify()
                                }
                            }
                            if (this.lefthand.fired <= 0) {
                                if (this.lefthand.anchored == 0) {
                                    this.leftshoulder.xmom = 0
                                    this.leftshoulder.ymom = 0
                                    this.lefthand.ymom = (this.punchspeed * 17) + this.body.ymom * 2
                                    this.lefthand.xmom = -this.punchspeed * -1
                                    this.lefthand.fired = 19
                                    this.idify()
                                }
                            }
                        }
                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {
                        if (this.body.fired <= 0) {
                            if (this.bullets.length > 0) {
                                if (this.bullets[0].generating == 0) {

                                    this.shot.bomb = 1
                                    this.detonate = 1
                                    this.bullets[0].body.x = this.body.x
                                    this.bullets[0].body.y = this.body.y
                                    this.bullets[0].body.ymom = -jumplimit * 2
                                    this.bullets[0].body.xmom = 0
                                    this.shots.push(this.bullets[0].body)
                                    this.bullets.splice(0, 1)
                                    if (this.body.ymom > -jumplimit) {
                                        // this.body.ymom -= this.speed * .3
                                        if (this.body.ymom < -jumplimit) {
                                            this.body.ymom = -jumplimit
                                        }
                                    } else {
                                    }
                                    this.idify()
                                    this.body.fired = 5
                                }
                            }
                        }
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.ymom = -(this.punchspeed * 17) + this.body.ymom * 2
                                this.righthand.xmom = this.punchspeed * -1
                                this.righthand.fired = 19
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = -(this.punchspeed * 17) + this.body.ymom * 2
                                this.lefthand.xmom = -this.punchspeed * -1
                                this.lefthand.fired = 19
                                this.idify()
                            }
                        }

                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {
                        if (this.body.fired <= 0) {
                            if (this.bullets.length > 0) {
                                if (this.face != 0) {
                                    if (this.bullets[0].generating == 0) {

                                        this.shot.bomb = 1
                                        this.detonate = 1
                                        this.bullets[0].body.x = this.body.x
                                        this.bullets[0].body.y = this.body.y
                                        this.bullets[0].body.xmom = this.speed * 3.5 * this.face
                                        this.bullets[0].body.ymom = 0
                                        this.shots.push(this.bullets[0].body)
                                        this.bullets.splice(0, 1)
                                        if (this.body.ymom > -jumplimit) {
                                            this.body.ymom -= this.speed * .15
                                            if (this.body.ymom < -jumplimit) {
                                                this.body.ymom = -jumplimit
                                            }
                                        } else {
                                        }
                                        this.idify()
                                        this.body.fired = 5
                                    }
                                }
                            }
                        }
                    }


                    if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.xmom = (this.punchspeed * 18)
                                this.righthand.ymom = this.punchspeed * .9 + this.body.ymom * 2
                                this.righthand.fired = 19
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.xmom = (this.punchspeed * -18)
                                this.lefthand.ymom = -this.punchspeed * .9 + this.body.ymom * 2
                                this.lefthand.fired = 19
                                this.idify()
                            }
                        }
                    }
                }
            }
        }
        degripl() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        degripr() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        collideStage() {
            if (this.inactive == 1) {
                return
            }
            const xb = this.body.x
            const yb = this.body.y
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            const x = this.body.x - xb
            const y = this.body.y - yb
            for (let t = 0; t < this.bullets.length; t++) {
                this.bullets[t].body.x += x
                this.bullets[t].body.y += y
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {

            if (this.inactive == 1) {
                return
            }

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.innerbody.x = this.body.x
                this.innerbody.y = this.body.y
                let wait = 1

                for (let t = 0; t < this.bullets.length; t++) {
                    if (this.bullets[t].generating != 1) {
                        this.bullets[t].body.x += (this.body.xmom / this.body.friction) + this.body.sxmom
                        this.bullets[t].body.x += (Math.random() - .5) / 100
                        this.bullets[t].body.y += (this.body.ymom / this.body.friction) + this.body.symom
                        let h = 0

                        while (!this.innerbody.isPointInside(this.bullets[t].body)) {
                            h++
                            if (h > 100) {
                                break
                            }
                            this.bullets[t].body.sxmom += (this.body.x - this.bullets[t].body.x) / 100
                            this.bullets[t].body.symom += (this.body.y - this.bullets[t].body.y) / 100
                            this.bullets[t].body.xmom *= .91
                            this.bullets[t].body.ymom *= .91
                            this.bullets[t].body.smovex()


                        }
                        // ////////////////////////console.log(this.bullets[t])
                        for (let k = 0; k < this.bullets.length; k++) {
                            if (k != t) {

                                let j = 0
                                while (this.bullets[k].body.doesPerimeterTouch(this.bullets[t].body)) {
                                    j++
                                    if (j > 100) {
                                        break
                                    }
                                    this.bullets[t].body.x += (this.bullets[t].body.x - this.bullets[k].body.x) / (this.bullets[t].body.radius + this.bullets[k].body.radius)
                                    this.bullets[t].body.y += (this.bullets[t].body.y - this.bullets[k].body.y) / (this.bullets[t].body.radius + this.bullets[k].body.radius)
                                    this.bullets[k].body.x -= (this.bullets[t].body.x - this.bullets[k].body.x) / (this.bullets[t].body.radius + this.bullets[k].body.radius)
                                    this.bullets[k].body.y -= (this.bullets[t].body.y - this.bullets[k].body.y) / (this.bullets[t].body.radius + this.bullets[k].body.radius)

                                    this.bullets[t].body.ymom *= .99
                                    this.bullets[k].body.ymom *= .99
                                }
                            }
                        }
                        if (this.jumping == .5) {
                            this.bullets[t].body.ymom *= -1
                        }
                    } else {

                        wait = 0
                        this.bullets[t].body.x = this.body.x
                        this.bullets[t].body.y = this.body.y - (this.body.radius * .8)
                    }
                    this.bullets[t].move()
                }
                if (this.bullets.length < 12) {
                    if (wait == 1) {
                        const bullet = new Bullet(this.body.x - 0, this.body.y - (this.body.radius * .8), 12, this.body.color)
                        bullet.generating = 1
                        this.bullets.push(bullet)
                    }
                }
            }

            for (let t = 0; t < this.bullets.length; t++) {
                this.bullets[t].body.color = this.body.color
                this.bullets[t].draw()
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.grounded = 0
            this.frame++
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                for (let t = 0; t < this.shots.length; t++) {
                    this.shots[t].move()
                    if (this.shots[t].marked <= 0) {
                        this.shots[t].draw()
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].draw()
                        }
                    }
                }
            }
            this.detonate = 0
            for (let j = 0; j < this.shots.length; j++) {
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked == 1) {
                        this.shots.splice(t, 1)
                    } else {
                        this.shots[t].marked--
                    }
                }
            }

            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.collideStage()
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].color = invertColor(this.body.color)
                this.links[t].draw()
            }

            for (let t = 0; t < this.nodes.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    if (t != k) {
                        if (this.nodes[t] != this.rightshoulder && this.nodes[t] != this.leftshoulder) {
                            if (this.nodes[k] != this.rightshoulder && this.nodes[k] != this.leftshoulder) {
                                let j = 0
                                while (this.nodes[t].doesPerimeterTouch(this.nodes[k])) {
                                    j++
                                    if (j > 100) {
                                        break
                                    }
                                    if (this.nodes[k].anchored != 1) {
                                        if (this.nodes[t].anchored != 1) {
                                            this.nodes[k].x += (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[k].y += (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[t].x -= (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[t].y -= (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
                                        } else {
                                            break
                                        }
                                    } else {
                                        break
                                    }
                                }
                            }
                        }
                    }
                }
            }
            for (let t = 0; t < this.nodes.length; t++) {
                this.nodes[t].draw()
            }

            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }
            if (this.screwangle != 0) {
                for (let t = 0; t < 25; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - ((Math.random() - .5) * this.body.radius * 2), 3, "#ffffff")
                    if (spot.doesPerimeterTouch(this.body)) {
                        spot.draw()
                    }
                }
            }




            canvas_context.font = "42px arial"

            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 70)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 70)

            canvas_context.fillStyle = "FFFFFF"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 110)
            }
            // canvas_context.fillText(`Height:${Math.round(this.brick.edgeright.y)}`, this.body.x - 20, this.body.y - 250)
            // canvas_context.fillText(`Safe:${Math.round(this.safe)}`, this.body.x - 20, this.body.y - 200)
            // // if (this != boys[0]) {
            //     canvas_context.fillText(`M ${Math.round(this.dmove)},${Math.round(this.amove)}`, this.body.x - 20, this.body.y - 100)
            //     canvas_context.fillText(`U ${Math.round(this.dmomu)},${Math.round(this.amomu)}`, this.body.x - 20, this.body.y - 150)
            //     canvas_context.fillText(`Under:${Math.round(this.under)},Safe:${Math.round(this.safe)}`, this.body.x - 20, this.body.y - 200)
            //     canvas_context.fillText(`_ ${Math.round(this.dmom)},${Math.round(this.amom)}`, this.body.x - 20, this.body.y - 300)
            //     if (this.fleeing == 1) {
            //         canvas_context.fillText(`fleeing`, this.body.x - 20, this.body.y - 100)
            //     }
            // }


            const link = new Line(this.body.x, this.body.y - this.body.radius, this.body.x + (((this.body.radius * .8) * this.face * 2)), this.body.y - this.body.radius, this.body.color, this.body.radius * .1)

            // canvas_context.lineWidth = this.strokeWidth
            // canvas_context.strokeStyle = "#FFFFFF" //invertColor(this.body.color)
            // canvas_context.beginPath();
            // canvas_context.arc(((link.x1 + link.x2) * .5) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .4, this.screwangle - 1, (Math.PI * 1) + this.screwangle + 1, false)
            // canvas_context.fillStyle = "#FFFFFF"//invertColor(this.body.color)
            // canvas_context.fill()
            // canvas_context.stroke();
            if (this.screwangle == 0) {
                link.draw()
            }

            if (this.shotdraw == 1) {

                if (this.face == -1) {
                    this.shot = new Shot(this.lefthand.x, this.lefthand.y, this.charge * .91, "#FF4400", -this.speed * 3, 0)
                } else if (this.face == 1) {
                    this.shot = new Shot(this.righthand.x, this.righthand.y, this.charge * .91, "#FF4400", -this.speed * 3, 0)
                }
                this.shot.draw()
            }
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.lefthand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
        }
        operate() {
            if (this.inactive == 1) {
                return
            }

            if (this.righthand.anchored == 1) {
                if (this.body.x > this.righthand.x) {
                    this.righthand.anchored = -10
                }
            }
            if (this.lefthand.anchored == 1) {
                if (this.body.x < this.lefthand.x) {
                    this.lefthand.anchored = -10
                }
            }

            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {

            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }

                    for (let k = 0; k < this.bullets.length; k++) {
                        this.playerMoveBullet(this.bullets[k].body, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }
                    for (let k = 0; k < this.bullets.length; k++) {
                        this.AImoveBullet(this.bullets[k].body, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            }
            // }
            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.leftshoulder.ymom * .99
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.rightshoulder.ymom * .99
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     // this.body.sxmom *= 0
                    //     this.body.xmom *= .5
                    // }
                }
                this.body.ymom += this.gravity
            } else {

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            } else {
                //this.collideStage()
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            } else {
                //this.collideStage()
            }
            this.righthand.ymom += this.gravity
            this.lefthand.ymom += this.gravity


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            this.body.xmom *= .99
            this.body.ymom *= .99

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].frictiveMove(this)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].smove(this)
                }
            }
            this.lefthand.xmom += (this.lefthand.x - this.body.x) / 80
            this.righthand.xmom += (this.righthand.x - this.body.x) / 80
            this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40
            this.fixupshoulder()

            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

            // this.leftshoulder.xmom *= 0
            // this.leftshoulder.ymom *= 0

            // this.rightshoulder.xmom *= 0
            // this.rightshoulder.ymom *= 0




            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            // if (this.controller == 0) {

            if (boys.indexOf(this) <= humanPlayers) {

                // this.AI()
                this.fightcontrol()
            } else {
                this.AI()
            }
            // }
        }
    }





    class Joule {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                if (AItoggle == 1 || localPlayToggle == 1) {
                    if (meshtoggle == 1) {
                        if (boys.length == 1) {
                            this.meshinputs = []
                            for (let t = 0; t < 200; t++) {
                                this.meshinputs.push(Math.random() - .5)
                            }
                            // //////////console.log(coreboyvcoreboymesh)
                            //bakedcoreboy
                            //overnight
                            this.mesh = new GenNN(this.meshinputs, 4, [66, 66, 24, 10], 10)
                        }
                    }
                }
                this.ping = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 11
                this.serverID = serverID
                this.shotdraw = 0
                this.id = controller //boys.length
                this.shielddraw = 0
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 60
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shot = {}
                this.striker = 10000
                this.name = "Joule"
                this.blasting = 0 // 0
                this.recovering = 0
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.wmove = 0
                this.amove = 0
                this.dmove = 0
                this.exgrip = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.storeshield = 0
                this.face = 0
                this.shots = []
                this.wasfalse = []
                this.controller = controller
                this.armlength = 36
                this.shoulderwidth = 12
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 10
                if(minigameSelected == 3){
                    this.speed = 20
                }
                this.punchspeed = 6.66 //6.5

                if(minigameSelected == 3){
                    this.punchspeed = 9.99 //6.5
                }
                this.grounded = 0
                this.frame = 0
                this.jumping = 1
                this.jumpcount = 100

                this.color = getRandomColor()
                this.body = new ShotJ(400 + (Math.random() * 2560), 500, 47, this.color)
                this.radball = new ShotJR(this.body.x, this.body.y, 74, this.color)
                this.radball.anchored = 1
                this.radball.anchor = this.body

                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.nodes.push(this.body)
                this.leftshoulder = new Shot(this.body.x - (this.body.radius + this.shoulderwidth), 350, 10, "magenta", 0, 0, .999)
                this.rightshoulder = new Shot(this.body.x + (this.body.radius + this.shoulderwidth), 350, 10, "#FF0000", 0, 0, .999)
                this.lefthand = new Shot(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 25, "magenta", 0, 0, .85) //26
                this.righthand = new Shot(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 25, "#FF0000", 0, 0, .85) //26
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.nodes.push(this.radball)
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                // this.links.push(this.leftcollar)
                // this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.gravity = 1
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = -1
                this.bodyx = this.body.x
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {
                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]

                    // const keys2 = Object.keys(args[keys[t]])
                    // // if(keys2.length > 1){
                    //     for(let j = 0; j<keys2.length;j++){
                    //     this[keys[t]][keys2[j]] = args[keys[t]][keys2[j]]
                    //  }
                }
                // ////////////// ////////////////////////////////////////////console.log(args)
                this.armlength = 36
                this.shoulderwidth = 12
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                // //////////// ////////////////////////////////////////////console.log(this.shotdraw)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    if (t == 0) {
                        this.nodes[t] = new ShotJ(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired, this.nodes[t].angle)
                    } else {
                        if (t == this.nodes.length - 1) {
                            this.nodes[t] = new ShotJR(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)

                        } else {

                            this.nodes[t] = new Shot(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired)
                        }
                    }
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }
                    this.nodes[t].id = idsto
                }

                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                    this.shots[t] = new Shot(this.shots[t].x, this.shots[t].y, this.shots[t].radius, this.shots[t].color, this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                    this.shots[t].id = idsto

                }
                this.id = args["id"]
                this.frame = args['frame']
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }
                this.rightshoulder = this.nodes[2]
                this.leftshoulder = this.nodes[1]
                this.righthand = this.nodes[3]
                this.lefthand = this.nodes[4]
                this.radball = this.nodes[5]
                // this.radball = new ShotJR(args['radball'].x, args['radball'].y, args['radball'].radius, args['radball'].color)
                if (typeof this.radball.color != "undefined") {
                    if (this.radball.color.length != 7) {
                        this.radball.color = "#00FF00"
                    }
                } else {
                    this.radball.color = "#00FF00"
                }
                //////////console.log(this.radball)

                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                // this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                // this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                // this.links.push(this.leftcollar)
                // this.links.push(this.rightcollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }
            }
        }

        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            object.ymom = -this.speed * 1 * 3
                        } else {
                            if (this.lefthand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                            if (this.righthand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom -= this.speed
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 3
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom -= this.speed
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = 10000//this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            const copy = new Joule(this.controller)
            if (this.hasOwnProperty("mesh")) {
                this.mesh.reduceWrapper()



                copy.mesh = this.mesh.freshClone(this.meshinputs)
                // copy.mesh.mutate()
            }
            copy.id = this.id
            copy.frame = this.frame
            copy.body.color = this.body.color
            if (this.inactive == 1) {
                copy.inactive = 1
            } copy.serverID = this.serverID
            copy.striker = 10000 //this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

            return copy
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }

            this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            this.leftshoulder.y = this.body.y - (this.shoulderwidth)

            this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            this.rightshoulder.y = this.body.y - (this.shoulderwidth)

            this.leftshoulder.color = this.body.color
            this.rightshoulder.color = this.body.color
            this.lefthand.color = this.body.color
            this.righthand.color = this.body.color


            if (this.lefthand.anchored == 0) {
                this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth)))
                this.lefthand.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth))
                this.leftshoulder.xmom *= 0
                this.leftshoulder.ymom *= 0
            }
            if (this.righthand.anchored == 0) {
                this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth)))
                this.righthand.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth))
                this.rightshoulder.xmom *= 0
                this.rightshoulder.ymom *= 0
            }

            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }



            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 2
                this.lefthand.ymom = -this.speed * 2
                this.righthand.ymom = -this.speed * 2
                this.jumpcount = 100

            }
        }

        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (this.shield == 1) {
                                            this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                        } else {
                                            this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 321)) + (boys[t].shots[k].xmom * (baselaunch * .9))) * 2
                                            this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 321)) + (boys[t].shots[k].ymom * (baselaunch * .9))) * 2) - (10 * (this.damage / 321))
                                            this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                            this.breaktimer = 0
                                        }
                                        boys[t].shots[k].marked = 1
                                    }
                                }
                            }

                            if (boys[t].hasOwnProperty('radball')) {
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }


                            const enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }


                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 321)) + (boys[t].bananahand.xmom * (baselaunch * .9))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 321)) + (boys[t].bananahand.ymom * (baselaunch * .9))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 321)) + (boys[t].middlehand.xmom * (baselaunch * .9))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 321)) + (boys[t].middlehand.ymom * (baselaunch * .9))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 321)) + (boys[t].righthand2.xmom * (baselaunch * .9))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 321)) + (boys[t].righthand2.ymom * (baselaunch * .9))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14

                                            this.shotIDs.push(boys[t].righthand2.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 321)) + (boys[t].lefthand2.xmom * (baselaunch * .9))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 321)) + (boys[t].lefthand2.ymom * (baselaunch * .9))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 321)) + (boys[t].righthand3.xmom * (baselaunch * .9))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 321)) + (boys[t].righthand3.ymom * (baselaunch * .9))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 321)) + (boys[t].lefthand3.xmom * (baselaunch * .9))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 321)) + (boys[t].lefthand3.ymom * (baselaunch * .9))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)

                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }


                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 321)) + (boys[t].righthand.xmom * (baselaunch * .9))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 321)) + (boys[t].righthand.ymom * (baselaunch * .9))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].lefthand.fired > 14) {
                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)
                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            } else {
                                                this.body.xmom = ((boys[t].lefthand.xmom * (this.damage / 321)) + (boys[t].lefthand.xmom * (baselaunch * .9))) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 321)) + (boys[t].lefthand.ymom * (baselaunch * .9))) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 321)) + (boys[t].body.xmom * (baselaunch * .9)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = ((((boys[t].body.ymom * (this.damage / 321)) + (boys[t].body.ymom * (baselaunch * .9))) * 2)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        this.fixupshoulder()
                        boys[f].fixupshoulder()
                        this.body.ymom *= .99
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        doJump(object, speed) {

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -speed * 3
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 3
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {
            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            this.jumpcount--
            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }
            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }
        fightcontrol() {
            if (this.inactive == 1) {
                return
            }

            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()
            this.righthand.fired--
            this.lefthand.fired--
            this.breaktimer--
            this.radball.fired--
            if(minigameSelected == 3){
                if(this.radball.fired < 0){
                    this.radball.fired-=3
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }


            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                    if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {
                        if (this.face == 1) {
                            if (this.righthand.fired <= 0) {
                                if (this.righthand.anchored == 0) {
                                    this.righthand.ymom = -5
                                    this.righthand.xmom = this.punchspeed * 14
                                    this.righthand.fired = 18
                                    this.idify()
                                }
                            }
                        }
                        if (this.face == -1) {
                            if (this.lefthand.fired <= 0) {
                                if (this.lefthand.anchored == 0) {
                                    this.lefthand.ymom = -5
                                    this.lefthand.xmom = -this.punchspeed * 14
                                    this.lefthand.fired = 18
                                    this.idify()
                                }
                            }
                        }

                        if (this.radball.fired <= 0 && this.radball.anchored == 1) {
                            this.radball.fired = 30
                            this.radball.anchored = 0
                            this.radball.friction = .98
                            this.radball.xmom = this.punchspeed * this.face * 5
                        }
                    }


                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.righthand.ymom = -this.punchspeed * 18
                                this.righthand.xmom = this.punchspeed * .5 + (this.face * this.punchspeed)
                                this.righthand.fired = 18
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.lefthand.ymom = -this.punchspeed * 18
                                this.lefthand.xmom = -this.punchspeed * .5 + (this.face * this.punchspeed)
                                this.lefthand.fired = 18
                                this.idify()
                            }
                        }

                        if (this.radball.fired <= 0 && this.radball.anchored == 1) {
                            this.radball.fired = 30
                            this.radball.anchored = 0
                            this.radball.friction = .99
                            this.radball.ymom = (-this.punchspeed * 2.31) + this.body.ymom
                        }
                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.ymom = (this.punchspeed * 19) + this.body.ymom * 2
                                this.righthand.xmom = this.punchspeed * 5
                                this.righthand.fired = 18
                                this.idify()
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = (this.punchspeed * 19) + this.body.ymom * 2
                                this.lefthand.xmom = -this.punchspeed * 5
                                this.lefthand.fired = 18
                                this.idify()
                            }
                        }
                        if (this.radball.fired <= 0 && this.radball.anchored == 1) {
                            this.radball.fired = 30
                            this.radball.anchored = 0
                            this.radball.friction = .97
                            this.radball.ymom = (this.punchspeed * 2.31) + this.body.ymom
                        }
                    }


                    if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
                        this.radball.radius = 250
                        this.speed = 5
                        if(minigameSelected == 3){
                            this.speed = 10
                        }
                        this.radball.xmom = 0
                        this.radball.ymom = 0
                        this.radball.fired = 1
                    } else {
                        this.speed = 10
                        if(minigameSelected == 3){
                            this.speed = 20
                        }
                        this.radball.radius = 74
                    }
                }
            }
        }
        meshCompute() {

            if (AItoggle == 1 || localPlayToggle == 1) {
                if (meshtoggle == 1 && this.hasOwnProperty('mesh')) {
                    if (boys.length == 2) {
                        this.meshinputs = []
                        this.meshinputs.push(this.damage)
                        this.meshinputs.push(Math.max(this.breaktimer, -1))
                        this.meshinputs.push(this.grounded)
                        this.meshinputs.push(this.shield)
                        this.meshinputs.push(this.shieldpower)
                        this.meshinputs.push(this.lefthand.anchored)
                        this.meshinputs.push(this.righthand.anchored)
                        this.meshinputs.push(Math.max(this.lefthand.fired, 0))
                        this.meshinputs.push(Math.max(this.righthand.fired, 0))
                        this.meshinputs.push(Math.max(this.body.fired, 0))
                        this.meshinputs.push(Math.max(this.blasting, 0))
                        this.meshinputs.push(this.face)
                        this.meshinputs.push(this.jumping)
                        this.meshinputs.push(Math.max(this.jumpcount, -20))
                        this.meshinputs.push(this.safe)
                        for (let k = 0; k < this.nodes.length; k++) {

                            const x = (this.nodes[k].x - (canvas.width * (invscale * .5))) / (canvas.width * (invscale * .5))
                            const y = (this.nodes[k].y - (canvas.height * (invscale * .5))) / (canvas.height * (invscale * .5))
                            this.meshinputs.push(x)
                            this.meshinputs.push(y)
                            this.meshinputs.push(this.nodes[k].radius)
                            this.meshinputs.push(this.nodes[k].xmom)
                            this.meshinputs.push(this.nodes[k].ymom)
                        }



                        for (let t = 0; t < boys.length; t++) {
                            if (this != boys[t]) {
                                this.meshinputs.push(boys[t].damage)
                                this.meshinputs.push(Math.max(boys[t].breaktimer, -1))
                                this.meshinputs.push(boys[t].grounded)
                                this.meshinputs.push(boys[t].shield)
                                this.meshinputs.push(boys[t].shieldpower)
                                this.meshinputs.push(boys[t].lefthand.anchored)
                                this.meshinputs.push(boys[t].righthand.anchored)
                                this.meshinputs.push(Math.max(boys[t].lefthand.fired, 0))
                                this.meshinputs.push(Math.max(boys[t].righthand.fired, 0))
                                this.meshinputs.push(Math.max(boys[t].body.fired, 0))
                                this.meshinputs.push(Math.max(boys[t].blasting, 0))
                                this.meshinputs.push(boys[t].face)
                                this.meshinputs.push(boys[t].jumping)
                                this.meshinputs.push(Math.max(boys[t].jumpcount, -20))
                                this.meshinputs.push(boys[t].safe)
                                for (let k = 0; k < boys[t].nodes.length; k++) {
                                    const x = (boys[t].nodes[k].x - (canvas.width * (invscale * .5))) / (canvas.width * (invscale * .5))
                                    const y = (boys[t].nodes[k].y - (canvas.height * (invscale * .5))) / (canvas.height * (invscale * .5))


                                    this.meshinputs.push(x)
                                    this.meshinputs.push(y)
                                    this.meshinputs.push(boys[t].nodes[k].radius)
                                    this.meshinputs.push(boys[t].nodes[k].xmom)
                                    this.meshinputs.push(boys[t].nodes[k].ymom)
                                }
                            }
                        }
                        this.mesh.changeInputs(this.meshinputs)
                        for (let t = 0; t < this.meshinputs.length; t++) {
                            if (isNaN(this.meshinputs[t])) {
                                this.meshinputs[t] = 0
                            }
                        }
                        // this.mesh.longInputs.push([...this.meshinputs])

                    }
                }
            }
        }
        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                // this.fleeing = 1 //aitesting
            }
            if (this.charge > 90) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }

            this.recovering = 0

            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + Math.max(this.body.radius, boys[t].body.radius))) {
                        this.wmove = 1
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 4) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        if (Math.random() < .2) {
                            this.wmove = 1
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }

            this.recovering = 0

            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }

            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    this.downspike = 1
                    this.wmove = 1
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    this.downspike = 1
                }
            }
            this.exgrip = 0
            for (let t = 0; t < boys.length; t++) {
                if (this.amomu <= 0 && this.dmomu <= 0) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].brick.center.y > this.brick.center.y) {
                            if (boys[t].body.x < this.body.x) {
                                this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                this.amomu += 15
                                this.exgrip = 1
                            } else {
                                this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                this.dmomu += 15
                                this.exgrip = 1
                            }
                        }
                    }
                } else {
                    this.exgrip = 1
                }
            }





            if (this.dmom > 0) {
                this.screwshot = 1
                this.dmove = 1
                this.wmove = 1
                this.amove = 0
                this.amom = 0
            } else {

                if (this.dmomu > 0) {
                    this.dmove = 1
                    this.amove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }
            if (this.amom > 0) {
                this.screwshot = 1
                this.dmom = 0
                this.amove = 1
                this.wmove = 1
                this.dmove = 0
            } else {
                if (this.amomu > 0) {
                    this.amove = 1
                    this.dmove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }

            if (this.safe == 0) {
                this.downspike = 1
                if (this.body.x > (this.brick.center.x)) {
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                } else {
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }


            if (this.trapped == 0) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]
                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        const runtimeR = xdisR / this.speed
                                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .8)) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.downspike = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        const runtimeL = xdisL / this.speed
                                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .8)) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.downspike = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }
                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        const runtimeR = xdisR / this.speed
                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .87)) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.downspike = 1
                                this.wmove = 1
                            }
                        }
                    } else {
                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        const runtimeL = xdisL / this.speed
                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .87)) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.downspike = 1
                                this.wmove = 1
                            }
                        }
                    }

                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }

            if (this.body.y < 900) {
                this.wmove = 0
                this.downspike = 0
            }
            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1

                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }


                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }


                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }

                if (object == this.body) {
                    if (this.hasOwnProperty('mesh')) {
                        this.meshCompute()

                        if (meshRun == 1) {

                            if (object == this.body) {
                                this.errors = [this.wmove, this.dmove, this.amove, this.exgrip]
                                this.wmove = Math.round(this.mesh.outputMagnitudes[0])
                                this.amove = Math.round(this.mesh.outputMagnitudes[1])
                                this.dmove = Math.round(this.mesh.outputMagnitudes[2])
                                if (isNaN(this.dmove)) {
                                    this.dmove = 0
                                }
                                if (isNaN(this.amove)) {
                                    this.amove = 0
                                }
                                this.exgrip = Math.round(this.mesh.outputMagnitudes[3])
                                if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[4])) {
                                    this.screwshot = 1
                                    this.downspike = 0
                                    this.hortsmash = 0
                                }
                                if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[5])) {
                                    this.downspike = 1
                                    this.screwshot = 0
                                    this.hortsmash = 0
                                }
                                if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[6])) {
                                    this.hortsmash = 1
                                    this.screwshot = 0
                                    this.downspike = 0
                                }
                                this.rightshot = Math.round(this.mesh.outputMagnitudes[7])
                                this.leftshot = Math.round(this.mesh.outputMagnitudes[8])
                                this.storeshield = Math.round(this.mesh.outputMagnitudes[9])
                            }
                        }
                    }
                }



                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 2
                    } else {
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed
                        }
                    }
                }

                if (!this.hasOwnProperty('mesh')) {
                    if (this.dmove == 1) {
                        this.face = 1
                        if (object == this.body) {
                            object.x += speed
                            this.righthand.x += speed
                            this.lefthand.x += speed
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    if (this.amove == 1) {
                        this.face = -1
                        if (object == this.body) {
                            object.x -= speed
                            this.righthand.x -= speed
                            this.lefthand.x -= speed
                        }
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }
                } else {



                    if (this.dmove > this.amove) {
                        if (object == this.body) {
                            this.face = 1
                            object.x += speed//*this.dmove
                            this.righthand.x += speed//*this.dmove
                            this.lefthand.x += speed//*this.dmove
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    } else if (this.dmove < this.amove) {
                        if (object == this.body) {
                            this.face = -1
                            object.x -= speed//*this.amove
                            this.righthand.x -= speed//*this.amove
                            this.lefthand.x -= speed//*this.amove
                        }
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }
                }
                if (this.exgrip == 1) {
                    this.righthand.anchored = 0
                    this.lefthand.anchored = 0
                }
            } else {

                if (this.hasOwnProperty('mesh')) {
                    if (object == this.body) {
                        this.errors = [this.wmove, this.dmove, this.amove, this.exgrip]
                    }
                }
            }
        }
        AI() {
            this.idify()
            if (this.inactive == 1) {
                return
            }

            this.breaks()
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].marked == 1) {
                    this.shots.splice(t, 1)
                } else {
                    this.shots[t].marked--
                }
            }

            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }



            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.rightshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {


                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if (link.hypotenuse() + (this.body.radius + boys[t].shots[g].radius) / (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) < 40) {
                            this.storeshield = 1
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 45 && this.body.y < boys[t].body.y) {
                        this.downspike = 1
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {
                        this.hortsmash = 1
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < 70 && this.body.y > boys[t].body.y) {
                        this.screwshot = 1
                    } else if (this.body.y - boys[t].body.y > 100) {
                        if (Math.random() < .01) {
                            this.downspike = 1
                        }
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == 1) {
                                this.hortsmash = 1
                            }
                        }
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == -1) {
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .09) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    this.leftshot = 1
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.leftshot = 0
                                    }
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    this.rightshot = 1
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.rightshot = 0
                                    }
                                }
                            }
                        }
                    }


                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }

            if (this.safe == 0) {
                if (this.recovering == 1) {
                    this.downspike = 1
                }
            }

            this.breaks()
            this.righthand.fired--
            this.lefthand.fired--
            this.breaktimer--
            this.radball.fired--
            if (Math.random() < .1) {
                this.storeshield = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .94) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (boys[t].lefthand.fired > 14) {
                        if (this.body.x < boys[t].body.x) {
                            if (Math.random() < .94) {
                                this.storeshield = 1
                            }
                        }
                    }
                }
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (this.grounded == 1) {
                                if (boys[t].shots[g].stuck != 1) {
                                    this.storeshield = 1
                                } else {
                                    this.wmove = 1
                                }
                            } else {
                                if (this.body.x < boys[t].shots[g].x) {
                                    if (this.amom <= 0 && this.dmom <= 0) {
                                        this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                        this.amove = 1
                                        this.dmove = 0
                                    }
                                } else {
                                    if (this.amom <= 0 && this.dmom <= 0) {
                                        this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                        this.amove = 0
                                        this.dmove = 1
                                    }
                                }
                            }
                            break
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].shots[g].x) {
                                            if (this.amom <= 0 && this.dmom <= 0) {
                                                this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                this.amove = 1
                                                this.dmove = 0
                                            }
                                        } else {
                                            if (this.amom <= 0 && this.dmom <= 0) {
                                                this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                this.amove = 0
                                                this.dmove = 1
                                            }
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        this.wmove = 1
                                        this.screwshot = 1
                                    }
                                }
                            }
                        }
                    }
                }
            }

            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }

            if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        this.shieldpower -= .63
                        this.shield = 1
                        this.shielddraw = 1
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }

            if (this.breaktimer <= 0 && this.shield == 0) {

                if (meshRun == 1) {
                    if (this.hasOwnProperty('mesh')) {
                        this.errors.push(this.screwshot)
                        this.errors.push(this.downspike)
                        this.errors.push(this.hortsmash)
                        this.errors.push(this.rightshot)
                        this.errors.push(this.leftshot)
                        this.errors.push(this.storeshield)
                        this.wmove = Math.round(this.mesh.outputMagnitudes[0])
                        this.amove = Math.round(this.mesh.outputMagnitudes[1])
                        this.dmove = Math.round(this.mesh.outputMagnitudes[2])
                        if (isNaN(this.dmove)) {
                            this.dmove = 0
                        }
                        if (isNaN(this.amove)) {
                            this.amove = 0
                        }
                        this.exgrip = Math.round(this.mesh.outputMagnitudes[3])
                        if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[4])) {
                            this.screwshot = 1
                            this.downspike = 0
                            this.hortsmash = 0
                        }
                        if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[5])) {
                            this.downspike = 1
                            this.screwshot = 0
                            this.hortsmash = 0
                        }
                        if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[6])) {
                            this.hortsmash = 1
                            this.screwshot = 0
                            this.downspike = 0
                        }
                        this.rightshot = Math.round(this.mesh.outputMagnitudes[7])
                        this.leftshot = Math.round(this.mesh.outputMagnitudes[8])
                        this.storeshield = Math.round(this.mesh.outputMagnitudes[9])
                    }
                }

                if (this.downspike == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.ymom = (this.punchspeed * 19) + this.body.ymom * 2
                            this.righthand.xmom = this.punchspeed * 5
                            this.righthand.fired = 18
                            this.idify()
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = (this.punchspeed * 19) + this.body.ymom * 2
                            this.lefthand.xmom = -this.punchspeed * 5
                            this.lefthand.fired = 18
                            this.idify()
                        }
                    }
                    if (this.radball.fired <= 0 && this.radball.anchored == 1) {
                        this.radball.fired = 30
                        this.radball.anchored = 0
                        this.radball.friction = .97
                        this.radball.ymom = (this.punchspeed * 2.31) + this.body.ymom
                    }
                }

                if (this.leftshot == 1 || this.rightshot == 1) {
                    if (this.face == 1) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.righthand.ymom = -5
                                this.righthand.xmom = this.punchspeed * 14
                                this.righthand.fired = 18
                                this.idify()
                            }
                        }
                    }
                    if (this.face == -1) {
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.lefthand.ymom = -5
                                this.lefthand.xmom = -this.punchspeed * 14
                                this.lefthand.fired = 18
                                this.idify()
                            }
                        }
                    }

                    if (this.radball.fired <= 0 && this.radball.anchored == 1) {
                        this.radball.fired = 30
                        this.radball.anchored = 0
                        this.radball.friction = .98
                        this.radball.xmom = this.punchspeed * this.face * 5
                    }
                }

                if (this.body.y < 900) {
                    this.wmove = 0
                    this.screwshot = 0
                }

                if (AItoggle == 1 || localPlayToggle == 1) {
                    if (meshtoggle == 1 && this.hasOwnProperty('mesh')) {
                        if (meshRun == 1) {
                            this.wmove = Math.round(this.mesh.outputMagnitudes[0])
                            this.amove = Math.round(this.mesh.outputMagnitudes[1])
                            this.dmove = Math.round(this.mesh.outputMagnitudes[2])
                            if (isNaN(this.dmove)) {
                                this.dmove = 0
                            }
                            if (isNaN(this.amove)) {
                                this.amove = 0
                            }
                            this.exgrip = Math.round(this.mesh.outputMagnitudes[3])
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[4])) {
                                this.screwshot = 1
                                this.downspike = 0
                                this.hortsmash = 0
                            }
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[5])) {
                                this.downspike = 1
                                this.screwshot = 0
                                this.hortsmash = 0
                            }
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[6])) {
                                this.hortsmash = 1
                                this.screwshot = 0
                                this.downspike = 0
                            }
                            this.rightshot = Math.round(this.mesh.outputMagnitudes[7])
                            this.leftshot = Math.round(this.mesh.outputMagnitudes[8])
                            this.storeshield = Math.round(this.mesh.outputMagnitudes[9])
                        }
                    }
                }


                if (this.screwshot == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.righthand.ymom = -this.punchspeed * 18
                            this.righthand.xmom = this.punchspeed * .5 + (this.face * this.punchspeed)
                            this.righthand.fired = 18
                            this.idify()
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.lefthand.ymom = -this.punchspeed * 18
                            this.lefthand.xmom = -this.punchspeed * .5 + (this.face * this.punchspeed)
                            this.lefthand.fired = 18
                            this.idify()
                        }
                    }

                    if (this.radball.fired <= 0 && this.radball.anchored == 1) {
                        this.radball.fired = 30
                        this.radball.anchored = 0
                        this.radball.friction = .99
                        this.radball.ymom = (-this.punchspeed * 2.31) + this.body.ymom
                    }
                }

                this.hortsmash = 0
                this.radballclone = new Circle(this.radball.x, this.radball.y, 251, "transparent")
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t]) {
                        if (this.radballclone.isPointInside(boys[t].body) && !this.radball.isPointInside(boys[t].body)) {
                            if (Math.abs(this.body.xmom) < this.speed) {
                                this.hortsmash = 1
                            }
                        }
                    }
                }
                if (this.radball)
                    if (this.hortsmash == 1) {
                        this.radball.radius = 250
                        this.speed = 5
                        this.radball.xmom = 0
                        this.radball.ymom = 0
                        this.radball.fired = 1
                    } else {
                        this.speed = 10
                        this.radball.radius = 74
                    }


            } else {

                if (meshRun == 1) {

                    if (this.hasOwnProperty('mesh')) {
                        this.errors.push(this.screwshot)
                        this.errors.push(this.downspike)
                        this.errors.push(this.hortsmash)
                        this.errors.push(this.rightshot)
                        this.errors.push(this.leftshot)
                        this.errors.push(this.storeshield)
                    }
                }
            }

            if (meshLearn == 1) {

                if (this.hasOwnProperty('mesh')) {
                    if (this.hasOwnProperty('meshinputs')) {
                        if (this.hasOwnProperty('errors')) {
                            for (let t = 0; t < this.meshinputs.length; t++) {
                                if (isNaN(this.meshinputs[t])) {
                                    this.meshinputs[t] = 0
                                }
                            }
                            this.mesh.longInputs.push([...this.meshinputs])
                            for (let t = 0; t < this.errors.length; t++) {
                                if (isNaN(this.errors[t])) {
                                    this.errors[t] = 0
                                }
                            }
                            this.mesh.longErrors.push([...this.errors])
                        }
                    }
                }
            }
        }
        degripl() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        degripr() {
            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        collideStage() {
            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {
            if (this.inactive == 1) {
                return
            }
            if (this.hasOwnProperty('mesh')) {
                if (keysPressed['p']) {
                    this.mesh.mutate()
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.grounded = 0
            this.frame++

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.shots.length; t++) {
                    this.shots[t].radius *= 1.02
                    this.shots[t].ymom *= 1.02
                    this.shots[t].move()
                    if (this.shots[t].marked <= 0) {
                        this.shots[t].draw()
                    }
                    if (this.shots[t].radius > 35) {
                        this.shots[t].marked = 1
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].draw()
                        }
                    }
                }
            }

            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].marked == 1) {
                    this.shots.splice(t, 1)
                } else {
                    this.shots[t].marked--
                }
            }
            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.collideStage()
            this.radball.color = invertColory(this.body.color)

            if (typeof this.radball.color != "undefined") {
                if (this.radball.color.length != 7) {
                    this.radball.color = "#00FF00"
                }
            } else {
                this.radball.color = "#00FF00"
            }
            this.radball.draw()
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].color = invertColor(this.body.color)
                if (this.hasOwnProperty('mesh')) {
                    this.links[t].color = invertColor(this.mesh.name)
                }
                this.links[t].draw()
            }



            for (let t = 0; t < this.nodes.length; t++) {

                if (this.hasOwnProperty('mesh')) {
                    this.nodes[t].color = this.mesh.name
                }
                if (this.nodes[t] !== this.radball) {
                    this.nodes[t].draw()
                } else {
                    // if(this.lefthand.fired%9 == 6){
                    this.nodes[t].draw()
                    // }
                }
            }

            // if (this.controller == 0) {
            const link = new Line(this.body.x, this.body.y, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y, invertColor(this.body.color), this.body.radius * .2)

            canvas_context.lineWidth = 0
            canvas_context.strokeStyle = invertColor(this.body.color)
            canvas_context.beginPath();
            canvas_context.arc((link.x1 + link.x2) * .5, link.y1, this.body.radius * .3, -(Math.PI / 7), (Math.PI * 1) + (Math.PI / 7), true)
            canvas_context.fillStyle = invertColor(this.body.color)
            canvas_context.fill()
            canvas_context.stroke();
            canvas_context.beginPath();
            canvas_context.arc((link.x1 + link.x2) * .5, link.y1 - this.body.radius * .40, this.body.radius * .3, -(Math.PI / 7), (Math.PI * 1) + (Math.PI / 7), true)
            canvas_context.fillStyle = invertColor(this.body.color)
            canvas_context.fill()
            canvas_context.stroke();
            // link.draw()
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.lefthand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
            canvas_context.font = "42px arial"

            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 70)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            if(minigameSelected != 3){
                canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 70)
            canvas_context.fillStyle = "white"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 110)
            }
            }


            // this.bodyx = this.body.x
        }
        operate() {

            if (this.inactive == 1) {
                return
            }



            if (this.righthand.anchored == 1) {
                if (this.body.x > this.righthand.x) {
                    this.righthand.anchored = -10
                }
            }
            if (this.lefthand.anchored == 1) {
                if (this.body.x < this.lefthand.x) {
                    this.lefthand.anchored = -10
                }
            }

            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {
            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.doubleJump()
                } else {

                    if (this.hasOwnProperty('mesh')) {
                        this.meshCompute()

                        if (meshRun == 1) {

                            this.errors = [this.wmove, this.dmove, this.amove, this.exgrip]
                            this.wmove = Math.round(this.mesh.outputMagnitudes[0])
                            this.amove = Math.round(this.mesh.outputMagnitudes[1])
                            this.dmove = Math.round(this.mesh.outputMagnitudes[2])
                            if (isNaN(this.dmove)) {
                                this.dmove = 0
                            }
                            if (isNaN(this.amove)) {
                                this.amove = 0
                            }
                            this.exgrip = Math.round(this.mesh.outputMagnitudes[3])
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[4])) {
                                this.screwshot = 1
                                this.downspike = 0
                                this.hortsmash = 0
                            }
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[5])) {
                                this.downspike = 1
                                this.screwshot = 0
                                this.hortsmash = 0
                            }
                            if (Math.max(this.mesh.outputMagnitudes[4], this.mesh.outputMagnitudes[5], this.mesh.outputMagnitudes[6]) == (this.mesh.outputMagnitudes[6])) {
                                this.hortsmash = 1
                                this.screwshot = 0
                                this.downspike = 0
                            }
                            this.rightshot = Math.round(this.mesh.outputMagnitudes[7])
                            this.leftshot = Math.round(this.mesh.outputMagnitudes[8])
                            this.storeshield = Math.round(this.mesh.outputMagnitudes[9])
                        }

                    }

                }
            }
            // }

            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.body.ymom *= .7
                    this.body.symom = this.leftshoulder.ymom * .99
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.body.ymom *= .7
                    this.body.symom = this.rightshoulder.ymom * .99
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     this.body.sxmom *= .5
                    // }
                }
                this.body.ymom += this.gravity
            } else {

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            } else {
                //this.collideStage()
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            } else {
                //this.collideStage()
            }
            this.righthand.ymom += this.gravity
            this.lefthand.ymom += this.gravity



            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    if (this.nodes[t] != this.radball) {
                        this.nodes[t].frictiveMove(this)
                    }
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    if (this.nodes[t] != this.radball) {
                        this.nodes[t].smove(this)
                    }
                }
            }
            this.lefthand.xmom += (this.lefthand.x - this.body.x) / 80
            this.righthand.xmom += (this.righthand.x - this.body.x) / 80
            this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40
            this.fixupshoulder()

            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

            // this.leftshoulder.xmom *= 0
            // this.leftshoulder.ymom *= 0

            // this.rightshoulder.xmom *= 0
            // this.rightshoulder.ymom *= 0

            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            if (boys.indexOf(this) <= humanPlayers) {

                this.fightcontrol()
            } else {
                this.AI()

                if (this.hasOwnProperty('mesh')) {
                    // this.mesh.errorReduce(this.errors, boys.indexOf(this))
                }
            }
            // }
            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.radball.frictiveMove(this)
            }
            if (this.radball.fired < -100) {
                if(minigameSelected == 3){
                    if (this.radball.fired < -300) {
                        this.radball.anchored = 1
                    }
                }else{
                    this.radball.anchored = 1
                }
            } else {
                if (this.radball.fired < -1 && this.radball.anchored != 1) {
                    this.radball.xmom = (this.body.x - this.radball.x) / 10
                    this.radball.ymom = (this.body.y - this.radball.y) / 10
                    let j = 0
                    while (Math.abs(this.radball.xmom) + Math.abs(this.radball.ymom) < Math.abs(this.radball.fired)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.radball.xmom *= 1.02
                        this.radball.ymom *= 1.02
                    }
                    const k = 0
                    while (Math.abs(this.radball.xmom) + Math.abs(this.radball.ymom) > Math.abs(this.radball.fired)) {
                        if (k > 100) {
                            break
                        }
                        this.radball.xmom *= .98
                        this.radball.ymom *= .98
                    }
                    if (this.body.isPointInside(this.radball)) {
                        this.radball.anchored = 1
                        this.radball.anchor = this.body
                        this.radball.xmom = 0
                        this.radball.ymom = 0
                    }
                }
            }
        }
    }


    class Kessler {
        constructor(controller, args = 0) {
            if (args == 0) {
                 this.stock = stock
                this.ping = 0
                this.reflecting = 0
                this.pounding = 0
                this.shotIDs = []
                this.struck = 0
                this.drops = 0
                this.knocks = 0
                this.pick = 12
                this.frame = 0
                this.serverID = serverID
                this.shotdraw = 0
                this.id = controller
                this.gamepad = new Gamepad(controller)
                this.jumpreduction = 0
                if(minigameSelected == 12){
                    this.jumpreduction = 119
                }
                this.shild = new Circle(0, 0, 0, "transparent")
                this.shot = new Brick(-1, -1, 1, 1)
                this.striker = 10000
                this.name = "Kessler"
                this.blasting = 0
                this.brick = new Brick(1, 1, 1, 1)
                this.dmomu = 0
                this.amomu = 0
                this.amom = 0
                this.dmom = 0
                this.fleeing = 0
                this.face = 0
                this.screwshot = 0
                this.rightshot = 0
                this.hortsmash = 0
                this.leftshot = 0
                this.downspike = 0
                this.storeshield = 0
                this.wasfalse = []
                for (let t = 0; t < 100; t++) {
                    this.wasfalse.push(1)
                }
                this.shield = 0
                this.shieldpower = 100
                this.breaktimer = 0
                this.screwangle = 0
                this.charge = 0
                this.shots = []

                this.color = getRandomColor()
                if (controller == 0) {
                    this.color = "#ffAA00"
                }
                if (controller == 1) {
                    this.color = "#ff0000"
                }
                this.body = new ShotG(400 + (Math.random() * 2560), 500, 50, this.color)
                this.controller = controller
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }

                this.armlength = 24
                this.shoulderwidth = 12
                this.damage = 0
                this.nodes = []
                this.springs = []
                this.hitboxes = []
                this.links = []
                this.speed = 8  //11
                this.punchspeed = 5 // 5.5
                this.grounded = 1
                this.jumping = 1


                this.nodes.push(this.body)
                this.leftshoulder = new ShotG(this.body.x - (this.body.radius + this.shoulderwidth), 350, 8, "#FF0000", 0, 0, .999)
                this.rightshoulder = new ShotG(this.body.x + (this.body.radius + this.shoulderwidth), 350, 8, "#FF0000", 0, 0, .999)
                this.middleshoulder = new ShotG(this.body.x, 350 - (this.shoulderwidth + this.body.radius), 3, "#FF0000", 0, 0, .999)
                this.lefthand = new ShotG(this.leftshoulder.x, (this.leftshoulder.y + this.armlength), 32, "#FF0000", 0, 0, .85)
                this.righthand = new ShotG(this.rightshoulder.x, (this.rightshoulder.y + this.armlength), 32, "#FF0000", 0, 0, .85)
                this.middlehand = new ShotG(this.middleshoulder.x, (this.middleshoulder.y + this.armlength), 21, "#FF0000", 0, 0, .85)
                this.nodes.push(this.leftshoulder)
                this.nodes.push(this.rightshoulder)
                this.nodes.push(this.middleshoulder)
                this.nodes.push(this.righthand)
                this.nodes.push(this.lefthand)
                this.nodes.push(this.middlehand)
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.middlecollar = new LineOP(this.middleshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.links.push(this.middlecollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, invertColor(this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.links.push(this.middlearm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.middlearm = new SpringOP(this.middleshoulder, this.middlehand, this.armlength * .5, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.springs.push(this.middlearm)
                this.gravity = 1.1
                if(minigameSelected == 12){
                    this.gravity = 0
                }
                if(minigameSelected == 12){
                    this.body.friction = 1.0001
                }
                this.righthand.fired = 0
                this.lefthand.fired = 0
                this.middlehand.fired = 0
                this.body.fired = 0
                this.screwmomentum = 0
                this.screwtimer = 0
                this.blasting = 0
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].gravity = this.gravity // lmao
                }
                this.target = {}
                this.target.body = {}
            } else {
                const keys = Object.keys(args)
                for (let t = 0; t < keys.length; t++) {
                    this[keys[t]] = args[keys[t]]
                }
                this.shotdraw = args['shotdraw']
                this.brick = new Brick(1, 1, 1, 1)
                this.jumpcount = args['jumpcount']

                for (let t = 0; t < this.nodes.length; t++) {
                    const idsto = this.nodes[t].id
                    this.nodes[t] = new ShotG(this.nodes[t].x, this.nodes[t].y, this.nodes[t].radius, this.nodes[t].color, this.nodes[t].xmom, this.nodes[t].ymom, this.nodes[t].friction, 0, this.nodes[t].fired, this.nodes[t].angle)
                    if (isNaN(this.nodes[t].ymom) || isNaN(this.nodes[t].xmom)) {
                        ////////////////////////////////console.log("vanish break", this.nodes[t])
                    }
                    this.nodes[t].id = idsto
                }

                for (let t = 0; t < this.shots.length; t++) {
                    const idsto = this.shots[t].id
                    this.shots[t] = new Shot(this.shots[t].x, this.shots[t].y, this.shots[t].radius, this.shots[t].color, this.shots[t].xmom, this.shots[t].ymom, this.shots[t].friction, this.shots[t].marked)
                    this.shots[t].id = idsto

                }
                this.id = args["id"]
                this.frame = args['frame']
                this.armlength = 24
                this.shoulderwidth = 12
                this.body = this.nodes[0]
                this.body.fired = this.nodes[0].fired //overwriting new logic?
                if (this.controller == 0) {
                    this.body.color = "#FF0000"
                }
                if (this.controller == 1) {
                    this.body.color = "#00FF00"
                }
                if (this.controller == 2) {
                    this.body.color = "#0000FF"
                }
                if (this.controller == 3) {
                    this.body.color = "#FFFF00"
                }
                if (this.controller == 4) {
                    this.body.color = "#FFAA00"
                }
                if (this.controller == 5) {
                    this.body.color = "#00FFFF"
                }
                if (this.controller == 6) {
                    this.body.color = "#FF00FF"
                }
                if (this.controller == 7) {
                    this.body.color = "#bbbbbb"
                }
                if (this.controller >= 8) {
                    this.body.color = colors[this.controller]
                }
                this.leftshoulder = this.nodes[1]
                this.rightshoulder = this.nodes[2]
                this.middleshoulder = this.nodes[3]
                this.righthand = this.nodes[4]
                this.lefthand = this.nodes[5]
                this.middlehand = this.nodes[6]
                // this.leftcollar = this.nodes[7]
                // this.rightcollar = this.nodes[7]
                // this.middlecollar = this.nodes[8]
                // this.leftarm = this.nodes[9]
                // this.rightarm = this.nodes[10]
                // this.middlearm = this.nodes[11]
                // this.leftarm = this.nodes[12]
                // this.rightarm = this.nodes[31]
                // this.middlearm = this.nodes[14]

                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.nodes[0].color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.nodes[0].color, 8)
                this.middlecollar = new LineOP(this.middleshoulder, this.body, this.nodes[0].color, 8)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.nodes[0].color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.nodes[0].color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, (this.nodes[0].color), 8)


                this.links = []
                this.springs = []
                this.leftcollar = new LineOP(this.leftshoulder, this.body, this.body.color, 8)
                this.rightcollar = new LineOP(this.rightshoulder, this.body, this.body.color, 8)
                this.middlecollar = new LineOP(this.middleshoulder, this.body, this.body.color, 8)
                this.links.push(this.leftcollar)
                this.links.push(this.rightcollar)
                this.links.push(this.middlecollar)
                this.leftarm = new LineOP(this.leftshoulder, this.lefthand, (this.body.color), 8)
                this.rightarm = new LineOP(this.rightshoulder, this.righthand, (this.body.color), 8)
                this.middlearm = new LineOP(this.middleshoulder, this.middlehand, (this.body.color), 8)
                this.links.push(this.leftarm)
                this.links.push(this.rightarm)
                this.links.push(this.middlearm)
                this.leftarm = new SpringOP(this.leftshoulder, this.lefthand, this.armlength, 8)
                this.rightarm = new SpringOP(this.rightshoulder, this.righthand, this.armlength, 8)
                this.middlearm = new SpringOP(this.middleshoulder, this.middlehand, this.armlength, 8)
                this.springs.push(this.leftarm)
                this.springs.push(this.rightarm)
                this.springs.push(this.middlearm)
                // if(this.righthand.fired > 0){
                //     // //////////// ////////////////////////////////////////////console.log(this.righthand.fired)
                // }
                for (let t = 0; t < this.nodes.length; t++) {
                    // this.nodes[t].self = this
                }
            }
            ////////////////////////////////////console.log(this)
        }

        playerMove(object) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                if (this.shield == 0) {
                    if (keysPressed['s']) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    } else if ((this.gamepad.gamepad.axesStatus[1] * this.speed) > this.speed * .5) {
                        this.righthand.anchored = 0
                        this.lefthand.anchored = 0
                    }

                    if (keysPressed['w']) {
                        if (this.grounded == 1) {
                            this.jumping = 1
                            ////////////////////////////////////console.log(object.ymom,this.body.ymom)
                            object.ymom = -this.speed * 1 * 4
                            ////////////////////////////////////console.log(object.ymom,this.body.ymom)
                        } else {
                            if (this.lefthand.anchored == 1) {
                                this.degripl()
                                this.jumping = 1
                                object.ymom = -this.speed * 1 * 2 // not as high as the axes? //not2
                            }
                            if (this.righthand.anchored == 1) {
                                this.degripr()
                                this.jumping = 1
                                object.ymom = -this.speed * 1 * 2  //not2
                            }
                        }
                    }
                    if (keysPressed['d']) {
                        this.face = 1
                        object.x += this.speed
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                        }
                    }
                    // if (keysPressed['s']) {
                    //     object.y += this.speed
                    //     this.degrip()
                    // }
                    if (keysPressed['a']) {
                        this.face = -1
                        object.x -= this.speed
                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                        }
                    }


                    if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                        if (this.gamepad.gamepad.axesStatus[0] > .05) {
                            this.face = 1
                        }

                        if (this.gamepad.gamepad.axesStatus[0] < -.05) {
                            this.face = -1
                        }
                    }

                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                // object.y += (this.gamepad.gamepad.axesStatus[1] * this.speed)
                                // if((this.gamepad.gamepad.axesStatus[1] * this.speed)  < this.speed*-.5){             
                                if (this.grounded == 1) {
                                    object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                    if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                        object.ymom = -this.speed * 1 * 4
                                        this.jumping = 1
                                    }
                                } else {


                                    if (this.gamepad.gamepad.axesStatus[0] < -.5) {
                                        if (this.lefthand.anchored == 1) {
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom = -this.speed * 1 * 2
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }
                                    if (this.gamepad.gamepad.axesStatus[0] > .5) {
                                        this.face = 1
                                        if (this.righthand.anchored == 1) {
                                            this.degripr()
                                            this.jumping = 1
                                            object.ymom = -this.speed * 1 * 2
                                        } else {
                                            object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                        }
                                    }


                                    if (this.gamepad.gamepad.axesStatus[1] < -.5) {
                                        // this.face = -1
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.degripr()
                                            this.degripl()
                                            this.jumping = 1
                                            object.ymom = -this.speed * 1 * 2
                                        }

                                    }
                                }
                                // }
                            }
                        }
                    }
                }
            } else {
                if (Math.random() < .001) {
                    //////////////// ////////////////////////////////////////////console.log(this.body.color, color)
                }
            }
        }
        copy() {
            const obj = {}
            obj.kill = 1
            obj.striker = this.striker
            if (AItoggle == 0  && localPlayToggle == 0) {
                 if(localPlayToggle != 1){
                    ws.send(JSON.stringify(obj))
                }
            }
            ////////////////////////////////console.log("caseF")

            const copy = new Kessler(this.controller)
            copy.id = this.id
            copy.frame = this.frame
            if (this.inactive == 1) {
                copy.inactive = this.inactive
            }
            copy.body.color = this.body.color
            copy.serverID = this.serverID
            copy.striker = this.striker
            copy.drops = this.drops + 1
            copy.knocks = this.knocks
            if (campaignToggle == 1) {
                for (let t = 0; t < copy.nodes.length; t++) {
                    copy.nodes[t].x = stage.spawnrunner
                }
            }

            return copy
        }
        fixupshoulder() {
            if (this.inactive == 1) {
                return
            }

            this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth * .3)
            this.leftshoulder.y = this.body.y - (this.shoulderwidth * .7)

            this.middleshoulder.x = this.body.x
            this.middleshoulder.y = this.body.y - ((this.shoulderwidth * 1) + this.body.radius)

            this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth * .3)
            this.rightshoulder.y = this.body.y - (this.shoulderwidth * .7)


            this.leftshoulder.color = this.body.color
            this.rightshoulder.color = this.body.color
            this.middleshoulder.color = this.body.color
            this.lefthand.color = this.body.color
            this.righthand.color = this.body.color
            this.middlehand.color = this.body.color



            if (this.lefthand.anchored == 0) {
                this.lefthand.x = this.lefthand.x + (this.leftshoulder.x - (this.body.x - (this.body.radius + this.shoulderwidth * .3)))
                this.lefthand.y -= this.leftshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                this.leftshoulder.xmom *= 0
                this.leftshoulder.ymom *= 0
            }
            if (this.righthand.anchored == 0) {
                this.righthand.x = this.righthand.x + (this.rightshoulder.x - (this.body.x + (this.body.radius + this.shoulderwidth * .3)))
                this.righthand.y -= this.rightshoulder.y - (this.body.y - (this.shoulderwidth * .7))
                this.rightshoulder.xmom *= 0
                this.rightshoulder.ymom *= 0
            }


            // this.middlehand.x = this.middlehand.x + (this.middleshoulder.x - (this.body.x))
            this.middlehand.y -= this.middleshoulder.y - (this.body.y - ((this.shoulderwidth * 1) + this.body.radius))
            this.middleshoulder.xmom *= 0
            this.middleshoulder.ymom *= 0


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }




            for (let t = 0; t < this.nodes.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    if (t != k) {
                        if (this.nodes[t] != this.rightshoulder && this.nodes[t] != this.leftshoulder && this.nodes[t] != this.middleshoulder && this.body.fired <= 0) {
                            if (this.nodes[k] != this.rightshoulder && this.nodes[k] != this.leftshoulder && this.nodes[k] != this.middleshoulder) {
                                let j = 0
                                while (this.nodes[t].doesPerimeterTouch(this.nodes[k])) {
                                    j++
                                    if (j > 100) {
                                        break
                                    }
                                    if (this.nodes[k].anchored != 1) {
                                        if (this.nodes[t].anchored != 1) {
                                            this.nodes[k].x += (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[k].y += (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[t].x -= (this.nodes[k].x - this.nodes[t].x) / (this.nodes[k].radius + this.nodes[t].radius)
                                            this.nodes[t].y -= (this.nodes[k].y - this.nodes[t].y) / (this.nodes[k].radius + this.nodes[t].radius)
                                        } else {
                                            break
                                        }
                                    } else {
                                        break
                                    }
                                }
                            }
                        }
                    }
                }
            }
            // this.leftshoulder.x = this.body.x - (this.body.radius + this.shoulderwidth)
            // this.leftshoulder.y = this.body.y

            // this.rightshoulder.x = this.body.x + (this.body.radius + this.shoulderwidth)
            // this.rightshoulder.y = this.body.y

        }
        idify() {
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            this.righthand.id = parseFloat(Math.random().toFixed(5))
            this.lefthand.id = parseFloat(Math.random().toFixed(5))
            this.middlehand.id = parseFloat(Math.random().toFixed(5))
            this.body.id = parseFloat(Math.random().toFixed(5))
            if (typeof this.lefthand2 != "undefined") {
                this.righthand2.id = parseFloat(Math.random().toFixed(5))
                this.lefthand2.id = parseFloat(Math.random().toFixed(5))
                this.righthand3.id = parseFloat(Math.random().toFixed(5))
                this.lefthand3.id = parseFloat(Math.random().toFixed(5))
            }
        }
        shotcleaner() {
            if (AItoggle == 0  && localPlayToggle == 0 && this.serverID != serverID) {
                return
            }
            for (let t = 0; t < this.shots.length; t++) {
                if (this.shots[t].y > (1440 * (invscale * .5)) || this.shots[t].x < 0 || this.shots[t].x > (2560 * (invscale * .5)) || this.shots[t].y < 0) {
                    if (campaignToggle == 0) {
                        this.shots[t].marked = 1
                    } else if (this.shots[t].y > (1840 * (invscale * .5))) {
                        this.shots[t].marked = 1
                    }
                }
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            if (this.shotIDs.length > 100) {
                this.shotIDs.splice(0, 50)
            }
            for (let t = 0; t < this.shots.length; t++) {
                for (let k = 0; k < boys.length; k++) {
                    const line = new LineOP(this.shots[t], boys[k].body)
                    const rline = new LineOP(this.righthand, boys[k].body)
                    const lline = new LineOP(this.lefthand, boys[k].body)
                    if (line.hypotenuse() < (this.shots[t].radius + boys[k].body.radius)) {
                        if (boys[k] == this) {
                            continue
                        }
                        this.shots[t].marked = 5
                    }
                }
            }
        }
        enemycollide() {
            const armfixstorage = {}
            armfixstorage.xcomp = this.body.xmom
            armfixstorage.ycomp = this.body.ymom
            this.shotcleaner()
            if (this.inactive == 1) {
                return
            }


            for (let f = 0; f < boys.length; f++) {
                if (boys[f] && this != boys[f]) {
                    for (let t = 0; t < boys.length; t++) {
                        if (this != boys[t] && boys[t]) {
                            for (let k = 0; k < boys[t].shots.length; k++) {
                                if (boys[t].shots[k].marked != 1 && !this.shotIDs.includes(boys[t].shots[k].id)) {
                                    if (boys[t].shots[k].doesPerimeterTouch(this.body)) {
                                        this.shotIDs.push(boys[t].shots[k].id)
                                        if (this.reflecting <= 0) {
                                            if (AItoggle == 0  && localPlayToggle == 0) {
                                                this.striker = boys[t].serverID
                                            } else if (AItoggle == 1 || localPlayToggle == 1) {
                                                this.striker = t
                                            }
                                            this.struck = 1
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].shots[k].xmom * (this.damage / 200)) + (boys[t].shots[k].xmom * baselaunch)) * 2
                                                this.body.ymom = (((boys[t].shots[k].ymom * (this.damage / 200)) + (boys[t].shots[k].ymom * baselaunch)) * 2) - (10 * (this.damage / 200))
                                                this.damage += (Math.abs(boys[t].shots[k].xmom) + Math.abs(boys[t].shots[k].ymom)) / 2
                                                this.breaktimer = 0
                                            }
                                            boys[t].shots[k].marked = 1
                                        } else {
                                            boys[t].shots[k].ymom *= -1
                                            boys[t].shots[k].xmom *= -1
                                            this.shots.push(boys[t].shots[k])
                                            boys[t].shots.splice(k, 1)
                                        }
                                    }
                                }
                            }


                            if (boys[t].hasOwnProperty('radball')) {
                                if (boys[t].radball.isPointInside(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (this.shield == 1) {
                                        this.shieldpower -= 5
                                    } else {
                                        this.damage += 73.5 / boys[t].radball.radius
                                        this.breaktimer = -1
                                    }

                                    //this.shotIDs.push(boys[t].radball.id)
                                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                        this.lefthand.anchored = -20
                                        this.righthand.anchored = -20
                                    }
                                    if (this.body.ymom < -vsmashlimit) {
                                        this.body.ymom = -vsmashlimit
                                    }
                                    if (this.body.ymom > vsmashlimit) {
                                        this.body.ymom = vsmashlimit
                                    }
                                    if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                        //  this.body.move(this)
                                    }
                                    this.fixupshoulder()
                                }
                            }

                            const enemycheckline = new LineOP(this.body, boys[t].body)
                            if (enemycheckline.sqrDis() > 310000) {
                                continue
                            }


                            if (boys[t].hasOwnProperty('bananahand2')) {
                                if (boys[t].bananahand2.fired > 14) {
                                    boys[t].bananahand2s = castBetween(boys[t].bananashoulder2, boys[t].bananahand2, armgranularity, boys[t].bananashoulder2.radius)
                                    if (boys[t].bananahand2s.doesPerimeterTouch(this.body) || boys[t].bananahand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand2.xmom * (this.damage / 200)) + (boys[t].bananahand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand2.ymom * (this.damage / 200)) + (boys[t].bananahand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand2.xmom) + Math.abs(boys[t].bananahand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand2.fired = 14

                                                this.shotIDs.push(boys[t].bananahand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand2')) {
                                if (boys[t].middlehand2.fired > 14) {
                                    boys[t].middlehand2s = castBetween(boys[t].middleshoulder2, boys[t].middlehand2, armgranularity, boys[t].middleshoulder2.radius)
                                    if (boys[t].middlehand2s.doesPerimeterTouch(this.body) || boys[t].middlehand2.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand2.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand2.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand2.xmom * (this.damage / 200)) + (boys[t].middlehand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand2.ymom * (this.damage / 200)) + (boys[t].middlehand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand2.xmom) + Math.abs(boys[t].middlehand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand2.fired = 14

                                                this.shotIDs.push(boys[t].middlehand2.id)
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
if(this.hasOwnProperty('bananahand')){
if (this.bananahand.anchored == 1) {
                                        this.bananahand.anchored = -20
}
}
if(this.hasOwnProperty('bananahand2')){
if (this.bananahand2.anchored == 1) {
                                        this.bananahand2.anchored = -20
}
}
if(this.hasOwnProperty('middlehand')){
if (this.middlehand.anchored == 1) {
                                        this.middlehand.anchored = -20
}
}
if(this.hasOwnProperty('middlehand2')){
if (this.middlehand2.anchored == 1) {
                                        this.middlehand2.anchored = -20
}
}



                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (boys[t].hasOwnProperty('bananahand')) {
                                if (boys[t].bananahand.fired > 14) {
                                    boys[t].bananahands = castBetween(boys[t].bananashoulder, boys[t].bananahand, armgranularity, boys[t].bananashoulder.radius)
                                    if (boys[t].bananahands.doesPerimeterTouch(this.body) || boys[t].bananahand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].bananahand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].bananahand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].bananahand.xmom * (this.damage / 171)) + (boys[t].bananahand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].bananahand.ymom * (this.damage / 171)) + (boys[t].bananahand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].bananahand.xmom) + Math.abs(boys[t].bananahand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].bananahand.fired = 14

                                                this.shotIDs.push(boys[t].bananahand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }
                            }
                            if (boys[t].hasOwnProperty('middlehand')) {
                                if (boys[t].middlehand.fired > 14) {
                                    boys[t].middlehands = castBetween(boys[t].middleshoulder, boys[t].middlehand, armgranularity, boys[t].middleshoulder.radius)
                                    if (boys[t].middlehands.doesPerimeterTouch(this.body) || boys[t].middlehand.doesPerimeterTouch(this.body)) {
                                        if (AItoggle == 0  && localPlayToggle == 0) {
                                            this.striker = boys[t].serverID
                                        } else if (AItoggle == 1 || localPlayToggle == 1) {
                                            this.striker = t
                                        }
                                        this.struck = 1
                                        if (boys[t].middlehand.fired > 14) {
                                            if (!this.shotIDs.includes(boys[t].middlehand.id)) {
                                                if (this.shield == 1) {
                                                    this.shieldpower -= (Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 11
                                                } else {
                                                    this.body.xmom = 1 * ((boys[t].middlehand.xmom * (this.damage / 171)) + (boys[t].middlehand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.body.ymom = 1 * (((boys[t].middlehand.ymom * (this.damage / 171)) + (boys[t].middlehand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.damage += 1 * ((Math.abs(boys[t].middlehand.xmom) + Math.abs(boys[t].middlehand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                    this.breaktimer = 0
                                                }
                                                boys[t].middlehand.fired = 14

                                                this.shotIDs.push(boys[t].middlehand.id)
                                                if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                    this.lefthand.anchored = -20
                                                    this.righthand.anchored = -20
                                                }
                                                if (this.body.ymom < -vsmashlimit) {
                                                    this.body.ymom = -vsmashlimit
                                                }
                                                if (this.body.ymom > vsmashlimit) {
                                                    this.body.ymom = vsmashlimit
                                                }
                                                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                    this.body.move(this)
                                                }
                                                this.fixupshoulder()
                                            }
                                        }
                                    }
                                }

                            }
                            if (typeof boys[t].lefthand2 != "undefined") {
                                boys[t].lefthands2 = castBetween(boys[t].leftshoulder2, boys[t].lefthand2, armgranularity, boys[t].leftshoulder2.radius)
                                boys[t].righthands2 = castBetween(boys[t].rightshoulder2, boys[t].righthand2, armgranularity, boys[t].rightshoulder2.radius)
                                boys[t].lefthands3 = castBetween(boys[t].leftshoulder3, boys[t].lefthand3, armgranularity, boys[t].leftshoulder3.radius)
                                boys[t].righthands3 = castBetween(boys[t].rightshoulder3, boys[t].righthand3, armgranularity, boys[t].rightshoulder3.radius)
                                if (boys[t].righthands2.doesPerimeterTouch(this.body) || boys[t].righthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand2.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand2.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 11
                                            } else {
                                                this.body.xmom = .3333 * ((boys[t].righthand2.xmom * (this.damage / 171)) + (boys[t].righthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = .3333 * (((boys[t].righthand2.ymom * (this.damage / 171)) + (boys[t].righthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += .3333 * ((Math.abs(boys[t].righthand2.xmom) + Math.abs(boys[t].righthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand2.fired = 14
                                            this.shotIDs.push(boys[t].righthand2.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                                if (boys[t].lefthands2.doesPerimeterTouch(this.body) || boys[t].lefthand2.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand2.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand2.xmom * (this.damage / 171)) + (boys[t].lefthand2.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand2.ymom * (this.damage / 171)) + (boys[t].lefthand2.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand2.xmom) + Math.abs(boys[t].lefthand2.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand2.fired = 14
                                        this.shotIDs.push(boys[t].lefthand2.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()

                                    }
                                }
                                if (boys[t].righthands3.doesPerimeterTouch(this.body) || boys[t].righthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].righthand3.xmom * (this.damage / 171)) + (boys[t].righthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].righthand3.ymom * (this.damage / 171)) + (boys[t].righthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].righthand3.xmom) + Math.abs(boys[t].righthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].righthand3.fired = 14
                                        this.shotIDs.push(boys[t].righthand3.id)
                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                                if (boys[t].lefthands3.doesPerimeterTouch(this.body) || boys[t].lefthand3.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand3.fired > 14) {
                                        if (this.shield == 1) {
                                            this.shieldpower -= .3333 * (Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 11
                                        } else {
                                            this.body.xmom = .3333 * ((boys[t].lefthand3.xmom * (this.damage / 171)) + (boys[t].lefthand3.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.body.ymom = .3333 * (((boys[t].lefthand3.ymom * (this.damage / 171)) + (boys[t].lefthand3.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.damage += .3333 * ((Math.abs(boys[t].lefthand3.xmom) + Math.abs(boys[t].lefthand3.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            this.breaktimer = 0
                                        }
                                        boys[t].lefthand3.fired = 14
                                        this.shotIDs.push(boys[t].lefthand3.id)

                                        if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                            this.lefthand.anchored = -20
                                            this.righthand.anchored = -20
                                        }
                                        if (this.body.ymom < -vsmashlimit) {
                                            this.body.ymom = -vsmashlimit
                                        }
                                        if (this.body.ymom > vsmashlimit) {
                                            this.body.ymom = vsmashlimit
                                        }
                                        if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                            this.body.move(this)
                                        }
                                        this.fixupshoulder()
                                    }
                                }
                            }

                            if (boys[t].righthand.fired > 14) {
                                boys[t].righthands = castBetween(boys[t].rightshoulder, boys[t].righthand, armgranularity, boys[t].rightshoulder.radius)
                                if (boys[t].righthands.doesPerimeterTouch(this.body) || boys[t].righthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].righthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].righthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 11
                                            } else {
                                                this.body.xmom = ((boys[t].righthand.xmom * (this.damage / 171)) + (boys[t].righthand.xmom * baselaunch)) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].righthand.ymom * (this.damage / 171)) + (boys[t].righthand.ymom * baselaunch)) * 1) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].righthand.xmom) + Math.abs(boys[t].righthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].righthand.fired = 14
                                            this.shotIDs.push(boys[t].righthand.id)

                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].lefthand.fired > 14) {
                                boys[t].lefthands = castBetween(boys[t].leftshoulder, boys[t].lefthand, armgranularity, boys[t].leftshoulder.radius)
                                if (boys[t].lefthands.doesPerimeterTouch(this.body) || boys[t].lefthand.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].lefthand.fired > 14) {
                                        if (!this.shotIDs.includes(boys[t].lefthand.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 11) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                            } else {
                                                this.body.xmom = (boys[t].lefthand.xmom * (this.damage / 171)) + (boys[t].lefthand.xmom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].lefthand.ymom * (this.damage / 171)) + (boys[t].lefthand.ymom * baselaunch) * Math.max((1 + (boys[t].blasting / 80)), 1)) * 1)
                                                this.damage += ((Math.abs(boys[t].lefthand.xmom) + Math.abs(boys[t].lefthand.ymom)) / 7) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].lefthand.fired = 14
                                            this.shotIDs.push(boys[t].lefthand.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                            if (boys[t].body.fired > 0) {
                                if (boys[t].body.fired > 0 && boys[t].body.doesPerimeterTouch(this.body)) {
                                    if (AItoggle == 0  && localPlayToggle == 0) {
                                        this.striker = boys[t].serverID
                                    } else if (AItoggle == 1 || localPlayToggle == 1) {
                                        this.striker = t
                                    }
                                    this.struck = 1
                                    if (boys[t].body.fired > 0) {
                                        if (!this.shotIDs.includes(boys[t].body.id)) {
                                            if (this.shield == 1) {
                                                this.shieldpower -= (Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 3
                                            } else {
                                                this.body.xmom = ((boys[t].body.xmom * (this.damage / 171)) + (boys[t].body.xmom * baselaunch) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.body.ymom = (((boys[t].body.ymom * (this.damage / 171)) + (boys[t].body.ymom * baselaunch)) * 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.damage += ((Math.abs(boys[t].body.xmom) + Math.max(20, Math.abs(boys[t].body.ymom))) / 2) * Math.max((1 + (boys[t].blasting / 80)), 1)
                                                this.breaktimer = 0
                                            }
                                            boys[t].body.fired = 0
                                            this.shotIDs.push(boys[t].body.id)
                                            if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                                                this.lefthand.anchored = -20
                                                this.righthand.anchored = -20
                                            }
                                            if (this.body.ymom < -vsmashlimit) {
                                                this.body.ymom = -vsmashlimit
                                            }
                                            if (this.body.ymom > vsmashlimit) {
                                                this.body.ymom = vsmashlimit
                                            }
                                            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                                this.body.move(this)
                                            }
                                            this.fixupshoulder()
                                        }
                                    }
                                }
                            }
                        }
                    }
                    let j = 0
                    while (boys[f].body.doesPerimeterTouch(this.body)) {
                        j++
                        if (j > 100) {
                            break
                        }
                        this.body.x += (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        this.body.y += (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.x -= (this.body.x - boys[f].body.x) / (this.body.radius + boys[f].body.radius)
                        boys[f].body.y -= (this.body.y - boys[f].body.y) / (this.body.radius + boys[f].body.radius)
                        this.fixupshoulder()
                        boys[f].fixupshoulder()
                        this.body.ymom *= .99
                    }
                }
            }

            if ((this.body.ymom - armfixstorage.ycomp) != 0) {
                this.body.ymom *= .5
            }

            for (let t = 0; t < this.nodes.length; t++) {
                if (this.nodes[t] != this.body) {
                    this.nodes[t].xmom += (this.body.xmom - armfixstorage.xcomp)
                    this.nodes[t].ymom += (this.body.ymom - armfixstorage.ycomp)
                }
            }
        }
        AIarmControl() {
            if (this.inactive == 1) {
                return
            }
            if (this.wmove == 1) {
                this.jumping = 1
                this.body.ymom = -this.speed * 4
                this.lefthand.ymom = -this.speed * 4
                this.righthand.ymom = -this.speed * 4
                this.middlehand.ymom = -this.speed * 4
                this.jumpcount = 100

            }
        }
        doJump(object, speed) {
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (keysPressed['w']) {
                    this.jumping = 1
                    object.ymom = -this.speed * 4
                    this.jumpcount = 100 - this.jumpreduction
                } else {
                    if (typeof object != 'undefined') {
                        if (typeof (this.gamepad.gamepad.axesStatus[1]) != 'undefined') {
                            if (typeof (this.gamepad.gamepad.axesStatus[0]) != 'undefined') {
                                object.x += (this.gamepad.gamepad.axesStatus[0] * this.speed)
                                if ((this.gamepad.gamepad.axesStatus[1] * this.speed) < this.speed * -.5) {
                                    object.ymom = -this.speed * 1 * 4
                                    this.jumping = 1
                                    this.jumpcount = 100 - this.jumpreduction
                                }
                            }
                        }
                    }
                }
            }
        }
        doubleJump() {

            if (this.inactive == 1) {
                return
            }
            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            this.jumpcount--

            if (this.jumpcount <= -20) {
                if (boys.indexOf(this) <= humanPlayers) {
                    this.doJump(this.body, this.speed)
                    this.doJump(this.lefthand, this.speed)
                    this.doJump(this.righthand, this.speed)
                    this.doJump(this.middlehand, this.speed)
                } else {
                    this.AIarmControl()
                }
            }
        }
        breaks() {
            if (this.inactive == 1) {
                return
            }

            if (this.shield == 1) {
                if (this.shieldpower <= 0) {
                    this.breaktimer = 200
                    this.shieldpower = 1
                    this.shield = 0
                }
            }
        }

        AImove(object, speed) {
            if (object == this.body) {
                this.amom--
                this.dmom--
                this.dmomu--
                this.amomu--
            }
            this.wmove = 0
            this.amove = 0
            this.dmove = 0
            if (Math.random() < .0015) {
                this.fleeing = 1
            }
            if (this.charge > 90) {
                this.fleeing = 0
            }
            if (Math.random() < .05) {
                this.fleeing = 0
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (Math.random() < .5) {
                    if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    } else if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    }
                } else {
                    if (this.amove == 1) {
                        this.amove = 0
                        this.dmove = 1
                    } else if (this.dmove == 1) {
                        this.amove = 1
                        this.dmove = 0
                    }
                }
                this.fleeing = 0
            } else {

            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {

                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        this.wmove = 1
                                        this.screwshot = 1
                                    }
                                }
                            }
                        }
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) > 1 && this.body.y > (boys[t].body.y + Math.max(this.body.radius, boys[t].body.radius))) {
                        this.wmove = 1
                    }

                    if (this.fleeing == 0) {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x > (boys[t].body.x + 5)) {
                            this.amove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x < (boys[t].body.x + 5)) {
                            this.dmove = 1
                        }
                    } else {
                        if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x > (boys[t].body.x + 5)) {
                            this.dmove = 1
                        } else if (Math.abs(this.body.x - boys[t].body.x) > (this.body.radius * 3) && this.body.x < (boys[t].body.x + 5)) {
                            this.amove = 1
                        }
                    }


                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        if (Math.random() < .2) {
                            this.wmove = 1
                        }
                        if (Math.random() < .1) {
                            this.dmove = 1
                        }
                        if (Math.random() < .1) {
                            this.amove = 1
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }


            this.under = 0
            this.trapped = 0
            for (let k = 0; k < boys.length; k++) {

                for (let t = 0; t < stage.bricks.length; t++) {
                    if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                        if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                            if (this.body.y > (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y))) {
                                this.trapped = 4
                            }
                        }
                    }
                }
                if (boys[k] && this != boys[k]) {
                    for (let t = 0; t < stage.bricks.length; t++) {
                        if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 1.6)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 1.6))) {
                            if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) < this.body.y) {
                                if (boys[k].brick == stage.bricks[t]) {
                                    this.under = 1
                                    this.bricksto = stage.bricks[t]
                                    if (Math.abs(Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) - this.body.y) < 300) {
                                        this.under = 4
                                        this.bricksto = stage.bricks[t]
                                        if (this.brick.edgeleft.x < stage.bricks[t].edgeleft.x && this.brick.edgeright.x < stage.bricks[t].edgeright.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 2
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 2
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                        if (this.brick.edgeright.x > stage.bricks[t].edgeright.x && this.brick.edgeleft.x > stage.bricks[t].edgeleft.x) {
                                            if ((boys[k].body.y - (boys[k].body.radius * .9)) < Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y)) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            } else {
                                                if (Math.random() < .01) {
                                                    this.under = 3
                                                    this.bricksto = stage.bricks[t]
                                                    break
                                                }
                                            }
                                        } else {
                                            if (Math.random() < .01) {
                                                this.under = 3
                                                this.bricksto = stage.bricks[t]
                                                break
                                            }
                                        }
                                    }
                                }
                                this.bricksto = stage.bricks[t]
                                break
                            }
                        }
                    }
                }
            }
            if (this.under !== 0 && this.under !== 4 && (this.amom <= 0 && this.dmom <= 0)) {
                if (this.under == 3) {
                    this.amove = 0
                    this.dmom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.amom = 0
                    this.dmove = 1
                    this.screwshot = 1
                    this.wmove = 1
                }
                if (this.under == 2) {
                    this.amove = 1
                    this.amom = (Math.abs(Math.abs(this.bricksto.center.x - this.body.x) - this.bricksto.width) / this.speed) * 1.03
                    this.dmom = 0
                    this.dmove = 0
                    this.wmove = 1
                    this.screwshot = 1
                }
            }
            this.exgrip = 0
            for (let t = 0; t < boys.length; t++) {
                if (this.amomu <= 0 && this.dmomu <= 0) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].brick.center.y > this.brick.center.y) {
                            if (boys[t].body.x < this.body.x) {
                                this.amomu = (Math.abs(this.brick.edgeleft.x - this.body.x)) / this.speed
                                this.amomu += 15
                                this.exgrip = 1
                            } else {
                                this.dmomu = (Math.abs(this.brick.edgeright.x - this.body.x)) / this.speed
                                this.dmomu += 15
                                this.exgrip = 1
                            }
                        }
                    }
                } else {
                    this.exgrip = 1
                }
            }


            if (this.dmom > 0) {
                this.screwshot = 1
                this.dmove = 1
                this.wmove = 1
                this.amove = 0
                this.amom = 0
            } else {

                if (this.dmomu > 0) {
                    this.dmove = 1
                    this.amove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }
            if (this.amom > 0) {
                this.screwshot = 1
                this.dmom = 0
                this.amove = 1
                this.wmove = 1
                this.dmove = 0
            } else {
                if (this.amomu > 0) {
                    this.amove = 1
                    this.dmove = 0
                    this.screwshot = 0
                    if (Math.random() < .95) {
                        this.wmove = 0
                    }
                }
            }

            if (this.safe == 0) {
                if (this.under == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                }
                if (this.body.x > (this.brick.center.x)) {
                    this.amove = 1
                    this.dmove = 0
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                } else {
                    this.amove = 0
                    this.dmove = 1
                    this.wmove = 1
                    //this.amomu = 0
                    //this.dmomu = 0
                }
                this.fleeing = 0
            } else {

            }

            if (this.trapped == 0) {
                this.tarmax = 0
                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        if (boys[t].damage >= this.tarmax) {
                            if (boys[t].safe == 1 || boys[t].safesto == 2) {
                                this.target = boys[t]
                                let cancel = 0
                                if (typeof this.target.body.x == "number") {
                                    if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                        cancel = -1
                                    }
                                    if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                        cancel = 1
                                    }
                                }
                                this.tarmax = boys[t].damage
                                if (Math.random() < .1) {
                                    this.bricksto = this.brick
                                    this.brick = this.target.brick
                                    if (this.target.body.x > this.body.x) {
                                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                                        const runtimeR = xdisR / this.speed
                                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                                        if (droptimerR < (runtimeR * .95)) {//&& this.body.fired < 3.8 * runtimeR) {
                                            this.dmove = 1
                                            this.amove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    } else {
                                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                                        const runtimeL = xdisL / this.speed
                                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                                        if (droptimerL < (runtimeL * .95)) {// && this.body.fired < 3.8 * runtimeL) {
                                            this.amove = 1
                                            this.dmove = 0
                                            this.safe = 1
                                            if (cancel == 0) {
                                                this.screwshot = 1
                                                this.wmove = 1
                                            }
                                        } else {
                                            this.brick = this.bricksto
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                let cancel = 0

                if (typeof this.target != "undefined") {
                    if (typeof this.target.body != "undefined") {
                        if (typeof this.target.body.x == "number") {
                            if (this.brick.edgeright.x > this.target.brick.edgeleft.x) {
                                cancel = -1
                            }
                            if (this.brick.edgeleft.x < this.target.brick.edgeright.x) {
                                cancel = 1
                            }
                        }
                    }
                }
                if (this.target.safe == 1 || this.target.safesto == 2) {
                    if (this.target.body.x > this.body.x) {
                        const xdisR = Math.abs(this.brick.edgeright.x - (this.body.x - (this.body.radius * 1.1)))
                        const runtimeR = xdisR / this.speed
                        const droptimerR = (((this.body.ymom + (this.gravity * runtimeR)) * runtimeR) / runtimeR)
                        if (droptimerR < (runtimeR * .8)) {// && this.body.fired < 1.8 * runtimeR) {
                            this.dmove = 1
                            this.amove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1 //erroor
                                this.wmove = 1
                            }
                        }
                    } else {
                        const xdisL = Math.abs(this.brick.edgeleft.x - (this.body.x + (this.body.radius * 1.1)))
                        const runtimeL = xdisL / this.speed
                        const droptimerL = (((this.body.ymom + (this.gravity * runtimeL)) * runtimeL) / runtimeL)
                        if (droptimerL < (runtimeL * .8)) {// && this.body.fired < 1.8 * runtimeL) {
                            this.amove = 1
                            this.dmove = 0
                            this.safe = 1
                            if (cancel == 0) {
                                this.screwshot = 1//error
                                this.wmove = 1
                            }
                        }
                    }
                } else {
                    if (this.target.safe == 0) {
                        if (this.target.righthand.anchored != 1 && this.target.lefthand.anchored != 1) {
                            this.fleeing = 1
                        }
                    }
                }
            } else {
                if (this.safe == 0) {
                    this.screwshot = 1
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
            }

            if (this.body.y < 900) {
                this.wmove = 0
                this.screwshot = 0
            }
            if (this.shield == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (this != boys[t] && boys[t]) {
                        for (let g = 0; g < boys[t].shots.length; g++) {
                            const link = new LineOP(this.body, boys[t].shots[g])
                            if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                                if (this.grounded == 1) {
                                    if (boys[t].shots[g].stuck != 1) {
                                        this.storeshield = 1
                                    } else {
                                        this.wmove = 1
                                    }
                                } else {
                                    if (this.body.x < boys[t].shots[g].x) {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 1
                                            this.dmove = 0
                                        }
                                    } else {
                                        if (this.amom <= 0 && this.dmom <= 0) {
                                            this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                            this.amove = 0
                                            this.dmove = 1
                                        }
                                    }
                                }
                                break
                            } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                                if (boys[t].shots[g].ymom > 0) {
                                    if (boys[t].body.y < this.body.y) {
                                        if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                            this.fleeing = 1
                                            if (this.body.x < boys[t].shots[g].x) {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.amom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 1
                                                    this.dmove = 0
                                                }
                                            } else {
                                                if (this.amom <= 0 && this.dmom <= 0) {
                                                    this.dmom = ((this.body.radius * 1.2) + boys[t].shots[g].radius * 2) / this.speed
                                                    this.amove = 0
                                                    this.dmove = 1
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                        if (this.body.y < boys[t].shots[g].y) {
                                            if (boys[t].shots[g].x > this.body.x) {
                                                if (boys[t].shots[g].xmom < 0) {
                                                    this.fleeing = 1
                                                }
                                            } else {
                                                if (boys[t].shots[g].xmom > 0) {
                                                    this.fleeing = 1
                                                }
                                            }
                                        } else {
                                            if (this.grounded == 1) {
                                                this.fleeing = 1
                                            }
                                        }
                                        if (this.under == 0) {
                                            this.wmove = 1
                                            if (this.dmomu <= 0 && this.amomu <= 0) {
                                                this.screwshot = 1
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                if (this.safe == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                    if (this.body.x > (this.brick.center.x)) {
                        this.amove = 1
                        this.dmove = 0
                        this.wmove = 1
                        this.amom = this.dmom
                        this.dmom = 0
                        //this.amomu = 0
                        //this.dmomu = 0
                    } else {
                        this.amove = 0
                        this.dmove = 1
                        this.wmove = 1
                        this.dmom = this.amom
                        this.amom = 0
                        //this.amomu = 0
                        //this.dmomu = 0
                    }
                    this.fleeing = 0
                } else {

                }
                if (this.dmove == 0 && this.amove == 0) {
                    if (Math.random() < .5) {
                        this.dmove = 1
                    } else {
                        this.amove = 1
                    }
                }

                for (let t = 0; t < stage.walls.length; t++) {
                    if (Math.abs(this.body.x - stage.walls[t].center.x) <= (stage.walls[t].width + (this.body.radius * 2))) {
                        if (Math.abs(this.body.y - stage.walls[t].center.y) <= (stage.walls[t].height + (this.body.radius * 2))) {
                            if (this.body.x > stage.walls[t].center.x) {
                                if (this.amove == 1) {
                                    this.wmove = 1
                                }
                            } if (this.body.x < stage.walls[t].center.x) {
                                if (this.dmove == 1) {
                                    this.wmove = 1
                                }
                            }
                        }
                    }
                }
                if (this.wmove == 1) {
                    if (this.grounded == 1) {
                        this.jumping = 1
                        object.ymom -= speed * 4
                    } else {
                        if (this.lefthand.anchored == 1) {
                            this.degripl()
                            this.jumping = 1
                            object.ymom -= speed * 2
                        }
                        if (this.righthand.anchored == 1) {
                            this.degripr()
                            this.jumping = 1
                            object.ymom -= speed * 2
                        }
                    }
                }
                if (this.dmove == 1) {
                    this.face = 1
                    if (object == this.body) {
                        object.x += speed
                        this.righthand.x += speed
                        this.lefthand.x += speed
                        this.middlehand.x += speed
                    }
                    if (this.righthand.anchored == 1) {
                        this.degripr()
                        this.jumping = 1
                    }
                }
                // if (keysPressed['s']) {
                //     object.y += speed
                //     this.degrip()
                // }
                if (this.amove == 1) {
                    this.face = -1
                    if (object == this.body) {
                        object.x -= speed
                        this.righthand.x -= speed
                        this.lefthand.x -= speed
                        this.middlehand.x -= speed
                    }
                    if (this.righthand.anchored == 1 || this.lefthand.anchored == 1) {
                        this.degripl()
                        this.jumping = 1
                    }
                }


                // if (typeof (controller.gamepad.axesStatus[1]) != 'undefined') {
                // if (controller.gamepad.axesStatus[0] > .1) {
                //     this.face = 1
                // }

                // if (controller.gamepad.axesStatus[1] < -.1) {
                //     this.face = -1
                // }
                // }

            }
            // if (this.dmomu > 0 || this.amomu > 0) {
            //     this.lefthand.anchored = 0
            //     this.righthand.anchored = 0
            // }

            if (this.exgrip == 1) {
                this.righthand.anchored = 0
                this.lefthand.anchored = 0
            }
        }
        AI() {
            this.idify()

            if (this.inactive == 1) {
                return
            }
            this.breaks()

            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.middlehand.fired--
            this.lefthand.fired--
            this.charge--
            if (this.charge <= 0) {
                this.charge = 0
            }




            if (this.body.fired == 50) {
                const shot = new Shot(this.body.x, this.body.y, 30 - (this.body.fired * .5), this.body.color, this.body.xmom, jumplimit)
                this.shots.push(shot)
                this.body.xmom += this.punchspeed * this.face
            }
            if (this.body.fired == 40) {
                const shot = new Shot(this.body.x, this.body.y, 30 - (this.body.fired * .5), this.body.color, this.body.xmom, jumplimit)
                this.shots.push(shot)

                this.body.xmom += this.punchspeed * this.face
            }
            if (this.body.fired == 30) {
                const shot = new Shot(this.body.x, this.body.y, 30 - (this.body.fired * .5), this.body.color, this.body.xmom, jumplimit)
                this.shots.push(shot)

                this.body.xmom += this.punchspeed * this.face
            }
            if (this.body.fired == 20) {
                const shot = new Shot(this.body.x, this.body.y, 30 - (this.body.fired * .5), this.body.color, this.body.xmom, jumplimit)
                this.shots.push(shot)

                this.body.xmom += this.punchspeed * this.face
            }
            if (this.body.fired == 10) {
                const shot = new Shot(this.body.x, this.body.y, 30 - (this.body.fired * .5), this.body.color, this.body.xmom, jumplimit)
                this.shots.push(shot)
                this.body.xmom += this.punchspeed * this.face
            }

            if (this.body.fired == 0) {
                this.body.xmom *= .5
            }

            this.body.fired -= 1
            this.reflecting--

            this.breaktimer--
            // if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] ||  keysPressed['e']) {

            if (Math.random() < .1) {
                this.storeshield = 0
            }
            if (Math.random() < .5) {
                this.screwshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.rightshot = 0
            }
            if (Math.random() < .01 || this.charge == 0) {
                this.leftshot = 0
            }
            if (Math.random() < .1) {
                this.downspike = 0
            }
            if (Math.random() < .1) {
                this.hortsmash = 0
            }
            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {


                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.dmomu <= 0 && this.amomu <= 0) {
                                            this.wmove = 1
                                            this.screwshot = 1
                                        }
                                    }
                                }
                            }
                        }
                    }

                    if (Math.abs(this.body.x - boys[t].body.x) < 50 && this.body.y < boys[t].body.y) {
                        if (this.brick == boys[t].brick) {
                            this.downspike = 1
                        }
                    } else if (Math.abs(this.body.x - boys[t].body.x) < 150 && this.body.y <= boys[t].body.y && (boys[t].righthand.anchored == 1 || boys[t].lefthand.anchored == 1)) {
                        if (this.brick == boys[t].brick) {
                            this.downspike = 1
                        }
                    }
                    if (Math.abs(this.body.x - boys[t].body.x) < 70 && this.body.y > boys[t].body.y) {
                        if (this.dmomu <= 0 && this.amomu <= 0) {
                            this.screwshot = 1
                        }
                    }




                    if (Math.abs(this.body.x - boys[t].body.x) < 240) {
                        if (this.body.x > boys[t].body.x) {
                            if (this.face == 1) {
                                this.hortsmash = 1
                            }
                        }
                        if (this.body.x < boys[t].body.x) {
                            if (this.face == -1) {
                                this.hortsmash = 1
                            }
                        }
                    }

                    if (boys[t].righthand.fired > 14) {
                        if (this.body.x > boys[t].body.x) {
                            if (Math.random() < .09) {
                                this.storeshield = 1
                            }
                        }
                    }
                    if (this.screwshot + this.hortsmash + this.downspike + this.storeshield == 0) {
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x > boys[t].body.x) {
                            if (this.face == -1) {
                                this.leftshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.leftshot = 0
                                    }
                                }
                            }
                        }
                        if (Math.abs(this.body.y - boys[t].body.y) < 35 && this.body.x < boys[t].body.x) {
                            if (this.face == 1) {
                                this.rightshot = 1
                                if (Math.abs(this.body.x - boys[t].body.x) < 170) {
                                    if (Math.random() < .009) {
                                        this.hortsmash = 1
                                        this.rightshot = 0
                                    }
                                }
                            }
                        }
                    }


                    if (Math.abs(this.body.y - boys[t].body.y) < 50 && Math.abs(this.body.x - boys[t].body.x) < 200) {
                        if (boys[t].lefthand.fired > 14 || boys[t].righthand.fired > 14) {
                            if (this.body.x < boys[t].body.x) {
                                if (Math.random() < .4) {
                                    this.storeshield = 1
                                }
                            }
                        }
                    }
                }
            }


            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            if (this.safe == 0) {
                if (this.under == 0) {
                    if (this.dmomu <= 0 && this.amomu <= 0) {
                        this.screwshot = 1
                    }
                } else {
                    this.wmove = 1
                }
            }

            for (let t = 0; t < boys.length; t++) {
                if (this != boys[t] && boys[t]) {
                    for (let g = 0; g < boys[t].shots.length; g++) {
                        const link = new LineOP(this.body, boys[t].shots[g])
                        if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 32) {
                            if (boys[t].shots[g].stuck != 1) {
                                this.storeshield = 1
                                break
                            } else {
                                this.wmove = 1
                            }
                        } else if ((link.sqrDis()) / ((Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom)) * (Math.abs(boys[t].shots[g].xmom) + Math.abs(boys[t].shots[g].ymom))) < 100) {
                            if (boys[t].shots[g].ymom > 0) {
                                if (boys[t].body.y < this.body.y) {
                                    if (Math.abs(this.body.x - boys[t].shots[g].x) < ((this.body.radius) + boys[t].shots[g].radius * 2)) {

                                        this.fleeing = 1
                                        if (this.body.x < boys[t].body.x) {
                                            this.amom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        } else {
                                            this.dmom = ((this.body.radius * 2) + boys[t].shots[g].radius * 2) / this.speed
                                        }
                                    }
                                }
                            } else {
                                if (Math.abs(this.body.y - boys[t].shots[g].y) <= this.body.radius + boys[t].shots[g].radius) {
                                    if (this.body.y < boys[t].shots[g].y) {
                                        if (boys[t].shots[g].x > this.body.x) {
                                            if (boys[t].shots[g].xmom < 0) {
                                                this.fleeing = 1
                                            }
                                        } else {
                                            if (boys[t].shots[g].xmom > 0) {
                                                this.fleeing = 1
                                            }
                                        }
                                    } else {
                                        if (this.grounded == 1) {
                                            this.fleeing = 1
                                        }
                                    }
                                    if (this.under == 0) {
                                        if (this.dmomu <= 0 && this.amomu <= 0) {
                                            this.screwshot = 1
                                            this.wmove = 1
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if (this.shieldpower < 10) {
                if (Math.random() < .95) {
                    this.storeshield = 0
                }
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            if (this.storeshield == 1) {
                if (this.breaktimer < 0) {
                    if (this.grounded == 1) {
                        this.shieldpower -= .63
                        this.shield = 1
                        this.shielddraw = 1
                    }
                }
            } else {
                this.shield = 0
                this.shieldpower += .2
                if (this.shieldpower > 100) {
                    this.shieldpower = 100
                }
            }

            if (this.body.fired > 30) {
                this.body.ymom -= this.body.fired * .008
            }
            if (this.screwtimer == 30) {
                this.body.fired = 30
                this.body.ymom = 0
            } else if (this.screwtimer <= 30) {
                if (this.screwtimer > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.breaktimer <= 0 && this.shield == 0) {


                if (this.hortsmash == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.face == 1) {
                            if (this.righthand.anchored == 0) {
                                this.righthand.ymom = this.punchspeed * 8
                                this.righthand.xmom = this.punchspeed * 19.1
                                this.righthand.fired = 19
                                this.body.xmom -= 5
                                this.idify()
                            }
                        }
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.face == -1) {
                            if (this.lefthand.anchored == 0) {
                                this.lefthand.ymom = this.punchspeed * 8
                                this.lefthand.xmom = this.punchspeed * -19.1
                                this.lefthand.fired = 19
                                this.idify()
                            }
                        }
                    }
                    if (this.middlehand.fired <= 0) {
                        if (this.face == 1) {
                            if (this.lefthand.anchored == 0) {
                                this.middlehand.xmom = this.punchspeed * 19.1
                            }
                        }
                        if (this.face == -1) {
                            this.middlehand.xmom = this.punchspeed * -19.1
                        }
                        this.idify()
                        this.middlehand.ymom = this.punchspeed * -4
                        this.middlehand.fired = 19
                    }
                }

                if (this.body.fired > 30) {
                    this.body.ymom -= this.body.fired * .008
                }
                if (this.screwtimer == 30) {
                    this.body.fired = 30
                    this.body.ymom = 0
                } else if (this.screwtimer <= 30) {
                    if (this.screwtimer > 0) {
                        this.body.ymom = 0
                    }
                }
                if (this.screwshot == 1) {
                    if (this.righthand.fired <= 0) {
                        if (this.righthand.anchored == 0) {
                            this.rightshoulder.xmom = 0
                            this.rightshoulder.ymom = 0
                            this.righthand.fired = 19
                            this.righthand.ymom = this.punchspeed * -20
                            this.righthand.xmom = this.punchspeed * -4
                            this.idify()
                        }
                    }
                    if (this.middlehand.fired <= 0) {
                        this.middleshoulder.xmom = 0
                        this.middleshoulder.ymom = 0
                        this.middlehand.fired = 19
                        this.middlehand.ymom = this.punchspeed * -20
                        this.idify()
                    }
                    if (this.lefthand.fired <= 0) {
                        if (this.lefthand.anchored == 0) {
                            this.leftshoulder.xmom = 0
                            this.leftshoulder.ymom = 0
                            this.lefthand.ymom = this.punchspeed * -20
                            this.lefthand.xmom = this.punchspeed * 4
                            this.lefthand.fired = 19
                            this.idify()
                        }
                    }
                }
                if (this.downspike == 1) {
                    if (this.grounded == 0) {
                        if (this.body.fired <= -30) {
                            this.body.xmom = this.punchspeed * 5.5 * this.face
                            this.body.ymom = this.punchspeed * 6
                            this.body.fired = 30
                            this.jumping = 1
                        }
                    } else {
                        if (this.body.fired <= -30) {
                            this.reflecting = 25
                            this.body.fired = 5
                        }
                    }
                }

                if (this.rightshot == 1 || this.leftshot == 1) {
                    if (this.body.fired <= -30) {
                        this.jumping = 1
                        this.body.xmom = this.punchspeed * 5.5 * this.face
                        this.body.ymom = -this.punchspeed * 6
                        this.body.fired = 55
                    }
                }
            }

        }
        fightcontrol() {

            if (this.inactive == 1) {
                return
            }
            this.safe = 0
            this.safesto = 0
            for (let t = 0; t < stage.bricks.length; t++) {
                if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * .05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 0.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safe = 1

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                } else if (stage.bricks[t].edgeleft.x < (this.body.x + (this.body.radius * 4.05)) && stage.bricks[t].edgeright.x > (this.body.x - (this.body.radius * 4.05))) {
                    if (Math.max(stage.bricks[t].edgeright.y, stage.bricks[t].edgeleft.y) >= this.body.y + (this.body.radius * .1)) {
                        this.safesto = 2

                        if (stage.bricks[t].center.y < this.brick.center.y) {
                            this.brick = stage.bricks[t]
                        } else if (!(this.brick.edgeleft.x < (this.body.x + (this.body.radius * .05)) && this.brick.edgeright.x > (this.body.x - (this.body.radius * 0.05)))) {
                            this.brick = stage.bricks[t]
                        } else if (!(Math.max(this.brick.edgeright.y, this.brick.edgeleft.y) >= this.body.y + (this.body.radius * .1))) {
                            this.brick = stage.bricks[t]
                        }
                    }
                }
            }
            this.breaks()



            if (this.screwtimer > 0) {
                this.screwtimer--
                this.screwangle += this.screwmomentum
            } else {
                this.screwtimer = 0
                this.screwangle = 0
            }


            this.righthand.fired--
            this.middlehand.fired--
            this.charge--
            if (this.charge <= 0) {
                this.charge = 0
            }


            if (this.body.fired == 50) {
                const shot = new Shot(this.body.x, this.body.y, 30 - (this.body.fired * .5), this.body.color, this.body.xmom, jumplimit)
                this.shots.push(shot)
                this.body.xmom += this.punchspeed * this.face
            }
            if (this.body.fired == 40) {
                const shot = new Shot(this.body.x, this.body.y, 30 - (this.body.fired * .5), this.body.color, this.body.xmom, jumplimit)
                this.shots.push(shot)

                this.body.xmom += this.punchspeed * this.face
            }
            if (this.body.fired == 30) {
                const shot = new Shot(this.body.x, this.body.y, 30 - (this.body.fired * .5), this.body.color, this.body.xmom, jumplimit)
                this.shots.push(shot)

                this.body.xmom += this.punchspeed * this.face
            }
            if (this.body.fired == 20) {
                const shot = new Shot(this.body.x, this.body.y, 30 - (this.body.fired * .5), this.body.color, this.body.xmom, jumplimit)
                this.shots.push(shot)

                this.body.xmom += this.punchspeed * this.face
            }
            if (this.body.fired == 10) {
                const shot = new Shot(this.body.x, this.body.y, 30 - (this.body.fired * .5), this.body.color, this.body.xmom, jumplimit)
                this.shots.push(shot)
                this.body.xmom += this.punchspeed * this.face
            }

            if (this.body.fired == 0) {
                this.body.xmom *= .5
            }
            this.body.fired -= 1
            this.reflecting--
            this.lefthand.fired--


            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                this.shielddraw = 0
            }
            this.breaktimer--
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                if (this.gamepad.gamepad.buttonsStatus.includes('RB') || keysPressed['o'] || keysPressed['e']) {
                    if (this.breaktimer < 0) {
                        if (this.grounded == 1) {
                            this.shieldpower -= .63
                            this.shield = 1
                            this.shielddraw = 1
                        }
                    }
                } else {
                    this.shield = 0
                    this.shieldpower += .2
                    if (this.shieldpower > 100) {
                        this.shieldpower = 100
                    }
                }
            }

            if (this.breaktimer <= 0 && this.shield == 0) {

                if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {


                    if (this.gamepad.gamepad.buttonsStatus.includes('B') || (keysPressed['l'] || keysPressed['ArrowRight'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.face == 1) {
                                if (this.righthand.anchored == 0) {
                                    this.righthand.ymom = this.punchspeed * 8
                                    this.righthand.xmom = this.punchspeed * 19.1
                                    this.righthand.fired = 19
                                    this.body.xmom -= 5
                                    this.idify()
                                }
                            }
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.face == -1) {
                                if (this.lefthand.anchored == 0) {
                                    this.lefthand.ymom = this.punchspeed * 8
                                    this.lefthand.xmom = this.punchspeed * -19.1
                                    this.lefthand.fired = 19
                                    this.idify()
                                }
                            }
                        }
                        if (this.middlehand.fired <= 0) {
                            if (this.face == 1) {
                                if (this.lefthand.anchored == 0) {
                                    this.middlehand.xmom = this.punchspeed * 19.1
                                }
                            }
                            if (this.face == -1) {
                                this.middlehand.xmom = this.punchspeed * -19.1
                            }
                            this.idify()
                            this.middlehand.ymom = this.punchspeed * -4
                            this.middlehand.fired = 19
                        }
                    }

                    if (this.body.fired > 30) {
                        this.body.ymom -= this.body.fired * .008
                    }
                    if (this.screwtimer == 30) {
                        this.body.fired = 30
                        this.body.ymom = 0
                    } else if (this.screwtimer <= 30) {
                        if (this.screwtimer > 0) {
                            this.body.ymom = 0
                        }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('Y') || (keysPressed['i'] || keysPressed['ArrowUp'])) {
                        if (this.righthand.fired <= 0) {
                            if (this.righthand.anchored == 0) {
                                this.rightshoulder.xmom = 0
                                this.rightshoulder.ymom = 0
                                this.righthand.fired = 19
                                this.righthand.ymom = this.punchspeed * -20
                                this.righthand.xmom = this.punchspeed * -4
                                this.idify()
                            }
                        }
                        if (this.middlehand.fired <= 0) {
                            this.middleshoulder.xmom = 0
                            this.middleshoulder.ymom = 0
                            this.middlehand.fired = 19
                            this.middlehand.ymom = this.punchspeed * -20
                            this.idify()
                        }
                        if (this.lefthand.fired <= 0) {
                            if (this.lefthand.anchored == 0) {
                                this.leftshoulder.xmom = 0
                                this.leftshoulder.ymom = 0
                                this.lefthand.ymom = this.punchspeed * -20
                                this.lefthand.xmom = this.punchspeed * 4
                                this.lefthand.fired = 19
                                this.idify()
                            }
                        }
                    }
                    if (this.gamepad.gamepad.buttonsStatus.includes('A') || (keysPressed['k'] || keysPressed['ArrowDown'])) {
                        if (this.grounded == 0) {
                            if (this.body.fired <= -30 || minigameSelected == 12) {
                                this.body.xmom = this.punchspeed * 5.5 * this.face
                                this.body.ymom = this.punchspeed * 6
                                this.body.fired = 30
                                this.jumping = 1
                                if(minigameSelected == 12){
                                this.body.fired = -1
                                this.jumping = 0
                                }
                            }
                        } else {
                            if (this.body.fired <= -30) {
                                this.reflecting = 25
                                this.body.fired = 5
                            }
                        }
                    }

                    if (this.gamepad.gamepad.buttonsStatus.includes('X') || (keysPressed['j'] || keysPressed['ArrowLeft'])) {
                        if (this.body.fired <= -30  || minigameSelected == 12) {
                            this.jumping = 1
                            this.body.xmom = this.punchspeed * 5.5 * this.face
                            this.body.ymom = -this.punchspeed * 6
                            this.body.fired = 55
                                if(minigameSelected == 12){
                                this.body.fired = -1
                                this.jumping = 0
                                }
                        }
                    }
                }
            }
        }
        degripl() {

            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.lefthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        degripr() {

            if (this.inactive == 1) {
                return
            }
            this.body.sxmom = 0
            this.body.symom = 0

            if (this.righthand.anchored == 1) {

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
                this.body.ymom -= this.speed
                this.lefthand.anchored = -10
                this.righthand.anchored = -10
                for (let t = 0; t < this.springs.length; t++) {
                    this.springs[t].balance()
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].move(this)
                }
            }


        }
        collideStage() {

            if (this.inactive == 1) {
                return
            }
            for (let t = 0; t < stage.bricks.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.bricks[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }

            for (let t = 0; t < stage.walls.length; t++) {
                for (let k = 0; k < this.nodes.length; k++) {
                    stage.walls[t].doesPerimeterTouch(this.nodes[k], this)
                }
            }
            this.fixupshoulder()
            //this.enemycollide()
        }
        draw() {

            if (this.inactive == 1) {
                return
            }
            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                 if(formname.value != "Chat/PlayerName"){
                        this.playername = formname.value
                       }else{
                        this.playername = ''
                       }
            }
            this.body.anchored = 0
            this.middlehand.anchored = 0
            this.blasting--
            if (this.grounded == 1) {
                if (this.screwtimer > 5) {
                    this.screwangle = 0
                    this.screwtimer = 0
                    // this.body.fired = 5
                }
            }
            this.grounded = 0
            this.frame++

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.shots.length; t++) {
                    if (typeof this.shots[t].gravity == "number") {
                        if (this.shots[t].ymom > -(vsmashlimit / 1.15)) {
                            this.shots[t].ymom += this.shots[t].gravity / 1.2
                            this.shots[t].radius -= .5
                            if (this.shots[t].radius < 10) {
                                this.shots[t].radius = 10
                            }
                        } else {
                            this.shots[t].marked = 1
                        }
                    }
                    if (typeof this.shots[t].countdown == "number") {
                        this.shots[t].countdown--
                        this.shots[t].gravity = Math.cos(this.shots[t].countdown * (Math.PI / 4)) * 20
                        if (this.shots[t].countdown <= 0) {
                            this.shots[t].marked = 1
                        }
                    }
                    this.shots[t].move()
                    if (this.shots[t].marked <= 0) {
                        this.shots[t].draw()
                    }

                    this.shots[t].life--
                    if (this.shots[t].life <= 0) {
                        this.shots[t].marked = 1
                    }
                }
            } else {
                let shotdummy = {}
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                        shotdummy = boys[t]
                    }
                }
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked <= 0) {
                        if (!shotdummy.shotIDs.includes(this.shots[t].id)) {
                            this.shots[t].draw()
                        }
                    }
                }
            }

            for (let j = 0; j < 10; j++) {
                for (let t = 0; t < this.shots.length; t++) {
                    if (this.shots[t].marked == 1) {
                        this.shots.splice(t, 1)
                    } else {
                        this.shots[t].marked--
                    }
                }
            }
            this.leftarm = new LineOP(this.leftshoulder, this.lefthand, invertColor(this.body.color), 8)
            this.rightarm = new LineOP(this.rightshoulder, this.righthand, invertColor(this.body.color), 8)
            this.middlearm = new LineOP(this.middleshoulder, this.middlehand, invertColor(this.body.color), 8)
            this.collideStage()
            for (let t = 0; t < this.links.length; t++) {
                this.links[t].color = invertColor(this.body.color)
                this.links[t].draw()
            }
            for (let t = 0; t < this.nodes.length; t++) {
                this.nodes[t].draw()
                if (this.nodes[t] == this.body) {
                    const link = new Line(this.body.x, this.body.y, this.body.x + (((this.body.radius * .8) * this.face)), this.body.y + Math.sin(this.screwangle), invertColor(this.body.color), this.body.radius * .2)
                    canvas_context.lineWidth = this.strokeWidth
                    canvas_context.strokeStyle = "#000000"
                    canvas_context.beginPath();
                    canvas_context.fillStyle = "#000000"
                    canvas_context.arc(((link.x1 + link.x2 + this.body.x) * (1 / 3)) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .35, (this.screwangle * this.face) + (this.face / 2), (Math.PI * 1) + (this.screwangle * this.face) + (this.face / 2), false)
                    canvas_context.fill()
                    canvas_context.stroke();
                    canvas_context.arc(((link.x1 + link.x2 + this.body.x) * (1 / 3)) + Math.cos(this.screwangle), link.y1 - this.body.radius * .1, this.body.radius * .35, (this.screwangle * this.face) - (this.face / 2), (Math.PI * 1) + (this.screwangle * this.face) - (this.face / 2), false)
                    canvas_context.fill()
                    canvas_context.stroke();
                }
            }

            // if (this.controller == 0) {

            // if (this.screwangle == 0) {
            //     link.draw()
            // }
            if (this.shielddraw == 1) {
                this.shild = new Circle(this.body.x, this.body.y, (Math.max((new LineOP(this.body, this.middlehand)).hypotenuse(), (new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.middlehand.radius, this.body.color + Math.min(Math.round(this.shieldpower + 11), 99))
                this.shild.draw()
            }
            canvas_context.font = "42px arial"
            canvas_context.strokeStyle = "#FFFFFF"
            canvas_context.linewidth = 0
            //canvas_context.strokeText(`${Math.round(this.damage)}%`, this.body.x - 20, this.body.y - 200)
            canvas_context.fillStyle = `rgb(${Math.max(255 - (this.damage / 10), 50)},${255 - this.damage},${255 - this.damage})`
            canvas_context.fillText(`${Math.round(this.damage)}%`, this.body.x - ((canvas_context.measureText(`${Math.round(this.damage)}%`)).width*.5), this.body.y - 200)
            canvas_context.fillStyle = "white"
            if (this.stock > 0) {
                canvas_context.fillText(`${Math.round(this.stock - (this.drops))}`, this.body.x - ((canvas_context.measureText(`${Math.round(this.stock - (this.drops))}`)).width*.5), this.body.y - 240)
            }

            if (this.reflecting > 0) {
                const polygot = new Polygon(this.body.x, this.body.y, ((Math.max((new LineOP(this.body, this.lefthand)).hypotenuse(), (new LineOP(this.body, this.righthand)).hypotenuse())) + this.lefthand.radius) * 1.2, this.body.color, 7, 0, 0, (Math.PI / 2))
                canvas_context.lineWidth = 5
                polygot.draw()
            }

        }
        operate() {

            if (this.inactive == 1) {
                return
            }
            if (this.righthand.anchored == 1) {
                if (this.body.x > this.righthand.x) {
                    this.righthand.anchored = -10
                }
            }
            if (this.lefthand.anchored == 1) {
                if (this.body.x < this.lefthand.x) {
                    this.lefthand.anchored = -10
                }
            }

            if (this.lefthand.anchored != 1 && this.righthand.anchored != 1) {
                this.body.sxmom = 0
                this.body.symom = 0
            }
            // if (this.controller == 0) {
            if (boys.indexOf(this) <= humanPlayers) {
                if (this.breaktimer < 0) {
                    this.playerMove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.playerMove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.playerMove(this.lefthand, this.speed, this.gamepad)
                    }

                    this.playerMove(this.middlehand, this.speed, this.gamepad)
                    this.doubleJump()
                }
            } else {
                if (this.breaktimer < 0) {
                    this.AImove(this.body, this.speed, this.gamepad)

                    if (this.righthand.anchored == 0) {
                        this.AImove(this.righthand, this.speed, this.gamepad)
                    }
                    if (this.lefthand.anchored == 0) {
                        this.AImove(this.lefthand, this.speed, this.gamepad)
                    }
                    this.AImove(this.middlehand, this.speed, this.gamepad)
                    this.doubleJump()
                }
            }
            // }
            if (this.lefthand.anchored == 1 || this.righthand.anchored == 1) {
                this.body.xmom *= .2
            }
            if (this.jumping == 1) {
                this.body.xmom *= .95
            }

            if (this.grounded == 0) {

                if (this.lefthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.leftshoulder.ymom * .99
                    this.body.sxmom = this.leftshoulder.xmom * .99
                } else if (this.righthand.anchored == 1) {
                    this.body.ymom *= .1
                    this.body.symom = this.rightshoulder.ymom * .99
                    this.body.sxmom = this.rightshoulder.xmom * .99
                } else {
                    // if (Math.abs(this.body.sxmom) < 5) {
                    //     // this.body.sxmom *= 0
                    //     this.body.xmom *= .5
                    // }
                }
                this.body.ymom += this.gravity
            } else {
                if (this.pounding == 1) {
                    this.pounding = 0
                    const shot1 = new ShotC(this.body.x, this.body.y + this.body.radius, 20, "#00FF00", this.speed * 2, 0)
                    shot1.life = 50
                    const shot2 = new ShotC(this.body.x, this.body.y + this.body.radius, 20, "#00FF00", - this.speed * 2, 0)
                    shot2.life = 50
                    this.shots.push(shot1)
                    this.shots.push(shot2)
                }

                this.jumpcount = 0
                this.jumping -= .5

                this.body.xmom *= .7

                if (this.body.ymom > 0) {
                    this.body.ymom = 0
                }
            }
            if (this.jumping < 0) {
                this.jumping = 0
            }
            if (this.lefthand.anchored <= -1) {
                this.lefthand.anchored++
            }
            if (this.righthand.anchored <= -1) {
                this.righthand.anchored++
            }
            this.righthand.ymom += this.gravity
            this.lefthand.ymom += this.gravity
            this.middlehand.ymom += this.gravity


            if (this.body.ymom < -vsmashlimit) {
                this.body.ymom = -vsmashlimit
            }
            if (this.body.ymom > vsmashlimit) {
                this.body.ymom = vsmashlimit
            }

            this.body.xmom *= .99
            this.body.ymom *= .99

            if (this.serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].frictiveMove(this)
                }
                for (let t = 0; t < this.nodes.length; t++) {
                    this.nodes[t].smove(this)
                }
            }
            this.lefthand.xmom += (this.lefthand.x - this.body.x) / 40
            this.righthand.xmom += (this.righthand.x - this.body.x) / 40
            this.middlehand.ymom += (this.middlehand.y - this.body.y) / 20
            this.leftshoulder.xmom -= (this.leftshoulder.x - this.body.x) / 40
            this.rightshoulder.xmom -= (this.rightshoulder.x - this.body.x) / 40
            this.middleshoulder.ymom -= (this.middleshoulder.y - this.body.y) / 40
            this.fixupshoulder()

            for (let t = 0; t < this.springs.length; t++) {
                this.springs[t].beam.color = invertColor(this.body.color)
                this.springs[t].balance()
            }
            //for (let t = 0; t < this.hitboxes.length; t++) {
            //                            }
            if (boys.indexOf(this) <= humanPlayers) {

                // this.AI()
                this.fightcontrol()
            } else {
                this.AI()
            }
            // }
            if (this.breaktimer > 0) {
                for (let t = 0; t < 5; t++) {
                    const spot = new Circle(this.body.x + ((Math.random() - .5) * this.body.radius * 2), this.body.y - (this.body.radius + 4), 3, "yellow")
                    spot.draw()
                }
            }

        }
    }









    const descriptor = new Descriptor()



    const circx = new Circle(700, 1000, 10, "#FF0000")
    const go = 0
    const boom = []// [new Circle(0, 0, 1, "transparent"), new Circle(0, 0, 1, "transparent")]

    for (let t = 0; t < 15; t++) {

        const selector = new Selector()
        selector.body.color = colors[t]
        selectors.push(selector)

    }

    // object instantiation and creation happens here 

    //, new Circle(0, 0, 1, "transparent"), new Circle(0, 0, 1, "transparent")]
    let counter = 0
    let sender = 0
    let bumper = 0

    let screenadjustx = -400
    let screenadjusty = -200

    const massSelector = new Shot(screenadjustx + 700, 700 + screenadjusty, 200, "#FF0000")
    const boySelector = new Circle(screenadjustx + 1200, 700 + screenadjusty, 200, "#00FF00")
    const blastSelector = new Shotb(screenadjustx + 1700, 700 + screenadjusty, 200, "#FF00FF")
    const joxSelector = new ShotC(screenadjustx + 2200, 700 + screenadjusty, 200, "#BBBBBB")
    const scorchSelector = new ShotD(screenadjustx + 2700, 700 + screenadjusty, 200, "#0000FF")
    const gwompeiSelector = new ShotGW(screenadjustx + 3200, 700 + screenadjusty, 200, "#AA00FF")
    screenadjusty += -30
    const asigSelector = new Circle(screenadjustx + 950, 1110 + screenadjusty, 200, "#FFAA00")
    const prinSelector = new ShotP(screenadjustx + 1450, 1110 + screenadjusty, 200, "#FFFF00")
    const rhophoSelector = new ShotR(screenadjustx + 1950, 1110 + screenadjusty, 200, "#00FFFF")
    const banandroidSelector = new ShotN(screenadjustx + 2450, 1110 + screenadjusty, 200, "#FFFF00")
    const pinwheelianSelector = new ShotFP(screenadjustx + 2950, 1110 + screenadjusty, 200, "#FFFF00")
    screenadjusty += -30
    const funkySelector = new ShotF(screenadjustx + 700, 1520 + screenadjusty, 200, "#FFAAFF")
    const dummySelector = new Circle(screenadjustx + 1200, 1520 + screenadjusty, 200, "#FFFFFF")
    const doctorSelector = new ShotZ(screenadjustx + 1700, 1520 + screenadjusty, 200, "#FFFFFF")
    const jouleSelector = new ShotJ(screenadjustx + 2200, 1520 + screenadjusty, 200, "#FF00AA")
    const kesslerSelector = new ShotG(screenadjustx + 2700, 1520 + screenadjusty, 200, "#00FF00")
    characterbuttons.push(massSelector)
    characterbuttons.push(boySelector)
    characterbuttons.push(blastSelector)
    characterbuttons.push(joxSelector)
    characterbuttons.push(scorchSelector)
    characterbuttons.push(asigSelector)
    characterbuttons.push(prinSelector)
    characterbuttons.push(rhophoSelector)
    characterbuttons.push(banandroidSelector)
    characterbuttons.push(funkySelector)
    characterbuttons.push(dummySelector)
    characterbuttons.push(doctorSelector)
    characterbuttons.push(jouleSelector)
    characterbuttons.push(kesslerSelector)
    characterbuttons.push(pinwheelianSelector)
    characterbuttons.push(gwompeiSelector)


    const optionsButton = new ShotO(3260, 600, 300, "#AAAABB")
    const mapSelectButton = new Rectangle(2900, 1300, 320, 100, "#FFFFFF")

    const minigameSelectButton = new Rectangle(3300, 1300, 320, 100, "#FFFFFF")
    const localButton = new Rectangle(2900, 1450, 320, 100, "#FFFFFF")
    const saveScoreButton = new Rectangle(3300, 1450, 320, 100, "#FFFFFF")


    const campaignButton = new Rectangle(2900, 1000, 320, 100, "#FFFFFF")
    const AIFightButton = new Rectangle(3300, 1000, 320, 100, "#FF0000")
    const onlineButton = new Rectangle(2900, 1150, 320, 100, "#00FF00")


    const escapeButton = new Rectangle((canvas.width * invscale) - 50, 0, 50, 50, "#FFAAAA")



    let flopper = 0


    function CreatePlayer(t) {
        let coreboy
        const chooser = Math.floor(Math.random() * 15)

        ////////////////////////////////console.log("caseE")
        if (chooser == 0) {
            coreboy = new Mass(t)
        } else if (chooser == 1) {
            coreboy = new Boy(t)
        } else if (chooser == 2) {
            coreboy = new Blastgirl(t)
        } else if (chooser == 3) {
            coreboy = new Jox(t)
        } else if (chooser == 4) {
            coreboy = new ScorchedMass(t)
        } else if (chooser == 5) {
            coreboy = new AsigMan(t)
        } else if (chooser == 6) {
            coreboy = new Princess(t)
        } else if (chooser == 7) {
            coreboy = new Rhopho(t)
        } else if (chooser == 8) {
            coreboy = new Banandroid(t)
        } else if (chooser == 9) {
            coreboy = new Bunkstanks(t)
        } else if (chooser == 10) {
            coreboy = new DrSoto(t)
        } else if (chooser == 11) {
            coreboy = new Joule(t)
        } else if (chooser == 12) {
            coreboy = new Kessler(t)
        }else if (chooser == 13) {
            coreboy = new Pinwheelian(t)
        }else if (chooser == 14) {
            coreboy = new Gwompei(t)
        }
        boys.push(coreboy)
        drops.push(0)
        scores.push(0)
        boom.push(new Circle(0, 0, 1, "transparent"))
    }

    function genRandomFighter(t) {
        let coreboy
        const chooser = Math.floor(Math.random() * 15)

        t = Math.floor(Math.random() * 16)
        ////////////////////////////////console.log("caseE")
        if (chooser == 0) {
            coreboy = new Mass(t)
        } else if (chooser == 1) {
            coreboy = new Boy(t)
        } else if (chooser == 2) {
            coreboy = new Blastgirl(t)
        } else if (chooser == 3) {
            coreboy = new Jox(t)
        } else if (chooser == 4) {
            coreboy = new ScorchedMass(t)
        } else if (chooser == 5) {
            coreboy = new AsigMan(t)
        } else if (chooser == 6) {
            coreboy = new Princess(t)
        } else if (chooser == 7) {
            coreboy = new Rhopho(t)
        } else if (chooser == 8) {
            coreboy = new Banandroid(t)
        } else if (chooser == 9) {
            coreboy = new Bunkstanks(t)
        } else if (chooser == 10) {
            coreboy = new DrSoto(t)
        } else if (chooser == 11) {
            coreboy = new Joule(t)
        } else if (chooser == 12) {
            coreboy = new Kessler(t)
        }else if (chooser == 13) {
            coreboy = new Pinwheelian(t)
        }else if (chooser == 14) {
            coreboy = new Gwompei(t)
        }

        if ( minigameSelected == 1) {
            coreboy.body.x = 500
            coreboy.body.y = 1200
                }
        coreboy.body.color = getRandomColor()
        return coreboy
    }


    function runCampaign(t) {
        let coreboy
        const chooser = t

        ////////////////////////////////console.log("caseE")
        if (chooser == 0) {
            coreboy = new Mass(t)
        } else if (chooser == 1) {
            coreboy = new Boy(t)
            coreboy.body.color = "#00FF00"
        } else if (chooser == 2) {
            coreboy = new Blastgirl(t)
            coreboy.body.color = "#FF00FF"
        } else if (chooser == 3) {
            coreboy = new Jox(t)
            coreboy.body.color = "#AAAAAA"
        } else if (chooser == 4) {
            coreboy = new ScorchedMass(t)
            coreboy.body.color = "#0000FF"
        } else if (chooser == 5) {
            coreboy = new AsigMan(t)
            coreboy.body.color = "#FFAA00"
        } else if (chooser == 6) {
            coreboy = new Princess(t)
            coreboy.body.color = "#FFFF00"
        } else if (chooser == 7) {
            coreboy = new Rhopho(t)
            coreboy.body.color = "#00FFFF"
        } else if (chooser == 8) {
            coreboy = new Banandroid(t)
            coreboy.body.color = "#FFFF00"
        } else if (chooser == 9) {
            coreboy = new Bunkstanks(t)
            coreboy.body.color = "#FFAAAA"
        } else if (chooser == 10) {
            coreboy = new DrSoto(t)
            coreboy.body.color = "#FFFFFF"
        } else if (chooser == 11) {
            coreboy = new Joule(t)
            coreboy.body.color = "#FF44AA"
        } else if (chooser == 12) {
            coreboy = new Kessler(t)
            coreboy.body.color = "#00FF00"
        } else if (chooser == 13) {
            coreboy = new Pinwheelian(t)
            coreboy.body.color = "#00FF00"
        } else if (chooser == 14) {
            coreboy = new Gwompei(t)
            coreboy.body.color = "#00FF00"
        } else {
            coreboy = new Dummy(t)
        }
        boys.push(coreboy)
        drops.push(0)
        scores.push(0)
        boom.push(new Circle(0, 0, 1, "transparent"))
    }



    const cleanup = 1

    // const testg = new Rhopho(0)
    // const testp = new Princess(1)
    // const kets1 = Object.keys(testp)
    // const kets2 = Object.keys(testg)
    // const miss = []
    // const miss2 = []
    //     for(let k = 0;k<kets2.length;k++){
    //         if(!kets1.includes(kets2[k])){
    //             miss.push(kets2[k])
    //         }
    //     }
    // for(let t = 0;t<kets1.length;t++){
    //         if(!kets2.includes(kets1[t])){
    //             miss2.push(kets1[t])
    //         }
    // }
    ////////////////////////////////////console.log(miss, miss2)

    function roughSizeOfObject(object) {
        var objectList = [];
        var stack = [object];
        var bytes = 0;
        while (stack.length) {
            var value = stack.pop();
            if (typeof value === 'boolean') {
                bytes += 4;
            }
            else if (typeof value === 'string') {
                bytes += value.length * 2;
            }
            else if (typeof value === 'number') {
                bytes += 8;
            }
            else if
                (
                typeof value === 'object'
                && objectList.indexOf(value) === -1
            ) {
                objectList.push(value);

                for (var i in value) {
                    stack.push(value[i]);
                }
            }
        }
        return bytes;
    }

    function main() {
        worldscore.tally()
        for (let t = 0; t < boys.length; t++) {
            if (typeof boys[t] == "undefined") {
                boys.splice(t, 1)
            }
        }
        if (keysPressed['Escape']) {
            stars = []
            if (mapSelectToggle == 1 || minigameSelectToggle == 1) {
                mapSelectToggle = 0
                minigameSelectToggle = 0
                descriptor.index = -1
            } else {

                if(minigameSelected == 9 || minigameSelected == 11){
                                canvas_context.scale(invscale, invscale)
                                 scale = .33
                                 invscale = 1 / scale
                                canvas_context.scale(scale, scale)
                }


                descriptor.index = -1
                serverID = parseFloat(Math.random().toFixed(7))
                stage = new Stage(MapSelect)
                selectors = []
                for (let t = 0; t < 15; t++) {
                    const selector = new Selector()
                    selector.body.color = colors[t]
                    selectors.push(selector)

                }
                if (campaignToggle == 1 || minigameSelected == 0 || minigameSelected == 1 || minigameSelected == 6 || minigameSelected == 12) {
                    if (boys.length > 0) {
                        if(counter == 1){
                        if(minigameSelected == 0){
                            canvas_context.translate(0,700)
                        }
                        }

                if(minigameSelected == 12){
                }else{
                    minigameSelected=-1
                    }
                        
                        if(counter == 1){
                        canvas_context.translate(boys[0].body.x - (canvas.width * (invscale * .5)), boys[0].body.y - (canvas.height * (invscale * .5)))
                            
                        }
                  
                    }
                }
                

                if(minigameSelected == 12){
                                canvas_context.scale(invscale, invscale)
                                 scale = .33
                                 invscale = 1 / scale
                                canvas_context.scale(scale, scale)
                                minigameSelected=-1
                }
                counter = 0

                minigameSelected = -1
                boys = []
                scores = []
                drops = []

                localIDs = []

                if (AItoggle == 0  && localPlayToggle == 0) {
                    ws.close()
                    start = 0
                    HOST = location.origin.replace(/^http/, 'ws')
                    ws = new WebSocket(HOST);
                    socketize(ws)
                }
            }
        }

        for (let t = 0; t < boys.length; t++) {
            if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                ID = t
                connectionnumber = t
                IDaddress = t
            }
        }

        if (counter == 1) {
            if (boys.length >= 1) {
                if (campaignToggle == 1 || minigameSelected == 0  || minigameSelected == 1  || minigameSelected == 6|| minigameSelected == 12) {
                    camerax = boys[0].body.x
                    cameray = boys[0].body.y
                    //translate relevant
                }
            }
            // JumpIn(boys[0])
            //  humanPlayers = -1

            if (AItoggle == 0  && localPlayToggle == 0 && localPlayToggle == 0) {

                for (let t = 0; t < boys.length; t++) {
                    if (!localIDs.includes(boys[t].serverID)) {
                        if (boys[t].serverID != serverID) {
                            boys.splice(t, 1)
                        }
                    }
                }

            }
            // const sel = 0
            // for (let t = 0; t < boys.length; t++) {
            //     if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
            //         if (sel == 1) {
            //             boys.splice(t, 1)
            //         }
            //         sel = 1
            //     }
            // }



            if (AItoggle == 0  && localPlayToggle == 0) {
                for (let k = 0; k < boys.length; k++) {
                    let sel = 0
                    for (let t = 0; t < boys.length; t++) {
                        if (boys[t].serverID == boys[k].serverID) {
                            if (sel == 1) {
                                boys.splice(t, 1)
                            }
                            sel = 1
                        }
                    }
                }



                for (let t = 0; t < boys.length; t++) {
                    // if(counters[t]>50){
                    //     if(boys[t].serverID != serverID){
                    //     localIDs.splice(localIDs.indexOf(boys[t].serverID),1)
                    //     boys.splice(t,1)
                    //     counters[t] = 0
                    //     }
                    // }
                    counters[t]++
                }
            }

            // cleanup++
            // if (cleanup % 50 == 0) {
            //     for (let g = 0; g < localIDs.length; g++) {
            //         for (let t = 0; t < boys.length; t++) {
            //             if (!localIDs.includes(boys[t].serverID)) {
            //                 if (serverID != boys[t].serverID) {
            //                     localIDs.splice(localIDs.indexOf(boys[t].serverID))
            //                     boys.splice(t, 1)
            //                 }
            //             }
            //         }
            //     }

            //     const coreboy
            //     if (pick == 0) {
            //         coreboy = new Mass(boys.length)
            //     } else if (pick == 1) {
            //         coreboy = new Boy(boys.length)
            //     } else if (pick == 2) {
            //         coreboy = new Blastgirl(boys.length)
            //     } else if (pick == 3) {
            //         coreboy = new Jox(boys.length)
            //     } else if (pick == 4) {
            //         coreboy = new ScorchedMass(boys.length)
            //     } else if (pick == 5) {
            //         coreboy = new AsigMan(boys.length)
            //     } else if (pick == 6) {
            //         coreboy = new Princess(boys.length)
            //     }

            //     const check = 0
            //     for(let t = 0;t<boys.length;t++){
            //         if(boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1){
            //             check = 1
            //         }
            //     }   

            //     for (let u = 0; u < boys.length; u++) {
            //         if(check == 0){
            //             if (boys[u].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
            //             coreboy.id = ID
            //             boys[u] = coreboy
            //             boom.push(new Circle(0, 0, 1, "transparent"))
            //             scores.push(0)
            //             drops.push(0)
            //         }
            //         }
            //     }
            // }

            flopper++ //aitesting
            canvas_context.clearRect(-canvas.width * 10000, -canvas.width * 10000, canvas.width * 20000, canvas.width * 20000)
            if (campaignToggle == 0 && minigameSelected == -1) {
                escapeButton.draw()
            }

            for (let t = boys.length - 1; t >= 0; t--) {
                if (boys[t]) {
                    if(localPlayToggle == 1){
                        boys[t].gamepad.locator = t
                        boys[t].gamepad.gamepad.locator = t
                    }
                    boys[t].gamepad.gamepad.update()
                }
            }
            stage.draw()


            if (AItoggle == 1 || localPlayToggle == 1) {
                if (flopper % 2 == 0) {
                    for (let t = 0; t < boys.length; t++) {
                        if (boys[t]) {
                            if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                boys[t].enemycollide()
                            }
                        }
                    }
                } else {
                    for (let t = boys.length - 1; t >= 0; t--) {
                        if (boys[t]) {
                            if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {
                                boys[t].enemycollide()
                            }
                        }
                    }
                }
            }
            if (flopper % 2 == 0) {
                for (let t = boys.length - 1; t >= 0; t--) {
                    if (boys[t]) {
                        boys[t].operate()
                    }
                }
            } else {
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t]) {
                        boys[t].operate()
                    }
                }
            }

            if (campaignToggle == 0) {
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t]) {

                        if (AItoggle == 0  && localPlayToggle == 0 && localPlayToggle == 0) {
                            boys[t].body.color = colors[t]
                            if(boys[t].pinwheel == 1){
                                for(let j = 0;j<boys[t].shots.length;j++){
                                boys[t].shots[j].color = colors[t]
                            }
                            }
                        }
                        boys[t].draw()
                    } else {
                        ////////////////////////////////console.log(boys)
                    }
                }
            } else {

                for (let t = 0; t < boys.length; t++) {
                    if (boys[t]) {
                        if (AItoggle == 0  && localPlayToggle == 0) {
                            boys[t].body.color = colors[t]

                            if(boys[t].pinwheel == 1){
                            for(let j = 0;j<boys[t].shots.length;j++){
                                boys[t].shots[j].color = colors[t]
                            }
                        }
                        }
                        if (t == 0) {
                            const x = boys[t].body.x
                            const y = boys[t].body.y
                            boys[t].draw()
                        } else {
                            boys[t].draw()
                        }

                    }
                }
            }


            for (let t = 0; t < boys.length; t++) {

                if (!boys[t]) {
                    continue
                }
            if(minigameSelected == 1 || minigameSelected == 6 || minigameSelected == 12){

            }else if(minigameSelected == 0){
                const leftwall = new Line(-10, -10000, -10, 10000000, "#FF0000", 10)
                const rightwall = new Line((2560 * (invscale * .5))+10, -10000, (2560 * (invscale * .5))+10, 10000000, "#FF0000", 10)
                leftwall.draw()
                rightwall.draw()
                let wet = 0
                for(let t = 0;t<stage.obstacles.length;t++){
                    if(boys[0].body.doesPerimeterTouch(stage.obstacles[t])){
                                    boys[0] = boys[0].copy()
                        drops[0]++
                                    boys[0].drops++
                    }
                }
                if (boys[t].body.x < 0 || boys[t].body.x > (2560 * (invscale * .5))) {
                    if (stock > 0) {
                        if (drops[t] < stock) {
                            if (t != boys[t].striker) {
                                // if(AItoggle == 0  && localPlayToggle == 0){
                                if (boys[boys[t].striker].hasOwnProperty("mesh")) {
                                    mutationrate *= .99
                                }
                                scores[boys[t].striker]++
                                // }else{
                                // scores[t]++
                                // }
                            }
                            drops[t]++
                        }
                    } else {
                        if (t != boys[t].striker) {
                            // if(AItoggle == 0  && localPlayToggle == 0){
                            scores[boys[t].striker]++
                            // }else{
                            // scores[t]++
                            // }
                        }
                        drops[t]++
                    }
                    if (boys[t].go !== 1) {
                        boys[t].go = 1
                         if (boys[t].body.x < 0) {
                            boom[t] = new ExplosionRight(boys[t].body.y, boys[t].body.color)
                        } else if (boys[t].body.x > canvas.width * invscale) {
                            boom[t] = new ExplosionLeft(boys[t].body.y, boys[t].body.color)
                        } 
                        boys[t].body.x = - 100000
                        boys[t].body.y = - 100000

                        if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                            if (stock > 0) {
                                if (drops[t] < stock) {
                                    boys[t] = boys[t].copy()
                                } else {
                                    boys[t].body.y = (canvas.height * invscale * 10)
                                }
                            } else {
                                boys[t] = boys[t].copy()
                            }
                        }
                        // }
                        // }
                    }

                }
            }else if ((boys[t].body.y > (1440 * (invscale * .5)) || boys[t].body.x < 0 || boys[t].body.x > (2560 * (invscale * .5)) || boys[t].body.y < 0) && campaignToggle == 0) {
                    if (stock > 0) {
                        if (drops[t] < stock) {
                            if (t != boys[t].striker) {
                                // if(AItoggle == 0  && localPlayToggle == 0){
                                // if (boys[boys[t].striker].hasOwnProperty("mesh")) {
                                //     mutationrate *= .99
                                // }
                                scores[boys[t].striker]++
                                // }else{
                                // scores[t]++
                                // }
                            }
                            drops[t]++
                        }
                    } else {
                        if (t != boys[t].striker) {
                            // if(AItoggle == 0  && localPlayToggle == 0){
                            scores[boys[t].striker]++
                            // }else{
                            // scores[t]++
                            // }
                        }
                        drops[t]++
                    }
                    if (boys[t].go !== 1) {
                        boys[t].go = 1
                        if (boys[t].body.y < 0) {
                            boom[t] = new ExplosionTop(boys[t].body.x, boys[t].body.color)
                        } else if (boys[t].body.y > canvas.height * invscale) {
                            boom[t] = new Explosion(boys[t].body.x, boys[t].body.color)
                        } else if (boys[t].body.x < 0) {
                            boom[t] = new ExplosionRight(boys[t].body.y, boys[t].body.color)
                        } else if (boys[t].body.x > canvas.width * invscale) {
                            boom[t] = new ExplosionLeft(boys[t].body.y, boys[t].body.color)
                        } else {
                            boom[t] = new Circle(0, 0, 0, "transparent")
                        }
                        boys[t].body.x = - 100000
                        boys[t].body.y = - 100000

                        if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1) {

                            if (stock > 0) {
                                if (drops[t] < stock) {
                                    boys[t] = boys[t].copy()
                                } else {
                                    boys[t].body.y = (canvas.height * invscale * 10)
                                }
                            } else {
                                boys[t] = boys[t].copy()
                            }
                        }
                        // }
                        // }
                    }
                } else if (campaignToggle == 1 && (boys[t].body.y < -400 || boys[t].body.y > (1540 * (invscale * .5)) || Math.abs(boys[t].body.x - boys[0].body.x) > 6500)) {
                    if (stock > 0) {
                        if (drops[t] < stock) {
                            if (t != boys[t].striker) {
                                // if(AItoggle == 0  && localPlayToggle == 0){
                                if (boys[boys[t].striker].hasOwnProperty("mesh")) {
                                    mutationrate *= .99
                                }
                                scores[boys[t].striker]++
                                // }else{
                                // scores[t]++
                                // }
                            }
                            drops[t]++
                        }
                    } else {
                        if (t != boys[t].striker) {
                            // if(AItoggle == 0  && localPlayToggle == 0){
                            scores[boys[t].striker]++
                            // }else{
                            // scores[t]++
                            // }
                        }
                        drops[t]++
                    }
                    if (boys[t].go !== 1) {
                        boys[t].go = 1
                        if (boys[t].body.y < -400) {
                            boom[t] = new ExplosionTop(boys[t].body.x, boys[t].body.color)
                        } else if (boys[t].body.y > (1540 * (invscale * .5))) {
                            boom[t] = new Explosion(boys[t].body.x, boys[t].body.color)
                        } else if (boys[t].body.x < 0) {
                            // boom[t] = new ExplosionRight(boys[t].body.y, boys[t].body.color)
                        } else if (boys[t].body.x > canvas.width * invscale) {
                            // boom[t] = new ExplosionLeft(boys[t].body.y, boys[t].body.color)
                        } else {
                            boom[t] = new Circle(0, 0, 0, "transparent")
                        }
                        boys[t].body.x = - 100000
                        boys[t].body.y = - 100000

                        if (boys[t].serverID == serverID || AItoggle == 1 || localPlayToggle == 1 || localPlayToggle == 1) {

                            if (stock > 0) {
                                if (drops[t] < stock) {
                                    if (t == 0) {
                                        boys[t] = boys[t].copy()
                                    } else {
                                        boys.splice(t, 1)
                                        boys[0].damage = 0
                                        scores[1] = 0
                                        drops[1] = 0
                                        stage.walls[stage.walls.length - 1].shape.shiftRight(6 * 1400)
                                        stage.walls[stage.walls.length - 1].center.x += (6 * 1400)
                                        stage.spawnrunner += (6 * 1400)
                                    }
                                } else {
                                    boys[t].body.y = (canvas.height * invscale * 10)
                                }
                            } else {
                                if (t == 0) {
                                    boys[t] = boys[t].copy()
                                } else {
                                    boys.splice(t, 1)
                                    scores[1] = 0
                                    drops[1] = 0
                                    boys[0].damage = 0
                                    stage.walls[stage.walls.length - 1].shape.shiftRight(6 * 1400)
                                    stage.walls[stage.walls.length - 1].center.x += (6 * 1400)
                                    stage.spawnrunner += (6 * 1400)

                                }
                            }
                        }
                        // }
                        // }
                    }

                }
                if (boom.length <= t) {
                    boom.push(new Circle(0, 0, 0, "transparent"))
                    drops.push(0)
                    scores.push(0)
                }
                boom[t].draw()
            }
            canvas_context.font = "60px arial"
            canvas_context.fillStyle = "white"
            const dropouts = 0
            for (let t = 0; t < boys.length; t++) {
                if (boys[t]) {
                    if (boys[t].inactive == 1) {
                        boys[t].body.x = - 100000
                        boys[t].body.y = - 100000
                        dropouts++
                    } else {
                        canvas_context.font = "60px arial"
                        canvas_context.fillStyle = boys[t].body.color
                        if(minigameSelected != 0 && minigameSelected !== 1 && minigameSelected !== 6 && minigameSelected !== 12){
                        if (AItoggle == 0  && localPlayToggle == 0) {
                            if (boys[t].playername != "") {
                                canvas_context.fillText(`${boys[t].name + " (" + boys[t].playername + ")"} ${boys[t].knocks}/${boys[t].drops} Ping: ${boys[t].ping}`, 20, ((t - dropouts) * 61) + 70)
                            } else {
                                canvas_context.fillText(`${boys[t].name} ${boys[t].knocks}/${boys[t].drops} Ping: ${boys[t].ping}`, 20, ((t - dropouts) * 61) + 70)

                            }
                        } else {
                            if (campaignToggle == 0) {

                            if(minigameSelected == 3 || minigameSelected == 4 || minigameSelected == 5 || minigameSelected == 6 || minigameSelected == 7 || minigameSelected == 8|| minigameSelected == 10){
                           
                            }else{
                                canvas_context.fillText(`${boys[t].name} ${scores[t]}/${drops[t]}`, 20, ((t - dropouts) * 61) + 70)
                            }
                            } else {
                                // canvas_context.fillText(`${boys[t].name} ${scores[t]}/${drops[t]}`, (boys[0].body.x-(canvas.width*invscale*.5)+20),(boys[0].body.y-(canvas.height*invscale*.5)+ (((t - dropouts) * 61)+170)))
                            }
                        }
                    }
                    }
                }
            }
            if(minigameSelected == 8){         

                canvas_context.font = "60px arial"

                canvas_context.fillStyle = "#AAAAFF"
                canvas_context.fillText(`${scores[0]}`, 750, 100)

                canvas_context.fillStyle = "#FFFFFF"
                canvas_context.fillText(`/`, 850, 100)           

                canvas_context.fillStyle = "#FF0000"
                canvas_context.fillText(`${scores[1]}`, 900, 100)           
            }
            if (stock > 0) {
                let wet = boys.length - 1
                let winner = {}
                for (let g = 0; g < boys.length; g++) {
                    if (drops[g] >= stock) {
                        wet--
                    } else {
                        winner = boys[g]
                    }
                }
                if (wet == 0) {
                    if (boys.length > 1) {
                        canvas_context.font = "100px arial"
                        canvas_context.fillStyle = winner.body.color
                        canvas_context.fillText(`The Winner of this Match is: ${winner.name + "!"} `, 1000, 100)
                    }
                }
            }
            sender++
            if (sender % 1 == 0) {
                for (let t = 0; t < boys.length; t++) {
                    const sto = []
                    for (let f = 0; f < boys.length; f++) {
                        sto.push([])
                    }
                    if (AItoggle == 0  && localPlayToggle == 0) {
                        for (let f = 0; f < boys[t].nodes.length; f++) {
                            boys[t].nodes[f].self = 0
                            sto[t].push(boys[t].nodes[f].anchored)
                            boys[t].nodes[f].anchored = 0
                        }
                    }
                    if (boys[t].serverID == serverID && AItoggle == 0  && localPlayToggle == 0) {

                        boys[t].id = ID
                        for (let f = 0; f < boys[t].nodes.length; f++) {
                            boys[t].nodes[f].x = Math.round(boys[t].nodes[f].x)
                            boys[t].nodes[f].y = Math.round(boys[t].nodes[f].y)
                            // boys[t].nodes[f].xmom = Math.round(boys[t].nodes[f].xmom )
                            boys[t].nodes[f].ymom = Math.round(boys[t].nodes[f].ymom)
                            boys[t].nodes[f].sxmom = Math.round(boys[t].nodes[f].sxmom)
                            boys[t].nodes[f].symom = Math.round(boys[t].nodes[f].symom)
                            boys[t].nodes[f].areaX = Math.round(boys[t].nodes[f].areaX)
                            boys[t].nodes[f].areaY = Math.round(boys[t].nodes[f].areaY)
                            // delete boys[t].nodes[f].string
                        }
                        let Json = {}
                        const keys = Object.keys(boys[t])
                        for (let k = 0; k < keys.length; k++) {
                            if (typeof boys[t][keys[k]] != "undefined") {
                                if (!Object.keys(boys[t][keys[k]]).includes("self")) {
                                    Json[keys[k]] = boys[t][keys[k]]
                                }
                            }
                        }

                        // ////////////// ////////////////////////////////////////////console.log(keys)
                        delete Json.springs
                        delete Json.links
                        delete Json.rightarm
                        delete Json.shild
                        delete Json.gamepad
                        delete Json.leftarm
                        delete Json.rightcollar
                        delete Json.leftcollar
                        delete Json.brick
                        delete Json.bricksto
                        delete Json.wasfalse
                        delete Json.target
                        delete Json.lefthands
                        delete Json.righthands
                        delete Json.storeshield


                        Json.serverID = serverID
                        if (typeof boys[t].lefthand2 != "undefined") {
                            delete Json.lefthand2
                            delete Json.lefthands2
                            delete Json.leftarm2
                        }
                        if (typeof boys[t].lefthand3 != "undefined") {
                            delete Json.lefthands3
                            delete Json.lefthand3
                            delete Json.leftarm3
                        }
                        if (typeof boys[t].righthand2 != "undefined") {
                            delete Json.righthands2
                            delete Json.righthand2
                            delete Json.rightarm2
                        }
                        if (typeof boys[t].righthand3 != "undefined") {
                            delete Json.righthands3
                            delete Json.righthand3
                            delete Json.rightarm3
                            //what about colllar? arm? shoulder?
                        }


                        if (boys[t].hasOwnProperty('middlehand')) {
                            delete Json.middlehand
                            delete Json.middlearm
                            delete Json.middleshoulder
                            delete Json.middlecollar
                        }

                        if (boys[t].hasOwnProperty('bananahand')) {
                            delete Json.bananahand
                            delete Json.bananahands
                            delete Json.bananarm
                            delete Json.bananashoulder
                            delete Json.bananacollar
                        }
                        if (boys[t].hasOwnProperty('middlehand2')) {
                            delete Json.middlehand2
                            delete Json.middlearm2
                            delete Json.middleshoulder2
                            delete Json.middlecollar2
                        }

                        if (boys[t].hasOwnProperty('bananahand2')) {
                            delete Json.bananahand2
                            delete Json.bananahand2s
                            delete Json.bananarm2
                            delete Json.bananashoulder2
                            delete Json.bananacollar2
                        }


                        //  this.startrad = 1
                        //  this.x = parseFloat(x)
                        // this.id = parseFloat(Math.random().toFixed(5))
                        // this.y = parseFloat(y)
                        // this.radius = parseFloat(radius)
                        // this.color = color
                        // this.body = new CircleS(this.x, this.y, this.radius, this.color,0,0,.99)
                        // this.launched = 0
                        // this.generating = 0
                        // this.gravity = .4


                        if (typeof Json.bullets != "undefined") {
                            for (let f = 0; f < Json.bullets.length; f++) {
                                delete Json.bullets[f].x
                                delete Json.bullets[f].y
                                delete Json.bullets[f].color
                                delete Json.bullets[f].id
                                // delete Json.bullets[f].radius
                                // delete Json.bullets[f].launched
                                // delete Json.bullets[f].generating
                                delete Json.bullets[f].body.color
                                delete Json.bullets[f].gravity
                                // delete Json.bullets[f].body.xmom
                                // delete Json.bullets[f].body.ymom

                            }
                        }

                        if (typeof Json.shots != "undefined") {
                            for (let f = 0; f < Json.shots.length; f++) {
                                delete Json.shots[f].boss
                            }
                        }
                        ////////// ////////////////////////////////////////////console.log("sending")


                        // delete Json.color
                        delete Json.armlength
                        delete Json.shoulderwidth
                        // delete Json.struck
                        // delete Json.grounded
                        // delete Json.id
                        delete Json.jumpreduction
                        // delete Json.countering // can't see?
                        // delete Json.radsto
                        // delete Json.shot
                        delete Json.recovering
                        delete Json.fleeing
                        // delete Json.controller
                        delete Json.speed
                        delete Json.punchspeed
                        // delete Json.jumping // vanishing?
                        // delete Json.gravity

                        delete Json.frame
                        // delete Json.screwmomentum
                        // delete Json.screwtimer
                        delete Json.punchspeed
                        delete Json.jumpcount
                        // AI block toggle
                        delete Json.safe // AI probably need this
                        delete Json.leftshot
                        delete Json.rightshot
                        delete Json.hortsmash
                        delete Json.screwshot
                        delete Json.downspike
                        delete Json.safesto
                        delete Json.fleeing
                        delete Json.shotIDs
                        // AI toggle block end
                        //?

                        delete Json.wmove
                        delete Json.dmomu
                        delete Json.amomu
                        delete Json.amom
                        delete Json.dmom
                        delete Json.hitboxes
                        delete Json.dmove
                        delete Json.amove
                        delete Json.bodyx



                        delete Json.color
                        delete Json.shotclock
                        delete Json.invcolor
                        delete Json.detonate
                        delete Json.radsto
                        delete Json.pounding
                        delete Json.nograv


                        //new
                        delete Json.pick
                        delete Json.shield
                        delete Json.reflecting
                        delete Json.struck
                        Json = JSON.stringify(Json)
                        Json = JSON.parse(Json)
                        for (let y = 0; y < Json.nodes.length; y++) {
                            if (y != 0) {
                                delete Json.nodes[y].color
                            }
                            delete Json.nodes[y].sxmom
                            delete Json.nodes[y].symom
                            delete Json.nodes[y].strokeWidth
                            delete Json.nodes[y].strokeColor
                            delete Json.nodes[y].self
                            delete Json.nodes[y].marked
                            delete Json.nodes[y].reflect
                            delete Json.nodes[y].gravity
                            delete Json.nodes[y].friction
                            delete Json.nodes[y].areaX
                            delete Json.nodes[y].areaY
                            delete Json.nodes[y].anchored
                            delete Json.nodes[y].anchor
                            delete Json.nodes[y].string
                        }
                        for (let y = 0; y < Json.shots.length; y++) {
                            delete Json.shots[y].sxmom
                            delete Json.shots[y].symom
                            delete Json.shots[y].strokeWidth
                            delete Json.shots[y].strokeColor
                            delete Json.shots[y].self
                            delete Json.shots[y].marked
                            delete Json.shots[y].reflect
                            delete Json.shots[y].gravity
                            delete Json.shots[y].areaX
                            delete Json.shots[y].areaY
                            delete Json.shots[y].anchored
                            delete Json.shots[y].friction
                            delete Json.shots[y].anchor
                            delete Json.shots[y].string
                        }
                        delete Json.shot
                        delete Json.pinwheel



                        if (bumper == 0) {
                            // bumper = 1
                            //console.log((Json))
                            //console.log(roughSizeOfObject(Json), `Bytes, ${boys[t].name} pruned for network traffic`)
                            // console.log(roughSizeOfObject(boys[t]),  `Bytes, ${boys[t].name} local`)
                            //console.log(Object.keys(Json))
                        }
                        if (keysPressed['l']) {
                            //////////////////////////console.log((Json))
                        }

                        if (AItoggle == 0  && localPlayToggle == 0) {

                            const Xson = {}
                            const now = new Date()
                            Xson.ping = now.getTime()
                            Xson.pinging = 1
                            Xson.serverID = serverID

                if(localPlayToggle != 1){
                            ws.send(JSON.stringify(Json))
                            ws.send(JSON.stringify(Xson))


                        //     if (bumper == 0) {
                        //     const dson = {
                        //         "dataScores":1,
                        //         "model":{
                        //         "CampaignComplete":true,
                        //         "GeGeGeGeeDropScore":14
                        //         }
                        //     }
                            
                        //     ws.send(JSON.stringify(dson))
                        //     bumper = 1
                        //     console.log(dson)
                        // }
                }
                        }

                        for (let f = 0; f < boys[t].nodes.length; f++) {
                            boys[t].nodes[f].anchored = sto[t][f]
                        }
                        // for(let f = 0;f<boys[t].nodes.length;f++){
                        //     boys[t].nodes[f].self =boys[t]
                        // }
                        //////////// ////////////////////////////////////////////console.log(boys[IDaddress].id, ID)
                    } else {
                        //////////// ////////////////////////////////////////////console.log(boys[IDaddress].id, ID)
                    }

                    // for (let t = boys.length - 1; t >= 0; t--) {
                    //     for (let k = 0; k < boys[t].nodes.length; k++) {
                    //         boys[t].nodes[k].self = boys[t]
                    //     }
                    // }
                }
            }
            // gametheme.pause()

            if (boys.length >= 1) {
                if (campaignToggle == 1 || minigameSelected == 0  || minigameSelected == 1  || minigameSelected == 6 || minigameSelected == 12) {
                    if (cameraLocked == 0) {
                        // ////////console.log("whea")
                        cameraxsum += boys[0].body.x - camerax
                        cameraysum += boys[0].body.y - cameray
                        canvas_context.translate(camerax - boys[0].body.x, cameray - boys[0].body.y)

                        canvas_context.font = "60px arial"
                        canvas_context.fillStyle = "white"
                        const dropouts = 0
                        for (let t = 0; t < boys.length; t++) {

                            canvas_context.font = "60px arial"
                            canvas_context.fillStyle = boys[t].body.color
                            if(minigameSelected == 0){
                                canvas_context.fillText(`${boys[t].name} ${scores[t]}/${drops[t]}`, (boys[0].body.x - (canvas.width * invscale * .5) + 20), (boys[0].body.y - (canvas.height * invscale * .5) + (((t - dropouts) * 61) + 770)))

                            }else{

                            if(minigameSelected == 3 || minigameSelected == 4 || minigameSelected == 12){
                            }else{
                            canvas_context.fillText(`${boys[t].name} ${scores[t]}/${drops[t]}`, (boys[0].body.x - (canvas.width * invscale * .5) + 20), (boys[0].body.y - (canvas.height * invscale * .5) + (((t - dropouts) * 61) + 70)))
                            }
                            }
                        }


                        const now = new Date()
                        campaigntime = now.getTime() - campaigntimestart

                        const ms = (campaigntime % 1000)
                        let seconds = campaigntime
                        let minutes = campaigntime
                        minutes = Math.floor(minutes / 60000)
                        seconds = Math.floor(seconds / 1000) % 60
                        if (seconds < 10) {
                            seconds = "0" + seconds
                        }

                        let roundedms = (ms / 1000).toFixed(2)
                        let rounder = roundedms.split('')
                        rounder.splice(0, 1)
                        roundedms = rounder.join('')

                        // ////////console.log(campaigntime)


                        canvas_context.fillStyle = "white"

                        if(minigameSelected == 0){

                        if( worldscore.gegegegeedropmin > campaigntime){
                            if(boys[0].body.y > 49500){
                                worldscore.gegegegeedropminstr = `${minutes}:${seconds}${roundedms}`
                                worldscore.gegegegeedropmin = campaigntime
                            }
                        }
                        canvas_context.fillText(`${minutes}:${seconds}${roundedms}`, (boys[0].body.x - (canvas.width * invscale * .5) + 20), (boys[0].body.y - (canvas.height * invscale * .5) + (((boys.length) * 61) + 870)))
                        }else{
                        canvas_context.fillText(`${minutes}:${seconds}${roundedms}`, (boys[0].body.x - (canvas.width * invscale * .5) + 20), (boys[0].body.y - (canvas.height * invscale * .5) + (((boys.length) * 61) + 170)))
                        }


                    }
                }else{
                    if(minigameSelected == 3 || minigameSelected == 7){

                        const now = new Date()
                        campaigntime = now.getTime() - campaigntimestart

                        const ms = (campaigntime % 1000)
                        let seconds = campaigntime
                        let minutes = campaigntime
                        minutes = Math.floor(minutes / 60000)
                        seconds = Math.floor(seconds / 1000) 
                        if (seconds < 10) {
                            seconds = "0" + seconds
                        }

                        let roundedms = (ms / 1000).toFixed(2)
                        let rounder = roundedms.split('')
                        rounder.splice(0, 1)
                        roundedms = rounder.join('')



                        canvas_context.fillStyle = "white"

                        canvas_context.fillText(`${Math.max(60-seconds,0)}`, 200, 400)
            
                    }
                    if(minigameSelected == 5){

                        const now = new Date()
                        campaigntime = now.getTime() - campaigntimestart

                        const ms = (campaigntime % 1000)
                        let seconds = campaigntime
                        let minutes = campaigntime
                        minutes = Math.floor(minutes / 60000)
                        seconds = Math.floor(seconds / 1000) 
                        if (seconds < 10) {
                            seconds = "0" + seconds
                        }

                        let roundedms = (ms / 1000).toFixed(2)
                        let rounder = roundedms.split('')
                        rounder.splice(0, 1)
                        roundedms = rounder.join('')



                        canvas_context.fillStyle = "#FFFFFF"

                        canvas_context.fillText(`${Math.max(60-seconds,0)}`, 200, 100)
            
                    }
                    if(minigameSelected == 4){

                        const now = new Date()
                        campaigntime = now.getTime() - campaigntimestart

                        const ms = (campaigntime % 1000)
                        let seconds = campaigntime
                        let minutes = campaigntime
                        minutes = Math.floor(minutes / 60000)
                        seconds = Math.floor(seconds / 1000) 
                        if (seconds < 10) {
                            seconds = "0" + seconds
                        }

                        let roundedms = (ms / 1000).toFixed(2)
                        let rounder = roundedms.split('')
                        rounder.splice(0, 1)
                        roundedms = rounder.join('')



                        canvas_context.fillStyle = "white"

                        canvas_context.fillText(`${Math.max(60-seconds,0)}`, 200, 400)
            
                    }
                }
            }
        } else {


            if ( ws.readyState == 1){ //
                    onlineButton.color = "#00FF00"
                }else{
                    onlineButton.color = "#FF0000"
                }
            // gametheme.play()
            canvas_context.clearRect(-canvas.width * 10000, -canvas.width * 10000, canvas.width * 20000, canvas.width * 20000)
            if (mapSelectToggle == 1 || minigameSelectToggle == 1) {
                descriptor.draw()
                if (optionsToggle == 0) {
                    optionsButton.radius = 240
                    optionsButton.draw()
                    canvas_context.font = "40px arial"
                    canvas_context.fillStyle = "black"
                    canvas_context.fillText(`Click For Options`, optionsButton.x - (optionsButton.radius * .6), optionsButton.y + (optionsButton.radius * 0))

                } else {
                    if (mapSelectToggle == 1) {
                    for (let t = 0; t < mapIcons.length; t++) {
                        mapIcons[t].draw()
                    }
                    mapSelectButton.draw()
                    canvas_context.font = "30px arial"
                    canvas_context.fillStyle = "#000000"
                    canvas_context.fillText(`Exit Map Select`, mapSelectButton.x + (mapSelectButton.width * .14), mapSelectButton.y + (mapSelectButton.width * .20))

                }else{

                    mapSelectButton.draw()
                    canvas_context.font = "30px arial"
                    canvas_context.fillStyle = "#000000"
                    canvas_context.fillText(`Map Select`, mapSelectButton.x + (mapSelectButton.width * .3), mapSelectButton.y + (mapSelectButton.width * .20))

                }
                if (minigameSelectToggle == 1) {
                    for (let t = 0; t < minigameIcons.length; t++) {
                        minigameIcons[t].draw()
                    }
                    minigameSelectButton.draw()
                    canvas_context.font = "30px arial"
                    canvas_context.fillStyle = "#000000"
                    canvas_context.fillText(`Exit Minigames`, minigameSelectButton.x + (minigameSelectButton.width * .14), minigameSelectButton.y + (minigameSelectButton.width * .20))
                } else {
                    minigameSelectButton.draw()
                    canvas_context.font = "30px arial"
                    canvas_context.fillStyle = "#000000"
                    canvas_context.fillText(`Minigames`, minigameSelectButton.x + (minigameSelectButton.width * .14), minigameSelectButton.y + (minigameSelectButton.width * .20))
                }
                    roomSelectionBox.draw()
                    stockSelectionBox.draw()
                    optionsButton.radius = 100
                    optionsButton.draw()
                    canvas_context.font = "90px arial"
                    canvas_context.fillStyle = "#FF0000"
                    canvas_context.fillText(`X`, optionsButton.x - (optionsButton.radius * .3), optionsButton.y + (optionsButton.radius * .20))

                    canvas_context.font = "30px arial"
                    localButton.draw()
                    canvas_context.fillStyle = "#000000"
                    canvas_context.fillText(`Local Match`, localButton.x + (localButton.width * .25), localButton.y + (localButton.width * .20))

                    canvas_context.font = "30px arial"
                    saveScoreButton.draw()
                    canvas_context.fillStyle = "#000000"
                    canvas_context.fillText(`Save Scores`, saveScoreButton.x + (saveScoreButton.width * .25), saveScoreButton.y + (saveScoreButton.width * .20))
                    
                    canvas_context.font = "30px arial"
                    campaignButton.draw()
                    canvas_context.fillStyle = "#000000"
                    canvas_context.fillText(`Campaign`, campaignButton.x + (campaignButton.width * .3), campaignButton.y + (campaignButton.width * .20))
                    AIFightButton.draw()
                    canvas_context.fillStyle = "#000000"
                    canvas_context.fillText(`AI Match`, AIFightButton.x + (AIFightButton.width * .3), AIFightButton.y + (AIFightButton.width * .20))
                    onlineButton.draw()
                    canvas_context.fillStyle = "#000000"
                    if (onlineButton.color == "#00FF00") {
                        canvas_context.fillText(`Online`, onlineButton.x + (onlineButton.width * .225), onlineButton.y + (onlineButton.width * .20))
                    } else {
                        canvas_context.fillStyle = "#FFFFFF"
                        canvas_context.fillText(`Offline`, onlineButton.x + (onlineButton.width * .225), onlineButton.y + (onlineButton.width * .15))
                    }
                }
            } else {


                if (optionsToggle == 0) {
                    optionsButton.radius = 240
                    optionsButton.draw()
                    canvas_context.font = "40px arial"
                    canvas_context.fillStyle = "black"
                    canvas_context.fillText(`Click For Options`, optionsButton.x - (optionsButton.radius * .6), optionsButton.y + (optionsButton.radius * 0))

                } else {

                    minigameSelectButton.draw()
                    canvas_context.font = "30px arial"
                    canvas_context.fillStyle = "#000000"
                    canvas_context.fillText(`Minigames`, minigameSelectButton.x + (minigameSelectButton.width * .14), minigameSelectButton.y + (minigameSelectButton.width * .20))

                    roomSelectionBox.draw()
                    stockSelectionBox.draw()
                    optionsButton.radius = 100
                    optionsButton.draw()
                    canvas_context.font = "90px arial"
                    canvas_context.fillStyle = "#FF0000"
                    canvas_context.fillText(`X`, optionsButton.x - (optionsButton.radius * .3), optionsButton.y + (optionsButton.radius * .20))

                    canvas_context.font = "30px arial"
                    localButton.draw()
                    canvas_context.fillStyle = "#000000"
                    canvas_context.fillText(`Local Match`, localButton.x + (localButton.width * .25), localButton.y + (localButton.width * .20))
                    

                    canvas_context.font = "30px arial"
                    saveScoreButton.draw()
                    canvas_context.fillStyle = "#000000"
                    canvas_context.fillText(`Save Scores`, saveScoreButton.x + (saveScoreButton.width * .25), saveScoreButton.y + (saveScoreButton.width * .20))
                    

                    canvas_context.font = "30px arial"
                    campaignButton.draw()
                    canvas_context.fillStyle = "#000000"
                    canvas_context.fillText(`Campaign`, campaignButton.x + (campaignButton.width * .3), campaignButton.y + (campaignButton.width * .20))
                    AIFightButton.draw()
                    canvas_context.fillStyle = "#000000"
                    canvas_context.fillText(`AI Match`, AIFightButton.x + (AIFightButton.width * .3), AIFightButton.y + (AIFightButton.width * .20))
                    onlineButton.draw()
                    canvas_context.fillStyle = "#000000"
                    if (onlineButton.color == "#00FF00") {
                        canvas_context.fillText(`Online`, onlineButton.x + (onlineButton.width * .225), onlineButton.y + (onlineButton.width * .20))
                    } else {
                        canvas_context.fillStyle = "#FFFFFF"
                        canvas_context.fillText(`Offline`, onlineButton.x + (onlineButton.width * .225), onlineButton.y + (onlineButton.width * .15))
                    }
                    mapSelectButton.draw()
                    canvas_context.fillStyle = "#000000"
                    canvas_context.fillText(`Map Select`, mapSelectButton.x + (mapSelectButton.width * .3), mapSelectButton.y + (mapSelectButton.width * .20))
                }
                descriptor.draw()
                massSelector.draw()
                boySelector.draw()
                blastSelector.draw()
                joxSelector.draw()
                scorchSelector.draw()
                gwompeiSelector.draw()
                asigSelector.draw()
                prinSelector.draw()
                rhophoSelector.draw()
                banandroidSelector.draw()
                funkySelector.draw()
                dummySelector.draw()
                doctorSelector.draw()
                jouleSelector.draw()
                kesslerSelector.draw()
                pinwheelianSelector.draw()

                canvas_context.font = "60px arial"
                canvas_context.fillStyle = "black"
                canvas_context.fillText(`Mass`, massSelector.x - (massSelector.radius * .4), massSelector.y + (massSelector.radius * 0))

                canvas_context.font = "60px arial"
                canvas_context.fillStyle = "black"
                canvas_context.fillText(`Coreboy`, boySelector.x - (boySelector.radius * .6), boySelector.y - (boySelector.radius * .3))

                canvas_context.font = "60px arial"
                canvas_context.fillStyle = "black"
                canvas_context.fillText(`Blastgirl`, blastSelector.x - (blastSelector.radius * .6), blastSelector.y - (blastSelector.radius * 0))

                canvas_context.font = "60px arial"
                canvas_context.fillStyle = "black"
                canvas_context.fillText(`Jox`, joxSelector.x - (joxSelector.radius * .2), joxSelector.y - (joxSelector.radius * .5))

                canvas_context.font = "40px arial"
                canvas_context.fillStyle = "#FFFFFF"
                canvas_context.fillText(`Scorched Mass`, scorchSelector.x - (scorchSelector.radius * .7), scorchSelector.y - (scorchSelector.radius * .5))

                canvas_context.font = "60px arial"
                canvas_context.fillStyle = "#FFFFFF"
                canvas_context.fillText(`Gwomp`, gwompeiSelector.x - (gwompeiSelector.radius * .5), gwompeiSelector.y + (gwompeiSelector.radius * .0))

                canvas_context.font = "50px arial"
                canvas_context.fillStyle = "black"
                canvas_context.fillText(`Adobrasig Man`, asigSelector.x - (asigSelector.radius * .8), asigSelector.y - (asigSelector.radius * .1))

                canvas_context.font = "60px arial"
                canvas_context.fillStyle = "#000000"
                canvas_context.strokeStyle = "#FFFFFF"
                canvas_context.lineWidth = 6
                canvas_context.strokeText(`Princess`, prinSelector.x - (prinSelector.radius * .60), prinSelector.y - (prinSelector.radius * .4))
                canvas_context.strokeText(`GeGeGeGee`, prinSelector.x - (prinSelector.radius * .85), prinSelector.y - (prinSelector.radius * .15))
                canvas_context.fillText(`Princess`, prinSelector.x - (prinSelector.radius * .6), prinSelector.y - (prinSelector.radius * .4))
                canvas_context.fillText(`GeGeGeGee`, prinSelector.x - (prinSelector.radius * .85), prinSelector.y - (prinSelector.radius * .15))

                canvas_context.font = "60px arial"
                canvas_context.fillStyle = "black"
                canvas_context.fillText(`Rhopho`, rhophoSelector.x - (rhophoSelector.radius * .54), rhophoSelector.y - (rhophoSelector.radius * .5))

                canvas_context.font = "60px arial"
                canvas_context.fillStyle = "#FFFFFF"
                canvas_context.fillText(`Banandroid`, banandroidSelector.x - (banandroidSelector.radius * .75), banandroidSelector.y - (banandroidSelector.radius * .3))


                canvas_context.font = "60px arial"
                canvas_context.fillStyle = "#000000"
                canvas_context.fillText(`Pinwheelian`, pinwheelianSelector.x - (pinwheelianSelector.radius * .795), pinwheelianSelector.y - (pinwheelianSelector.radius * .02))

                canvas_context.font = "60px arial"
                canvas_context.fillStyle = "#00FF00"
                canvas_context.fillText(`Funky`, funkySelector.x - (funkySelector.radius * .4), funkySelector.y - (funkySelector.radius * .3))
                canvas_context.fillText(`Bunkstanks`, funkySelector.x - (funkySelector.radius * .75), funkySelector.y - (funkySelector.radius * .05))


                canvas_context.font = "60px arial"
                canvas_context.fillStyle = "#000000"
                canvas_context.fillText(`Dummy`, dummySelector.x - (dummySelector.radius * .5), dummySelector.y - (dummySelector.radius * .0))
                canvas_context.fillText(`Training`, dummySelector.x - (dummySelector.radius * .51), dummySelector.y - (dummySelector.radius * .25))

                canvas_context.font = "40px arial"
                canvas_context.fillStyle = "#FFFFFF"
                canvas_context.fillText(`Doctor Soto`, doctorSelector.x - (doctorSelector.radius * .55), doctorSelector.y - (doctorSelector.radius * .1))

                canvas_context.font = "50px arial"
                canvas_context.fillStyle = "#FFFFFF"
                canvas_context.fillText(`Joule`, jouleSelector.x - (jouleSelector.radius * .35), jouleSelector.y - (jouleSelector.radius * .45))

                canvas_context.font = "50px arial"
                canvas_context.fillStyle = "#000000"
                canvas_context.fillText(`Kessler`, kesslerSelector.x - (kesslerSelector.radius * .40), kesslerSelector.y - (kesslerSelector.radius * .65))

                for (let t = 0; t < selectors.length; t++) {
                    if (t == connectionnumber || AItoggle == 1 || localPlayToggle == 1 || localPlayToggle == 1) {
                        selectors[t].draw()
                    }
                }

                canvas_context.font = "60px arial"
                canvas_context.fillStyle = "white"
                canvas_context.fillText(`Press Space to Start`, 50, 60)
                if (start == 0) {
                    canvas_context.fillText(`Connecting`, 700, 60)
                }
            }

            if(optionsToggle == 0){
                    minigameSelectToggle = 0
                    mapSelectToggle = 0
                }
            if (keysPressed[' ']) {
                if(minigameSelected == 9){
                    canvas_context.scale(invscale, invscale)
                                 scale = .2
                                 invscale = 1 / scale
                                canvas_context.scale(scale, scale)
                }
                if(minigameSelected == 11){
                    canvas_context.scale(invscale, invscale)
                                 scale = .16
                                 invscale = 1 / scale
                                canvas_context.scale(scale, scale)
                }
                if(minigameSelected == 12){
                    canvas_context.scale(invscale, invscale)
                                 scale = .1
                                 invscale = 1 / scale
                                canvas_context.scale(scale, scale)
                }
                minigameSelectToggle = 0
                roomSelectionBox.focus = 0
                let wet = boys.length
                for (let t = 0; t < selectors.length; t++) {
                    for (let k = 0; k < characterbuttons.length; k++) {
                        if (characterbuttons[k].isPointInside(selectors[t].body)) {
                            let coreboy
                            ////////////////////////////////console.log("caseD")
                            if (k == 0) {

                                coreboy = new Mass(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else if (k == 1) {
                                coreboy = new Boy(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else if (k == 2) {
                                coreboy = new Blastgirl(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else if (k == 3) {
                                coreboy = new Jox(boys.length)
                                pick = k
                                coreboy.body.color = invertColor(selectors[t].body.color)
                            } else if (k == 4) {
                                coreboy = new ScorchedMass(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else if (k == 5) {
                                coreboy = new AsigMan(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else if (k == 6) {
                                coreboy = new Princess(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else if (k == 7) {
                                coreboy = new Rhopho(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else if (k == 8) {
                                coreboy = new Banandroid(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else if (k == 9) {
                                coreboy = new Bunkstanks(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else if (k == 10) {
                                coreboy = new Dummy(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else if (k == 11) {
                                coreboy = new DrSoto(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else if (k == 12) {
                                coreboy = new Joule(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else if (k == 13) {
                                coreboy = new Kessler(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else if (k == 14) {
                                coreboy = new Pinwheelian(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else if (k == 15) {
                                coreboy = new Gwompei(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            } else {

                            }
                            if(minigameSelected == 0){
                                coreboy = new Princess(boys.length)
                                pick = k
                                coreboy.body.color = selectors[t].body.color
                            }
                            if(minigameSelected == 1){
                                coreboy.body.x = 500
                                coreboy.body.y = 1000
                            }

                            if (AItoggle == 1 || localPlayToggle == 1) {
                                boys.push(coreboy)
                                coreboy.id = ID
                                boom.push(new Circle(0, 0, 1, "transparent"))
                                scores.push(0)
                                drops.push(0)

                            } else {
                                for (let u = 0; u < boys.length; u++) {
                                    if (boys[u].serverID == serverID) {
                                        coreboy.id = ID
                                        boys[u] = coreboy
                                        boom.push(new Circle(0, 0, 1, "transparent"))
                                        scores.push(0)
                                        drops.push(0)
                                        wet--
                                    }
                                }

                            }
                        }
                    }
                }

                if (wet == 0) {
                    counter = 1
                }
                counter = 1

                if(minigameSelected == 1){
                                boys[0].body.x = 500
                                boys[0].body.y = 1500

                if (boys.length == 1 && minigameSelected == 1) {
                    const coreboy = genRandomFighter(boys.length)
                    boys.push(coreboy)
                    coreboy.id = ID
                    boom.push(new Circle(0, 0, 1, "transparent"))
                    scores.push(0)
                    drops.push(0)
                }
                }

                let localplayer = 0
                for (let t = 0; t < boys.length; t++) {
                    if (boys[t].serverID == serverID) {
                        localplayer = 1
                    }
                }

                if (localplayer == 0) {
                    for (let t = 0; t < selectors.length; t++) {
                        for (let k = 0; k < characterbuttons.length; k++) {
                            if (characterbuttons[k].isPointInside(selectors[t].body)) {
                                let coreboy
                                if (k == 0) {

                                    coreboy = new Mass(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                } else if (k == 1) {
                                    coreboy = new Boy(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                } else if (k == 2) {
                                    coreboy = new Blastgirl(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                } else if (k == 3) {
                                    coreboy = new Jox(boys.length)
                                    pick = k
                                    coreboy.body.color = invertColor(selectors[t].body.color)
                                } else if (k == 4) {
                                    coreboy = new ScorchedMass(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                } else if (k == 5) {
                                    coreboy = new AsigMan(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                } else if (k == 6) {
                                    coreboy = new Princess(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                } else if (k == 7) {
                                    coreboy = new Rhopho(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                } else if (k == 8) {
                                    coreboy = new Banandroid(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                } else if (k == 9) {
                                    coreboy = new Bunkstanks(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                } else if (k == 10) {
                                    coreboy = new Dummy(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                } else if (k == 11) {
                                    coreboy = new DrSoto(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                } else if (k == 12) {
                                    coreboy = new Joule(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                } else if (k == 13) {
                                    coreboy = new Kessler(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                }else if (k == 14) {
                                    coreboy = new Pinwheelian(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                } else if (k == 15) {
                                    coreboy = new Gwompei(boys.length)
                                    pick = k
                                    coreboy.body.color = selectors[t].body.color
                                } else {

                                }
                                
                                boys.push(coreboy)
                                coreboy.id = ID
                                boom.push(new Circle(0, 0, 1, "transparent"))
                                scores.push(0)
                                drops.push(0)
                            }
                        }
                    }

                }
                

                if (boys.length == 0) {
                    const coreboy = genRandomFighter(boys.length)
                    boys.push(coreboy)
                    coreboy.id = ID
                    boom.push(new Circle(0, 0, 1, "transparent"))
                    scores.push(0)
                    drops.push(0)
                }

                if (boys.length == 1 && minigameSelected == 1) {
                    const coreboy = genRandomFighter(boys.length)
                    boys.push(coreboy)
                    coreboy.id = ID
                    boom.push(new Circle(0, 0, 1, "transparent"))
                    scores.push(0)
                    drops.push(0)
                }

                if (boys.length == 1) {
                    if (campaignToggle == 0 && (AItoggle == 1 || localPlayToggle == 1)) {
                        if(minigameSelected == -1){
                            const coreboy = new Dummy()
                            boys.push(coreboy)
                            coreboy.id = ID
                            boom.push(new Circle(0, 0, 1, "transparent"))
                            scores.push(0)
                            drops.push(0)
                        }
                    }
                }
                if( minigameSelected == 3){
                    const now = new Date()
                    campaigntimestart = now.getTime()
                }
                if( minigameSelected == 9){
                    const now = new Date()
                    campaigntimestart = now.getTime()
                }
                if( minigameSelected == 7){
                    const now = new Date()
                    campaigntimestart = now.getTime()
                }
                if( minigameSelected == 4){
                    const now = new Date()
                    campaigntimestart = now.getTime()
                }
                if( minigameSelected == 5){
                    const now = new Date()
                    campaigntimestart = now.getTime()
                }
                if( minigameSelected == 10){
                    const now = new Date()
                    campaigntimestart = now.getTime()
                }

                if( minigameSelected == 11){
                    const now = new Date()
                    campaigntimestart = now.getTime()
                }
                if( minigameSelected == 12){
                    const now = new Date()
                    campaigntimestart = now.getTime()
                }

                if (campaignToggle == 1 || minigameSelected == 0  || minigameSelected == 1  || minigameSelected == 6 || minigameSelected == 12) {
                    const now = new Date()
                    campaigntimestart = now.getTime()

                    for (let t = 0; t < boys[0].nodes.length; t++) {
                        boys[0].nodes[t].x = stage.spawnrunner
                    }
                    if (boys.length > 0) {
                        canvas_context.translate((canvas.width * (invscale * .5)) - boys[0].body.x, (canvas.height * (invscale * .5)) - boys[0].body.y)
                        if(minigameSelected == 0){
                            canvas_context.translate(0, -700)
                        }
                    }
                }
                if (boys.length == 1) {
                    // coreboy = new Mass(boys.length)
                    // coreboy.body.color = "#ffffff"
                    // boys.push(coreboy)
                    // boom.push(new Circle(0, 0, 1, "transparent"))
                    // scores.push(0)
                    // drops.push(0)
                }
            }

        }
    }
    // canvas_context.fillText(`${worldcounter}`, 50, 500)


    function JumpIn(fighter) {
        //start with the dummy
        if (scores.includes(120)) {
            const str = `${boys[0].name}: ${scores[0]}, ${boys[1].name}: ${scores[1]}`
            strarr.push(str)
            scores = [0, 0]
            drops = [0, 0]
            let whosUp
            if (fightnum == 0) {
                whosUp = new DrSoto(boys.length)
            } else if (fightnum == 1) {
                whosUp = new Boy(boys.length)
            } else if (fightnum == 2) {
                whosUp = new Blastgirl(boys.length)
            } else if (fightnum == 3) {
                whosUp = new Jox(boys.length)
            } else if (fightnum == 4) {
                whosUp = new ScorchedMass(boys.length)
            } else if (fightnum == 5) {
                whosUp = new AsigMan(boys.length)
            } else if (fightnum == 6) {
                whosUp = new Princess(boys.length)
            } else if (fightnum == 7) {
                whosUp = new Rhopho(boys.length)
            } else if (fightnum == 8) {
                whosUp = new Banandroid(boys.length)
            } else if (fightnum == 9) {
                whosUp = new Bunkstanks(boys.length)
            } else if (fightnum == 10) {
                whosUp = new Mass(boys.length)
            } else if (fightnum == 11) {
                whosUp = new Joule(boys.length)
            } else if (fightnum == 12) {
                whosUp = new Kessler(boys.length)
            }else if (fightnum == 13) {
                whosUp = new Pinwheelian(boys.length)
            }else if (fightnum == 14) {
                whosUp = new Gwompei(boys.length)
            } else {
                if (fightlogged == 0) {
                    console.log(strarr)
                    fightlogged = 1
                }
                whosUp = new Dummy(boys.length)
            }
            boys[1] = whosUp
            fighter = fighter.copy()
            fightnum++
        }
    }

</script>
</html>